<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Allink: src/Addyn/ForcesLoop.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ed615368fd5ab0766bfe5b479d2a7e4e.html">Addyn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ForcesLoop.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;Forces.h&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="classForces.html#a111835c2cd5d392591f9e32ea6d9cf19">    3</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a111835c2cd5d392591f9e32ea6d9cf19">Forces::ChooseSimMode</a>(){</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_2D)){</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    <span class="comment">//CalcUpdate = &amp;Forces::Sim2d;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  }</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="classForces.html#a941bab4d0655ea3e774cd525e664be52">    9</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a941bab4d0655ea3e774cd525e664be52">Forces::Solve</a>(){</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_2D))</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classForces.html#abcac13d7754b73f6f22b2900a0d46d7d">SolveLinksIterative</a>();</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">//SolveLinks();</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_LEAVES))</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classForces.html#a7a03a3d52f5a114cbbc22e60af60c049">SolveLeaves</a>();</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_PORE))</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classForces.html#a7a03a3d52f5a114cbbc22e60af60c049">SolveLeaves</a>();</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_ROD))</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classForces.html#a3953ee74479102530a979e3cd447d174">SolveRod</a>();</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classForces.html#a338adbdaecf3f72150ce3e88ec710bf1">   20</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a338adbdaecf3f72150ce3e88ec710bf1">Forces::Dynamics</a>(){</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_MD)){</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classForces.html#a7a55d93047438c9c5f5f9145a995e8d0">VelVerlet1</a>();</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_2D)){</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classForces.html#aea3ac235b677278906db133f4cfd54f4">Wave</a>();</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  }</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_LEAVES)){</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classForces.html#aed97e42cbfeb918574e91a90719864ab">ForceFieldLeaves</a>();</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_1D)){</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classForces.html#abe46a6cf819d53f35747565f9276854f">ForceFieldLine</a>();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_3D)){</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classForces.html#aa57796d41906bf35c6a79225ecda6f98">ForceFieldBulk</a>();</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_ROD)){</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classForces.html#ae35380222f8a3cacfa4a4df6d1742ffb">ForceFieldRod</a>();</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_RIGID)){</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classForces.html#a8f12492ed75d05c816d8f14bbeaf71be">ForceFieldRigid</a>();</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classForces.html#a050e80ecdb61ccf749649d6ec6542ee7">VelVerletRigid</a>();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_MC)){</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_NVT)){</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="comment">//for(int p=0;p&lt;2*pNPCh();p++) </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#ad69656acc46a08f2361dbe5b1067dffa">TryMove</a>();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_NcVT)){</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#aa30016ca75ff4d48a905a9dad7da023f">TryMoveCh</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_mVT)){</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() &lt; .5) </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a> += <a class="code" href="classForces.html#a0658783c2d6dcab7a875f938747255a6">TryRemove</a>();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">else</span> </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#a56709cda842db1c6f3813acc5bca5237">TryInsert</a>();</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_mcVT)){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span>(!VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_CONF_BIAS)){</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() &lt; .5) <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a> += <a class="code" href="classForces.html#aefc3ccff8a9805e952ddc49194595844">TryRemoveCh</a>();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">else</span> <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#ab7bfa9d7122c69b311f666740653bd0b">TryInsertCh</a>();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() &lt; .5) </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;     <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a> += <a class="code" href="classForces.html#a32c3f4b656bce2cf73370ce605f53113">TryRemoveChBias</a>();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordflow">else</span> </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;     <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#a949d9de0a157e4258f88d5b5f322f74e">TryInsertChBias</a>();</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_ELECTRO)){</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_NVT)){</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#ad69656acc46a08f2361dbe5b1067dffa">TryMove</a>();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_mVT)){</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() &lt; .5) </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a> += <a class="code" href="classForces.html#a0658783c2d6dcab7a875f938747255a6">TryRemove</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">else</span> </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a> += <a class="code" href="classForces.html#a56709cda842db1c6f3813acc5bca5237">TryInsert</a>();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_MD)){</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    OldNrgSys = <a class="code" href="classForces.html#a791c1d5f301eb9c0d39c43a180eaf737">SumForcesMD</a>();</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a98ae2e78109ea826eea71da14c37ce95">Erase</a>();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9">AddPart</a>(p,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a>,SYS_MD)){</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classForces.html#a0ccf73fded29832c9d6c8edad5a51b76">ApplyTherm</a>();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classForces.html#a7965b2207a6253f8215b96a7195cb5bc">VelVerlet2</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classForces.html#af51ff88ae9c6c4b9907f516c09ebf68f">Time</a> += <a class="code" href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">pDeltat</a>();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classVarData.html#aaa11921d5205a7db714c4f733065b710">IncrStep</a>();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classVarData.html#a983f1e3e595a21568bec4d2852011a56">SetTime</a>(<a class="code" href="classForces.html#af51ff88ae9c6c4b9907f516c09ebf68f">Time</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classForces.html#af662b8c150e7cdd3983066e8dab609be">Task</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classForces.html#a49654bba62557156b6599f4875484078">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a49654bba62557156b6599f4875484078">Forces::ExplorePepSize</a>(){</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Explore pep size\n&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a> != SYS_LEAVES) return ;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">char</span> FName[120];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">double</span> HeiMin = .15;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">double</span> HeiMax = .4;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">double</span> HeiStep = (HeiMax-HeiMin)/(<span class="keywordtype">double</span>)NGrid;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">double</span> AngMin = 5.;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> AngMax = 35.;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">double</span> AngStep = (AngMax-AngMin)/(<span class="keywordtype">double</span>)NGrid;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">double</span> SLapMin = 0.001;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">double</span> SLapMax = 10.0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">double</span> SLapStep = 10.;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">double</span> SLap=SLapMin;SLap&lt;SLapMax;SLap*=SLapStep){</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    sprintf(FName,<span class="stringliteral">&quot;PepHeiElThickSLap%lf.dat&quot;</span>,SLap);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    FILE *FWrite = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> Hei=HeiMin;Hei&lt;HeiMax;Hei+=HeiStep){</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">double</span> Angle=AngMin;Angle&lt;AngMax;Angle+=AngStep){</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   fprintf(stderr,<span class="stringliteral">&quot;%lf %lf %lf\r&quot;</span>,SLap,Hei,Angle);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57">Height</a> = Hei;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309">SLap</a> = SLap;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a> = Angle;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="classForces.html#a941bab4d0655ea3e774cd525e664be52">Solve</a>();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordtype">int</span> c = 0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordtype">double</span> Min = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(2);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keywordtype">double</span> Max = 0.;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordtype">double</span> xMin = 0.;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordtype">double</span> xMax = 0.;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p = c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>();p&lt;(c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>();p++){</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[2] &gt; Max &amp;&amp; <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Typ == 0){</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       Max = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[2];</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       xMax = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0];</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   c = 1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p = c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>();p&lt;(c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>();p++){</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[2] &lt; Min &amp;&amp; <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Typ == 0){</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       Min = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[2];</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       xMin = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0];</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   fprintf(FWrite,<span class="stringliteral">&quot;%lf %lf %lf %lf %lf\n&quot;</span>,Hei/.2,Angle,(Min-Max)/.2,SLap,.5*(xMin+xMax)/.2);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    fclose(FWrite);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classForces.html#a9ebbcc00e2ef112a3739e90118698f80">  145</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a9ebbcc00e2ef112a3739e90118698f80">Forces::ExplorePepSize2d</a>(){</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Explore pep size 2d\n&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a> != SYS_2D) return ;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30">SetEdge</a>(.5*MIN(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(1)),3);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">char</span> FName[120];</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">double</span> HeiMin = 0.2;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">double</span> HeiMax = 4.2;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">double</span> HeiStep = (HeiMax-HeiMin)/(<span class="keywordtype">double</span>)NGrid;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">double</span> AngMin = 0.;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">double</span> AngMax = 80.;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">double</span> AngStep = (AngMax-AngMin)/(<span class="keywordtype">double</span>)NGrid;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">double</span> InvNBin = 1./(double)NBin;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classVarData.html#acefa5842862d4587442db05af40e7490">SysFormat</a> = VAR_SYS_TXVL;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">double</span> Angle=AngMin;Angle&lt;AngMax;Angle+=AngStep){</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> Hei=HeiMin;Hei&lt;HeiMax;Hei+=HeiStep){</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;%lf %lf\r&quot;</span>,Hei,Angle);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57">Height</a> = Hei;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a> = Angle;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="classForces.html#a941bab4d0655ea3e774cd525e664be52">Solve</a>();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      sprintf(FName,<span class="stringliteral">&quot;Sol2dHei%.1fAng%02d.dat&quot;</span>,Hei,(<span class="keywordtype">int</span>)Angle);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb">Write</a>(FName);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classForces.html#a3efc71eff5d768421c05dc9f9ef801d1">  170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a3efc71eff5d768421c05dc9f9ef801d1">Forces::ExploreDoubleMin</a>(){</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Explore pep size\n&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">char</span> String[120];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">SysShape</a> != SYS_2D) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>() &lt; 2) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> DistMin = <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(1,0);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">double</span> DistDelta = (<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(0)-<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(1,0))/(<span class="keywordtype">double</span>)NGrid;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">double</span> DeltaGrid = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(0)/(double)<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f">nEdge</a>[0];</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// DistDelta = floor(2.*DistDelta/DeltaGrid)*DeltaGrid;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// SigErr(DistDelta &lt;= 0.,&quot;The grid step is too short for %d distances &quot;,NGrid);</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">char</span> FName[60];</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  FILE *FProf = fopen(<span class="stringliteral">&quot;DistThinMin.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NGrid;i++){</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;done %.2f %%\r&quot;</span>,100.*i/(<span class="keywordtype">double</span>)NGrid);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classForces.html#a1d4b4e62a626434fc48475224ab89dca">IfFillMatrix</a> = 1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classForces.html#a941bab4d0655ea3e774cd525e664be52">Solve</a>();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    sprintf(FName,<span class="stringliteral">&quot;MinProf%03d.dat&quot;</span>,i);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    FILE *FWrite = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classVarData.html#ab0cc3088657341d2696949515927e91c">StringNano</a>(String,0);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    fprintf(FWrite,String);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classVarData.html#ab0cc3088657341d2696949515927e91c">StringNano</a>(String,1);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    fprintf(FWrite,String);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">double</span> Min = 100000.;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">double</span> Dist = 0.;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">double</span> zOld = 100000.;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> IfContinue = 0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">int</span> nBin = 0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f">nEdge</a>[1]/2+1;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p+=<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f">nEdge</a>[1]){</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">double</span> x = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">pPos</a>(p,0) - <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(0,0);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordtype">double</span> z = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">pPos</a>(p,2);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">pType</a>(p) == 1) z = <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(0,2) + .5*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[0].<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57">Height</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span>( x &gt; (<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(1,0) - <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(0,0) )) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      fprintf(FWrite,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,z);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span>( x &gt; .6*(<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(1,0) - <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">pNanoPos</a>(0,0) )) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span>(Min &gt; z){<span class="comment">// &amp;&amp; IfContinue){</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   Min = z;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   Dist = x;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   nBin = p;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">// if(z &gt; zOld){IfContinue = 1;}</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">// zOld = z;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    fprintf(FProf,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[1].Pos[0]-<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[0].Pos[0],Dist,Min);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    fflush(FProf);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    fclose(FWrite);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    sprintf(FName,<span class="stringliteral">&quot;Sol2dDist%.3f.dat&quot;</span>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[1].Pos[0]-<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[0].Pos[0]);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classVarData.html#a76873542f36c8e36b790c90273c95cf1">WriteTxvl</a>(FName);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[1].<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] += DistDelta;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[1].Pos[0] &gt; <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(0)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  fclose(FProf);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classForces.html#abfa5f0b075c87a5ae914d91c5481c359">  223</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#abfa5f0b075c87a5ae914d91c5481c359">Forces::RunWidom</a>(<span class="keywordtype">char</span> *File2Open,<span class="keywordtype">int</span> f){</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Widom on particles\n&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">int</span> NInt = 10000;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">double</span> NrgDiff = 0.;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordtype">char</span> File2Write[60];</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  sprintf(File2Write,<span class="stringliteral">&quot;WidomOut%05d.dat&quot;</span>,f);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(File2Open,BF_PART);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  FILE *WidomOut = fopen(File2Write,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  SigErr(WidomOut==NULL,<span class="stringliteral">&quot;Cannot allocate %s\n&quot;</span>,File2Write);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classForces.html#a85d825b7b4af29d476abbf098ce630e3">WidomRemove</a>(&amp;NrgDiff,p);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    fprintf(WidomOut,<span class="stringliteral">&quot;%lf\n&quot;</span>,NrgDiff);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  fclose(WidomOut);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  sprintf(File2Write,<span class="stringliteral">&quot;WidomIn%05d.dat&quot;</span>,f);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  FILE *WidomIn = fopen(File2Write,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;NInt;p++){</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classForces.html#af9eda9a781eabd31a8813c9a64f2d5ec">WidomInsert</a>(&amp;NrgDiff);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    fprintf(WidomIn,<span class="stringliteral">&quot;%lf\n&quot;</span>,NrgDiff);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  fclose(WidomIn);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classForces.html#a3f16bbc64bdd8ac4835e6a4702e30678">  245</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a3f16bbc64bdd8ac4835e6a4702e30678">Forces::RosenIn</a>(FILE *WidomIn){</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Widom insertion biased/Rosenbluth\n&quot;</span>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">int</span> NInt = 10000;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordtype">double</span> Weight = 0.;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;NInt;p++){</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classForces.html#af07ae7761f13798c6de1391b10c5856d">WidomBiasChIn</a>(&amp;Weight);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    fprintf(WidomIn,<span class="stringliteral">&quot;%g\n&quot;</span>,Weight);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classForces.html#a7a1566050eaabfebba82e0b6002d797b">  254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a7a1566050eaabfebba82e0b6002d797b">Forces::RosenOut</a>(FILE *WidomIn){</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Widom deletion biased/Rosenbluth\n&quot;</span>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">int</span> NInt = 10000;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">double</span> Weight = 0.;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();c++){</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classForces.html#ab249c91e15e3611167002159ef6d5b60">WidomBiasChOut</a>(&amp;Weight,c);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    fprintf(WidomIn,<span class="stringliteral">&quot;%g\n&quot;</span>,Weight);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classForces.html#ac313c324785f5c7c044e2e94ea39c01c">  263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ac313c324785f5c7c044e2e94ea39c01c">Forces::RunWidomChIn</a>(<span class="keywordtype">char</span> *File2Open,<span class="keywordtype">int</span> f){</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Widom chain in\n&quot;</span>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">int</span> NInt = 5*<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">double</span> NrgDiff[3];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">char</span> File2Write[60];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(File2Open,BF_PART);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  sprintf(File2Write,<span class="stringliteral">&quot;WidomIn%05d.dat&quot;</span>,f);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  FILE *WidomIn = fopen(File2Write,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">//StudySys();</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;NInt;p++){</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classVarData.html#aaa11921d5205a7db714c4f733065b710">IncrStep</a>();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classForces.html#acffb530559d4e3ebfac6481a46468f52">WidomInsertCh</a>(NrgDiff);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    fprintf(WidomIn ,<span class="stringliteral">&quot;%lf\n&quot;</span>,NrgDiff[2]);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  fclose(WidomIn);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classForces.html#a6c88528ae5cf46ad5cc7080ca47ef1fb">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a6c88528ae5cf46ad5cc7080ca47ef1fb">Forces::RunWidomChOut</a>(<span class="keywordtype">char</span> *File2Open,<span class="keywordtype">int</span> f){</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Widom chain out\n&quot;</span>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">double</span> NrgDiff[3];</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">char</span> File2Write[60];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  sprintf(File2Write,<span class="stringliteral">&quot;WidomOut%05d.dat&quot;</span>,f);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(File2Open,BF_PART);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  FILE *WidomOut = fopen(File2Write,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classForces.html#a59c5e973ca9b852115683c3cc2fc6035">CalcTotNrgCh</a>();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();c++){</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classForces.html#a0ab84cf7b372ab5ae21966ed671ee4c3">WidomRemoveCh</a>(NrgDiff,c);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    fprintf(WidomOut,<span class="stringliteral">&quot;%lf\n&quot;</span>,NrgDiff[2]);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  fclose(WidomOut);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classForces.html#aa82709db8e55cc620cfbfb483489f5b6">  293</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#aa82709db8e55cc620cfbfb483489f5b6">Forces::CalcTotNrg</a>(<span class="keywordtype">char</span> *File2Open,<span class="keywordtype">int</span> f){</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Calculating total energy\n&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(File2Open,BF_PART);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">double</span> NrgNb = 0.;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">double</span> NrgSpr = 0.;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">double</span> NrgSpr2 = 0.;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">double</span> NrgBend = 0.;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();c++){</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>();p&lt;(c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>()-1;p++){</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordtype">double</span> DistBA[3];</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordtype">double</span> DistCB[3];</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordtype">double</span> DistBA2 = 0.;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordtype">double</span> DistCB2 = 0.;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordtype">double</span> CosAngle = 0.;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   DistBA[d] = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d];</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   DistBA[d] -= floor(DistBA[d]/(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(d)) + .5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(d);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   DistCB[d] = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d];</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   DistCB[d] -= floor(DistCB[d]/(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(d)) + .5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(d);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   DistBA2 += SQR(DistBA[d]);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   DistCB2 += SQR(DistCB[d]);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   CosAngle += DistBA[d]*DistCB[d];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      DistCB2 = sqrt(DistCB2);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      NrgSpr += .5*<a class="code" href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3">pkSpr</a>()*SQR(DistCB2 - <a class="code" href="classVarData.html#ad180facca71ad48ae3ce77052bf22957">pSprRest</a>());</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span>(p == c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      DistBA2 = sqrt(DistBA2);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      CosAngle /= (DistBA2*DistCB2);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      NrgBend += <a class="code" href="classVarData.html#a395cfa5f68437606051e29df1759e371">pkBen</a>()*(1.-CosAngle);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">double</span> NrgNano = 0.;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    NrgNano += <a class="code" href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">NanoNrg</a>(p);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="classForces.html#a59c5e973ca9b852115683c3cc2fc6035">CalcTotNrgCh</a>();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  printf(<span class="stringliteral">&quot;Nb %lf + Nano %lf = %lf Spr %lf + Ben %lf = %lf\n&quot;</span>,OldNrgSys,NrgNano,OldNrgSys+NrgNano,NrgSpr,NrgBend,NrgSpr+NrgBend);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  fprintf(StatFile1,<span class="stringliteral">&quot;%d %lf %lf %lf %lf\n&quot;</span>,f,OldNrgSys,NrgSpr,NrgBend,NrgNano);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  fflush(StatFile1);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="classForces.html#a6a491826bd0df50e5d4941710783a54c">  333</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a6a491826bd0df50e5d4941710783a54c">Forces::CalcNrgPep</a>(<span class="keywordtype">char</span> *File2Open,<span class="keywordtype">int</span> f){</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Calculating total energy\n&quot;</span>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(File2Open,BF_PART);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="classForces.html#a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b">AddDens</a>(0,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  OldNrgSys = <a class="code" href="classForces.html#a0449e9410bf23ad4d073f1eab66c2a68">SumDens</a>(0,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());  </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="classForces.html#a0390d97ed1665851fb6175342d1c598b">ClearDens</a>();</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0,NPep=0,cOff=0,pOff=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">pNBlock</a>();cOff+=<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>(b++)){</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span>(!strncmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e">Block</a>[b].Name,<span class="stringliteral">&quot;PEP&quot;</span>,3)){</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=cOff;c&lt;cOff+<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>(b);c++,pOff+=<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b)){</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=pOff,link=0;p&lt;MIN(pOff+<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b),<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());p++){</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <a class="code" href="classForces.html#a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b">AddDens</a>(p,p+1);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">double</span> NrgPep = OldNrgSys - <a class="code" href="classForces.html#a0449e9410bf23ad4d073f1eab66c2a68">SumDens</a>(0,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());  </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  printf(<span class="stringliteral">&quot;Nrg pep %lf\n&quot;</span>,NrgPep);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  fprintf(StatFile1,<span class="stringliteral">&quot;%d %lf %lf\n&quot;</span>,f,NrgPep,OldNrgSys);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  fflush(StatFile1);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classForces.html#aac83d4bd108ccaa2c52289f05ea0d009">  354</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a69a4a0318fb6e0382d6e2288a40c9e98">Forces::CalcTens</a>(<span class="keywordtype">char</span> **argv,<span class="keywordtype">int</span> *FilePos,<span class="keywordtype">int</span> <a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959">NFile</a>){</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Calculating tension\n&quot;</span>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="classForces.html#ac6a2e2465107cd1b6eea81aeb80646c2">AllocTens</a>();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">char</span> FName[60];</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;<a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959">NFile</a>;f++){</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Elaborating file %s %.3f %%\r&quot;</span>,argv[FilePos[f]],f/(<span class="keywordtype">double</span>)NFile*100.);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(argv[FilePos[f]],BF_PART);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classForces.html#a69a4a0318fb6e0382d6e2288a40c9e98">CalcTens</a>();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="classForces.html#a44c4bed1843e51f20f252a5dd05f64fe">CalcDens</a>();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span>( !(f%(<a class="code" href="classForces.html#adcaf21deb47f48c1e25997f52ebd09d6">NWrite</a>)) ){</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a">Tens</a>.<a class="code" href="structTENS.html#a5a9396ca53c5306c34eb62ef4f02593b">NComp</a>;c++){</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a">Tens</a>.<a class="code" href="structTENS.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_2d))</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;     sprintf(FName,<span class="stringliteral">&quot;Tension2d%05dL%d.dat&quot;</span>,f,c);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a">Tens</a>.<a class="code" href="structTENS.html#ae7fd260630480928a069e7e536739df1">CalcMode</a>,CALC_3d))</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;     sprintf(FName,<span class="stringliteral">&quot;Tension3d%05dL%d.dat&quot;</span>,f,c);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="classForces.html#a0bd0430e9512fea0edf8d3cc157f6e7f">WriteTens</a>(FName,c,1./(<span class="keywordtype">double</span>)NFile);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classForces.html#acf39045486a7e38d437f191e2a845d83">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#acf39045486a7e38d437f191e2a845d83">Forces::AvForces</a>(<span class="keywordtype">char</span> **argv,<span class="keywordtype">int</span> *FilePos,<span class="keywordtype">int</span> <a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959">NFile</a>){</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;Calculating force field/average force\n&quot;</span>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classForces.html#ac6a2e2465107cd1b6eea81aeb80646c2">AllocTens</a>();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordtype">char</span> FName[60];</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NBin = 120;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">double</span> *Profile = (<span class="keywordtype">double</span> *)calloc(3*NBin,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;<a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959">NFile</a>;f++){</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    fprintf(stderr,<span class="stringliteral">&quot;Elaborating file %s %.3f %%\r&quot;</span>,argv[FilePos[f]],f/(<span class="keywordtype">double</span>)NFile*100.);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">ReOpen</a>(argv[FilePos[f]],BF_PART);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classForces.html#a5c32ef207ba714e72e72de3063860b39">CalcForcesDensFunc</a>();</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    FILE *FForce = fopen(<span class="stringliteral">&quot;ForceProfile.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">double</span> Force[3] = {0.,0.,0.};</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">int</span> cBin[3];</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   cBin[d] = (int)(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[d]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac">pInvEdge</a>(d)*NBin);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keywordflow">if</span>(cBin[d] &lt; 0 || cBin[d] &gt;= NBin) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   Profile[cBin[d]*3+d] += <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   Force[d] += <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   fprintf(FForce,<span class="stringliteral">&quot;%d %g %g %g\n&quot;</span>,p,Force[0],Force[1],Force[2]);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    printf(<span class="stringliteral">&quot;%g %g %g\n&quot;</span>,Force[0],Force[1],Force[2]);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    fclose(FForce);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  FILE *FProf = fopen(<span class="stringliteral">&quot;ForceProfile.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;NBin;b++){</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    fprintf(FProf,<span class="stringliteral">&quot;%d %lf %lf %lf\n&quot;</span>,b,Profile[b*3],Profile[b*3+1],Profile[b*3+2]);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  FILE *FField = fopen(<span class="stringliteral">&quot;ForceField.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">double</span> Delta = sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>)/(double)NTab;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;NTab;b++){</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">double</span> x = b*Delta;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    fprintf(FField,<span class="stringliteral">&quot;%lf &quot;</span>,x);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t1=0;t1&lt;<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>();t1++){</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t2=0;t2&lt;<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>();t2++){</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   fprintf(FField,<span class="stringliteral">&quot;%lf &quot;</span>,FTab[(b*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t1)*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t2]);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    fprintf(FField,<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  free(Profile);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  fclose(FProf);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  fclose(FField);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="classForces.html#af662b8c150e7cdd3983066e8dab609be">  421</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#af662b8c150e7cdd3983066e8dab609be">Forces::Task</a>(){</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">SysAlloc</a>,ALL_MC)){</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">pStep</a>()%<a class="code" href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97">NUpdate</a>)!=0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    OldNrgSys = 0.;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">double</span> Pot[3];</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();c++) OldNrgSys += <a class="code" href="classForces.html#ac028948e0862f18bf805f23078ebf7fa">CalcNrgCh</a>(c,Pot);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//fprintf(TempFile,&quot;%d %d %lf \n&quot;,pStep(),pNChain(),NrgSys/(double)pNChain());</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">//fprintf(StatFile1,&quot;%d %d %lf \n&quot;,pStep(),pNChain(),OldNrgSys/(double)pNChain());</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//fflush(StatFile1);</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// int c = 0;//p%pNPCh();</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// double Pot[3];</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// CalcNrgCh(c,Pot);</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// for(int e=0;e&lt;3;e++) OldNrgCh[c*3+e] = Pot[e];</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// double Dist[4];</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// TwoPartDist(0,pNPCh()-1,Dist);</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// fprintf(TempFile,&quot;%d %lf %lf %lf %lf\n&quot;,pStep(),OldNrgCh[3*0],OldNrgCh[3*0+1],OldNrgCh[3*0+2],Dist[3]);</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">SysAlloc</a>,ALL_MD)){</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">if</span>( !(<a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">pStep</a>()%<a class="code" href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97">NUpdate</a>) ){</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordtype">double</span> v2 = 0.;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     v2 += SQR(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Vel[d]);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="comment">//fprintf(StatFile1,&quot;%d %lf %lf\n&quot;,pStep(),v2/(double)(3*pNPart()),OldNrgSys);</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="comment">//fflush(StatFile1);</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div><div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="classForces.html#a38ef42f2e70e5ed764a0fa0d56757a57">  452</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a38ef42f2e70e5ed764a0fa0d56757a57">Forces::Trial</a>(){</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="classForces.html#a419ca9dee6d5e955abe44cf409e24d66">CheckPairList</a>();</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="classForces.html#aadef342da0e2abb136031d2df4c264bf">  455</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#aadef342da0e2abb136031d2df4c264bf">Forces::RunDynamics</a>(){</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Shout</a>(<span class="stringliteral">&quot;run dynamics\n&quot;</span>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">double</span> NLoopSec = 0.;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordtype">char</span> FileName[60];</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="classForces.html#ad7e01b1bd04ce252d991ae872eaa5270">DefForceParam</a>();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">//MinimalNrg();</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;<a class="code" href="classForces.html#afa426c87de325a8eb41e1f2a29485003">SimLimit</a>;s++){</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classForces.html#a338adbdaecf3f72150ce3e88ec710bf1">Dynamics</a>();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">//MinimalMD();</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span>( !(s%<a class="code" href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97">NUpdate</a>) ){</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      CurrTime = time(NULL);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      NLoopSec += (s)/(<span class="keywordtype">double</span>)(CurrTime-InitTime);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">double</span> Temp = 0.;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;     Temp += SQR(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Vel[d]);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      Temp = Temp/(double)(3*<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;NPart %d loop/ms %.3g acc/step %.3f in/out %.4f T %.4f accomplished %.3f %% Nrg %lf\n&quot;</span>,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>(),NLoopSec,(<a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a>+<a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a>)/(<span class="keywordtype">double</span>)s,<a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a>/(<span class="keywordtype">double</span>)<a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a>,Temp,s/(<span class="keywordtype">double</span>)(SimLimit)*100.,OldNrgSys);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      fprintf(StatFile1,<span class="stringliteral">&quot;%d %lf %lf\n&quot;</span>,s,OldNrgSys,Temp);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span>( !(s%(<a class="code" href="classForces.html#adcaf21deb47f48c1e25997f52ebd09d6">NWrite</a>)) ){</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      sprintf(FileName,<span class="stringliteral">&quot;Trajectory%09d.dat&quot;</span>,<a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">pStep</a>());</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb">Write</a>(FileName);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  CurrTime = time(NULL);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  NLoopSec += (<a class="code" href="classForces.html#afa426c87de325a8eb41e1f2a29485003">SimLimit</a>)/(<span class="keywordtype">double</span>)(CurrTime-InitTime);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">double</span> v2 = 0.;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      v2 += SQR(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Vel[d]);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  fprintf(StatFile1,<span class="stringliteral">&quot;##NPart %d loop/ms %.3g acc/step %.3f in/out %.4f T %.4f accomplished Nrg %lf\r&quot;</span>,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>(),NLoopSec,(<a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a>+<a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a>)/(<span class="keywordtype">double</span>)<a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">pStep</a>(),<a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">NInsertion</a>/(<span class="keywordtype">double</span>)<a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">NRemoval</a>,v2/(<span class="keywordtype">double</span>)(3*<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>()),OldNrgSys);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div><div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classForces.html#a8f18498c3494e8fe2476f90f9631c6a8">  493</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a8f18498c3494e8fe2476f90f9631c6a8">Forces::MinimalNrg</a>(){</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">double</span> Pos[3];</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">double</span> Pot[3];</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">double</span> DistRel[4];</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  OldNrgSys = 0.;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a98ae2e78109ea826eea71da14c37ce95">Erase</a>();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">pPos</a>(p,Pos);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9">AddPart</a>(p,Pos);}</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p1=0;p1&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p1++){</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">SysAlloc</a>,ALL_FORCES)){</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p1].Dir[d] = 0.;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a74b7b0d716684a7d46993c83795fd9e7">SetCurr</a>(p1);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a63c5d18d3a487d1a8ab2a5881c6acb38">IfCurr</a>();<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a42eeb7049c078ca89057fbc08726eded">NextCurr</a>()){</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordtype">int</span> p2 = <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDomDecBasics.html#a28d65a777a97b96280ca0f9173c76c93">p2Curr</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">if</span>(p2 &lt;= p1) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#ad4860e7b4a26d4b424e5c98b7c6bae09">Dist2Curr</a>(DistRel);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">if</span>(DistRel[3] &gt; <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordtype">double</span> Cons = <a class="code" href="classForces.html#ac5ef477f97601b779392b8622ac6b1fe">Potential</a>(DistRel[3],<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">pType</a>(p1),<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">pType</a>(p2),Pot);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordtype">double</span> InvDist = DistRel[3];</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">SysAlloc</a>,ALL_FORCES)){</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += Cons*DistRel[d]*InvDist;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p2].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= Cons*DistRel[d]*InvDist;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      OldNrgSys += Pot[0];</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classForces.html#a3ee2891acdfca29fc27e89883f2a2df4">  521</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a3ee2891acdfca29fc27e89883f2a2df4">Forces::MinimalMD</a>(){</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordtype">double</span> Sigma = sqrt(<a class="code" href="classVarData.html#a495c5b182109864eb1db337d49a53999">pTemp</a>());</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">double</span> Pos[3];</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2">Vel</a>[d] += .5*<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d]*<a class="code" href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">pDeltat</a>();</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d] += <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2">Vel</a>[d]*<a class="code" href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">pDeltat</a>();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d] -= floor(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[d]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac">pInvEdge</a>(d))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">pEdge</a>(d);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <a class="code" href="classForces.html#a8f18498c3494e8fe2476f90f9631c6a8">MinimalNrg</a>();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">//vv2</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordtype">double</span> Temp = 0.;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2">Vel</a>[d] += .5*<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d]*<a class="code" href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">pDeltat</a>();</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      Temp += SQR(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Vel[d]);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//Andersen</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() &lt; <a class="code" href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">pDeltat</a>()){</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2">Vel</a>[d] = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#ad14013038c5963ed49ca1236e681db10">Gaussiano</a>(0.,Sigma);<span class="comment">//Mat-&gt;Gaussiano(0.,Sigma);</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  Temp = Temp/(3*<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">double</span> Norm = 1./sqrt(Temp);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// for(int p=0;p&lt;pNPart();p++){</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">//   for(int d=0;d&lt;3;d++){</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">//     Pm[p].Vel[d] *= Norm;</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">//   }</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div><div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="classForces.html#a4a0ed3bb2c5155bda06158b0e918cd34">  556</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a4a0ed3bb2c5155bda06158b0e918cd34">Forces::MinimizeSol</a>(){</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordtype">double</span> *Sol2d = (<span class="keywordtype">double</span> *)calloc(SQR(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>),<span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordtype">double</span> *Count = (<span class="keywordtype">double</span> *)calloc(SQR(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>),<span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordtype">double</span> NInvEdge = 1./(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">pType</a>(p) != 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">int</span> vx = (<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0]*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac">pInvEdge</a>(0));</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span>(vx &lt; 0 || vx &gt;= <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">int</span> vy = (<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[1]*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac">pInvEdge</a>(1));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span>(vy &lt; 0 || vy &gt;= <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    Sol2d[vx*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>+vx] = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[2];</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    Count[vx*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>+vx] = 1.;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vx=0;vx&lt;SQR(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>);vx++){</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">double</span> Norm = Count[vx] &gt; 0. ?  1./Count[vx] : 1.;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    Sol2d[vx] *= Norm;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="classForces.html#a9e66d18b6b637a388161c4310deb71e9">Create2d</a>();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">int</span> NInt = 1000;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NInt;n++){</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    </div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;}</div><div class="ttc" id="classForces_html_aa30016ca75ff4d48a905a9dad7da023f"><div class="ttname"><a href="classForces.html#aa30016ca75ff4d48a905a9dad7da023f">Forces::TryMoveCh</a></div><div class="ttdeci">int TryMoveCh()</div><div class="ttdoc">Trial desplacement of a chain. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00649">ForcesIntegration.cpp:649</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a9a64ea1512bb8d62f9f6a7a80a2bfec9"><div class="ttname"><a href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9">DdLinkedList::AddPart</a></div><div class="ttdeci">void AddPart(const int p, double *Pos)</div><div class="ttdoc">Add a particle to the cell c. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00276">Cubo.cpp:276</a></div></div>
<div class="ttc" id="classForces_html_aadef342da0e2abb136031d2df4c264bf"><div class="ttname"><a href="classForces.html#aadef342da0e2abb136031d2df4c264bf">Forces::RunDynamics</a></div><div class="ttdeci">void RunDynamics()</div><div class="ttdoc">Run a step further. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00455">ForcesLoop.cpp:455</a></div></div>
<div class="ttc" id="classForces_html_a69a4a0318fb6e0382d6e2288a40c9e98"><div class="ttname"><a href="classForces.html#a69a4a0318fb6e0382d6e2288a40c9e98">Forces::CalcTens</a></div><div class="ttdeci">void CalcTens()</div><div class="ttdoc">Calculate the forces for the tension profile. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesTens_8cpp_source.html#l00085">ForcesTens.cpp:85</a></div></div>
<div class="ttc" id="classForces_html_af07ae7761f13798c6de1391b10c5856d"><div class="ttname"><a href="classForces.html#af07ae7761f13798c6de1391b10c5856d">Forces::WidomBiasChIn</a></div><div class="ttdeci">void WidomBiasChIn(double *Weight)</div><div class="ttdoc">Widom with Rosenbluth weight. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00926">ForcesIntegration.cpp:926</a></div></div>
<div class="ttc" id="classVarData_html_a395cfa5f68437606051e29df1759e371"><div class="ttname"><a href="classVarData.html#a395cfa5f68437606051e29df1759e371">VarData::pkBen</a></div><div class="ttdeci">double pkBen()</div><div class="ttdoc">Bending coupling. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00932">VarData.h:932</a></div></div>
<div class="ttc" id="classForces_html_a9ebbcc00e2ef112a3739e90118698f80"><div class="ttname"><a href="classForces.html#a9ebbcc00e2ef112a3739e90118698f80">Forces::ExplorePepSize2d</a></div><div class="ttdeci">void ExplorePepSize2d()</div><div class="ttdoc">Find the minimun bilayer thickness for different peptide sizes. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00145">ForcesLoop.cpp:145</a></div></div>
<div class="ttc" id="classForces_html_aa82709db8e55cc620cfbfb483489f5b6"><div class="ttname"><a href="classForces.html#aa82709db8e55cc620cfbfb483489f5b6">Forces::CalcTotNrg</a></div><div class="ttdeci">void CalcTotNrg(char *FName, int nFile)</div><div class="ttdoc">Total energy of the system. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00293">ForcesLoop.cpp:293</a></div></div>
<div class="ttc" id="classForces_html_a59c5e973ca9b852115683c3cc2fc6035"><div class="ttname"><a href="classForces.html#a59c5e973ca9b852115683c3cc2fc6035">Forces::CalcTotNrgCh</a></div><div class="ttdeci">double CalcTotNrgCh()</div><div class="ttdoc">Calculate and sum up the energy of the chains. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00411">ForcesCalcEnergies.cpp:411</a></div></div>
<div class="ttc" id="classForces_html_a38ef42f2e70e5ed764a0fa0d56757a57"><div class="ttname"><a href="classForces.html#a38ef42f2e70e5ed764a0fa0d56757a57">Forces::Trial</a></div><div class="ttdeci">void Trial()</div><div class="ttdoc">Trial loop. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00452">ForcesLoop.cpp:452</a></div></div>
<div class="ttc" id="classForces_html_a7a55d93047438c9c5f5f9145a995e8d0"><div class="ttname"><a href="classForces.html#a7a55d93047438c9c5f5f9145a995e8d0">Forces::VelVerlet1</a></div><div class="ttdeci">void VelVerlet1()</div><div class="ttdoc">First step of the velocity Verlet. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00942">ForcesIntegration.cpp:942</a></div></div>
<div class="ttc" id="classForces_html_ae1da38d5d966b9236ebd3641d103546d"><div class="ttname"><a href="classForces.html#ae1da38d5d966b9236ebd3641d103546d">Forces::NInsertion</a></div><div class="ttdeci">int NInsertion</div><div class="ttdoc">Count accepted moves. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00767">Forces.h:767</a></div></div>
<div class="ttc" id="classForces_html_abe46a6cf819d53f35747565f9276854f"><div class="ttname"><a href="classForces.html#abe46a6cf819d53f35747565f9276854f">Forces::ForceFieldLine</a></div><div class="ttdeci">int ForceFieldLine()</div><div class="ttdoc">Helfrich Hamiltonian for a line. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00004">ForcesForceField.cpp:4</a></div></div>
<div class="ttc" id="classForces_html_a0bd0430e9512fea0edf8d3cc157f6e7f"><div class="ttname"><a href="classForces.html#a0bd0430e9512fea0edf8d3cc157f6e7f">Forces::WriteTens</a></div><div class="ttdeci">void WriteTens(char *TFile, int Comp, double InvNFile)</div><div class="ttdoc">Write the pressure and density profile. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesTens_8cpp_source.html#l00324">ForcesTens.cpp:324</a></div></div>
<div class="ttc" id="classForces_html_a9e66d18b6b637a388161c4310deb71e9"><div class="ttname"><a href="classForces.html#a9e66d18b6b637a388161c4310deb71e9">Forces::Create2d</a></div><div class="ttdeci">void Create2d()</div><div class="ttdoc">Create a plane of connected beads. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCreate_8cpp_source.html#l00071">ForcesCreate.cpp:71</a></div></div>
<div class="ttc" id="classVarData_html_ab8ead2169b1b4894b78fd3c264b6009e"><div class="ttname"><a href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e">VarData::Block</a></div><div class="ttdeci">BLOCK * Block</div><div class="ttdoc">Information for every block. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01054">VarData.h:1054</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a98ae2e78109ea826eea71da14c37ce95"><div class="ttname"><a href="classDdLinkedList.html#a98ae2e78109ea826eea71da14c37ce95">DdLinkedList::Erase</a></div><div class="ttdeci">void Erase()</div><div class="ttdoc">Erase the pairlist. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00258">Cubo.cpp:258</a></div></div>
<div class="ttc" id="structPART_html_afd1b3747170c238c06ba3420cbc5c2a2"><div class="ttname"><a href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2">PART::Vel</a></div><div class="ttdeci">double Vel[4]</div><div class="ttdoc">xyzr Velocity of the particle </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00220">VarData.h:220</a></div></div>
<div class="ttc" id="classForces_html_a32c3f4b656bce2cf73370ce605f53113"><div class="ttname"><a href="classForces.html#a32c3f4b656bce2cf73370ce605f53113">Forces::TryRemoveChBias</a></div><div class="ttdeci">int TryRemoveChBias()</div><div class="ttdoc">Trial biased removal of a chain. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00854">ForcesIntegration.cpp:854</a></div></div>
<div class="ttc" id="classVarData_html_aee5ea3e3c08ea9745e40192350f5d14b"><div class="ttname"><a href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">VarData::Nano</a></div><div class="ttdeci">NANO * Nano</div><div class="ttdoc">Extra particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01044">VarData.h:1044</a></div></div>
<div class="ttc" id="structNANO_html_a2c39c1efe4f21bf1103d46b0a4e8f5a9"><div class="ttname"><a href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">NANO::Hamaker</a></div><div class="ttdeci">double Hamaker</div><div class="ttdoc">Strength of the interaction. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00447">VarData.h:447</a></div></div>
<div class="ttc" id="classForces_html_abfa5f0b075c87a5ae914d91c5481c359"><div class="ttname"><a href="classForces.html#abfa5f0b075c87a5ae914d91c5481c359">Forces::RunWidom</a></div><div class="ttdeci">void RunWidom(char *File2Read, int f)</div><div class="ttdoc">Build the widom histograms. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00223">ForcesLoop.cpp:223</a></div></div>
<div class="ttc" id="classVarData_html_a054aab836dcf7735720ef32e0b8f7ecb"><div class="ttname"><a href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb">VarData::Write</a></div><div class="ttdeci">bool Write(char *OutFile)</div><div class="ttdoc">Writes a &quot;system-file&quot; or a &quot;x y z&quot; file&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataWrite_8cpp_source.html#l00048">VarDataWrite.cpp:48</a></div></div>
<div class="ttc" id="classVarData_html_ab0cc3088657341d2696949515927e91c"><div class="ttname"><a href="classVarData.html#ab0cc3088657341d2696949515927e91c">VarData::StringNano</a></div><div class="ttdeci">void StringNano(char *NString, int n)</div><div class="ttdoc">String for the rigid inclusion in the header file. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataWrite_8cpp_source.html#l00130">VarDataWrite.cpp:130</a></div></div>
<div class="ttc" id="classForces_html_a419ca9dee6d5e955abe44cf409e24d66"><div class="ttname"><a href="classForces.html#a419ca9dee6d5e955abe44cf409e24d66">Forces::CheckPairList</a></div><div class="ttdeci">void CheckPairList()</div><div class="ttdoc">Check the pair list. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00595">ForcesCalcEnergies.cpp:595</a></div></div>
<div class="ttc" id="classVarData_html_a983f1e3e595a21568bec4d2852011a56"><div class="ttname"><a href="classVarData.html#a983f1e3e595a21568bec4d2852011a56">VarData::SetTime</a></div><div class="ttdeci">void SetTime(double Val)</div><div class="ttdoc">Set Time. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01006">VarData.h:1006</a></div></div>
<div class="ttc" id="classVarData_html_a33833c025a5c9bf7ad5abab2cf9b1dac"><div class="ttname"><a href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac">VarData::pInvEdge</a></div><div class="ttdeci">double pInvEdge(int d)</div><div class="ttdoc">Inverted xyzr edges of the simulation box. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00920">VarData.h:920</a></div></div>
<div class="ttc" id="structNANO_html_a18ece2127f70c26ead73bc24856a5c57"><div class="ttname"><a href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57">NANO::Height</a></div><div class="ttdeci">double Height</div><div class="ttdoc">Height of the cylinder. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00449">VarData.h:449</a></div></div>
<div class="ttc" id="classVarData_html_a75896c37dd78ba0d2da013ad4cf0e87c"><div class="ttname"><a href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">VarData::pType</a></div><div class="ttdeci">int pType(int p)</div><div class="ttdoc">Return the type. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00219">VarDataComm.cpp:219</a></div></div>
<div class="ttc" id="classForces_html_a338adbdaecf3f72150ce3e88ec710bf1"><div class="ttname"><a href="classForces.html#a338adbdaecf3f72150ce3e88ec710bf1">Forces::Dynamics</a></div><div class="ttdeci">void Dynamics()</div><div class="ttdoc">Sum up all the forces and update the positions. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00020">ForcesLoop.cpp:20</a></div></div>
<div class="ttc" id="classForces_html_ab7bfa9d7122c69b311f666740653bd0b"><div class="ttname"><a href="classForces.html#ab7bfa9d7122c69b311f666740653bd0b">Forces::TryInsertCh</a></div><div class="ttdeci">int TryInsertCh()</div><div class="ttdoc">Trial insertion of a chain. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00697">ForcesIntegration.cpp:697</a></div></div>
<div class="ttc" id="structPART_html_a863738e46f14b3bfc674ad87d35f143d"><div class="ttname"><a href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">PART::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdoc">xyz Position of the particle </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00216">VarData.h:216</a></div></div>
<div class="ttc" id="classForces_html_ac313c324785f5c7c044e2e94ea39c01c"><div class="ttname"><a href="classForces.html#ac313c324785f5c7c044e2e94ea39c01c">Forces::RunWidomChIn</a></div><div class="ttdeci">void RunWidomChIn(char *File2Read, int f)</div><div class="ttdoc">Build the widom histograms. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00263">ForcesLoop.cpp:263</a></div></div>
<div class="ttc" id="classForces_html_a791c1d5f301eb9c0d39c43a180eaf737"><div class="ttname"><a href="classForces.html#a791c1d5f301eb9c0d39c43a180eaf737">Forces::SumForcesMD</a></div><div class="ttdeci">double SumForcesMD()</div><div class="ttdoc">Iterate all over the particles and calculate the forces. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00573">ForcesCalcEnergies.cpp:573</a></div></div>
<div class="ttc" id="classForces_html_af9eda9a781eabd31a8813c9a64f2d5ec"><div class="ttname"><a href="classForces.html#af9eda9a781eabd31a8813c9a64f2d5ec">Forces::WidomInsert</a></div><div class="ttdeci">void WidomInsert(double *NrgDiff)</div><div class="ttdoc">Widom insertion. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00890">ForcesIntegration.cpp:890</a></div></div>
<div class="ttc" id="structFORCES_html_ac77c91979738079508cf3f257a7164ba"><div class="ttname"><a href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">FORCES::Dir</a></div><div class="ttdeci">double Dir[3]</div><div class="ttdoc">Direction. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00178">Forces.h:178</a></div></div>
<div class="ttc" id="classForces_html_adcaf21deb47f48c1e25997f52ebd09d6"><div class="ttname"><a href="classForces.html#adcaf21deb47f48c1e25997f52ebd09d6">Forces::NWrite</a></div><div class="ttdeci">int NWrite</div><div class="ttdoc">How many timesteps before write the snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00775">Forces.h:775</a></div></div>
<div class="ttc" id="classVarData_html_a16f3b01ba84886cbaf53fa1238c434f3"><div class="ttname"><a href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3">VarData::pkSpr</a></div><div class="ttdeci">double pkSpr()</div><div class="ttdoc">Spring coupling. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00934">VarData.h:934</a></div></div>
<div class="ttc" id="classVarData_html_ad180facca71ad48ae3ce77052bf22957"><div class="ttname"><a href="classVarData.html#ad180facca71ad48ae3ce77052bf22957">VarData::pSprRest</a></div><div class="ttdeci">double pSprRest()</div><div class="ttdoc">Rest distance of the harmonic potential. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00942">VarData.h:942</a></div></div>
<div class="ttc" id="classForces_html_a6a491826bd0df50e5d4941710783a54c"><div class="ttname"><a href="classForces.html#a6a491826bd0df50e5d4941710783a54c">Forces::CalcNrgPep</a></div><div class="ttdeci">void CalcNrgPep(char *File2Open, int f)</div><div class="ttdoc">Exchange energy of the protein. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00333">ForcesLoop.cpp:333</a></div></div>
<div class="ttc" id="classForces_html_ae35380222f8a3cacfa4a4df6d1742ffb"><div class="ttname"><a href="classForces.html#ae35380222f8a3cacfa4a4df6d1742ffb">Forces::ForceFieldRod</a></div><div class="ttdeci">void ForceFieldRod()</div><div class="ttdoc">Bending potential on a rod. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00210">ForcesForceField.cpp:210</a></div></div>
<div class="ttc" id="classDdLinkedList_html_ad4860e7b4a26d4b424e5c98b7c6bae09"><div class="ttname"><a href="classDdLinkedList.html#ad4860e7b4a26d4b424e5c98b7c6bae09">DdLinkedList::Dist2Curr</a></div><div class="ttdeci">void Dist2Curr(double *DistRel)</div><div class="ttdoc">Retrun the squared current interparticle distance. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00502">Cubo.cpp:502</a></div></div>
<div class="ttc" id="classForces_html_abcac13d7754b73f6f22b2900a0d46d7d"><div class="ttname"><a href="classForces.html#abcac13d7754b73f6f22b2900a0d46d7d">Forces::SolveLinksIterative</a></div><div class="ttdeci">void SolveLinksIterative()</div><div class="ttdoc">Solve a system of four oder differential equation of particles connected by links. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00047">ForcesIntegration.cpp:47</a></div></div>
<div class="ttc" id="classForces_html_a949d9de0a157e4258f88d5b5f322f74e"><div class="ttname"><a href="classForces.html#a949d9de0a157e4258f88d5b5f322f74e">Forces::TryInsertChBias</a></div><div class="ttdeci">int TryInsertChBias()</div><div class="ttdoc">Trial biased insertion of a chain. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00873">ForcesIntegration.cpp:873</a></div></div>
<div class="ttc" id="classForces_html_acffb530559d4e3ebfac6481a46468f52"><div class="ttname"><a href="classForces.html#acffb530559d4e3ebfac6481a46468f52">Forces::WidomInsertCh</a></div><div class="ttdeci">void WidomInsertCh(double *NrgDiff)</div><div class="ttdoc">Widom insertion. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00908">ForcesIntegration.cpp:908</a></div></div>
<div class="ttc" id="classForces_html_afc36f5ebb0ee5c1be5fc2161e1fa3959"><div class="ttname"><a href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959">Forces::NFile</a></div><div class="ttdeci">int NFile[2]</div><div class="ttdoc">First and last file of the list. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00771">Forces.h:771</a></div></div>
<div class="ttc" id="classForces_html_ab3f89c2d946d9c242d3d6061ae17ae78"><div class="ttname"><a href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">Forces::SysAlloc</a></div><div class="ttdeci">int SysAlloc</div><div class="ttdoc">Which arrays are allocated. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00753">Forces.h:753</a></div></div>
<div class="ttc" id="classForces_html_a0ab84cf7b372ab5ae21966ed671ee4c3"><div class="ttname"><a href="classForces.html#a0ab84cf7b372ab5ae21966ed671ee4c3">Forces::WidomRemoveCh</a></div><div class="ttdeci">void WidomRemoveCh(double *NrgDiff, int c)</div><div class="ttdoc">Widom removal. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00918">ForcesIntegration.cpp:918</a></div></div>
<div class="ttc" id="classForces_html_a1d4b4e62a626434fc48475224ab89dca"><div class="ttname"><a href="classForces.html#a1d4b4e62a626434fc48475224ab89dca">Forces::IfFillMatrix</a></div><div class="ttdeci">int IfFillMatrix</div><div class="ttdoc">If the matrix has to be changed. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00763">Forces.h:763</a></div></div>
<div class="ttc" id="classForces_html_a5c32ef207ba714e72e72de3063860b39"><div class="ttname"><a href="classForces.html#a5c32ef207ba714e72e72de3063860b39">Forces::CalcForcesDensFunc</a></div><div class="ttdeci">void CalcForcesDensFunc()</div><div class="ttdoc">Calculate the forces for the density functional. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00597">ForcesForceField.cpp:597</a></div></div>
<div class="ttc" id="classForces_html_aeeef7711986a24838884d8ef8c12f4ae"><div class="ttname"><a href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae">Forces::NRemoval</a></div><div class="ttdeci">int NRemoval</div><div class="ttdoc">Count accepted moves. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00769">Forces.h:769</a></div></div>
<div class="ttc" id="classForces_html_afa426c87de325a8eb41e1f2a29485003"><div class="ttname"><a href="classForces.html#afa426c87de325a8eb41e1f2a29485003">Forces::SimLimit</a></div><div class="ttdeci">int SimLimit</div><div class="ttdoc">Maximum number of time steps. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00751">Forces.h:751</a></div></div>
<div class="ttc" id="classForces_html_a3efc71eff5d768421c05dc9f9ef801d1"><div class="ttname"><a href="classForces.html#a3efc71eff5d768421c05dc9f9ef801d1">Forces::ExploreDoubleMin</a></div><div class="ttdeci">void ExploreDoubleMin()</div><div class="ttdoc">Find the minimum for different interpeptide distances. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00170">ForcesLoop.cpp:170</a></div></div>
<div class="ttc" id="classForces_html_ae7fd260630480928a069e7e536739df1"><div class="ttname"><a href="classForces.html#ae7fd260630480928a069e7e536739df1">Forces::CalcMode</a></div><div class="ttdeci">int CalcMode</div><div class="ttdoc">Calculation mode. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00747">Forces.h:747</a></div></div>
<div class="ttc" id="classForces_html_a0ccf73fded29832c9d6c8edad5a51b76"><div class="ttname"><a href="classForces.html#a0ccf73fded29832c9d6c8edad5a51b76">Forces::ApplyTherm</a></div><div class="ttdeci">void ApplyTherm()</div><div class="ttdoc">Pointer to the energy function. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00441">Forces.h:441</a></div></div>
<div class="ttc" id="structNANO_html_a863738e46f14b3bfc674ad87d35f143d"><div class="ttname"><a href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d">NANO::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdoc">Position. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00427">VarData.h:427</a></div></div>
<div class="ttc" id="classForces_html_ac11429f7ec42e6eb4806e77f8aa24e7f"><div class="ttname"><a href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">Forces::Shout</a></div><div class="ttdeci">void Shout(const char *s,...)</div><div class="ttdoc">Internal message. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8cpp_source.html#l00003">Forces.cpp:3</a></div></div>
<div class="ttc" id="classForces_html_af51ff88ae9c6c4b9907f516c09ebf68f"><div class="ttname"><a href="classForces.html#af51ff88ae9c6c4b9907f516c09ebf68f">Forces::Time</a></div><div class="ttdeci">double Time</div><div class="ttdoc">Total time. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00733">Forces.h:733</a></div></div>
<div class="ttc" id="classVarData_html_a0f556f4717568ddf4b1a4b2111b8d8f3"><div class="ttname"><a href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">VarData::pNanoPos</a></div><div class="ttdeci">double pNanoPos(int n, int d)</div><div class="ttdoc">Return back folded nano position. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00225">VarDataComm.cpp:225</a></div></div>
<div class="ttc" id="classVarData_html_ab1955d8a8a364358ea5cb9b22419941d"><div class="ttname"><a href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d">VarData::pEdge</a></div><div class="ttdeci">double pEdge(int d)</div><div class="ttdoc">xyzr edges of the simulation box </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00918">VarData.h:918</a></div></div>
<div class="ttc" id="classForces_html_a050e80ecdb61ccf749649d6ec6542ee7"><div class="ttname"><a href="classForces.html#a050e80ecdb61ccf749649d6ec6542ee7">Forces::VelVerletRigid</a></div><div class="ttdeci">void VelVerletRigid()</div><div class="ttdoc">Velocity Verlet for a rigid body, first step. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00321">ForcesIntegration.cpp:321</a></div></div>
<div class="ttc" id="classVarData_html_a0ad300d40b5d4a3391361b4c8875091f"><div class="ttname"><a href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">VarData::pNPCh</a></div><div class="ttdeci">int pNPCh()</div><div class="ttdoc">Number of particle per chain. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00249">VarDataComm.cpp:249</a></div></div>
<div class="ttc" id="classForces_html_a8f12492ed75d05c816d8f14bbeaf71be"><div class="ttname"><a href="classForces.html#a8f12492ed75d05c816d8f14bbeaf71be">Forces::ForceFieldRigid</a></div><div class="ttdeci">void ForceFieldRigid()</div><div class="ttdoc">Interaction between rigid bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00283">ForcesForceField.cpp:283</a></div></div>
<div class="ttc" id="classVarData_html_a474ffd5306304ac53eb7ef48a18e511d"><div class="ttname"><a href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">VarData::pNBlock</a></div><div class="ttdeci">int pNBlock()</div><div class="ttdoc">Number of blocks. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00254">VarDataComm.cpp:254</a></div></div>
<div class="ttc" id="classForces_html_a7a1566050eaabfebba82e0b6002d797b"><div class="ttname"><a href="classForces.html#a7a1566050eaabfebba82e0b6002d797b">Forces::RosenOut</a></div><div class="ttdeci">void RosenOut(FILE *WidomIn)</div><div class="ttdoc">Rosenbluth histograms for deletion. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00254">ForcesLoop.cpp:254</a></div></div>
<div class="ttc" id="classForces_html_a7ab5c0bcf11c3f33530a25984720b424"><div class="ttname"><a href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">Forces::NanoNrg</a></div><div class="ttdeci">double NanoNrg(int p)</div><div class="ttdoc">Exchange energy with the nano. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00366">ForcesForceField.cpp:366</a></div></div>
<div class="ttc" id="classForces_html_ad69656acc46a08f2361dbe5b1067dffa"><div class="ttname"><a href="classForces.html#ad69656acc46a08f2361dbe5b1067dffa">Forces::TryMove</a></div><div class="ttdeci">int TryMove()</div><div class="ttdoc">Trial movement. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00457">ForcesIntegration.cpp:457</a></div></div>
<div class="ttc" id="classForces_html_a3f36144668126bc6bb1c682c5b10b300"><div class="ttname"><a href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">Forces::ReOpen</a></div><div class="ttdeci">void ReOpen(char *FName, int Bf)</div><div class="ttdoc">Open a new file. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8cpp_source.html#l00901">Forces.cpp:901</a></div></div>
<div class="ttc" id="classVarData_html_ae2e67b49132b33a026b19c647cbf4f3c"><div class="ttname"><a href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">VarData::NEdge</a></div><div class="ttdeci">int NEdge</div><div class="ttdoc">Number of particles per edge. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01084">VarData.h:1084</a></div></div>
<div class="ttc" id="classMatematica_html_a953e8be14f6a9c259f192683f3a5a970"><div class="ttname"><a href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Matematica::Casuale</a></div><div class="ttdeci">double Casuale()</div><div class="ttdoc">Random uniform number. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaSign_8cpp_source.html#l00031">MatematicaSign.cpp:31</a></div></div>
<div class="ttc" id="classVarData_html_a76873542f36c8e36b790c90273c95cf1"><div class="ttname"><a href="classVarData.html#a76873542f36c8e36b790c90273c95cf1">VarData::WriteTxvl</a></div><div class="ttdeci">bool WriteTxvl(char *OutFile)</div><div class="ttdoc">Writes a &quot;system-file&quot; or a &quot;x y z&quot; file&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataWrite_8cpp_source.html#l00061">VarDataWrite.cpp:61</a></div></div>
<div class="ttc" id="classForces_html_a774d65ef8685d2859fae66bad8c9b435"><div class="ttname"><a href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Forces::Kf</a></div><div class="ttdeci">KFORCES Kf</div><div class="ttdoc">Prefactor of the forces. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00779">Forces.h:779</a></div></div>
<div class="ttc" id="classForces_html_ab8c3546f48b68bd8fa59174d8a5afa97"><div class="ttname"><a href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97">Forces::NUpdate</a></div><div class="ttdeci">int NUpdate</div><div class="ttdoc">How many timesteps before redrawing. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00773">Forces.h:773</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a42eeb7049c078ca89057fbc08726eded"><div class="ttname"><a href="classDdLinkedList.html#a42eeb7049c078ca89057fbc08726eded">DdLinkedList::NextCurr</a></div><div class="ttdeci">void NextCurr()</div><div class="ttdoc">Increase the iterator to the next couple. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00479">Cubo.cpp:479</a></div></div>
<div class="ttc" id="classForces_html_a8f18498c3494e8fe2476f90f9631c6a8"><div class="ttname"><a href="classForces.html#a8f18498c3494e8fe2476f90f9631c6a8">Forces::MinimalNrg</a></div><div class="ttdeci">double MinimalNrg()</div><div class="ttdoc">Minmal nrg. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00493">ForcesLoop.cpp:493</a></div></div>
<div class="ttc" id="classForces_html_aed97e42cbfeb918574e91a90719864ab"><div class="ttname"><a href="classForces.html#aed97e42cbfeb918574e91a90719864ab">Forces::ForceFieldLeaves</a></div><div class="ttdeci">int ForceFieldLeaves()</div><div class="ttdoc">Helfrich Hamiltonian with an elastic coupling. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00130">ForcesForceField.cpp:130</a></div></div>
<div class="ttc" id="classForces_html_a0658783c2d6dcab7a875f938747255a6"><div class="ttname"><a href="classForces.html#a0658783c2d6dcab7a875f938747255a6">Forces::TryRemove</a></div><div class="ttdeci">int TryRemove()</div><div class="ttdoc">Trial removal. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00432">ForcesIntegration.cpp:432</a></div></div>
<div class="ttc" id="classForces_html_a49654bba62557156b6599f4875484078"><div class="ttname"><a href="classForces.html#a49654bba62557156b6599f4875484078">Forces::ExplorePepSize</a></div><div class="ttdeci">void ExplorePepSize()</div><div class="ttdoc">Find the minimun bilayer thickness for different peptide sizes. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00097">ForcesLoop.cpp:97</a></div></div>
<div class="ttc" id="classForces_html_abb0374374d00777fe085e4a163a0e9c5"><div class="ttname"><a href="classForces.html#abb0374374d00777fe085e4a163a0e9c5">Forces::SysShape</a></div><div class="ttdeci">int SysShape</div><div class="ttdoc">Shape of system. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00745">Forces.h:745</a></div></div>
<div class="ttc" id="classForces_html_a3f16bbc64bdd8ac4835e6a4702e30678"><div class="ttname"><a href="classForces.html#a3f16bbc64bdd8ac4835e6a4702e30678">Forces::RosenIn</a></div><div class="ttdeci">void RosenIn(FILE *WidomIn)</div><div class="ttdoc">Rosenbluth weights for insertion. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00245">ForcesLoop.cpp:245</a></div></div>
<div class="ttc" id="classVarData_html_aef94681f570cacf1a76aac1512563f17"><div class="ttname"><a href="classVarData.html#aef94681f570cacf1a76aac1512563f17">VarData::pNNano</a></div><div class="ttdeci">int pNNano()</div><div class="ttdoc">Number of nanoparticles. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00253">VarDataComm.cpp:253</a></div></div>
<div class="ttc" id="classForces_html_a6c88528ae5cf46ad5cc7080ca47ef1fb"><div class="ttname"><a href="classForces.html#a6c88528ae5cf46ad5cc7080ca47ef1fb">Forces::RunWidomChOut</a></div><div class="ttdeci">void RunWidomChOut(char *File2Read, int f)</div><div class="ttdoc">Build the widom histograms. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00279">ForcesLoop.cpp:279</a></div></div>
<div class="ttc" id="classForces_html_a3ee2891acdfca29fc27e89883f2a2df4"><div class="ttname"><a href="classForces.html#a3ee2891acdfca29fc27e89883f2a2df4">Forces::MinimalMD</a></div><div class="ttdeci">void MinimalMD()</div><div class="ttdoc">Minmal md. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00521">ForcesLoop.cpp:521</a></div></div>
<div class="ttc" id="classForces_html_aefc3ccff8a9805e952ddc49194595844"><div class="ttname"><a href="classForces.html#aefc3ccff8a9805e952ddc49194595844">Forces::TryRemoveCh</a></div><div class="ttdeci">int TryRemoveCh()</div><div class="ttdoc">Trial removal of a chain. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00675">ForcesIntegration.cpp:675</a></div></div>
<div class="ttc" id="classForces_html_adcf19dc278dd27f0bba8cc1ae9375b4f"><div class="ttname"><a href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f">Forces::nEdge</a></div><div class="ttdeci">int nEdge[3]</div><div class="ttdoc">Number of particle per edge. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00743">Forces.h:743</a></div></div>
<div class="ttc" id="classVarData_html_aaa11921d5205a7db714c4f733065b710"><div class="ttname"><a href="classVarData.html#aaa11921d5205a7db714c4f733065b710">VarData::IncrStep</a></div><div class="ttdeci">void IncrStep()</div><div class="ttdoc">Increment Step. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01008">VarData.h:1008</a></div></div>
<div class="ttc" id="classForces_html_aa57796d41906bf35c6a79225ecda6f98"><div class="ttname"><a href="classForces.html#aa57796d41906bf35c6a79225ecda6f98">Forces::ForceFieldBulk</a></div><div class="ttdeci">int ForceFieldBulk()</div><div class="ttdoc">Armonic potential on a lattice. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00187">ForcesForceField.cpp:187</a></div></div>
<div class="ttc" id="classForces_html_a4a0ed3bb2c5155bda06158b0e918cd34"><div class="ttname"><a href="classForces.html#a4a0ed3bb2c5155bda06158b0e918cd34">Forces::MinimizeSol</a></div><div class="ttdeci">void MinimizeSol()</div><div class="ttdoc">Iterative process to approach to the solution. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00556">ForcesLoop.cpp:556</a></div></div>
<div class="ttc" id="classForces_html_ac5ef477f97601b779392b8622ac6b1fe"><div class="ttname"><a href="classForces.html#ac5ef477f97601b779392b8622ac6b1fe">Forces::Potential</a></div><div class="ttdeci">double Potential(double Dist, int t1, int t2, double *Pot)</div><div class="ttdoc">Pointer to a potential. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00504">Forces.h:504</a></div></div>
<div class="ttc" id="classForces_html_a7a03a3d52f5a114cbbc22e60af60c049"><div class="ttname"><a href="classForces.html#a7a03a3d52f5a114cbbc22e60af60c049">Forces::SolveLeaves</a></div><div class="ttdeci">void SolveLeaves()</div><div class="ttdoc">Solve a system of four oder differential equation of particles in a line. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00005">ForcesIntegration.cpp:5</a></div></div>
<div class="ttc" id="structTENS_html_ae7fd260630480928a069e7e536739df1"><div class="ttname"><a href="structTENS.html#ae7fd260630480928a069e7e536739df1">TENS::CalcMode</a></div><div class="ttdeci">int CalcMode</div><div class="ttdoc">Calculation mode. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00197">Forces.h:197</a></div></div>
<div class="ttc" id="classForces_html_a0390d97ed1665851fb6175342d1c598b"><div class="ttname"><a href="classForces.html#a0390d97ed1665851fb6175342d1c598b">Forces::ClearDens</a></div><div class="ttdeci">void ClearDens()</div><div class="ttdoc">Set the local densities to zero. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00401">ForcesCalcEnergies.cpp:401</a></div></div>
<div class="ttc" id="classMatematica_html_ad14013038c5963ed49ca1236e681db10"><div class="ttname"><a href="classMatematica.html#ad14013038c5963ed49ca1236e681db10">Matematica::Gaussiano</a></div><div class="ttdeci">double Gaussiano(double Media, double Scarto)</div><div class="ttdoc">Gaussian random number. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaSign_8cpp_source.html#l00023">MatematicaSign.cpp:23</a></div></div>
<div class="ttc" id="classVarData_html_acefa5842862d4587442db05af40e7490"><div class="ttname"><a href="classVarData.html#acefa5842862d4587442db05af40e7490">VarData::SysFormat</a></div><div class="ttdeci">int SysFormat</div><div class="ttdoc">Contains the definition of the file format. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01088">VarData.h:1088</a></div></div>
<div class="ttc" id="classForces_html_aea3ac235b677278906db133f4cfd54f4"><div class="ttname"><a href="classForces.html#aea3ac235b677278906db133f4cfd54f4">Forces::Wave</a></div><div class="ttdeci">void Wave()</div><div class="ttdoc">Sinusoidal surface wave. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesBoundary_8cpp_source.html#l00022">ForcesBoundary.cpp:22</a></div></div>
<div class="ttc" id="classForces_html_ac028948e0862f18bf805f23078ebf7fa"><div class="ttname"><a href="classForces.html#ac028948e0862f18bf805f23078ebf7fa">Forces::CalcNrgCh</a></div><div class="ttdeci">double CalcNrgCh(int c, double *Pot)</div><div class="ttdoc">Pointer to the chain energy function. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00513">Forces.h:513</a></div></div>
<div class="ttc" id="classForces_html_ac6a2e2465107cd1b6eea81aeb80646c2"><div class="ttname"><a href="classForces.html#ac6a2e2465107cd1b6eea81aeb80646c2">Forces::AllocTens</a></div><div class="ttdeci">void AllocTens()</div><div class="ttdoc">Alloc the pressure profile. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesTens_8cpp_source.html#l00002">ForcesTens.cpp:2</a></div></div>
<div class="ttc" id="classForces_html_a7965b2207a6253f8215b96a7195cb5bc"><div class="ttname"><a href="classForces.html#a7965b2207a6253f8215b96a7195cb5bc">Forces::VelVerlet2</a></div><div class="ttdeci">void VelVerlet2()</div><div class="ttdoc">Second step of the velocity Verlet. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l01029">ForcesIntegration.cpp:1029</a></div></div>
<div class="ttc" id="classVarData_html_aab4995eedc5bb0d45d86f0e2a5d0e869"><div class="ttname"><a href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">VarData::Mat</a></div><div class="ttdeci">Matematica * Mat</div><div class="ttdoc">Implementation of all usefull algorythms. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00527">VarData.h:527</a></div></div>
<div class="ttc" id="classVarData_html_a6496acd0cba8289e8306507336dd2f88"><div class="ttname"><a href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">VarData::pNType</a></div><div class="ttdeci">int pNType()</div><div class="ttdoc">of types of the particle</div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00251">VarDataComm.cpp:251</a></div></div>
<div class="ttc" id="structTENS_html_a5a9396ca53c5306c34eb62ef4f02593b"><div class="ttname"><a href="structTENS.html#a5a9396ca53c5306c34eb62ef4f02593b">TENS::NComp</a></div><div class="ttdeci">int NComp</div><div class="ttdoc">of components</div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00191">Forces.h:191</a></div></div>
<div class="ttc" id="classForces_html_af662b8c150e7cdd3983066e8dab609be"><div class="ttname"><a href="classForces.html#af662b8c150e7cdd3983066e8dab609be">Forces::Task</a></div><div class="ttdeci">void Task()</div><div class="ttdoc">Perform a operation every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00421">ForcesLoop.cpp:421</a></div></div>
<div class="ttc" id="classVarData_html_ab70211c3dc01d352727d2052b2c555c5"><div class="ttname"><a href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">VarData::pPos</a></div><div class="ttdeci">double pPos(int p, int d)</div><div class="ttdoc">Return back folded position. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00192">VarDataComm.cpp:192</a></div></div>
<div class="ttc" id="classVarData_html_a495c5b182109864eb1db337d49a53999"><div class="ttname"><a href="classVarData.html#a495c5b182109864eb1db337d49a53999">VarData::pTemp</a></div><div class="ttdeci">double pTemp()</div><div class="ttdoc">Temperature. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00912">VarData.h:912</a></div></div>
<div class="ttc" id="classVarData_html_a9f6d9339cabdd81a05bf272c116ceea2"><div class="ttname"><a href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">VarData::pNChain</a></div><div class="ttdeci">int pNChain()</div><div class="ttdoc">Number of chain. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00247">VarDataComm.cpp:247</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a63c5d18d3a487d1a8ab2a5881c6acb38"><div class="ttname"><a href="classDdLinkedList.html#a63c5d18d3a487d1a8ab2a5881c6acb38">DdLinkedList::IfCurr</a></div><div class="ttdeci">int IfCurr()</div><div class="ttdoc">Tell when the curr loop is over. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00498">Cubo.cpp:498</a></div></div>
<div class="ttc" id="classForces_html_a85d825b7b4af29d476abbf098ce630e3"><div class="ttname"><a href="classForces.html#a85d825b7b4af29d476abbf098ce630e3">Forces::WidomRemove</a></div><div class="ttdeci">void WidomRemove(double *NrgDiff, int p)</div><div class="ttdoc">Widom removal. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00901">ForcesIntegration.cpp:901</a></div></div>
<div class="ttc" id="classForces_html_a3953ee74479102530a979e3cd447d174"><div class="ttname"><a href="classForces.html#a3953ee74479102530a979e3cd447d174">Forces::SolveRod</a></div><div class="ttdeci">void SolveRod()</div><div class="ttdoc">Solve a system of four oder differential equation of particles connected by links. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00029">ForcesIntegration.cpp:29</a></div></div>
<div class="ttc" id="structKFORCES_html_ac448df5dbfd256324893075200dace49"><div class="ttname"><a href="structKFORCES.html#ac448df5dbfd256324893075200dace49">KFORCES::CutOff2</a></div><div class="ttdeci">double CutOff2</div><div class="ttdoc">CutOff of the lennard jones. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00165">Forces.h:165</a></div></div>
<div class="ttc" id="classDomDecBasics_html_a28d65a777a97b96280ca0f9173c76c93"><div class="ttname"><a href="classDomDecBasics.html#a28d65a777a97b96280ca0f9173c76c93">DomDecBasics::p2Curr</a></div><div class="ttdeci">int p2Curr</div><div class="ttdoc">Current particle. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8h_source.html#l00051">Cubo.h:51</a></div></div>
<div class="ttc" id="classForces_html_a0449e9410bf23ad4d073f1eab66c2a68"><div class="ttname"><a href="classForces.html#a0449e9410bf23ad4d073f1eab66c2a68">Forces::SumDens</a></div><div class="ttdeci">double SumDens(int pInit, int pEnd)</div><div class="ttdoc">Sum the local density for the particles between pInit and pEnd and multiply the factors by the virial...</div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00243">ForcesCalcEnergies.cpp:243</a></div></div>
<div class="ttc" id="classForces_html_a111835c2cd5d392591f9e32ea6d9cf19"><div class="ttname"><a href="classForces.html#a111835c2cd5d392591f9e32ea6d9cf19">Forces::ChooseSimMode</a></div><div class="ttdeci">void ChooseSimMode()</div><div class="ttdoc">Choose the simulation method. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00003">ForcesLoop.cpp:3</a></div></div>
<div class="ttc" id="classForces_html_a44c4bed1843e51f20f252a5dd05f64fe"><div class="ttname"><a href="classForces.html#a44c4bed1843e51f20f252a5dd05f64fe">Forces::CalcDens</a></div><div class="ttdeci">void CalcDens()</div><div class="ttdoc">Calculate the densities. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesTens_8cpp_source.html#l00045">ForcesTens.cpp:45</a></div></div>
<div class="ttc" id="classVarData_html_a53eee20378b4a2c61407897d98a4b5d7"><div class="ttname"><a href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">VarData::Pm</a></div><div class="ttdeci">PART * Pm</div><div class="ttdoc">Particle information of all particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01046">VarData.h:1046</a></div></div>
<div class="ttc" id="classForces_html_a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b"><div class="ttname"><a href="classForces.html#a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b">Forces::AddDens</a></div><div class="ttdeci">int AddDens(int pInit, int pEnd)</div><div class="ttdoc">Add the densities connected with the particles between pInit and pEnd. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00218">ForcesCalcEnergies.cpp:218</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a74b7b0d716684a7d46993c83795fd9e7"><div class="ttname"><a href="classDdLinkedList.html#a74b7b0d716684a7d46993c83795fd9e7">DdLinkedList::SetCurr</a></div><div class="ttdeci">void SetCurr(int p)</div><div class="ttdoc">Gather information of the neighbouring cells. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00453">Cubo.cpp:453</a></div></div>
<div class="ttc" id="classVarData_html_af6622c9e9e57aae3faf756b7faa73e29"><div class="ttname"><a href="classVarData.html#af6622c9e9e57aae3faf756b7faa73e29">VarData::pDeltat</a></div><div class="ttdeci">double pDeltat()</div><div class="ttdoc">Delta t. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00910">VarData.h:910</a></div></div>
<div class="ttc" id="classForces_html_a77e000512807ae8da791d650d739299a"><div class="ttname"><a href="classForces.html#a77e000512807ae8da791d650d739299a">Forces::Tens</a></div><div class="ttdeci">TENS Tens</div><div class="ttdoc">Structure for the pressure calculation. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00783">Forces.h:783</a></div></div>
<div class="ttc" id="classForces_html_a5d8052dd63b08f01b581aeffa8506051"><div class="ttname"><a href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Forces::Pc</a></div><div class="ttdeci">DomDec * Pc</div><div class="ttdoc">Pair list. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00785">Forces.h:785</a></div></div>
<div class="ttc" id="structKFORCES_html_a348745786658bd8382be1fd25066a309"><div class="ttname"><a href="structKFORCES.html#a348745786658bd8382be1fd25066a309">KFORCES::SLap</a></div><div class="ttdeci">double SLap</div><div class="ttdoc">Prefactor of the square laplacian. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00149">Forces.h:149</a></div></div>
<div class="ttc" id="classForces_html_acf39045486a7e38d437f191e2a845d83"><div class="ttname"><a href="classForces.html#acf39045486a7e38d437f191e2a845d83">Forces::AvForces</a></div><div class="ttdeci">void AvForces(char **argv, int *FilePos, int NFile)</div><div class="ttdoc">Average of the forces. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00375">ForcesLoop.cpp:375</a></div></div>
<div class="ttc" id="classVarData_html_ac659e9234deb7729483b32fd9d6b5b30"><div class="ttname"><a href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30">VarData::SetEdge</a></div><div class="ttdeci">void SetEdge(double Val, int d)</div><div class="ttdoc">Set Edge. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00976">VarData.h:976</a></div></div>
<div class="ttc" id="classForces_html_a56709cda842db1c6f3813acc5bca5237"><div class="ttname"><a href="classForces.html#a56709cda842db1c6f3813acc5bca5237">Forces::TryInsert</a></div><div class="ttdeci">int TryInsert()</div><div class="ttdoc">Trial insertion. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00413">ForcesIntegration.cpp:413</a></div></div>
<div class="ttc" id="classForces_html_afca243db3841bf482910199bdb22e5f3"><div class="ttname"><a href="classForces.html#afca243db3841bf482910199bdb22e5f3">Forces::Fm</a></div><div class="ttdeci">FORCES * Fm</div><div class="ttdoc">Array containing the forces for each particle. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00781">Forces.h:781</a></div></div>
<div class="ttc" id="classVarData_html_acf2e386d659b56caeceb504cd74e90e0"><div class="ttname"><a href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">VarData::pStep</a></div><div class="ttdeci">int pStep()</div><div class="ttdoc">Number of steps. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00245">VarDataComm.cpp:245</a></div></div>
<div class="ttc" id="classVarData_html_a388622b5e7d2ad20e8ac1a8a951d655f"><div class="ttname"><a href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">VarData::pNPart</a></div><div class="ttdeci">int pNPart()</div><div class="ttdoc">Number of particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00246">VarDataComm.cpp:246</a></div></div>
<div class="ttc" id="classForces_html_ad7e01b1bd04ce252d991ae872eaa5270"><div class="ttname"><a href="classForces.html#ad7e01b1bd04ce252d991ae872eaa5270">Forces::DefForceParam</a></div><div class="ttdeci">void DefForceParam()</div><div class="ttdoc">Define the parameters for calculating the force. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00388">ForcesForceField.cpp:388</a></div></div>
<div class="ttc" id="classForces_html_ab249c91e15e3611167002159ef6d5b60"><div class="ttname"><a href="classForces.html#ab249c91e15e3611167002159ef6d5b60">Forces::WidomBiasChOut</a></div><div class="ttdeci">void WidomBiasChOut(double *Weight, int c)</div><div class="ttdoc">Widom with Rosenbluth weight. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesIntegration_8cpp_source.html#l00935">ForcesIntegration.cpp:935</a></div></div>
<div class="ttc" id="classForces_html_a941bab4d0655ea3e774cd525e664be52"><div class="ttname"><a href="classForces.html#a941bab4d0655ea3e774cd525e664be52">Forces::Solve</a></div><div class="ttdeci">void Solve()</div><div class="ttdoc">Solve a system of four oder differential equation. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesLoop_8cpp_source.html#l00009">ForcesLoop.cpp:9</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
