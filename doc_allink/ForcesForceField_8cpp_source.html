<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Allink: src/Addyn/ForcesForceField.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ed615368fd5ab0766bfe5b479d2a7e4e.html">Addyn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ForcesForceField.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;Forces.h&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//-------------------------SPLINES--------------------------------</span></div><div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="classForces.html#abe46a6cf819d53f35747565f9276854f">    4</a></span>&#160;<span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classForces.html#abe46a6cf819d53f35747565f9276854f">Forces::ForceFieldLine</a>(){</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  <span class="keywordtype">double</span> Sign=1.;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Sp1;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Sp2;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Cub1;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Cub2;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Par1;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Par2;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">double</span> fSLap=0.;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">double</span> fLap=0.;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="comment">//Fm[Part2Move].fExt[2] = -Fm[Part2Move].fHel[2];</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">//Fm[Part2Move].fExt[2] = 0.;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38">Ext</a>[2] = -<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2]/1.1;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">IfInterp</a>==FIT_SPLINE3){</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordflow">if</span>( p == 0)</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#aa2836a8f43d770c560eb34c3cafa4ceb">Spline3Beg</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2 )</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492">Spline3</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2 )</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128">Spline3End</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      fSLap = 0.;<span class="comment">//atan(Sp2.a1);</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      fLap = 2.*Sp2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>; </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">IfInterp</a>==FIT_SPLINE4){</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordflow">if</span>( p == 0){</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a4166dfd1c333203677c8caf040ead05b">Spline4Beg</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+3].Pos,0,2);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 3 )</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a6b6c8217f2c75492c48cd60e4d9c17cf">Spline4</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+3].Pos,0,2);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 3 ){</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492">Spline3</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="comment">//Sp2 = Mate-&gt;Spline4PreEnd(Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,0,1);</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2 ){</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128">Spline3End</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="comment">//Sp2 = Mate-&gt;Spline4End(Pm[p].Pos,Pm[p+1].Pos,0,1);</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      fSLap = (24.*Sp2.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441">a4</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      fLap = (2.*Sp2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//     else if(IfInterp==FIT_PARAB){</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//       if(p &lt; Gen-&gt;NPart - 2){</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//    Par1 = Mate-&gt;Parab(Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,0,2);</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//       }</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//       fSLap  = 0.;//(2.*Par2.A*Pm[p].Pos[0]+Par2.B);</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//       fLap  = 2.*Par1.A/100.; </span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">IfInterp</a>==FIT_PARAB2){</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span>(p == 0){</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a0bf66137177a5078071d2da064fa3a72">Parab</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span>(p &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 1){</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">Parab2</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      fSLap = 0.;<span class="comment">//(Par2.B);</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      fLap = 2.*Sp2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">IfInterp</a>==FIT_CUBIC){</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span>(p == 0){</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   Cub2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a0bf66137177a5078071d2da064fa3a72">Parab</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">if</span>(p &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2){</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   Cub2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb">Cubica</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span>(p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2){</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   Cub2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">Parab2</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      fSLap = 0.;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      fLap = 2.*Cub2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">IfInterp</a>==FIT_FORTH){</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordtype">double</span> Ref=0.;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span>(p &lt; 1){</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">//Sp1 = Mat-&gt;Forth(Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,Pm[p+3].Pos,Pm[p+4].Pos,0,1);</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+3].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+4].Pos,0,2);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      Ref = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0]; </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &lt; 2){</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">//Sp1 = Mat-&gt;Forth(Pm[p-1].Pos,Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,Pm[p+3].Pos,0,1);</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+3].Pos,0,2);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      Ref = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0]; </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>()-2){</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">//Sp1 = Mat-&gt;Forth(Pm[p-2].Pos,Pm[p-1].Pos,Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,0,1);</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      Ref = 0.; </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>()-2){</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">//Sp1 = Mat-&gt;Forth(Pm[p-3].Pos,Pm[p-2].Pos,Pm[p-1].Pos,Pm[p].Pos,Pm[p+1].Pos,0,1);</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-3].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      Ref = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0]; </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &lt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>()-1){</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="comment">//Sp1 = Mat-&gt;Forth(Pm[p-4].Pos,Pm[p-3].Pos,Pm[p-2].Pos,Pm[p-1].Pos,Pm[p].Pos,0,1);</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-4].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-3].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,0,2);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      Ref = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-2].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0]; </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    fSLap = -(24.*Sp2.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441">a4</a>)*QUAD(QUAD(<a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a">Dx</a>));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    fLap = (2.*Sp2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>)*QUAD(<a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a">Dx</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//printf(&quot;%d) %lf %lf\n&quot;,p,Kf.kLap*fLap,Kf.kSLap*fSLap);</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span>(fLap &gt; 100.)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      fLap = 100.;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span>(fSLap &lt; -100.)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      fSLap = -100.;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span>(fSLap &gt; 100.)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      fSLap = 100.;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span>(fSLap &lt; -100.)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      fSLap = -100.;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309">SLap</a>*fSLap + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*fLap;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//if(Pm[p].Pos[2] &lt;0) Sign = -1.;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//else Sign = 1;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//Fm[p].fHel[2] *= Sign;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//if(p == Part2Move)</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//if(p &gt; Part2Move -4 &amp;&amp; p &lt; Part2Move +4)</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">//printf(&quot;%d in (%lf,%lf) ha %lf|%lf Sp %lf %lf\n&quot;,p,Pm[p].Pos[2],Pm[p].Vel[2],Fm[p].fHel[2],Fm[p].fExt[2],fSLap,fLap);</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classForces.html#aed97e42cbfeb918574e91a90719864ab">  130</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classForces.html#aed97e42cbfeb918574e91a90719864ab">Forces::ForceFieldLeaves</a>(){</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">double</span> Sign=1.;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Sp1;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Sp2;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="structPARABOLA.html">PARABOLA</a> Par1;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="structPARABOLA.html">PARABOLA</a> Par2;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">double</span> fSLap=0.;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">double</span> fLap=0.;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>();c++){</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>*(c+1);p++){</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38">Ext</a>[2] = -(<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2])/1.1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">//      Fm[p].El[2] = - Kf.El[2]*( c*Kf.Elong[2] + .5 - Pm[p].Pos[2]);</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span>( p == c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">NEdge</a>){</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a4166dfd1c333203677c8caf040ead05b">Spline4Beg</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+3].Pos,0,2);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p &lt; NEdge*(c+1) - 3 )</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Forth</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-2].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p-1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="comment">//Sp2 = Mat-&gt;Spline4(Pm[p].Pos,Pm[p].Pos,Pm[p+1].Pos,Pm[p+2].Pos,0,2);</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">//      else Pm[p].Typ = 2;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p == NEdge*(c+1) - 3 ){</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492">Spline3</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+2].Pos,0,2);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2 ){</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   Sp2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128">Spline3End</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p+1].Pos,0,2);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="comment">//Pm[p].Typ = 2;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      fSLap = -(24.*Sp2.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441">a4</a>)*QUAD(QUAD(<a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a">Dx</a>));</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      fLap = (2.*Sp2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>)*QUAD(<a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a">Dx</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span>(fLap &gt; 100.)fLap = 100.;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span>(fLap &lt; -100.)fLap = -100.;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">if</span>(fSLap &gt; 100.)fSLap = 100.;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span>(fSLap &lt; -100.)fSLap = -100.;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] = +<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309">SLap</a>*fSLap + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*fLap;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keywordtype">double</span> Rad2=0.;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     Rad2 += QUAD((<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[d] - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[d]));</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">if</span>( Rad2 &gt; QUAD((3.*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>))) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keywordtype">double</span> CosTh = (<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">Pos</a>[0])/<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordtype">double</span> SenTh = sqrt(1 - QUAD(CosTh));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="keywordtype">double</span> Sign = 1.;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordtype">double</span> Rad = sqrt(Rad2);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordtype">double</span> Strength = 12.*pow( (<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>/Rad) , 13) + 6.*pow( (<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>/Rad) , 7);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordflow">if</span>(p &lt;= NEdge)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     Sign *= -1.;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[0] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a> * Strength * CosTh;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a> * Strength * SenTh * Sign;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//----------------------HARMONIC-POTENTIAL-------------------</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classForces.html#aa57796d41906bf35c6a79225ecda6f98">  187</a></span>&#160;<span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classForces.html#aa57796d41906bf35c6a79225ecda6f98">Forces::ForceFieldBulk</a>(){</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38">Ext</a>[d] = -(<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d])/2.;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8">NLink</a>;l++){</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordtype">int</span> link = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">Link</a>[l];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordtype">double</span> Delta = ASS((<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link].Pos[d] - <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[d]));</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span>(Delta &lt; 0.001) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="comment">// printf(&quot;%d-%d (%d) %lf &quot;,p,link,d,Delta);</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordtype">double</span> Sign = 1.;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos[d] &lt; <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link].Pos[d] )</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     Sign = -1.;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] +=  - Sign*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527">El</a>[d]*(Delta - <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca">Elong</a>[d])/1.1;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">//      printf(&quot;\n&quot;);</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">//if(p &gt; Part2Move -4 &amp;&amp; p &lt; Part2Move +4)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">//printf(&quot;%d) in (%lf,%lf) ha %lf|%lf|%lf Sp %lf %lf\n&quot;,p,Pm[p].Pos[2],Pm[p].Vel[2],Fm[p].fHel[2],Fm[p].fExt[2],Fm[p].fEl[2]);</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="classForces.html#ae35380222f8a3cacfa4a4df6d1742ffb">  210</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ae35380222f8a3cacfa4a4df6d1742ffb">Forces::ForceFieldRod</a>(){</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">double</span> DistRelBA[4];</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">double</span> DistRelBC[4];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">double</span> Pre[12];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">pNBlock</a>();b++){</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>(b);c++){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b);p&lt;(c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b)-1;p++){</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="classVarData.html#a19886baf2914ac46bc50f333254a4e57">TwoPartDist</a>(p+1,p,DistRelBA);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordtype">double</span> ForceSp = <a class="code" href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3">pkSpr</a>()*(1. - <a class="code" href="classVarData.html#ad180facca71ad48ae3ce77052bf22957">pSprRest</a>()/DistRelBA[3]);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += ForceSp*DistRelBA[d];</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= ForceSp*DistRelBA[d];</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keywordflow">if</span>(p &lt; (c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b)-2){</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;     <a class="code" href="classVarData.html#a19886baf2914ac46bc50f333254a4e57">TwoPartDist</a>(p+2,p+1,DistRelBC);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     <span class="keywordtype">double</span> CosAngle = 0.;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       DistRelBA[d] /= DistRelBA[3];</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       DistRelBC[d] /= DistRelBC[3];</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;       CosAngle += DistRelBA[d]*DistRelBC[d];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     <span class="keywordtype">double</span> PreFactBA = <a class="code" href="classVarData.html#a395cfa5f68437606051e29df1759e371">pkBen</a>()/DistRelBA[3];</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     <span class="keywordtype">double</span> PreFactBC = <a class="code" href="classVarData.html#a395cfa5f68437606051e29df1759e371">pkBen</a>()/DistRelBC[3];</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+0].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += PreFactBA*(DistRelBC[d]-DistRelBA[d]*CosAngle);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= PreFactBA*(DistRelBC[d]-DistRelBA[d]*CosAngle);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += PreFactBC*(DistRelBA[d]-DistRelBC[d]*CosAngle);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+2].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= PreFactBC*(DistRelBA[d]-DistRelBC[d]*CosAngle);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;     }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   }    </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/* obsolete? */</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classForces.html#aad7c51f4a67ea41983881db33d1e5434">  245</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classForces.html#aad7c51f4a67ea41983881db33d1e5434">Forces::SumSomeForces</a>(<span class="keywordtype">int</span> HowMany){</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">double</span> Sign=1.;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Par1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="structSPLINE.html">SPLINE</a> Par2;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">double</span> Slope1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordtype">double</span> Slope2;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c">Bead2Move</a> - HowMany &lt; 1 || Bead2Move + HowMany &gt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>() - 2)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">//Fm[Part2Move].fExt[2] = -Fm[Part2Move].fHel[2];</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//Fm[Part2Move].fExt[2] = 0.;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">int</span> pp = <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c">Bead2Move</a>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> h = 0;h&lt;HowMany;h++){</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">int</span> link1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[pp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">Link</a>[0];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> link2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[pp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">Link</a>[1];</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//     printf(&quot;(%lf %lf %lf), (%lf %lf %lf), (%lf %lf %lf)\n&quot;,</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//       Pm[link1].Pos[0],Pm[link1].Pos[1],Pm[link1].Pos[2],</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//       Pm[pp].Pos[0],Pm[pp].Pos[1],Pm[pp].Pos[2],</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//       Pm[link2].Pos[0],Pm[link2].Pos[1],Pm[link2].Pos[2]);</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//    Par1 = Mat-&gt;Parab2(Pm[link1].Pos,Pm[pp].Pos,Pm[link2].Pos,0,2);</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    Par2 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">Parab2</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[pp].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link2].Pos,1,2);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[pp].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] = - <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*QUAD(2.*Par1.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[pp].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] += - <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*QUAD(2.*Par2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//printf(&quot;%d-%d|%d) %lf %lf %lf %lf  &quot;,pp,link1,link2,Slope1,Par1.A,Slope2,Par2.A);</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    link1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[pp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">Link</a>[2];</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    link2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">Ln</a>[pp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">Link</a>[3];</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    Par1 = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">Parab2</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link1].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[pp].Pos,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[link2].Pos,0,2);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">//Par2 = Mat-&gt;Parab2(Pm[link1].Pos,Pm[pp].Pos,Pm[link2].Pos,1,2);</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[pp].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] += - <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*QUAD(2.*Par1.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[pp].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] += - <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">Lap</a>*QUAD(2.*Par2.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">//printf(&quot;%d-%d|%d) %lf %lf %lf %lf\n&quot;,pp,link1,link2,Slope1,Par1.A,Slope2,Par2.A);</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[pp].Pos[2] &lt;0) Sign = -1.;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">else</span> Sign = 1;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[pp].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[2] *= Sign;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">//printf(&quot;%d) Pos %lf Force %lf %lf\n&quot;,pp,Pm[pp].Pos[2],Fm[pp].fHel[2],Fm[pp].fExt[2]);</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//-----------------------------RIGID-------------------------</span></div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classForces.html#a8f12492ed75d05c816d8f14bbeaf71be">  283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a8f12492ed75d05c816d8f14bbeaf71be">Forces::ForceFieldRigid</a>(){</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">Force</a>[d] = 0.;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">AMom</a>[d] = 0.;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nn=n+1;nn&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();nn++){</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordtype">double</span> dr[3] = {0.,0.,0.};</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordtype">double</span> Dist = <a class="code" href="classForces.html#a0bd8b1fc300bbbf7b4d7a6c5836ff0dc">RigidDistanceAxis</a>(n,nn,dr);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">//if( Dist &gt; CutOff ) continue;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordtype">double</span> Cons = <a class="code" href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">RigidLJ</a>(n,Dist,Pot,0);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">Force</a>[d] -= Cons*dr[d];</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[nn].<a class="code" href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">Force</a>[d] += Cons*dr[d];</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">AMom</a>[d] -= <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a062cb4da9ccaf4fe931d0262f827c8c3">AMomTemp</a>[d]*Cons;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[nn].<a class="code" href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">AMom</a>[d] += <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a062cb4da9ccaf4fe931d0262f827c8c3">AMomTemp</a>[d]*Cons;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="comment">//printf(&quot;%d %lf %lf\n&quot;,d,Cons*dr[d],Nano[nn].AMom[d]);</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordtype">double</span> Ran = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7e97ac28698cae83ebf4b304dbbae40a">Zeta</a> * (2.*<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() - 1.);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">double</span> Dis = - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a>*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ae3fae9edc78d8cadc33c5a52bebdb46c">Vel</a>[d];</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">//Nano-&gt;Force[d] += Ran + Dis;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">//printf(&quot;%d %lf %lf %lf\n&quot;,n,Nano[n].AMom[0],Nano[n].AMom[1],Nano[n].AMom[2]);</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classForces.html#a0bd8b1fc300bbbf7b4d7a6c5836ff0dc">  313</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a0bd8b1fc300bbbf7b4d7a6c5836ff0dc">Forces::RigidDistanceAxis</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> nn,<span class="keywordtype">double</span> *dr){</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Pos1(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Pos,3);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Pos2(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[nn].Pos,3);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> PosRel(Pos2[0]-Pos1[0],Pos2[1]-Pos1[1],Pos2[2]-Pos1[2]);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Axis(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Axis,3);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Perp(3);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> AMomTemp(3);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">double</span> Dist = Perp.<a class="code" href="classVettore.html#ad289412e19e3a03ef86d329311712cff">PerpTo</a>(&amp;PosRel,&amp;Axis);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  Perp.<a class="code" href="classVettore.html#a05beac72f2373cd7d3caa4ad8d3823be">Export</a>(dr);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  AMomTemp.<a class="code" href="classVettore.html#a9b3422c7c865368c649cb008c6185250">VetV</a>(&amp;Perp,&amp;PosRel);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  AMomTemp.<a class="code" href="classVettore.html#a05beac72f2373cd7d3caa4ad8d3823be">Export</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].AMomTemp);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">//AMomTemp.Export(Nano[nn].AMomTemp);</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">double</span> HeiOnAxis = Perp.<a class="code" href="classVettore.html#a060c730e982c30a0530598d864a6e508">ProjOnAxis</a>(&amp;PosRel,&amp;Axis);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="keywordflow">if</span>( fabs(HeiOnAxis) &gt; <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Height*.5){</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">double</span> Sign = HeiOnAxis &gt; 0 ? 1. : -1.;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    Dist = 0.;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      dr[d] = Pos2[d] - Pos1[d];</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      Dist = SQR(dr[d]);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    Dist = sqrt(Dist);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">return</span> Dist;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="classForces.html#ac56bd243d0c3cac921959104fac03d2c">  337</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ac56bd243d0c3cac921959104fac03d2c">Forces::NanoInteraction</a>(){</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">Force</a>[d] = 0.;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">AMom</a>[d] = 0.;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c">Point2Shape</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Shape);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordtype">double</span> dr[3] = {0.,0.,0.};</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordtype">double</span> Dist2 = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8">NanoDist2</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p].Pos,n);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span>( Dist2 &gt; <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a> ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">double</span> Cons = <a class="code" href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">RigidLJ</a>(n,Dist2,Pot,0);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">Force</a>[d] -= Cons*dr[d];</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += Cons*dr[d];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">AMom</a>[d] -= <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a062cb4da9ccaf4fe931d0262f827c8c3">AMomTemp</a>[d]*Cons;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordtype">double</span> Ran = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7e97ac28698cae83ebf4b304dbbae40a">Zeta</a> * (2.*<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Casuale</a>() - 1.);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordtype">double</span> Dis = - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a>*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ae3fae9edc78d8cadc33c5a52bebdb46c">Vel</a>[d];</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="comment">//Nano-&gt;Force[d] += Ran + Dis;</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">//printf(&quot;%d %lf %lf %lf\n&quot;,n,Nano[n].AMom[0],Nano[n].AMom[1],Nano[n].AMom[2]);</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">  366</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">Forces::NanoNrg</a>(<span class="keywordtype">int</span> p){</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">double</span> Nrg = <a class="code" href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">NanoNrg</a>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">pPos</a>(p),<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">pType</a>(p));</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">return</span> Nrg;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classForces.html#af2058d93db6e3ef4894d33f6790a6749">  370</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">Forces::NanoNrg</a>(<span class="keywordtype">double</span> *Pos,<span class="keywordtype">int</span> t){</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordtype">double</span> Cons = 0.;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordtype">double</span> Nrg = 0.;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c">Point2Shape</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Shape);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">double</span> Dist2 = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8">NanoDist2</a>(Pos,n);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span>( Dist2 &gt; SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a>) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">double</span> Dist = sqrt(Dist2);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">double</span> Sign = -1.;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span>(t == 1) Sign = 1.;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    Cons += <a class="code" href="classForces.html#abd9350bc451b7ae5507675805b4318d5">RigidHamaker</a>(n,Dist,Pot,Sign);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//Cons += RigidLJ(n,Dist2,Pot,0);</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    Nrg += Pot[0];</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  Nrg *= <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>-&gt;<a class="code" href="structNANO.html#a33ea180d74655fd48d17ae1b6ff1236d">Coating</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> Nrg;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classForces.html#ad7e01b1bd04ce252d991ae872eaa5270">  388</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ad7e01b1bd04ce252d991ae872eaa5270">Forces::DefForceParam</a>(){</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a> = 50.;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a7be87fae5fde1648d34b194775515d08">DistThr</a> = 0.;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="classForces.html#ac5ef477f97601b779392b8622ac6b1fe">Potential</a>(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>,0,0,Pot);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a> = -Pot[0];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a> = sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=10000;i&gt;0;i--){</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">double</span> x = CutOff/10000.*i;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">double</span> For = <a class="code" href="classForces.html#ac5ef477f97601b779392b8622ac6b1fe">Potential</a>(SQR(x),0,0,Pot)/x;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span>(For &gt;= <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>){</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a7be87fae5fde1648d34b194775515d08">DistThr</a> = x;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">PotThr</a> = Pot[0];</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4">  405</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4">Forces::DefNanoForceParam</a>(){</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">pNNano</a>();n++){</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a> = 50.;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c">Point2Shape</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Shape);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a> = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>*3.;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a> = 0.;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">double</span> For =  <a class="code" href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">RigidLJ</a>(n,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a>,Pot,0);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a> = -Pot[0];</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7be87fae5fde1648d34b194775515d08">DistThr</a> = 0.;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=10000;i&gt;0;i--){</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordtype">double</span> x = (<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a>)/10000.*i;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      For = <a class="code" href="classForces.html#abd9350bc451b7ae5507675805b4318d5">RigidHamaker</a>(n,x,Pot,0);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">//For = RigidLJ(n,x,Pot,0);</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span>(For &gt;= <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].ForThr){</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7be87fae5fde1648d34b194775515d08">DistThr</a> = x;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">PotThr</a> = Pot[0];</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keywordflow">break</span>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//printf(&quot;DefForce %lf %lf %lf\n&quot;,Nano[n].DistThr,Nano[n].PotThr,Nano[n].BaseLine);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classForces.html#a4aa4b64aa78c004e13b7d5e059c61c7f">  428</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a4aa4b64aa78c004e13b7d5e059c61c7f">Forces::RigidDistanceRad</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> nn,<span class="keywordtype">double</span> *dr){</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Pos1(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Pos,3);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="classVettore.html">Vettore</a> Pos2(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[nn].Pos,3);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">double</span> Dist = 0.;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    dr[d] = Pos2[d] - Pos1[d];</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    Dist += SQR(dr[d]);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> sqrt(Dist);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">  438</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">Forces::RigidLJ</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">double</span> Dist,<span class="keywordtype">double</span> *Pot,<span class="keywordtype">double</span> Sign){</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">double</span> Cons = 0.;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">double</span> Strength = pow(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Coating,9.)*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">double</span> Hamaker  = pow(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Coating,3.)*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">if</span>( Dist &lt;  <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].DistThr){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    Pot[0] = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">PotThr</a> - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>*(Dist - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7be87fae5fde1648d34b194775515d08">DistThr</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    Pot[1] = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    Cons = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> Cons;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordtype">double</span> idr = 1./(Dist-<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>+<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a33ea180d74655fd48d17ae1b6ff1236d">Coating</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">double</span> idr2 = idr*idr;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">double</span> idr4 = idr2*idr2;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">double</span> idr6 = idr2*idr4;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  Pot[0] = idr*idr2*(Strength*idr6   +Sign*Hamaker)+<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].BaseLine;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  Cons   = idr4    *(Strength*9.*idr6+Sign*3.*Hamaker);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  Pot[1] = idr4    *(Strength*9.*idr6+Sign*3.*Hamaker);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">return</span> Cons;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classForces.html#abd9350bc451b7ae5507675805b4318d5">  458</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#abd9350bc451b7ae5507675805b4318d5">Forces::RigidHamaker</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">double</span> Dr,<span class="keywordtype">double</span> *Pot,<span class="keywordtype">double</span> Sign){</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordtype">double</span> SurfTens = 3.*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">double</span> Cons = 0.;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">double</span> Sigma  = 1.0;<span class="comment">//0.04;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">double</span> Slope = 1.00203;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">double</span> Intercept = 0.31739;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">double</span> Rnp = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">Rad</a>/Slope-Intercept;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span>( Dr &lt;  <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].DistThr){</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    Pot[0] = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">PotThr</a> - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>*(Dr - <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a7be87fae5fde1648d34b194775515d08">DistThr</a>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    Pot[1] = <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">PotThr</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">ForThr</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordtype">double</span> DrInv  = 1./Dr;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">double</span> DrP1 = 1./(Dr+Rnp);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordtype">double</span> DrP3 = CUBE(DrP1);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">double</span> DrP6 = SQR(DrP3);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordtype">double</span> DrP9 = DrP6*DrP3;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordtype">double</span> DrM1 = 1./(-Dr+Rnp);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordtype">double</span> DrM3 = CUBE(DrM1);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">double</span> DrM6 = SQR(DrM3);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordtype">double</span> DrM9 = DrM6*DrM3;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">double</span> PreRep = Sigma*1./360.*DrInv*SurfTens;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">double</span> PreAttr = 1./12.*DrInv*SurfTens;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordtype">double</span> Rep = (9.0*Rnp+Dr)*DrP9 - (9.0*Rnp-Dr)*DrM9;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">double</span> Attr= (3.0*Rnp+Dr)*DrP3 - (3.0*Rnp-Dr)*DrM3;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">double</span> RepP  = -DrP9+9.*(9.*Rnp+Dr)*DrP9*DrP1</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    -(9.*Rnp+Dr)*DrP9*DrInv;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">double</span> RepM  = -DrM9+9.*(9.*Rnp-Dr)*DrM9*DrM1</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    -(9.*Rnp-Dr)*DrM9*DrInv;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">double</span> AttrP = -DrP3+3.*(3.*Rnp+Dr)*DrP3*DrP1</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    -(3.*Rnp+Dr)*DrP3*DrInv;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">double</span> AttrM = -DrM3+3.*(3.*Rnp-Dr)*DrM3*DrM1</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    -(3.*Rnp-Dr)*DrM3*DrInv;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">double</span> RepChem = 9.*DrP9 - (9.*Rnp+Dr)*9.*DrP9*DrP1 </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    - 9.*DrM9 + 9.*(9.*Rnp-Dr)*DrM9*DrM1;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">double</span> AttrChem = 3.*DrP3 - (3.*Rnp+Dr)*3.*DrP3*DrP1 </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    - 3.*DrM9 + 3.*(3.*Rnp-Dr)*DrM3*DrM1;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  Pot[0] = PreRep*Rep + Sign*PreAttr*Attr + <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  Pot[1] = PreRep*RepChem + Sign*PreAttr*AttrChem;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  Cons = PreRep*(RepP+RepM) + Sign*PreAttr*(AttrP+AttrM);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">return</span> Cons;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classForces.html#af8f6e965e516633b54115556243a681a">  500</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#af8f6e965e516633b54115556243a681a">Forces::RigidCoulomb</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">double</span> Dist,<span class="keywordtype">double</span> *Pot,<span class="keywordtype">double</span> Sign){</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span>(Dist &lt; 2.*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].Rad)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> 300.;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  Pot[0] = Sign*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a>/(Dist);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">return</span> -Sign*<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">Nano</a>[n].<a class="code" href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">Hamaker</a>/SQR(Dist);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">//----------------------------DEF-FORCES-POTENTIAL-------------</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordtype">void</span> Forces::PointShape(<span class="keywordtype">int</span> iShape){</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c">Point2Shape</a>(iShape);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_SPH))</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_CYL))</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_PILL))</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TILT))</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_WALL))</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_PORE))</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_EXT)) </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_JANUS))</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_STALK))</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TIP))</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TORUS))</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_HARM))</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_UMBR))</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    CalcPot = &amp;<a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4">DefNanoForceParam</a>();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div><div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classForces.html#af449f7871a4d5c5f1e263e4fe660bd63">  537</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#af449f7871a4d5c5f1e263e4fe660bd63">Forces::Harmonic</a>(<span class="keywordtype">double</span> Dist2,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">double</span> *Pot){</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordtype">double</span> Dist = sqrt(Dist2);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordtype">double</span> a = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordtype">double</span> b = -2.*a*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">double</span> c = -a*SQR(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>) - b*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  Pot[2] = a*Dist2 + b*Dist + c;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordtype">double</span> For =  - 2.*a*Dist2 - b*Dist;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span>(t1 != t2){</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    Pot[2] *= -1.;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> -For;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">//Pot[2] = 0.;</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">return</span> For;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classForces.html#a28fd299b40762b1703462b830df2473d">  551</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a>(<span class="keywordtype">double</span> Dist2,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">double</span> *Pot){</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">double</span> idr6 = CUBE(SQR(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>)/Dist2);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">double</span> idr3 = CUBE(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>)/(Dist2*sqrt(Dist2));</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// if( Dist2 &lt;  Kf.DistThr){</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">//   Pot[0] = Kf.PotThr - Kf.ForThr*(Dist2 - Kf.DistThr);</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">//   return Cons = Kf.ForThr;</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span>(t1 == t2){</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    Pot[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*idr3*(idr6-1.)+<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*idr3*(9.*idr6-3.);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    Pot[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*idr3*(idr6+1.)+<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*idr3*(9.*idr6+3.);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classForces.html#ad6b11a62ba4f9871d598109fe007a121">  567</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#ad6b11a62ba4f9871d598109fe007a121">Forces::LJPot</a>(<span class="keywordtype">double</span> Dist2,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">double</span> *Pot){</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">double</span> idr6 = CUBE(SQR(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">LJMin</a>)/Dist2);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// if( Dist2 &lt;  Kf.DistThr){</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">//   Pot[0] = Kf.PotThr - Kf.ForThr*(Dist2 - Kf.DistThr);</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">//   return Kf.ForThr;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">if</span>(t1 == t2){</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    Pot[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*4.*(idr6*idr6-idr6) + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*48.*(idr6*idr6-.5*idr6);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    Pot[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*4.*(idr6*idr6+idr6) + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">BaseLine</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*48.*(idr6*idr6+.5*idr6);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classForces.html#a1f0b019b2a8c81938b8f4a3f3ddcfc48">  582</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a1f0b019b2a8c81938b8f4a3f3ddcfc48">Forces::StepPot</a>(<span class="keywordtype">double</span> Dist2,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">double</span> *Pot){</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span>(t1 != t2){</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    Pot[2] = -<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*sqrt(Dist2/<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  Pot[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>*sqrt(Dist2/<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classForces.html#ad1ef4b910c2f6e057b8b2e079d32100b">  590</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#ad1ef4b910c2f6e057b8b2e079d32100b">Forces::ElectroPot</a>(<span class="keywordtype">double</span> Dist2,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">double</span> *Pot){</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span>(t1 == t2)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    Pot[2] =  <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a60a1f1fb24ef62e5433e4c50466a1624">Ext</a>/Dist2;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    Pot[2] =  -<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">LJ</a>/Dist2;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">return</span> Pot[2];</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div><div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="classForces.html#a5c32ef207ba714e72e72de3063860b39">  597</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a5c32ef207ba714e72e72de3063860b39">Forces::CalcForcesDensFunc</a>(){</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">if</span>(!VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">SysAlloc</a>,ALL_FORCES)){</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    printf(<span class="stringliteral">&quot;Forces not allocated\n&quot;</span>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordtype">int</span> NTabF = 300;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="classForces.html#ab7b56f14cb877cece5075bc6a160aab3">TabForceAlloc</a>(NTabF);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">double</span> *Count = (<span class="keywordtype">double</span> *)calloc(NTab*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>(),<span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <a class="code" href="classForces.html#a0390d97ed1665851fb6175342d1c598b">ClearDens</a>();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="classForces.html#a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b">AddDens</a>(0,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="classForces.html#a0449e9410bf23ad4d073f1eab66c2a68">SumDens</a>(0,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>());</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordtype">double</span> Dist = 0.;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordtype">double</span> DistRelBA[4];</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordtype">double</span> InvCutOff = 1./sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p++){</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] = 0.;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// non bonded</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p1=0;p1&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">pNPart</a>();p1++){</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a74b7b0d716684a7d46993c83795fd9e7">SetCurr</a>(p1);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a63c5d18d3a487d1a8ab2a5881c6acb38">IfCurr</a>();<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a42eeb7049c078ca89057fbc08726eded">NextCurr</a>()){</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordtype">int</span> p2 = <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDomDecBasics.html#a28d65a777a97b96280ca0f9173c76c93">p2Curr</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">if</span>(p2 &lt;= p1) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#ad4860e7b4a26d4b424e5c98b7c6bae09">Dist2Curr</a>(DistRelBA);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span>(DistRelBA[3] &gt; <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordtype">double</span> Force = 0.;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordtype">double</span> Dist = sqrt(DistRelBA[3]);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>();t++){</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   Force += <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5">Coeff</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p1].Typ,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p2].Typ,t)*(Dens3[p1*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t]+Dens3[p2*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t]);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      Force *= <a class="code" href="classForces.html#a3d44e49e6ced82a300d6071060b72c48">DerWei3</a>(Dist,<a class="code" href="classVarData.html#aa5c40af319c1dda726271b9fe4059443">pWei3Par</a>())*2./3.;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      Force += <a class="code" href="classForces.html#a5c07d0e26deb83592ec816a9d6dfd05b">DerWei2</a>(Dist,<a class="code" href="classVarData.html#a217f00c8faf9ba6bb022913df51e5f24">pWei2Par</a>())*<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5">Coeff</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p1].Typ,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p2].Typ);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      Force /= -Dist;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordtype">int</span> x = (int)(Dist*InvCutOff*NTab);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span>( x &lt; 0 || x &gt;= NTab) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordtype">int</span> t = MIN(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p1].Typ,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p2].Typ)*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+MAX(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p1].Typ,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">Pm</a>[p2].Typ);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      FTab[x*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t] += Force;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      Count[x*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+t] += 1.;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += Force*DistRelBA[d];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p2].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= Force*DistRelBA[d];</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTab;t++){</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t1=0;t1&lt;<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>();t1++){</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t2=0;t2&lt;<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>();t2++){</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordtype">int</span> tType = MIN(t1,t2)*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+MAX(t1,t2);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordtype">double</span> Norm = Count[t*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+tType] &gt; 0. ? 1./Count[t*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+tType] : 1.;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   FTab[t*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()+tType] *= Norm;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// bonded</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">double</span> DistRelBC[4];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">double</span> Pre[12];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">pNBlock</a>();b++){</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">pNChain</a>(b);c++){</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b);p&lt;(c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b)-1;p++){</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <a class="code" href="classVarData.html#a19886baf2914ac46bc50f333254a4e57">TwoPartDist</a>(p+1,p,DistRelBA);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordtype">double</span> ForceSp = <a class="code" href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3">pkSpr</a>()*(1. - <a class="code" href="classVarData.html#ad180facca71ad48ae3ce77052bf22957">pSprRest</a>()/DistRelBA[3]);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += ForceSp*DistRelBA[d];</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= ForceSp*DistRelBA[d];</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="keywordflow">if</span>(p &lt; (c+1)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">pNPCh</a>(b)-2){</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     <a class="code" href="classVarData.html#a19886baf2914ac46bc50f333254a4e57">TwoPartDist</a>(p+2,p+1,DistRelBC);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;     <span class="keywordtype">double</span> CosAngle = 0.;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;       DistRelBA[d] /= DistRelBA[3];</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;       DistRelBC[d] /= DistRelBC[3];</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;       CosAngle += DistRelBA[d]*DistRelBC[d];</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;     }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;     <span class="keywordtype">double</span> PreFactBA = <a class="code" href="classVarData.html#a395cfa5f68437606051e29df1759e371">pkBen</a>()/DistRelBA[3];</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     <span class="keywordtype">double</span> PreFactBC = <a class="code" href="classVarData.html#a395cfa5f68437606051e29df1759e371">pkBen</a>()/DistRelBC[3];</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+0].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= PreFactBA*(DistRelBC[d]-DistRelBA[d]*CosAngle);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += PreFactBA*(DistRelBC[d]-DistRelBA[d]*CosAngle);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+1].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] -= PreFactBC*(DistRelBA[d]-DistRelBC[d]*CosAngle);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;       <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3">Fm</a>[p+2].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">Dir</a>[d] += PreFactBC*(DistRelBA[d]-DistRelBC[d]*CosAngle);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;     }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   }    </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="classForces.html#a7b92a25206538d578d6129879bfac183">  684</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a7b92a25206538d578d6129879bfac183">Forces::PrintForce</a>(){</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordtype">double</span> NPoint = 1000.;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  FILE *FWrite = fopen(<span class="stringliteral">&quot;Force.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordtype">double</span> Delta = sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>)/NPoint;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a> = sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">double</span> x=Delta;x&lt;<a class="code" href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">CutOff</a>;x+=Delta){</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordtype">double</span> Cons = <a class="code" href="classForces.html#ad6b11a62ba4f9871d598109fe007a121">LJPot</a>(x,0,0,Pot);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    fprintf(FWrite,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,x,Cons,*Pot);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  fclose(FWrite);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div><div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="classForces.html#ab7b56f14cb877cece5075bc6a160aab3">  696</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#ab7b56f14cb877cece5075bc6a160aab3">Forces::TabForceAlloc</a>(<span class="keywordtype">int</span> NTabExt){</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  NTab = NTabExt;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordtype">double</span> Pot[2];</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">double</span> Delta = sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49">CutOff2</a>)/(double)NTab;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">double</span> NrgLim = 20.;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  FTab = (<span class="keywordtype">double</span> *)calloc(NTab*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>(),<span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  MTab = (<span class="keywordtype">double</span> *)calloc(NTab,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  PTab = (<span class="keywordtype">double</span> *)calloc(NTab*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">pNType</a>(),<span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  VAR_ADD_TYPE(DynFlag,ALL_FORCES);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div><div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="classForces.html#a1c00d241ca805ba05becca0e9aafe45f">  706</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classForces.html#a1c00d241ca805ba05becca0e9aafe45f">Forces::TabPot</a>(){</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  NTab = 10000;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordtype">double</span> NrgLim = 10.;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">double</span> Delta = 2.*NrgLim/(double)NTab;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">double</span> Nrg=-NrgLim;Nrg&lt;NrgLim;Nrg+=Delta,i++){</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    PTab[i] = Nrg;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    MTab[i] = exp(-<a class="code" href="classVarData.html#a495c5b182109864eb1db337d49a53999">pTemp</a>()*Nrg);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  VAR_ADD_TYPE(DynFlag,ALL_METR);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  VAR_ADD_TYPE(DynFlag,ALL_POT);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div><div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="classForces.html#a5c95469e44bbbea88c38809308ca4551">  718</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a5c95469e44bbbea88c38809308ca4551">Forces::Wei3</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span> b){</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">if</span>(r &lt; 0.0001) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">return</span> (r &lt; b) ? 15. / (2. * M_PI * CUBE(b)) * SQR(1. - r / b) : 0.;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="classForces.html#a3d44e49e6ced82a300d6071060b72c48">  722</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a3d44e49e6ced82a300d6071060b72c48">Forces::DerWei3</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span> b){</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span>(r &lt; 0.0001) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">return</span> (r &lt; b) ? 15. / (M_PI * SQR(SQR(b))) * (r / b - 1.) : 0.;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="classForces.html#a2a275bbffe53c778eb8d535f3dc601f8">  726</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a2a275bbffe53c778eb8d535f3dc601f8">Forces::Wei2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span> a){</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span>(r &lt; 0.0001) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b = 1.;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordtype">double</span> Ai = .5 * 15. / M_PI / (CUBE(a) + CUBE(a + b) + CUBE(b));</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">return</span> (r &lt; a) ? Ai : (Ai / CUBE(a - b)) *</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    ((((-2. * r) + 3. * (a + b)) * r - 6. * a * b) * r +</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;     3. * a * b * b - b * b * b);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div><div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="classForces.html#a5c07d0e26deb83592ec816a9d6dfd05b">  734</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classForces.html#a5c07d0e26deb83592ec816a9d6dfd05b">Forces::DerWei2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span> a){</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span>(r &lt; 0.0001) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> b = 1.;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">double</span> Ai = 15. / (M_PI * (((((4. * a) + 6.) * a) + 6.) * a + 4.));</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">return</span> (r &gt; a &amp;&amp; r &lt; b) ? (6. * Ai / CUBE(a - b) * (-r * r + (a + b) *</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        r - a * b)) : 0.; </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div><div class="ttc" id="classVettore_html_a05beac72f2373cd7d3caa4ad8d3823be"><div class="ttname"><a href="classVettore.html#a05beac72f2373cd7d3caa4ad8d3823be">Vettore::Export</a></div><div class="ttdeci">void Export(double *x)</div><div class="ttdoc">Export. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaVect_8cpp_source.html#l00376">MatematicaVect.cpp:376</a></div></div>
<div class="ttc" id="classMatematica_html_a4166dfd1c333203677c8caf040ead05b"><div class="ttname"><a href="classMatematica.html#a4166dfd1c333203677c8caf040ead05b">Matematica::Spline4Beg</a></div><div class="ttdeci">SPLINE Spline4Beg(double *P1, double *P2, double *P3, double *P4, int x, int y)</div><div class="ttdoc">Four order spline first boundary. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00068">MatematicaInterp.cpp:68</a></div></div>
<div class="ttc" id="structSPLINE_html_ac6ef178808a2e015c97d93c99e52a441"><div class="ttname"><a href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441">SPLINE::a4</a></div><div class="ttdeci">double a4</div><div class="ttdoc">a0 + a1*x + a2*x^2 + a3*x^3 + a4^4 </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaStruct_8h_source.html#l00114">MatematicaStruct.h:114</a></div></div>
<div class="ttc" id="structKFORCES_html_ae05456a79f8f4e14c02b374d188ba9da"><div class="ttname"><a href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da">KFORCES::LJMin</a></div><div class="ttdeci">double LJMin</div><div class="ttdoc">Lennard-Jones. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00161">Forces.h:161</a></div></div>
<div class="ttc" id="classVarData_html_a395cfa5f68437606051e29df1759e371"><div class="ttname"><a href="classVarData.html#a395cfa5f68437606051e29df1759e371">VarData::pkBen</a></div><div class="ttdeci">double pkBen()</div><div class="ttdoc">Bending coupling. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00932">VarData.h:932</a></div></div>
<div class="ttc" id="structKFORCES_html_a60a1f1fb24ef62e5433e4c50466a1624"><div class="ttname"><a href="structKFORCES.html#a60a1f1fb24ef62e5433e4c50466a1624">KFORCES::Ext</a></div><div class="ttdeci">double Ext</div><div class="ttdoc">External force. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00153">Forces.h:153</a></div></div>
<div class="ttc" id="classForces_html_ad6b11a62ba4f9871d598109fe007a121"><div class="ttname"><a href="classForces.html#ad6b11a62ba4f9871d598109fe007a121">Forces::LJPot</a></div><div class="ttdeci">double LJPot(double Dist2, int t1, int t2, double *Pot)</div><div class="ttdoc">Classical Lennard Jones potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00567">ForcesForceField.cpp:567</a></div></div>
<div class="ttc" id="structLINKS_html_a73918a2decc99bcf2317d2855dada6c8"><div class="ttname"><a href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8">LINKS::NLink</a></div><div class="ttdeci">int NLink</div><div class="ttdoc">How many links per particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00233">VarData.h:233</a></div></div>
<div class="ttc" id="classForces_html_abe46a6cf819d53f35747565f9276854f"><div class="ttname"><a href="classForces.html#abe46a6cf819d53f35747565f9276854f">Forces::ForceFieldLine</a></div><div class="ttdeci">int ForceFieldLine()</div><div class="ttdoc">Helfrich Hamiltonian for a line. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00004">ForcesForceField.cpp:4</a></div></div>
<div class="ttc" id="classVarData_html_a1dd0baef0ade6f5abcacba0d814f40d8"><div class="ttname"><a href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8">VarData::NanoDist2</a></div><div class="ttdeci">double NanoDist2(double *Pos, int n)</div><div class="ttdoc">Pointer to a generic function. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00764">VarData.h:764</a></div></div>
<div class="ttc" id="classVarData_html_a8864e546987744c3b932ff2a3b8c1291"><div class="ttname"><a href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291">VarData::Ln</a></div><div class="ttdeci">LINKS * Ln</div><div class="ttdoc">Array of linking between the particles. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01048">VarData.h:1048</a></div></div>
<div class="ttc" id="classForces_html_af8f6e965e516633b54115556243a681a"><div class="ttname"><a href="classForces.html#af8f6e965e516633b54115556243a681a">Forces::RigidCoulomb</a></div><div class="ttdeci">double RigidCoulomb(int nNano, double Dist, double *Pot, double Sign)</div><div class="ttdoc">Force between to rigid bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00500">ForcesForceField.cpp:500</a></div></div>
<div class="ttc" id="classVarData_html_aee5ea3e3c08ea9745e40192350f5d14b"><div class="ttname"><a href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b">VarData::Nano</a></div><div class="ttdeci">NANO * Nano</div><div class="ttdoc">Extra particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01044">VarData.h:1044</a></div></div>
<div class="ttc" id="classForces_html_ab7b56f14cb877cece5075bc6a160aab3"><div class="ttname"><a href="classForces.html#ab7b56f14cb877cece5075bc6a160aab3">Forces::TabForceAlloc</a></div><div class="ttdeci">void TabForceAlloc(int NTabExt)</div><div class="ttdoc">Tabulate the values of the force. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00696">ForcesForceField.cpp:696</a></div></div>
<div class="ttc" id="structNANO_html_a1a0cbbb118b67bb2a3f1f682c0dad85b"><div class="ttname"><a href="structNANO.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">NANO::Gamma</a></div><div class="ttdeci">double Gamma</div><div class="ttdoc">Friction term. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00451">VarData.h:451</a></div></div>
<div class="ttc" id="structNANO_html_a2c39c1efe4f21bf1103d46b0a4e8f5a9"><div class="ttname"><a href="structNANO.html#a2c39c1efe4f21bf1103d46b0a4e8f5a9">NANO::Hamaker</a></div><div class="ttdeci">double Hamaker</div><div class="ttdoc">Strength of the interaction. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00447">VarData.h:447</a></div></div>
<div class="ttc" id="structNANO_html_a7be87fae5fde1648d34b194775515d08"><div class="ttname"><a href="structNANO.html#a7be87fae5fde1648d34b194775515d08">NANO::DistThr</a></div><div class="ttdeci">double DistThr</div><div class="ttdoc">Minimum distance threshold. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00465">VarData.h:465</a></div></div>
<div class="ttc" id="classVettore_html"><div class="ttname"><a href="classVettore.html">Vettore</a></div><div class="ttdoc">Geometrical operations on vectors. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaVect_8h_source.html#l00009">MatematicaVect.h:9</a></div></div>
<div class="ttc" id="structKFORCES_html_ad68dc62d6c1b859ad3abebc60476453e"><div class="ttname"><a href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e">KFORCES::Lap</a></div><div class="ttdeci">double Lap</div><div class="ttdoc">Prefactor of the Laplacian. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00147">Forces.h:147</a></div></div>
<div class="ttc" id="classForces_html_a299061ca48b352b4d40c0dfbb6ffd2da"><div class="ttname"><a href="classForces.html#a299061ca48b352b4d40c0dfbb6ffd2da">Forces::RigidLJ</a></div><div class="ttdeci">double RigidLJ(int nNano, double Dist, double *Pot, double Sign)</div><div class="ttdoc">Force between to rigid bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00438">ForcesForceField.cpp:438</a></div></div>
<div class="ttc" id="classMatematica_html_aa2836a8f43d770c560eb34c3cafa4ceb"><div class="ttname"><a href="classMatematica.html#aa2836a8f43d770c560eb34c3cafa4ceb">Matematica::Spline3Beg</a></div><div class="ttdeci">SPLINE Spline3Beg(double *P1, double *P2, double *P3, int x, int y)</div><div class="ttdoc">Three order spline first boundary. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00015">MatematicaInterp.cpp:15</a></div></div>
<div class="ttc" id="structPARABOLA_html"><div class="ttname"><a href="structPARABOLA.html">PARABOLA</a></div><div class="ttdoc">Parabolas coefficients. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaStruct_8h_source.html#l00007">MatematicaStruct.h:7</a></div></div>
<div class="ttc" id="structNANO_html_a860bef50013f57ab1a6437b7986a9487"><div class="ttname"><a href="structNANO.html#a860bef50013f57ab1a6437b7986a9487">NANO::Rad</a></div><div class="ttdeci">double Rad</div><div class="ttdoc">Size. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00445">VarData.h:445</a></div></div>
<div class="ttc" id="classForces_html_af449f7871a4d5c5f1e263e4fe660bd63"><div class="ttname"><a href="classForces.html#af449f7871a4d5c5f1e263e4fe660bd63">Forces::Harmonic</a></div><div class="ttdeci">double Harmonic(double Dist2, int t1, int t2, double *Pot)</div><div class="ttdoc">Harmonic potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00537">ForcesForceField.cpp:537</a></div></div>
<div class="ttc" id="structNANO_html_ae3fae9edc78d8cadc33c5a52bebdb46c"><div class="ttname"><a href="structNANO.html#ae3fae9edc78d8cadc33c5a52bebdb46c">NANO::Vel</a></div><div class="ttdeci">double Vel[3]</div><div class="ttdoc">Velocity. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00431">VarData.h:431</a></div></div>
<div class="ttc" id="classVarData_html_a75896c37dd78ba0d2da013ad4cf0e87c"><div class="ttname"><a href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">VarData::pType</a></div><div class="ttdeci">int pType(int p)</div><div class="ttdoc">Return the type. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00219">VarDataComm.cpp:219</a></div></div>
<div class="ttc" id="classForces_html_a5c07d0e26deb83592ec816a9d6dfd05b"><div class="ttname"><a href="classForces.html#a5c07d0e26deb83592ec816a9d6dfd05b">Forces::DerWei2</a></div><div class="ttdeci">double DerWei2(const double r, const double b)</div><div class="ttdoc">Derivative of the quadratic weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00734">ForcesForceField.cpp:734</a></div></div>
<div class="ttc" id="structKFORCES_html_a682d0bf554363bfcb9698c55bd6a0527"><div class="ttname"><a href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527">KFORCES::El</a></div><div class="ttdeci">double El[3]</div><div class="ttdoc">Elastic force. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00151">Forces.h:151</a></div></div>
<div class="ttc" id="structKFORCES_html_adf3d7e8b11ee1fa9f6b7b58141ab5112"><div class="ttname"><a href="structKFORCES.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">KFORCES::PotThr</a></div><div class="ttdeci">double PotThr</div><div class="ttdoc">Maximum potential allowed. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00169">Forces.h:169</a></div></div>
<div class="ttc" id="structPART_html_a863738e46f14b3bfc674ad87d35f143d"><div class="ttname"><a href="structPART.html#a863738e46f14b3bfc674ad87d35f143d">PART::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdoc">xyz Position of the particle </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00216">VarData.h:216</a></div></div>
<div class="ttc" id="classForces_html_a283f91fa3fbd05178f4b77ff3a585495"><div class="ttname"><a href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495">Forces::IfInterp</a></div><div class="ttdeci">int IfInterp</div><div class="ttdoc">If interpolates with the splines. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00755">Forces.h:755</a></div></div>
<div class="ttc" id="structFORCES_html_ac77c91979738079508cf3f257a7164ba"><div class="ttname"><a href="structFORCES.html#ac77c91979738079508cf3f257a7164ba">FORCES::Dir</a></div><div class="ttdeci">double Dir[3]</div><div class="ttdoc">Direction. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00178">Forces.h:178</a></div></div>
<div class="ttc" id="classVarData_html_a16f3b01ba84886cbaf53fa1238c434f3"><div class="ttname"><a href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3">VarData::pkSpr</a></div><div class="ttdeci">double pkSpr()</div><div class="ttdoc">Spring coupling. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00934">VarData.h:934</a></div></div>
<div class="ttc" id="classVarData_html_ad180facca71ad48ae3ce77052bf22957"><div class="ttname"><a href="classVarData.html#ad180facca71ad48ae3ce77052bf22957">VarData::pSprRest</a></div><div class="ttdeci">double pSprRest()</div><div class="ttdoc">Rest distance of the harmonic potential. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00942">VarData.h:942</a></div></div>
<div class="ttc" id="classForces_html_ae35380222f8a3cacfa4a4df6d1742ffb"><div class="ttname"><a href="classForces.html#ae35380222f8a3cacfa4a4df6d1742ffb">Forces::ForceFieldRod</a></div><div class="ttdeci">void ForceFieldRod()</div><div class="ttdoc">Bending potential on a rod. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00210">ForcesForceField.cpp:210</a></div></div>
<div class="ttc" id="classDdLinkedList_html_ad4860e7b4a26d4b424e5c98b7c6bae09"><div class="ttname"><a href="classDdLinkedList.html#ad4860e7b4a26d4b424e5c98b7c6bae09">DdLinkedList::Dist2Curr</a></div><div class="ttdeci">void Dist2Curr(double *DistRel)</div><div class="ttdoc">Retrun the squared current interparticle distance. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00502">Cubo.cpp:502</a></div></div>
<div class="ttc" id="classForces_html_ab3f89c2d946d9c242d3d6061ae17ae78"><div class="ttname"><a href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78">Forces::SysAlloc</a></div><div class="ttdeci">int SysAlloc</div><div class="ttdoc">Which arrays are allocated. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00753">Forces.h:753</a></div></div>
<div class="ttc" id="classForces_html_a5c32ef207ba714e72e72de3063860b39"><div class="ttname"><a href="classForces.html#a5c32ef207ba714e72e72de3063860b39">Forces::CalcForcesDensFunc</a></div><div class="ttdeci">void CalcForcesDensFunc()</div><div class="ttdoc">Calculate the forces for the density functional. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00597">ForcesForceField.cpp:597</a></div></div>
<div class="ttc" id="structNANO_html_a863738e46f14b3bfc674ad87d35f143d"><div class="ttname"><a href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d">NANO::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdoc">Position. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00427">VarData.h:427</a></div></div>
<div class="ttc" id="classForces_html_ad1ef4b910c2f6e057b8b2e079d32100b"><div class="ttname"><a href="classForces.html#ad1ef4b910c2f6e057b8b2e079d32100b">Forces::ElectroPot</a></div><div class="ttdeci">double ElectroPot(double Dist2, int t1, int t2, double *Pot)</div><div class="ttdoc">Potential for the electrical lines. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00590">ForcesForceField.cpp:590</a></div></div>
<div class="ttc" id="classForces_html_ac56bd243d0c3cac921959104fac03d2c"><div class="ttname"><a href="classForces.html#ac56bd243d0c3cac921959104fac03d2c">Forces::NanoInteraction</a></div><div class="ttdeci">void NanoInteraction()</div><div class="ttdoc">Calculate all the interaction with the nano. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00337">ForcesForceField.cpp:337</a></div></div>
<div class="ttc" id="classMatematica_html_a000dcbdd9b1b4f62dd4c4b2fc19ff300"><div class="ttname"><a href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">Matematica::Parab2</a></div><div class="ttdeci">SPLINE Parab2(double *PA, double *PB, double *PC, int x, int y)</div><div class="ttdoc">Three points parabolic interpolation. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00199">MatematicaInterp.cpp:199</a></div></div>
<div class="ttc" id="classVarData_html_a0ad300d40b5d4a3391361b4c8875091f"><div class="ttname"><a href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">VarData::pNPCh</a></div><div class="ttdeci">int pNPCh()</div><div class="ttdoc">Number of particle per chain. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00249">VarDataComm.cpp:249</a></div></div>
<div class="ttc" id="classForces_html_a8f12492ed75d05c816d8f14bbeaf71be"><div class="ttname"><a href="classForces.html#a8f12492ed75d05c816d8f14bbeaf71be">Forces::ForceFieldRigid</a></div><div class="ttdeci">void ForceFieldRigid()</div><div class="ttdoc">Interaction between rigid bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00283">ForcesForceField.cpp:283</a></div></div>
<div class="ttc" id="structKFORCES_html_a7be87fae5fde1648d34b194775515d08"><div class="ttname"><a href="structKFORCES.html#a7be87fae5fde1648d34b194775515d08">KFORCES::DistThr</a></div><div class="ttdeci">double DistThr</div><div class="ttdoc">Correspondent radial distance for this force. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00173">Forces.h:173</a></div></div>
<div class="ttc" id="classForces_html_aea50b2cb321ee5dfaa107a0726838e1a"><div class="ttname"><a href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a">Forces::Dx</a></div><div class="ttdeci">double Dx</div><div class="ttdoc">Spatial separation between particles. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00729">Forces.h:729</a></div></div>
<div class="ttc" id="classVarData_html_aa5c40af319c1dda726271b9fe4059443"><div class="ttname"><a href="classVarData.html#aa5c40af319c1dda726271b9fe4059443">VarData::pWei3Par</a></div><div class="ttdeci">double pWei3Par()</div><div class="ttdoc">Parameter of the third order weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00950">VarData.h:950</a></div></div>
<div class="ttc" id="classMatematica_html_a6b6c8217f2c75492c48cd60e4d9c17cf"><div class="ttname"><a href="classMatematica.html#a6b6c8217f2c75492c48cd60e4d9c17cf">Matematica::Spline4</a></div><div class="ttdeci">SPLINE Spline4(double *P1, double *P2, double *P3, double *P4, int x, int y)</div><div class="ttdoc">Four order spline. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00087">MatematicaInterp.cpp:87</a></div></div>
<div class="ttc" id="classVarData_html_a19886baf2914ac46bc50f333254a4e57"><div class="ttname"><a href="classVarData.html#a19886baf2914ac46bc50f333254a4e57">VarData::TwoPartDist</a></div><div class="ttdeci">double TwoPartDist(int p1, int p2, double *RelDist)</div><div class="ttdoc">Return the relative distance between two particles (wrapped) </div><div class="ttdef"><b>Definition:</b> <a href="VarDataEl_8cpp_source.html#l00419">VarDataEl.cpp:419</a></div></div>
<div class="ttc" id="classVarData_html_a474ffd5306304ac53eb7ef48a18e511d"><div class="ttname"><a href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">VarData::pNBlock</a></div><div class="ttdeci">int pNBlock()</div><div class="ttdoc">Number of blocks. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00254">VarDataComm.cpp:254</a></div></div>
<div class="ttc" id="classForces_html_a7ab5c0bcf11c3f33530a25984720b424"><div class="ttname"><a href="classForces.html#a7ab5c0bcf11c3f33530a25984720b424">Forces::NanoNrg</a></div><div class="ttdeci">double NanoNrg(int p)</div><div class="ttdoc">Exchange energy with the nano. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00366">ForcesForceField.cpp:366</a></div></div>
<div class="ttc" id="structNANO_html_a12346a80b6dd9472f0a10aab633f2f4f"><div class="ttname"><a href="structNANO.html#a12346a80b6dd9472f0a10aab633f2f4f">NANO::BaseLine</a></div><div class="ttdeci">double BaseLine</div><div class="ttdoc">Baseline of the potential. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00463">VarData.h:463</a></div></div>
<div class="ttc" id="classVarData_html_a7bb96647a8e4b53477394d2538fdfb3f"><div class="ttname"><a href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f">VarData::MInt</a></div><div class="ttdeci">MatInt * MInt</div><div class="ttdoc">Matrix of the prefactor of the interactions. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00529">VarData.h:529</a></div></div>
<div class="ttc" id="structLINKS_html_aefc83dee460fda66ca240e011e7ce0a7"><div class="ttname"><a href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7">LINKS::Link</a></div><div class="ttdeci">int * Link</div><div class="ttdoc">with whom is bonded </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00231">VarData.h:231</a></div></div>
<div class="ttc" id="classVarData_html_ae2e67b49132b33a026b19c647cbf4f3c"><div class="ttname"><a href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c">VarData::NEdge</a></div><div class="ttdeci">int NEdge</div><div class="ttdoc">Number of particles per edge. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01084">VarData.h:1084</a></div></div>
<div class="ttc" id="classForces_html_a1c00d241ca805ba05becca0e9aafe45f"><div class="ttname"><a href="classForces.html#a1c00d241ca805ba05becca0e9aafe45f">Forces::TabPot</a></div><div class="ttdeci">void TabPot()</div><div class="ttdoc">Tabulate the values of the potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00706">ForcesForceField.cpp:706</a></div></div>
<div class="ttc" id="classMatematica_html_a953e8be14f6a9c259f192683f3a5a970"><div class="ttname"><a href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970">Matematica::Casuale</a></div><div class="ttdeci">double Casuale()</div><div class="ttdoc">Random uniform number. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaSign_8cpp_source.html#l00031">MatematicaSign.cpp:31</a></div></div>
<div class="ttc" id="classVettore_html_a060c730e982c30a0530598d864a6e508"><div class="ttname"><a href="classVettore.html#a060c730e982c30a0530598d864a6e508">Vettore::ProjOnAxis</a></div><div class="ttdeci">double ProjOnAxis(Vettore *a)</div><div class="ttdoc">Projects along the axis. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaVect_8cpp_source.html#l00351">MatematicaVect.cpp:351</a></div></div>
<div class="ttc" id="classForces_html_a774d65ef8685d2859fae66bad8c9b435"><div class="ttname"><a href="classForces.html#a774d65ef8685d2859fae66bad8c9b435">Forces::Kf</a></div><div class="ttdeci">KFORCES Kf</div><div class="ttdoc">Prefactor of the forces. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00779">Forces.h:779</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a42eeb7049c078ca89057fbc08726eded"><div class="ttname"><a href="classDdLinkedList.html#a42eeb7049c078ca89057fbc08726eded">DdLinkedList::NextCurr</a></div><div class="ttdeci">void NextCurr()</div><div class="ttdoc">Increase the iterator to the next couple. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00479">Cubo.cpp:479</a></div></div>
<div class="ttc" id="structNANO_html_a7e97ac28698cae83ebf4b304dbbae40a"><div class="ttname"><a href="structNANO.html#a7e97ac28698cae83ebf4b304dbbae40a">NANO::Zeta</a></div><div class="ttdeci">double Zeta</div><div class="ttdoc">Stochastic term. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00453">VarData.h:453</a></div></div>
<div class="ttc" id="structNANO_html_ad631a0b43047f95f5bb991f5407b813e"><div class="ttname"><a href="structNANO.html#ad631a0b43047f95f5bb991f5407b813e">NANO::ForThr</a></div><div class="ttdeci">double ForThr</div><div class="ttdoc">Maximum value of the force. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00467">VarData.h:467</a></div></div>
<div class="ttc" id="classForces_html_aed97e42cbfeb918574e91a90719864ab"><div class="ttname"><a href="classForces.html#aed97e42cbfeb918574e91a90719864ab">Forces::ForceFieldLeaves</a></div><div class="ttdeci">int ForceFieldLeaves()</div><div class="ttdoc">Helfrich Hamiltonian with an elastic coupling. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00130">ForcesForceField.cpp:130</a></div></div>
<div class="ttc" id="classVarData_html_acd4e4b1e648b7d1ca3a169bb176e9f5c"><div class="ttname"><a href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c">VarData::Point2Shape</a></div><div class="ttdeci">void Point2Shape(int iShape)</div><div class="ttdoc">Point to the shape function. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataEl_8cpp_source.html#l00490">VarDataEl.cpp:490</a></div></div>
<div class="ttc" id="classForces_html_af2411aba2dd63fa22b1bc279653ff7a0"><div class="ttname"><a href="classForces.html#af2411aba2dd63fa22b1bc279653ff7a0">Forces::CutOff</a></div><div class="ttdeci">double CutOff</div><div class="ttdoc">Cut off of the interactions. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00727">Forces.h:727</a></div></div>
<div class="ttc" id="classForces_html_a7b92a25206538d578d6129879bfac183"><div class="ttname"><a href="classForces.html#a7b92a25206538d578d6129879bfac183">Forces::PrintForce</a></div><div class="ttdeci">void PrintForce()</div><div class="ttdoc">Print the force and the potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00684">ForcesForceField.cpp:684</a></div></div>
<div class="ttc" id="classVarData_html_a217f00c8faf9ba6bb022913df51e5f24"><div class="ttname"><a href="classVarData.html#a217f00c8faf9ba6bb022913df51e5f24">VarData::pWei2Par</a></div><div class="ttdeci">double pWei2Par()</div><div class="ttdoc">Parameter of the second order weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00948">VarData.h:948</a></div></div>
<div class="ttc" id="classVarData_html_aef94681f570cacf1a76aac1512563f17"><div class="ttname"><a href="classVarData.html#aef94681f570cacf1a76aac1512563f17">VarData::pNNano</a></div><div class="ttdeci">int pNNano()</div><div class="ttdoc">Number of nanoparticles. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00253">VarDataComm.cpp:253</a></div></div>
<div class="ttc" id="classVettore_html_a9b3422c7c865368c649cb008c6185250"><div class="ttname"><a href="classVettore.html#a9b3422c7c865368c649cb008c6185250">Vettore::VetV</a></div><div class="ttdeci">double VetV(const Vettore *u, const Vettore *v)</div><div class="ttdoc">Vectorial product between two Vettore returns the area. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaVect_8cpp_source.html#l00310">MatematicaVect.cpp:310</a></div></div>
<div class="ttc" id="structNANO_html_a33ea180d74655fd48d17ae1b6ff1236d"><div class="ttname"><a href="structNANO.html#a33ea180d74655fd48d17ae1b6ff1236d">NANO::Coating</a></div><div class="ttdeci">double Coating</div><div class="ttdoc">Thickness of the LJ well. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00461">VarData.h:461</a></div></div>
<div class="ttc" id="classForces_html_aad7c51f4a67ea41983881db33d1e5434"><div class="ttname"><a href="classForces.html#aad7c51f4a67ea41983881db33d1e5434">Forces::SumSomeForces</a></div><div class="ttdeci">int SumSomeForces(int HowMany)</div><div class="ttdoc">Boh. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00245">ForcesForceField.cpp:245</a></div></div>
<div class="ttc" id="structSPLINE_html_ac55c2d269ed76bd9bdb7fb25f3533a4e"><div class="ttname"><a href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">SPLINE::a2</a></div><div class="ttdeci">double a2</div><div class="ttdoc">a0 + a1*x + a2*x^2 + a3*x^3 + a4^4 </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaStruct_8h_source.html#l00110">MatematicaStruct.h:110</a></div></div>
<div class="ttc" id="classMatInt_html_a1c5a9c480e688013bf93d9d5409319e5"><div class="ttname"><a href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5">MatInt::Coeff</a></div><div class="ttdeci">double Coeff(int t1, int t2)</div><div class="ttdoc">Prefactor of the force. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8cpp_source.html#l00246">VarData.cpp:246</a></div></div>
<div class="ttc" id="classForces_html_aa57796d41906bf35c6a79225ecda6f98"><div class="ttname"><a href="classForces.html#aa57796d41906bf35c6a79225ecda6f98">Forces::ForceFieldBulk</a></div><div class="ttdeci">int ForceFieldBulk()</div><div class="ttdoc">Armonic potential on a lattice. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00187">ForcesForceField.cpp:187</a></div></div>
<div class="ttc" id="classMatematica_html_a9f4d9bbeaf65d0ee820dc906aaee0128"><div class="ttname"><a href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128">Matematica::Spline3End</a></div><div class="ttdeci">SPLINE Spline3End(double *P1, double *P2, int x, int y)</div><div class="ttdoc">Three order spline last boundary. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00052">MatematicaInterp.cpp:52</a></div></div>
<div class="ttc" id="classForces_html_a1f0b019b2a8c81938b8f4a3f3ddcfc48"><div class="ttname"><a href="classForces.html#a1f0b019b2a8c81938b8f4a3f3ddcfc48">Forces::StepPot</a></div><div class="ttdeci">double StepPot(double Dist2, int t1, int t2, double *Pot)</div><div class="ttdoc">Step potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00582">ForcesForceField.cpp:582</a></div></div>
<div class="ttc" id="classForces_html_ac5ef477f97601b779392b8622ac6b1fe"><div class="ttname"><a href="classForces.html#ac5ef477f97601b779392b8622ac6b1fe">Forces::Potential</a></div><div class="ttdeci">double Potential(double Dist, int t1, int t2, double *Pot)</div><div class="ttdoc">Pointer to a potential. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00504">Forces.h:504</a></div></div>
<div class="ttc" id="classForces_html_a5c95469e44bbbea88c38809308ca4551"><div class="ttname"><a href="classForces.html#a5c95469e44bbbea88c38809308ca4551">Forces::Wei3</a></div><div class="ttdeci">double Wei3(const double r, const double a)</div><div class="ttdoc">Cubic weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00718">ForcesForceField.cpp:718</a></div></div>
<div class="ttc" id="classForces_html_a4aa4b64aa78c004e13b7d5e059c61c7f"><div class="ttname"><a href="classForces.html#a4aa4b64aa78c004e13b7d5e059c61c7f">Forces::RigidDistanceRad</a></div><div class="ttdeci">double RigidDistanceRad(int n, int nn, double *dr)</div><div class="ttdoc">Distance between two bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00428">ForcesForceField.cpp:428</a></div></div>
<div class="ttc" id="structNANO_html_adf3d7e8b11ee1fa9f6b7b58141ab5112"><div class="ttname"><a href="structNANO.html#adf3d7e8b11ee1fa9f6b7b58141ab5112">NANO::PotThr</a></div><div class="ttdeci">double PotThr</div><div class="ttdoc">Maximum value of the potential. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00469">VarData.h:469</a></div></div>
<div class="ttc" id="classForces_html_a0390d97ed1665851fb6175342d1c598b"><div class="ttname"><a href="classForces.html#a0390d97ed1665851fb6175342d1c598b">Forces::ClearDens</a></div><div class="ttdeci">void ClearDens()</div><div class="ttdoc">Set the local densities to zero. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00401">ForcesCalcEnergies.cpp:401</a></div></div>
<div class="ttc" id="classForces_html_a0bd8b1fc300bbbf7b4d7a6c5836ff0dc"><div class="ttname"><a href="classForces.html#a0bd8b1fc300bbbf7b4d7a6c5836ff0dc">Forces::RigidDistanceAxis</a></div><div class="ttdeci">double RigidDistanceAxis(int n, int nn, double *dr)</div><div class="ttdoc">Distance between two bodies. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00313">ForcesForceField.cpp:313</a></div></div>
<div class="ttc" id="structKFORCES_html_a014d64316c28b7014a2e8696ea99388f"><div class="ttname"><a href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f">KFORCES::LJ</a></div><div class="ttdeci">double LJ</div><div class="ttdoc">Lennard-Jones. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00155">Forces.h:155</a></div></div>
<div class="ttc" id="structNANO_html_ad597aadcc443ffa959ac837ba5382bff"><div class="ttname"><a href="structNANO.html#ad597aadcc443ffa959ac837ba5382bff">NANO::Force</a></div><div class="ttdeci">double Force[3]</div><div class="ttdoc">Forces. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00433">VarData.h:433</a></div></div>
<div class="ttc" id="classVarData_html_aab4995eedc5bb0d45d86f0e2a5d0e869"><div class="ttname"><a href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869">VarData::Mat</a></div><div class="ttdeci">Matematica * Mat</div><div class="ttdoc">Implementation of all usefull algorythms. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00527">VarData.h:527</a></div></div>
<div class="ttc" id="classVarData_html_a6496acd0cba8289e8306507336dd2f88"><div class="ttname"><a href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">VarData::pNType</a></div><div class="ttdeci">int pNType()</div><div class="ttdoc">of types of the particle</div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00251">VarDataComm.cpp:251</a></div></div>
<div class="ttc" id="classMatematica_html_a0bf66137177a5078071d2da064fa3a72"><div class="ttname"><a href="classMatematica.html#a0bf66137177a5078071d2da064fa3a72">Matematica::Parab</a></div><div class="ttdeci">SPLINE Parab(double *P1, double *P2, double *P3, int x, int y)</div><div class="ttdoc">Three points parabolic interpolation. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00178">MatematicaInterp.cpp:178</a></div></div>
<div class="ttc" id="structNANO_html_ad1bdf13b47e2dca8f97d3807e3adf840"><div class="ttname"><a href="structNANO.html#ad1bdf13b47e2dca8f97d3807e3adf840">NANO::AMom</a></div><div class="ttdeci">double AMom[3]</div><div class="ttdoc">Angular momentum. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00437">VarData.h:437</a></div></div>
<div class="ttc" id="classVarData_html_ab70211c3dc01d352727d2052b2c555c5"><div class="ttname"><a href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">VarData::pPos</a></div><div class="ttdeci">double pPos(int p, int d)</div><div class="ttdoc">Return back folded position. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00192">VarDataComm.cpp:192</a></div></div>
<div class="ttc" id="structNANO_html_af2411aba2dd63fa22b1bc279653ff7a0"><div class="ttname"><a href="structNANO.html#af2411aba2dd63fa22b1bc279653ff7a0">NANO::CutOff</a></div><div class="ttdeci">double CutOff</div><div class="ttdoc">Cut off of the potential. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00459">VarData.h:459</a></div></div>
<div class="ttc" id="classVarData_html_a495c5b182109864eb1db337d49a53999"><div class="ttname"><a href="classVarData.html#a495c5b182109864eb1db337d49a53999">VarData::pTemp</a></div><div class="ttdeci">double pTemp()</div><div class="ttdoc">Temperature. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00912">VarData.h:912</a></div></div>
<div class="ttc" id="classForces_html_a3d44e49e6ced82a300d6071060b72c48"><div class="ttname"><a href="classForces.html#a3d44e49e6ced82a300d6071060b72c48">Forces::DerWei3</a></div><div class="ttdeci">double DerWei3(const double r, const double a)</div><div class="ttdoc">Derivative of the cubic weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00722">ForcesForceField.cpp:722</a></div></div>
<div class="ttc" id="classVarData_html_a9f6d9339cabdd81a05bf272c116ceea2"><div class="ttname"><a href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">VarData::pNChain</a></div><div class="ttdeci">int pNChain()</div><div class="ttdoc">Number of chain. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00247">VarDataComm.cpp:247</a></div></div>
<div class="ttc" id="structNANO_html_a062cb4da9ccaf4fe931d0262f827c8c3"><div class="ttname"><a href="structNANO.html#a062cb4da9ccaf4fe931d0262f827c8c3">NANO::AMomTemp</a></div><div class="ttdeci">double AMomTemp[3]</div><div class="ttdoc">Temporal angular momentum. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l00439">VarData.h:439</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a63c5d18d3a487d1a8ab2a5881c6acb38"><div class="ttname"><a href="classDdLinkedList.html#a63c5d18d3a487d1a8ab2a5881c6acb38">DdLinkedList::IfCurr</a></div><div class="ttdeci">int IfCurr()</div><div class="ttdoc">Tell when the curr loop is over. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00498">Cubo.cpp:498</a></div></div>
<div class="ttc" id="structFORCES_html_a034ef504c45f9a730ddb6053df710a38"><div class="ttname"><a href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38">FORCES::Ext</a></div><div class="ttdeci">double Ext[3]</div><div class="ttdoc">External. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00182">Forces.h:182</a></div></div>
<div class="ttc" id="structKFORCES_html_a3a05bdc0a320e2408242a0f5152debca"><div class="ttname"><a href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca">KFORCES::Elong</a></div><div class="ttdeci">double Elong[3]</div><div class="ttdoc">Elongation of the springs. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00159">Forces.h:159</a></div></div>
<div class="ttc" id="classMatematica_html_a69f1211856d5b0cd58178a21156d0492"><div class="ttname"><a href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492">Matematica::Spline3</a></div><div class="ttdeci">SPLINE Spline3(double *P1, double *P2, double *P3, int x, int y)</div><div class="ttdoc">Three order spline. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00034">MatematicaInterp.cpp:34</a></div></div>
<div class="ttc" id="structSPLINE_html"><div class="ttname"><a href="structSPLINE.html">SPLINE</a></div><div class="ttdoc">Coefficient of a spline. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaStruct_8h_source.html#l00104">MatematicaStruct.h:104</a></div></div>
<div class="ttc" id="structKFORCES_html_ac448df5dbfd256324893075200dace49"><div class="ttname"><a href="structKFORCES.html#ac448df5dbfd256324893075200dace49">KFORCES::CutOff2</a></div><div class="ttdeci">double CutOff2</div><div class="ttdoc">CutOff of the lennard jones. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00165">Forces.h:165</a></div></div>
<div class="ttc" id="classMatematica_html_a7eb694853e69b9cbd2020788e9665424"><div class="ttname"><a href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">Matematica::Forth</a></div><div class="ttdeci">SPLINE Forth(double *PA, double *PB, double *PC, double *PD, double *PE, int x, int y)</div><div class="ttdoc">Five points four order interpolation. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00262">MatematicaInterp.cpp:262</a></div></div>
<div class="ttc" id="classDomDecBasics_html_a28d65a777a97b96280ca0f9173c76c93"><div class="ttname"><a href="classDomDecBasics.html#a28d65a777a97b96280ca0f9173c76c93">DomDecBasics::p2Curr</a></div><div class="ttdeci">int p2Curr</div><div class="ttdoc">Current particle. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8h_source.html#l00051">Cubo.h:51</a></div></div>
<div class="ttc" id="classMatematica_html_acc21ee420953fcc9d0587f56324631cb"><div class="ttname"><a href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb">Matematica::Cubica</a></div><div class="ttdeci">SPLINE Cubica(double *PA, double *PB, double *PC, double *PD, int x, int y)</div><div class="ttdoc">Four point cubic interpolation. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaInterp_8cpp_source.html#l00239">MatematicaInterp.cpp:239</a></div></div>
<div class="ttc" id="classForces_html_a0449e9410bf23ad4d073f1eab66c2a68"><div class="ttname"><a href="classForces.html#a0449e9410bf23ad4d073f1eab66c2a68">Forces::SumDens</a></div><div class="ttdeci">double SumDens(int pInit, int pEnd)</div><div class="ttdoc">Sum the local density for the particles between pInit and pEnd and multiply the factors by the virial...</div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00243">ForcesCalcEnergies.cpp:243</a></div></div>
<div class="ttc" id="structKFORCES_html_a12346a80b6dd9472f0a10aab633f2f4f"><div class="ttname"><a href="structKFORCES.html#a12346a80b6dd9472f0a10aab633f2f4f">KFORCES::BaseLine</a></div><div class="ttdeci">double BaseLine</div><div class="ttdoc">Baseline of the potential. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00167">Forces.h:167</a></div></div>
<div class="ttc" id="classVarData_html_a53eee20378b4a2c61407897d98a4b5d7"><div class="ttname"><a href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7">VarData::Pm</a></div><div class="ttdeci">PART * Pm</div><div class="ttdoc">Particle information of all particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarData_8h_source.html#l01046">VarData.h:1046</a></div></div>
<div class="ttc" id="classForces_html_abd9350bc451b7ae5507675805b4318d5"><div class="ttname"><a href="classForces.html#abd9350bc451b7ae5507675805b4318d5">Forces::RigidHamaker</a></div><div class="ttdeci">double RigidHamaker(int n, double Dist, double *Pot, double Sign)</div><div class="ttdoc">Hamaker potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00458">ForcesForceField.cpp:458</a></div></div>
<div class="ttc" id="classForces_html_a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b"><div class="ttname"><a href="classForces.html#a9d4e2ba1cf8ce2142f50a1b7e8bf4f7b">Forces::AddDens</a></div><div class="ttdeci">int AddDens(int pInit, int pEnd)</div><div class="ttdoc">Add the densities connected with the particles between pInit and pEnd. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesCalcEnergies_8cpp_source.html#l00218">ForcesCalcEnergies.cpp:218</a></div></div>
<div class="ttc" id="classForces_html_a28fd299b40762b1703462b830df2473d"><div class="ttname"><a href="classForces.html#a28fd299b40762b1703462b830df2473d">Forces::LJ39</a></div><div class="ttdeci">double LJ39(double Dist2, int t1, int t2, double *Pot)</div><div class="ttdoc">Integrated Lennard Jones potential. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00551">ForcesForceField.cpp:551</a></div></div>
<div class="ttc" id="classDdLinkedList_html_a74b7b0d716684a7d46993c83795fd9e7"><div class="ttname"><a href="classDdLinkedList.html#a74b7b0d716684a7d46993c83795fd9e7">DdLinkedList::SetCurr</a></div><div class="ttdeci">void SetCurr(int p)</div><div class="ttdoc">Gather information of the neighbouring cells. </div><div class="ttdef"><b>Definition:</b> <a href="Cubo_8cpp_source.html#l00453">Cubo.cpp:453</a></div></div>
<div class="ttc" id="classForces_html_a2a275bbffe53c778eb8d535f3dc601f8"><div class="ttname"><a href="classForces.html#a2a275bbffe53c778eb8d535f3dc601f8">Forces::Wei2</a></div><div class="ttdeci">double Wei2(const double r, const double b)</div><div class="ttdoc">Quadratic weighting function. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00726">ForcesForceField.cpp:726</a></div></div>
<div class="ttc" id="classForces_html_a5d8052dd63b08f01b581aeffa8506051"><div class="ttname"><a href="classForces.html#a5d8052dd63b08f01b581aeffa8506051">Forces::Pc</a></div><div class="ttdeci">DomDec * Pc</div><div class="ttdoc">Pair list. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00785">Forces.h:785</a></div></div>
<div class="ttc" id="structKFORCES_html_a348745786658bd8382be1fd25066a309"><div class="ttname"><a href="structKFORCES.html#a348745786658bd8382be1fd25066a309">KFORCES::SLap</a></div><div class="ttdeci">double SLap</div><div class="ttdoc">Prefactor of the square laplacian. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00149">Forces.h:149</a></div></div>
<div class="ttc" id="classForces_html_ae1187ff72e7ad2765b17948df1aff2b4"><div class="ttname"><a href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4">Forces::DefNanoForceParam</a></div><div class="ttdeci">void DefNanoForceParam()</div><div class="ttdoc">Define the parameters for calculating the force. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00405">ForcesForceField.cpp:405</a></div></div>
<div class="ttc" id="structKFORCES_html_ad631a0b43047f95f5bb991f5407b813e"><div class="ttname"><a href="structKFORCES.html#ad631a0b43047f95f5bb991f5407b813e">KFORCES::ForThr</a></div><div class="ttdeci">double ForThr</div><div class="ttdoc">Maximum force allowed. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00171">Forces.h:171</a></div></div>
<div class="ttc" id="classForces_html_a9a870e91a0fb8ba626adc4c77b532c9c"><div class="ttname"><a href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c">Forces::Bead2Move</a></div><div class="ttdeci">int Bead2Move</div><div class="ttdoc">Bead to move. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00737">Forces.h:737</a></div></div>
<div class="ttc" id="classForces_html_afca243db3841bf482910199bdb22e5f3"><div class="ttname"><a href="classForces.html#afca243db3841bf482910199bdb22e5f3">Forces::Fm</a></div><div class="ttdeci">FORCES * Fm</div><div class="ttdoc">Array containing the forces for each particle. </div><div class="ttdef"><b>Definition:</b> <a href="Forces_8h_source.html#l00781">Forces.h:781</a></div></div>
<div class="ttc" id="classVettore_html_ad289412e19e3a03ef86d329311712cff"><div class="ttname"><a href="classVettore.html#ad289412e19e3a03ef86d329311712cff">Vettore::PerpTo</a></div><div class="ttdeci">void PerpTo(Vettore *o)</div><div class="ttdoc">The vector perpendicolar. </div><div class="ttdef"><b>Definition:</b> <a href="MatematicaVect_8cpp_source.html#l00380">MatematicaVect.cpp:380</a></div></div>
<div class="ttc" id="classVarData_html_a388622b5e7d2ad20e8ac1a8a951d655f"><div class="ttname"><a href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">VarData::pNPart</a></div><div class="ttdeci">int pNPart()</div><div class="ttdoc">Number of particle. </div><div class="ttdef"><b>Definition:</b> <a href="VarDataComm_8cpp_source.html#l00246">VarDataComm.cpp:246</a></div></div>
<div class="ttc" id="classForces_html_ad7e01b1bd04ce252d991ae872eaa5270"><div class="ttname"><a href="classForces.html#ad7e01b1bd04ce252d991ae872eaa5270">Forces::DefForceParam</a></div><div class="ttdeci">void DefForceParam()</div><div class="ttdoc">Define the parameters for calculating the force. </div><div class="ttdef"><b>Definition:</b> <a href="ForcesForceField_8cpp_source.html#l00388">ForcesForceField.cpp:388</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
