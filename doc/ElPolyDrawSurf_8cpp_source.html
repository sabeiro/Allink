<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/ElPoly/ElPolyDrawSurf.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_1bb97581e94de66daf7acda7f0e3ec00.html">ElPoly</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ElPolyDrawSurf.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">* ElPolyDrawSurf - Drawing of the surfaces defined by the chain position</span>
<a name="l00003"></a>00003 <span class="comment"> opyright (C) 2008-2010 by Giovanni Marelli &lt;sabeiro@virgilio.it&gt;</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment"> This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"> the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00009"></a>00009 <span class="comment"> (at your option) any later version.</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment"> This program is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"> but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"> GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment"> You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> along with this program; If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00018"></a>00018 <span class="comment">***********************************************************************/</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;ElPoly.h&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;vector&gt;</span> 
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="classDraw.html" title="Draw provides the basic configuration of the openGL libraries used in every derived program...">Draw</a> *Dr;
<a name="l00024"></a><a class="code" href="classElPoly.html#a214894e61823ee214875334b23fa69c2">00024</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a214894e61823ee214875334b23fa69c2" title="Every particle is traeted as a vertex.">ElPoly::DrPolygon</a>(){
<a name="l00025"></a>00025   glEnable(GL_LIGHTING);
<a name="l00026"></a>00026   glEnable( GL_LIGHT0 );
<a name="l00027"></a>00027   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00028"></a>00028   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00029"></a>00029   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00030"></a>00030   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++) <a class="code" href="classElPoly.html#a15254dc837a01412ec79ec26e9019095" title="Pointer to a generic function.">DrawNano</a>(n);
<a name="l00031"></a>00031   <span class="keywordtype">double</span> Cm[3];
<a name="l00032"></a>00032   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p+=<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>+1){
<a name="l00033"></a>00033     <span class="comment">//if(Pm[p].Pos[2] &gt; .6*pEdge(2) || Pm[p].Pos[2] &lt; .3*pEdge(2)) continue;</span>
<a name="l00034"></a>00034     <span class="keywordtype">double</span> Red = 0.0;
<a name="l00035"></a>00035     <span class="keywordtype">double</span> Green = .4 + .3*<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970" title="Random uniform number.">Casuale</a>();
<a name="l00036"></a>00036     <span class="keywordtype">double</span> Blue  = 0.0;
<a name="l00037"></a>00037     GLfloat DrMatColor [] = {Red,Green,Blue,1.};
<a name="l00038"></a>00038     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,DrMatColor); 
<a name="l00039"></a>00039     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,DrMatColor); 
<a name="l00040"></a>00040     glColor4f(Red,Green,Blue,1.);
<a name="l00041"></a>00041     glPushMatrix();
<a name="l00042"></a>00042     glBegin(GL_POLYGON);
<a name="l00043"></a>00043     <span class="comment">//glBegin(GL_TRIANGLE);</span>
<a name="l00044"></a>00044     <span class="comment">//glBegin(GL_TRIANGLE_STRIP);</span>
<a name="l00045"></a>00045     glNormal3d(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00046"></a>00046     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00047"></a>00047     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) Cm[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d);
<a name="l00048"></a>00048     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>;l++){
<a name="l00049"></a>00049       <span class="keywordtype">int</span> l1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[l];
<a name="l00050"></a>00050       glNormal3d(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(l1,0),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(l1,1),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(l1,2));
<a name="l00051"></a>00051       glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*ScaleFact);
<a name="l00052"></a>00052       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00053"></a>00053    Cm[d] += <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d);
<a name="l00054"></a>00054       }
<a name="l00055"></a>00055     }
<a name="l00056"></a>00056     glEnd();
<a name="l00057"></a>00057     glPopMatrix();
<a name="l00058"></a>00058     <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a>){
<a name="l00059"></a>00059       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00060"></a>00060    Cm[d] /= (double)(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].NLink+1);
<a name="l00061"></a>00061       }
<a name="l00062"></a>00062       glColor4f(.1,.3,1.,1.);
<a name="l00063"></a>00063       glBegin(GL_LINES);
<a name="l00064"></a>00064       glNormal3d(0.,0.,1.);
<a name="l00065"></a>00065       glVertex3d(Cm[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,Cm[1]*InvScaleUn,Cm[2]*InvScaleUn*ScaleFact);
<a name="l00066"></a>00066       glVertex3d((Cm[0]-<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0))*InvScaleUn,(Cm[1]-<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1))*InvScaleUn,(Cm[2]-<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2))*InvScaleUn*ScaleFact);
<a name="l00067"></a>00067       glEnd();
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069   }
<a name="l00070"></a>00070   glEndList();
<a name="l00071"></a>00071 }
<a name="l00072"></a><a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc">00072</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc" title="Draw the normal to a point.">ElPoly::DrNormalPoint</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> NEdge){
<a name="l00073"></a>00073   <span class="keywordtype">int</span> link[4];
<a name="l00074"></a>00074   link[0] = p + <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00075"></a>00075   <span class="keywordflow">if</span>(link[0] &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()) link[0] -= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00076"></a>00076   link[1] = p + 1;
<a name="l00077"></a>00077   <span class="keywordflow">if</span>(link[1] &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()) link[1] -= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00078"></a>00078   link[2] = p - <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00079"></a>00079   <span class="keywordflow">if</span>(link[2] &lt; 0 ) link[2] += <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00080"></a>00080   link[3] = p - 1;
<a name="l00081"></a>00081   <span class="keywordflow">if</span>(link[3] &lt; 0 ) link[3] += <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00082"></a>00082   <span class="keywordtype">double</span> Normals[5][3];
<a name="l00083"></a>00083   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;4;l++){
<a name="l00084"></a>00084     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00085"></a>00085       <span class="keywordtype">int</span> d1 = (d+1)%3;
<a name="l00086"></a>00086       <span class="keywordtype">int</span> d2 = (d+2)%3;
<a name="l00087"></a>00087       Normals[l][d] = (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d1)-<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link[l],d2))*(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d2)-<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link[l],d));
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089   }
<a name="l00090"></a>00090   <span class="keywordtype">double</span> Norm;
<a name="l00091"></a>00091   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00092"></a>00092     Normals[4][d] = Normals[0][d] + Normals[1][d] + Normals[2][d] + Normals[3][d];
<a name="l00093"></a>00093     Norm += SQR(Normals[4][d]);
<a name="l00094"></a>00094   }
<a name="l00095"></a>00095   Norm = 1./sqrt(Norm);
<a name="l00096"></a>00096   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00097"></a>00097     Normals[4][d] /= Norm;
<a name="l00098"></a>00098   }
<a name="l00099"></a>00099   glNormal3d(Normals[4][0],Normals[4][1],Normals[4][2]);
<a name="l00100"></a>00100 }
<a name="l00101"></a><a class="code" href="classElPoly.html#a7ee6e038b2bc5f4d9440118b807e115e">00101</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a7ee6e038b2bc5f4d9440118b807e115e" title="Draw the polygons for a square mesh.">ElPoly::DrSquareMesh</a>(){
<a name="l00102"></a>00102   <span class="keywordflow">if</span>(Dr-&gt;<a class="code" href="classDraw.html#a2e742183addcbbee8c3d478448355b43" title="Activate the illumination for a specific material.">IfMaterial</a>){
<a name="l00103"></a>00103     glEnable(GL_LIGHTING);
<a name="l00104"></a>00104     glEnable( GL_LIGHT0 );
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106   <span class="keywordflow">else</span> 
<a name="l00107"></a>00107     glDisable(GL_LIGHTING);
<a name="l00108"></a>00108   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00109"></a>00109   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00110"></a>00110   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00111"></a>00111   <span class="keywordtype">int</span> <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a> = (int)sqrt(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>());
<a name="l00112"></a>00112   <span class="keywordflow">if</span>(NEdge*NEdge != <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()) NEdge += 1;
<a name="l00113"></a>00113   GLfloat Color[4];
<a name="l00114"></a>00114   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00115"></a>00115     <span class="keywordtype">double</span> Depth = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>+<a class="code" href="classElPoly.html#a669c83da48812050d13a2c63fff0fef9" title="External parameter (e.g. for MarchingCubes)">ExtParam</a>;
<a name="l00116"></a>00116     Dr-&gt;<a class="code" href="classDraw.html#ab3d9c36aceb9e5f4b158eb15b47c2003" title="Pointer to a generic function.">DepthMap</a>(Depth,Color);
<a name="l00117"></a>00117     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color); 
<a name="l00118"></a>00118     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color); 
<a name="l00119"></a>00119     glColor4fv(Color);
<a name="l00120"></a>00120     <span class="keywordtype">int</span> l1 = p+1;
<a name="l00121"></a>00121     <span class="keywordflow">if</span>((l1%NEdge) == 0)<span class="keywordflow">continue</span>;
<a name="l00122"></a>00122     <span class="keywordtype">int</span> l2 = p + NEdge + 1;
<a name="l00123"></a>00123     <span class="keywordflow">if</span>(l2 &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1)<span class="keywordflow">continue</span>;
<a name="l00124"></a>00124     <span class="keywordtype">int</span> l3 = p + <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00125"></a>00125     <span class="keywordflow">if</span>(l3 &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1)<span class="keywordflow">continue</span>;
<a name="l00126"></a>00126     <span class="comment">//glPushMatrix();</span>
<a name="l00127"></a>00127     glBegin(GL_POLYGON);
<a name="l00128"></a>00128     <a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc" title="Draw the normal to a point.">DrNormalPoint</a>(p,NEdge);
<a name="l00129"></a>00129     glVertex3d(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[1]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00130"></a>00130     <a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc" title="Draw the normal to a point.">DrNormalPoint</a>(l1,NEdge);
<a name="l00131"></a>00131     glVertex3d(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l1].Pos[0]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l1].Pos[1]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l1].Pos[2]*InvScaleUn*ScaleFact);
<a name="l00132"></a>00132     <a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc" title="Draw the normal to a point.">DrNormalPoint</a>(l2,NEdge);
<a name="l00133"></a>00133     glVertex3d(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l2].Pos[0]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l2].Pos[1]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l2].Pos[2]*InvScaleUn*ScaleFact);
<a name="l00134"></a>00134     <a class="code" href="classElPoly.html#a6caa02ea64327736aab6533720461acc" title="Draw the normal to a point.">DrNormalPoint</a>(l3,NEdge);
<a name="l00135"></a>00135     glVertex3d(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l3].Pos[0]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l3].Pos[1]*InvScaleUn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[l3].Pos[2]*InvScaleUn*ScaleFact);
<a name="l00136"></a>00136     glEnd();
<a name="l00137"></a>00137     <span class="comment">//glPopMatrix();</span>
<a name="l00138"></a>00138   }
<a name="l00139"></a>00139   glEndList();
<a name="l00140"></a>00140   glDisable(GL_LIGHTING);
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 <span class="preprocessor">#include &quot;ElPolyDrawSurf.h&quot;</span>
<a name="l00143"></a><a class="code" href="classElPoly.html#ae5093f79e99758c116e6957ce8bd5bce">00143</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">ElPoly::DrField</a>(<span class="keywordtype">int</span> NGrid,<span class="keywordtype">double</span> IsoLevel,<span class="keywordtype">int</span> nNano){
<a name="l00144"></a>00144   glEnable(GL_LIGHTING);
<a name="l00145"></a>00145   glEnable( GL_LIGHT0 );
<a name="l00146"></a>00146   glMaterialfv(GL_BACK,  GL_AMBIENT,   DrAmbientRed); 
<a name="l00147"></a>00147   glMaterialfv(GL_BACK,  GL_DIFFUSE,   DrDiffuseRed); 
<a name="l00148"></a>00148   glMaterialfv(GL_FRONT, GL_AMBIENT,   DrAmbientBlue); 
<a name="l00149"></a>00149   glMaterialfv(GL_FRONT, GL_DIFFUSE,   DrDiffuseBlue); 
<a name="l00150"></a>00150   glMaterialfv(GL_FRONT, GL_SPECULAR,  DrSpecularWhite); 
<a name="l00151"></a>00151   glMaterialf( GL_FRONT, GL_SHININESS, 25.0); 
<a name="l00152"></a>00152   <span class="keywordtype">double</span> CubeDist[8];
<a name="l00153"></a>00153   <span class="keywordtype">double</span> EdgeVertex[12][3];
<a name="l00154"></a>00154   <span class="keywordtype">double</span> EdgeNormal[12][3];
<a name="l00155"></a>00155   <span class="keywordtype">double</span> InvNGrid = 1./(double)NGrid;
<a name="l00156"></a>00156   <span class="keywordtype">double</span> Pos[3];
<a name="l00157"></a>00157   <span class="keywordtype">double</span> Pos1[3];
<a name="l00158"></a>00158   glBegin(GL_TRIANGLES);
<a name="l00159"></a>00159   <span class="comment">//glBegin(GL_LINES);</span>
<a name="l00160"></a>00160   <span class="comment">//glBegin(GL_POINTS);</span>
<a name="l00161"></a>00161   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gx=0;gx&lt;NGrid;gx++){
<a name="l00162"></a>00162     Pos[0] = gx*InvNGrid*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0);
<a name="l00163"></a>00163     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gy=0;gy&lt;NGrid;gy++){
<a name="l00164"></a>00164       Pos[1] = gy*InvNGrid*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l00165"></a>00165       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gz=0;gz&lt;NGrid;gz++){
<a name="l00166"></a>00166    Pos[2] = gz*InvNGrid*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00167"></a>00167    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;8;v++){
<a name="l00168"></a>00168      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00169"></a>00169        Pos1[d] = Pos[d] + VertCube[v][d]*InvNGrid*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00170"></a>00170      }
<a name="l00171"></a>00171      CubeDist[v] = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos1,nNano);
<a name="l00172"></a>00172    }
<a name="l00173"></a>00173    <span class="keywordtype">int</span> Flag = 0;
<a name="l00174"></a>00174    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;8;v++){
<a name="l00175"></a>00175      <span class="keywordflow">if</span>(CubeDist[v] &lt;= IsoLevel)
<a name="l00176"></a>00176        Flag |= 1&lt;&lt;v;
<a name="l00177"></a>00177    }
<a name="l00178"></a>00178    <span class="keywordtype">int</span> CubeShape = CubeTop[Flag];
<a name="l00179"></a>00179    <span class="keywordflow">if</span>(CubeShape==0) <span class="keywordflow">continue</span>;
<a name="l00180"></a>00180    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0;e&lt;12;e++){
<a name="l00181"></a>00181      <span class="keywordflow">if</span>(CubeShape &amp; (1&lt;&lt;e)){
<a name="l00182"></a>00182        <span class="keywordtype">double</span> Delta = CubeDist[EdgeConn[e][1]] - CubeDist[EdgeConn[e][0]];
<a name="l00183"></a>00183        <span class="keywordtype">double</span> OffSet = (IsoLevel-CubeDist[EdgeConn[e][0]])/Delta;
<a name="l00184"></a>00184        <span class="keywordflow">if</span>(Delta == 0.0){
<a name="l00185"></a>00185          OffSet = .5;
<a name="l00186"></a>00186        }
<a name="l00187"></a>00187        EdgeNormal[e][0] = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0]-0.01,Pos[1],Pos[2],nNano) 
<a name="l00188"></a>00188          - <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0]+0.01,Pos[1],Pos[2],nNano);
<a name="l00189"></a>00189        EdgeNormal[e][1] = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0],Pos[1]-0.01,Pos[2],nNano) 
<a name="l00190"></a>00190          - <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0],Pos[1]+0.01,Pos[2],nNano);
<a name="l00191"></a>00191        EdgeNormal[e][2] = <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0],Pos[1],Pos[2]-0.01,nNano) 
<a name="l00192"></a>00192          - <a class="code" href="classVarData.html#a1dd0baef0ade6f5abcacba0d814f40d8" title="Pointer to a generic function.">NanoDist2</a>(Pos[0],Pos[1],Pos[2]+0.01,nNano);
<a name="l00193"></a>00193        <span class="keywordtype">double</span> Norm = sqrt(SQR(EdgeNormal[e][0])+SQR(EdgeNormal[e][1])+SQR(EdgeNormal[e][2]));
<a name="l00194"></a>00194        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00195"></a>00195          EdgeVertex[e][d] = Pos[d] + (VertCube[EdgeConn[e][0]][d]+OffSet*EdgeDir[e][d])*InvNGrid*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00196"></a>00196          EdgeVertex[e][d] *= <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00197"></a>00197          EdgeNormal[e][d] *= 1./Norm;
<a name="l00198"></a>00198        }
<a name="l00199"></a>00199      }
<a name="l00200"></a>00200    }
<a name="l00201"></a>00201    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;5;t++){
<a name="l00202"></a>00202      <span class="keywordflow">if</span>(TrConnTable[Flag][3*t] &lt; 0.) <span class="keywordflow">break</span>;
<a name="l00203"></a>00203      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00204"></a>00204        <span class="keywordtype">int</span> v = TrConnTable[Flag][3*t+d];
<a name="l00205"></a>00205        <span class="comment">//glColor4f(1.0,0.1,0.1,1.0);</span>
<a name="l00206"></a>00206        glNormal3d(EdgeNormal[v][0],EdgeNormal[v][1],EdgeNormal[v][2]);
<a name="l00207"></a>00207        glVertex3d(EdgeVertex[v][0],EdgeVertex[v][1],EdgeVertex[v][2]);
<a name="l00208"></a>00208      }
<a name="l00209"></a>00209    }
<a name="l00210"></a>00210       }
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213   glEnd();
<a name="l00214"></a>00214 }
<a name="l00215"></a><a class="code" href="classElPoly.html#a725549fe7e1a9fbb5e6710bfc17ce007">00215</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a725549fe7e1a9fbb5e6710bfc17ce007" title="Intensity scheme.">ElPoly::DrQuad1</a>(){
<a name="l00216"></a>00216   glEnable(GL_LIGHTING);
<a name="l00217"></a>00217   glEnable( GL_LIGHT0 );
<a name="l00218"></a>00218   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00219"></a>00219   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00220"></a>00220   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00221"></a>00221   <span class="comment">//glEnable(GL_POLYGON_STIPPLE);</span>
<a name="l00222"></a>00222   <span class="keywordtype">double</span> RedMax = fabs(log(fabs(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(0,0))*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>));
<a name="l00223"></a>00223   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00224"></a>00224     <span class="keywordflow">if</span>(RedMax &lt;  fabs(log(fabs(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(0,0))*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>)) )
<a name="l00225"></a>00225       RedMax  =  fabs(log(fabs(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(0,0))*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>));
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227   <span class="keywordtype">int</span> NDraw = 0;
<a name="l00228"></a>00228   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00229"></a>00229     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2) &lt; .7*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)) <span class="keywordflow">continue</span>;
<a name="l00230"></a>00230     <span class="comment">//double Red = fabs(log(fabs(pPos(p,0))*Sat))/RedMax;</span>
<a name="l00231"></a>00231     <span class="keywordtype">double</span> Red = fabs(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(0));
<a name="l00232"></a>00232     <span class="keywordtype">double</span> Green = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(1)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00233"></a>00233     <span class="keywordtype">double</span> Blue  = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(2)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00234"></a>00234     GLfloat DrMatColor [] = {Red,Green,Blue,1.};
<a name="l00235"></a>00235     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,DrMatColor); 
<a name="l00236"></a>00236     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,DrMatColor); 
<a name="l00237"></a>00237     <span class="comment">//if(Red&lt;0.1) continue;</span>
<a name="l00238"></a>00238     glColor4f(Red,Green,Blue,1.);
<a name="l00239"></a>00239     glPushMatrix();
<a name="l00240"></a>00240     glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00241"></a>00241     glCallList(Quad);
<a name="l00242"></a>00242     glPopMatrix();
<a name="l00243"></a>00243     NDraw++;
<a name="l00244"></a>00244   }
<a name="l00245"></a>00245   printf(<span class="stringliteral">&quot;%d\n&quot;</span>,NDraw);
<a name="l00246"></a>00246   glEndList();
<a name="l00247"></a>00247 }
<a name="l00248"></a><a class="code" href="classElPoly.html#a626c51b506cf13c725c26652f9a25926">00248</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a626c51b506cf13c725c26652f9a25926" title="Call a square in every particle position.">ElPoly::DrQuad</a>(){
<a name="l00249"></a>00249   glEnable(GL_LIGHTING);
<a name="l00250"></a>00250   glEnable( GL_LIGHT0 );
<a name="l00251"></a>00251   <span class="comment">//CompileList();</span>
<a name="l00252"></a>00252   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00253"></a>00253   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00254"></a>00254   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00255"></a>00255   <span class="keywordtype">int</span> Incr = 1;<span class="comment">//4;</span>
<a name="l00256"></a>00256   <span class="keywordtype">double</span> Offset = 1./(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00257"></a>00257   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p+=Incr){
<a name="l00258"></a>00258     <span class="keywordtype">double</span> Red = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;<span class="comment">// + pPos(p,2)*Sat;</span>
<a name="l00259"></a>00259     <span class="keywordtype">double</span> Green = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00260"></a>00260     <span class="keywordtype">double</span> Blue = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00261"></a>00261     GLfloat DrMatColor [] = {Red,Green,Blue,1.};
<a name="l00262"></a>00262     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,DrMatColor); 
<a name="l00263"></a>00263     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,DrMatColor); 
<a name="l00264"></a>00264     <span class="comment">//if(Red &lt; 0.0001  &amp;&amp; Green &lt; 0.2 &amp;&amp; Blue &lt; 0.2) continue;</span>
<a name="l00265"></a>00265     glColor4f(Red,Green,Blue,1.0);
<a name="l00266"></a>00266     glPushMatrix();
<a name="l00267"></a>00267     glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,0.);
<a name="l00268"></a>00268     glCallList(Quad);
<a name="l00269"></a>00269     glPopMatrix();
<a name="l00270"></a>00270     <span class="comment">// glPushMatrix();</span>
<a name="l00271"></a>00271     <span class="comment">// glTranslated(-pPos(p,0)*InvScaleUn-Offset,pPos(p,1)*InvScaleUn,0.);</span>
<a name="l00272"></a>00272     <span class="comment">// glCallList(Quad);</span>
<a name="l00273"></a>00273     <span class="comment">// glPopMatrix();</span>
<a name="l00274"></a>00274   }
<a name="l00275"></a>00275   glEndList();<span class="keywordflow">return</span>;
<a name="l00276"></a>00276 }
<a name="l00277"></a><a class="code" href="classElPoly.html#ab1a8c31a875c7270e5e4ed06aa0490f8">00277</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ab1a8c31a875c7270e5e4ed06aa0490f8" title="Potential function.">ElPoly::DrPotential</a>(){
<a name="l00278"></a>00278   glEnable(GL_LIGHTING);
<a name="l00279"></a>00279   glEnable( GL_LIGHT0 );
<a name="l00280"></a>00280   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00281"></a>00281   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00282"></a>00282   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00283"></a>00283   <span class="keywordtype">int</span> Nx = 0;
<a name="l00284"></a>00284   <span class="keywordtype">int</span> Ny = 0;
<a name="l00285"></a>00285   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00286"></a>00286     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>) &lt; <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p+1,<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>))
<a name="l00287"></a>00287       Ny++;
<a name="l00288"></a>00288     <span class="keywordflow">else</span> <span class="keywordflow">break</span>;
<a name="l00289"></a>00289   }
<a name="l00290"></a>00290   Ny++;
<a name="l00291"></a>00291   Nx = (int)(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/(double)Ny);
<a name="l00292"></a>00292   <span class="keyword">const</span> <span class="keywordtype">int</span> NIso = 20;
<a name="l00293"></a>00293   <span class="keywordtype">double</span> Min = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(0,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>);
<a name="l00294"></a>00294   <span class="keywordtype">double</span> Max = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(0,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>);
<a name="l00295"></a>00295   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00296"></a>00296     <span class="keywordflow">if</span>(Min &gt; <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)) Min = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>);
<a name="l00297"></a>00297     <span class="keywordflow">if</span>(Max &lt; <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)) Max = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>);
<a name="l00298"></a>00298   }
<a name="l00299"></a>00299   Min = 1./MIN(fabs(Min),1.);
<a name="l00300"></a>00300   Max = 1./MIN(1.,Max);
<a name="l00301"></a>00301   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00302"></a>00302     <span class="keywordtype">int</span> l1 = p+1;
<a name="l00303"></a>00303     <span class="keywordflow">if</span>( !(l1%Ny) ) <span class="keywordflow">continue</span>;
<a name="l00304"></a>00304     <span class="keywordtype">int</span> l2 = p + Ny;
<a name="l00305"></a>00305     <span class="keywordflow">if</span>(l2 &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>() - 1) <span class="keywordflow">continue</span>;
<a name="l00306"></a>00306     <span class="keywordtype">int</span> l3 = p + Ny + 1;
<a name="l00307"></a>00307     <span class="keywordtype">double</span> Red = 1.;
<a name="l00308"></a>00308     <span class="keywordtype">double</span> Blue = 1.;
<a name="l00309"></a>00309     <span class="keywordtype">double</span> Green = 1.;
<a name="l00310"></a>00310     <span class="keywordtype">double</span> Alpha = 1.;
<a name="l00311"></a>00311     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>) &lt; 0.){
<a name="l00312"></a>00312       Red = 0.;
<a name="l00313"></a>00313       Green = fabs(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)*Min)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00314"></a>00314       <span class="comment">//Green = fabs(pPos(p,2)*1.)*Sat;</span>
<a name="l00315"></a>00315       Blue = 0.;
<a name="l00316"></a>00316       Alpha = MAX(Green-.2,0.);
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>) &gt; 0.){
<a name="l00319"></a>00319       Red = 0.;
<a name="l00320"></a>00320       Green = 0.;
<a name="l00321"></a>00321       Blue = (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>))*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00322"></a>00322       <span class="comment">//Blue = pPos(p,2)*1.*Sat;</span>
<a name="l00323"></a>00323       Alpha = MAX(Blue,0.);
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325     <span class="keywordflow">else</span>
<a name="l00326"></a>00326       Alpha = 0.;
<a name="l00327"></a>00327     GLfloat DrMatColor [] = {Red,Green,Blue,Alpha};
<a name="l00328"></a>00328     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,DrMatColor); 
<a name="l00329"></a>00329     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,DrMatColor); 
<a name="l00330"></a>00330     glColor4d(Red,Green,Blue,Alpha);
<a name="l00331"></a>00331     <span class="comment">// glPushMatrix();//Particle</span>
<a name="l00332"></a>00332     glBegin(GL_POINTS);
<a name="l00333"></a>00333     glVertex3f(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00334"></a>00334     glEnd();
<a name="l00335"></a>00335     <span class="comment">// glPopMatrix();//Particle</span>
<a name="l00336"></a>00336     glBegin(GL_POLYGON);
<a name="l00337"></a>00337     glNormal3f(0.,0.,1.);
<a name="l00338"></a>00338     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00339"></a>00339     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00340"></a>00340     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00341"></a>00341     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00342"></a>00342     glEnd();
<a name="l00343"></a>00343   }
<a name="l00344"></a>00344   glEndList();
<a name="l00345"></a>00345   <span class="comment">// int Values = NEdge/4;</span>
<a name="l00346"></a>00346   <span class="comment">// double *Border = (double *)calloc(2*Values,sizeof(double));</span>
<a name="l00347"></a>00347   <span class="comment">// double *Norm = (double *)calloc(2*Values,sizeof(double));</span>
<a name="l00348"></a>00348   <span class="comment">// for(int p=0;p&lt;pNPart();p++){</span>
<a name="l00349"></a>00349   <span class="comment">//   int v = (int)(pPos(p,0)/pEdge(0)*Values);</span>
<a name="l00350"></a>00350   <span class="comment">//   if( v &gt;= Values) continue;</span>
<a name="l00351"></a>00351   <span class="comment">//   if(pPos(p,1) &gt; .5*pEdge(1)){</span>
<a name="l00352"></a>00352   <span class="comment">//     Border[2*v] += pPos(p,1)*pPos(p,2);</span>
<a name="l00353"></a>00353   <span class="comment">//     Norm[2*v] += pPos(p,2);</span>
<a name="l00354"></a>00354   <span class="comment">//   }</span>
<a name="l00355"></a>00355   <span class="comment">//   else{</span>
<a name="l00356"></a>00356   <span class="comment">//     Border[2*v+1] += pPos(p,1)*pPos(p,2);</span>
<a name="l00357"></a>00357   <span class="comment">//     Norm[2*v+1] += pPos(p,2];</span>
<a name="l00358"></a>00358   <span class="comment">//   }</span>
<a name="l00359"></a>00359   <span class="comment">// }</span>
<a name="l00360"></a>00360   <span class="comment">// glColor4f(.4,0.0,.6,1.0);</span>
<a name="l00361"></a>00361   <span class="comment">// glBegin(GL_LINE_STRIP);</span>
<a name="l00362"></a>00362   <span class="comment">// glNormal3f(0.,0.,1.);</span>
<a name="l00363"></a>00363   <span class="comment">// for(int v=0,vv=0;v&lt;2*Values-1;v+=2,vv++){</span>
<a name="l00364"></a>00364   <span class="comment">//   if(!(Norm[v] &gt; 0. ) )continue;</span>
<a name="l00365"></a>00365   <span class="comment">//   glVertex3f(vv/(double)Values*pEdge(0)*InvScaleUn,Border[v]*InvScaleUn/Norm[v],0.);</span>
<a name="l00366"></a>00366   <span class="comment">// }</span>
<a name="l00367"></a>00367   <span class="comment">// glEnd();</span>
<a name="l00368"></a>00368   <span class="comment">// glBegin(GL_LINE_STRIP);</span>
<a name="l00369"></a>00369   <span class="comment">// for(int v=1,vv=0;v&lt;2*Values-1;v+=2,vv++){</span>
<a name="l00370"></a>00370   <span class="comment">//   if(!(Norm[v] &gt; 0. ) )continue;</span>
<a name="l00371"></a>00371   <span class="comment">//   glVertex3f(vv/(double)Values*pEdge(0)*InvScaleUn,Border[v]*InvScaleUn/Norm[v],0.);</span>
<a name="l00372"></a>00372   <span class="comment">// }</span>
<a name="l00373"></a>00373   <span class="comment">// glEnd();</span>
<a name="l00374"></a>00374   <span class="comment">// glBegin(GL_LINE_STRIP);</span>
<a name="l00375"></a>00375   <span class="comment">// for(int v=0,vv=0;v&lt;2*Values-1;v+=2,vv++){</span>
<a name="l00376"></a>00376   <span class="comment">//   if(!(Norm[v] &gt; 0. ) )continue;</span>
<a name="l00377"></a>00377   <span class="comment">//   glVertex3f(-vv/(double)Values*pEdge(0)*InvScaleUn,Border[v]*InvScaleUn/Norm[v],0.);</span>
<a name="l00378"></a>00378   <span class="comment">// }</span>
<a name="l00379"></a>00379   <span class="comment">// glEnd();</span>
<a name="l00380"></a>00380   <span class="comment">// glBegin(GL_LINE_STRIP);</span>
<a name="l00381"></a>00381   <span class="comment">// for(int v=1,vv=0;v&lt;2*Values-1;v+=2,vv++){</span>
<a name="l00382"></a>00382   <span class="comment">//   if(!(Norm[v] &gt; 0. ) )continue;</span>
<a name="l00383"></a>00383   <span class="comment">//   glVertex3f(-vv/(double)Values*pEdge(0)*InvScaleUn,Border[v]*InvScaleUn/Norm[v],0.);</span>
<a name="l00384"></a>00384   <span class="comment">// }</span>
<a name="l00385"></a>00385   <span class="comment">// glEnd();</span>
<a name="l00386"></a>00386   <span class="comment">// glEndList();</span>
<a name="l00387"></a>00387 }
<a name="l00388"></a><a class="code" href="classElPoly.html#a04dd5a15e1151a49baece8c9196ca614">00388</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a04dd5a15e1151a49baece8c9196ca614" title="(rad,norm,dens) visualisation">ElPoly::DrDensity</a>(){
<a name="l00389"></a>00389   <span class="keywordflow">if</span>(Dr-&gt;<a class="code" href="classDraw.html#a2e742183addcbbee8c3d478448355b43" title="Activate the illumination for a specific material.">IfMaterial</a>){
<a name="l00390"></a>00390     glEnable(GL_LIGHTING);
<a name="l00391"></a>00391     glEnable( GL_LIGHT0 );
<a name="l00392"></a>00392   }
<a name="l00393"></a>00393   <span class="keywordflow">else</span> 
<a name="l00394"></a>00394     glDisable(GL_LIGHTING);
<a name="l00395"></a>00395   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00396"></a>00396   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00397"></a>00397   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00398"></a>00398   <span class="keywordtype">double</span> Offset = 1./(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00399"></a>00399   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0,c=0,t=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00400"></a>00400     <span class="keywordflow">if</span>( <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].NLink != 3 ) <span class="keywordflow">continue</span>;
<a name="l00401"></a>00401     <span class="keywordflow">if</span>(c == <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)) <span class="keywordflow">continue</span>;
<a name="l00402"></a>00402     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a> != BEAD_EVERY  &amp;&amp; <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) != <a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a>) <span class="keywordflow">continue</span>;
<a name="l00403"></a>00403     c = <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p);
<a name="l00404"></a>00404     <span class="keywordtype">double</span> Red = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(0);<span class="comment">// + pPos(p,2)*Sat;</span>
<a name="l00405"></a>00405     <span class="keywordtype">double</span> Green = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(1);
<a name="l00406"></a>00406     <span class="keywordtype">double</span> Blue = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(2);
<a name="l00407"></a>00407     <span class="keywordtype">double</span> Alpha = 1.0;<span class="comment">//7.+(Green+Blue);</span>
<a name="l00408"></a>00408     <span class="keywordflow">if</span>(Blue + Red + Green &lt; .08){Blue = 1.; Red = 1.;Green = 1.;Alpha=0.;}
<a name="l00409"></a>00409     GLfloat DrMatColor [] = {Red,Green,Blue,Alpha};
<a name="l00410"></a>00410     glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,DrMatColor);
<a name="l00411"></a>00411     glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,DrMatColor); 
<a name="l00412"></a>00412     <span class="keywordtype">int</span> l1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0];
<a name="l00413"></a>00413     <span class="comment">//if(l1 &gt; Gen-&gt;NPart) continue;</span>
<a name="l00414"></a>00414     <span class="keywordtype">int</span> l2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2];
<a name="l00415"></a>00415     <span class="comment">//if(l2 &gt; Gen-&gt;NPart) continue;</span>
<a name="l00416"></a>00416     <span class="keywordtype">int</span> l3 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1];
<a name="l00417"></a>00417     <span class="comment">//if(Green &gt; 0.) continue;</span>
<a name="l00418"></a>00418     <span class="comment">//     Green = 0.; Blue = 0.;</span>
<a name="l00419"></a>00419     glColor4f(Red,Green,Blue,Alpha);
<a name="l00420"></a>00420     <span class="comment">// if(pPos(p,2)&gt;12.) pPos(p,2) = 12.;</span>
<a name="l00421"></a>00421     <span class="comment">// if(pPos(l1,2)&gt;12.) pPos(l1,2) = 12.;</span>
<a name="l00422"></a>00422     <span class="comment">// if(pPos(l2,2)&gt;12.) pPos(l2,2) = 12.;</span>
<a name="l00423"></a>00423     <span class="comment">// if(pPos(l3,2)&gt;12.) pPos(l3,2) = 12.;</span>
<a name="l00424"></a>00424     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v1(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00425"></a>00425     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v2(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,2)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00426"></a>00426     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v3(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,2)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00427"></a>00427     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v4(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,2)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00428"></a>00428     v1.<a class="code" href="classVettore.html#a462cc9cf81c1f3a1b3c8b0136d6378d5" title="multiply by a scalar">Mult</a>(<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00429"></a>00429     v2.<a class="code" href="classVettore.html#a462cc9cf81c1f3a1b3c8b0136d6378d5" title="multiply by a scalar">Mult</a>(<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00430"></a>00430     v3.<a class="code" href="classVettore.html#a462cc9cf81c1f3a1b3c8b0136d6378d5" title="multiply by a scalar">Mult</a>(<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00431"></a>00431     v4.<a class="code" href="classVettore.html#a462cc9cf81c1f3a1b3c8b0136d6378d5" title="multiply by a scalar">Mult</a>(<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00432"></a>00432     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> u(3);
<a name="l00433"></a>00433     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v(3);
<a name="l00434"></a>00434     <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> vN(3);
<a name="l00435"></a>00435     vN.<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(&amp;v1,&amp;v2,&amp;v3);
<a name="l00436"></a>00436     glPushMatrix();<span class="comment">//Particle</span>
<a name="l00437"></a>00437     glBegin(GL_QUADS);
<a name="l00438"></a>00438     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00439"></a>00439     u = v2-v1;v = v3-v1;vN = u ^ v;<span class="comment">//vN.Normalize();</span>
<a name="l00440"></a>00440     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00441"></a>00441     glVertex3d(v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00442"></a>00442     u = v1-v2;v = v3-v2;vN = u ^ v;<span class="comment">//vN.Normalize();</span>
<a name="l00443"></a>00443     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00444"></a>00444     glVertex3d(v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00445"></a>00445     u = v2-v3;v = v4-v3;vN = u ^ v;<span class="comment">//vN.Normalize();</span>
<a name="l00446"></a>00446     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00447"></a>00447     glVertex3d(v2.x[0],v2.x[1],v2.x[2]);
<a name="l00448"></a>00448     u = v1-v4;v = v3-v4;vN = u ^ v;<span class="comment">//vN.Normalize();</span>
<a name="l00449"></a>00449     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00450"></a>00450     glVertex3d(v1.x[0],v1.x[1],v1.x[2]);
<a name="l00451"></a>00451     glEnd();
<a name="l00452"></a>00452     glPopMatrix();<span class="comment">//Particle</span>
<a name="l00453"></a>00453     <span class="comment">//continue;</span>
<a name="l00454"></a>00454     glPushMatrix();<span class="comment">//Particle</span>
<a name="l00455"></a>00455     glBegin(GL_QUADS);
<a name="l00456"></a>00456     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00457"></a>00457     glVertex3d(-v1.x[0],v1.x[1],v1.x[2]);
<a name="l00458"></a>00458     glVertex3d(-v2.x[0],v2.x[1],v2.x[2]);
<a name="l00459"></a>00459     glVertex3d(-v3.x[0],v3.x[1],v3.x[2]);
<a name="l00460"></a>00460     glVertex3d(-v4.x[0],v4.x[1],v4.x[2]);
<a name="l00461"></a>00461     glEnd();
<a name="l00462"></a>00462     glPopMatrix();<span class="comment">//Particle</span>
<a name="l00463"></a>00463   }
<a name="l00464"></a>00464   glEndList();
<a name="l00465"></a>00465 }
<a name="l00466"></a><a class="code" href="classElPoly.html#a6f21a42e28c3633aa1f57be5ff26e3aa">00466</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a6f21a42e28c3633aa1f57be5ff26e3aa" title="Boh.">ElPoly::DrInterpSurface</a>(){
<a name="l00467"></a>00467   glEnable(GL_LIGHTING);
<a name="l00468"></a>00468   glEnable( GL_LIGHT0 );
<a name="l00469"></a>00469   <span class="keywordtype">int</span> NPoint = 32;
<a name="l00470"></a>00470   GLfloat Deltax = 1./(GLfloat) NPoint;
<a name="l00471"></a>00471   <a class="code" href="structPART.html" title="Information of every particle.">PART</a> *PSample = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(NPoint*NPoint,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00472"></a>00472   <span class="keywordtype">int</span> NSample = (int)sqrt(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()); 
<a name="l00473"></a>00473   glColor4f(1.0,.0,1.,1.);
<a name="l00474"></a>00474   glEnableClientState(GL_VERTEX_ARRAY);
<a name="l00475"></a>00475   glEnableClientState(GL_NORMAL_ARRAY);
<a name="l00476"></a>00476   glEnable(GL_VERTEX_ARRAY);
<a name="l00477"></a>00477   glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
<a name="l00478"></a>00478   glFrontFace(GL_CCW);   <span class="comment">//Tell OGL which orientation shall be the front face</span>
<a name="l00479"></a>00479   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00480"></a>00480   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00481"></a>00481   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00482"></a>00482   <span class="comment">//InterSpline3(Pm,PSample,NSample*NSample,NPoint*NPoint);</span>
<a name="l00483"></a>00483   glVertexPointer(3,GL_DOUBLE,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>),&amp;PSample[0].Pos[0]);
<a name="l00484"></a>00484   glNormalPointer(GL_DOUBLE,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>),&amp;PSample[0].Vel[0]);
<a name="l00485"></a>00485   vector &lt;GLuint&gt; VecIndices; 
<a name="l00486"></a>00486   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NPoint-1;i++){
<a name="l00487"></a>00487     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;NPoint-1;j++){
<a name="l00488"></a>00488       VecIndices.push_back(i*NPoint + j);
<a name="l00489"></a>00489       VecIndices.push_back((i+1)*NPoint + j);
<a name="l00490"></a>00490       VecIndices.push_back((i+1)*NPoint + (j+1));
<a name="l00491"></a>00491       
<a name="l00492"></a>00492       VecIndices.push_back(i*NPoint + j);
<a name="l00493"></a>00493       VecIndices.push_back((i+1)*NPoint + (j+1));
<a name="l00494"></a>00494       VecIndices.push_back((i)*NPoint + (j+1));
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497   <span class="keywordtype">int</span> NIndex = VecIndices.size();
<a name="l00498"></a>00498   GLuint *Indices = (GLuint *)calloc(NIndex,<span class="keyword">sizeof</span>(GLuint));
<a name="l00499"></a>00499   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NIndex;i++){
<a name="l00500"></a>00500     Indices[i] = VecIndices[i];
<a name="l00501"></a>00501   }
<a name="l00502"></a>00502   glDrawElements(GL_TRIANGLES,NIndex,GL_UNSIGNED_INT,Indices);
<a name="l00503"></a>00503   VecIndices.clear();
<a name="l00504"></a>00504   free(Indices);
<a name="l00505"></a>00505   glEndList();
<a name="l00506"></a>00506   <span class="keywordflow">return</span>;
<a name="l00507"></a>00507 }
<a name="l00508"></a><a class="code" href="classElPoly.html#a4f733cc712ac229489bff59b4b4f8c58">00508</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a4f733cc712ac229489bff59b4b4f8c58" title="Double triangle defined by four vectors.">ElPoly::DrDoubleTria</a>(<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v00,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v01,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v11,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v10,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *vN){
<a name="l00509"></a>00509   glPushMatrix();<span class="comment">//Particle</span>
<a name="l00510"></a>00510   glBegin(GL_TRIANGLES);
<a name="l00511"></a>00511   <span class="comment">// vN-&gt;NormalSurf(v00,v01,v11);</span>
<a name="l00512"></a>00512   <span class="comment">// vN-&gt;Normalize();</span>
<a name="l00513"></a>00513   <span class="comment">// glNormal3f(vN-&gt;x[0],vN-&gt;x[1],vN-&gt;x[2]);</span>
<a name="l00514"></a>00514   <span class="comment">// glVertex3d(v00-&gt;x[0],v00-&gt;x[1],v00-&gt;x[2]);</span>
<a name="l00515"></a>00515   <span class="comment">// vN-&gt;NormalSurf(v01,v00,v11);</span>
<a name="l00516"></a>00516   <span class="comment">// vN-&gt;Normalize();</span>
<a name="l00517"></a>00517   <span class="comment">// glNormal3f(vN-&gt;x[0],vN-&gt;x[1],vN-&gt;x[2]);</span>
<a name="l00518"></a>00518   <span class="comment">// glVertex3d(v01-&gt;x[0],v01-&gt;x[1],v01-&gt;x[2]);</span>
<a name="l00519"></a>00519   <span class="comment">// vN-&gt;NormalSurf(v11,v01,v10);</span>
<a name="l00520"></a>00520   <span class="comment">// vN-&gt;Normalize();</span>
<a name="l00521"></a>00521   <span class="comment">// glNormal3f(vN-&gt;x[0],vN-&gt;x[1],vN-&gt;x[2]);</span>
<a name="l00522"></a>00522   <span class="comment">// glVertex3d(v11-&gt;x[0],v11-&gt;x[1],v11-&gt;x[2]);</span>
<a name="l00523"></a>00523   <span class="comment">// glEnd();</span>
<a name="l00524"></a>00524   vN-&gt;<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(v00,v01,v11);
<a name="l00525"></a>00525   vN-&gt;<a class="code" href="classVettore.html#aef629c102c4d237ef6e4897238f5bc18" title="Normlizes a Vettore.">Normalize</a>();
<a name="l00526"></a>00526   glNormal3f(vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00527"></a>00527   glVertex3d(v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00528"></a>00528   glVertex3d(v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00529"></a>00529   glVertex3d(v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00530"></a>00530   glEnd();
<a name="l00531"></a>00531   glPopMatrix();<span class="comment">//Particle</span>
<a name="l00532"></a>00532   vN-&gt;<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(v00,v11,v10);
<a name="l00533"></a>00533   vN-&gt;<a class="code" href="classVettore.html#aef629c102c4d237ef6e4897238f5bc18" title="Normlizes a Vettore.">Normalize</a>();
<a name="l00534"></a>00534   glPushMatrix();<span class="comment">//Particle</span>
<a name="l00535"></a>00535   glBegin(GL_TRIANGLES);
<a name="l00536"></a>00536   glNormal3f(vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00537"></a>00537   glVertex3d(v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00538"></a>00538   glVertex3d(v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00539"></a>00539   glVertex3d(v10-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v10-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v10-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00540"></a>00540   glEnd();
<a name="l00541"></a>00541   glPopMatrix();<span class="comment">//Particle</span>
<a name="l00542"></a>00542 }
<a name="l00543"></a><a class="code" href="classElPoly.html#adcc85b143b5bbcb89aa5eabeb33b9ed6">00543</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#adcc85b143b5bbcb89aa5eabeb33b9ed6" title="single triangle defined by three vectors">ElPoly::DrTria</a>(<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v00,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v01,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v11,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *vN){
<a name="l00544"></a>00544   vN-&gt;<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(v00,v01,v11);
<a name="l00545"></a>00545   vN-&gt;<a class="code" href="classVettore.html#aef629c102c4d237ef6e4897238f5bc18" title="Normlizes a Vettore.">Normalize</a>();
<a name="l00546"></a>00546   glPushMatrix();<span class="comment">//Particle</span>
<a name="l00547"></a>00547   glBegin(GL_TRIANGLES);
<a name="l00548"></a>00548   glNormal3f(vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00549"></a>00549   glVertex3d(v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00550"></a>00550   glVertex3d(v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00551"></a>00551   glVertex3d(v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00552"></a>00552   glEnd();
<a name="l00553"></a>00553   glPopMatrix();<span class="comment">//Particle</span>
<a name="l00554"></a>00554 }
<a name="l00555"></a><a class="code" href="classElPoly.html#ad7b11c55a050b47140f4063d6ad80756">00555</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ad7b11c55a050b47140f4063d6ad80756" title="Draw the contour of three vectors.">ElPoly::DrTriaContour</a>(<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v00,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v01,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> *v11){
<a name="l00556"></a>00556   glPushMatrix();<span class="comment">//Particle</span>
<a name="l00557"></a>00557   glBegin(GL_LINES);
<a name="l00558"></a>00558   glVertex3d(v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00559"></a>00559   glVertex3d(v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00560"></a>00560   glEnd();
<a name="l00561"></a>00561   glBegin(GL_LINES);
<a name="l00562"></a>00562   glVertex3d(v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v01-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00563"></a>00563   glVertex3d(v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00564"></a>00564   glEnd();
<a name="l00565"></a>00565   glBegin(GL_LINES);
<a name="l00566"></a>00566   glVertex3d(v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00567"></a>00567   glVertex3d(v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00-&gt;<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00568"></a>00568   glEnd();
<a name="l00569"></a>00569   glPopMatrix();<span class="comment">//Particle</span>
<a name="l00570"></a>00570 }
<a name="l00571"></a><a class="code" href="classElPoly.html#a7681bc74a114ac4d7c4503a9dc39e957">00571</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a7681bc74a114ac4d7c4503a9dc39e957" title="Draw the surface in triangles.">ElPoly::DrSmooth</a>(<span class="keywordtype">double</span> *Plot,<span class="keywordtype">int</span> NSample,<span class="keywordtype">double</span> Min,<span class="keywordtype">double</span> Max){
<a name="l00572"></a>00572   <span class="keywordflow">if</span>(Dr-&gt;<a class="code" href="classDraw.html#a2e742183addcbbee8c3d478448355b43" title="Activate the illumination for a specific material.">IfMaterial</a>){
<a name="l00573"></a>00573     glEnable(GL_LIGHTING);
<a name="l00574"></a>00574     glEnable( GL_LIGHT0 );
<a name="l00575"></a>00575   }
<a name="l00576"></a>00576   <span class="keywordflow">else</span> 
<a name="l00577"></a>00577     glDisable(GL_LIGHTING);
<a name="l00578"></a>00578   <span class="keywordtype">double</span> FactC1 = 1./(double)NSample*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>);
<a name="l00579"></a>00579   <span class="keywordtype">double</span> FactC2 = 1./(double)NSample*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>);
<a name="l00580"></a>00580   <span class="keywordtype">double</span> FactCN = <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00581"></a>00581   GLfloat Color[4];
<a name="l00582"></a>00582   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v00(3);
<a name="l00583"></a>00583   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v01(3);
<a name="l00584"></a>00584   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v11(3);
<a name="l00585"></a>00585   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v10(3);
<a name="l00586"></a>00586   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> vN(3);
<a name="l00587"></a>00587   Min *= <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00588"></a>00588   Max *= <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00589"></a>00589   <span class="keywordtype">double</span> Delta = 1./(Max-Min);
<a name="l00590"></a>00590   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample-1;s++){
<a name="l00591"></a>00591     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ss=0;ss&lt;NSample-1;ss++){
<a name="l00592"></a>00592       v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+.5)*FactC1;
<a name="l00593"></a>00593       v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+.5)*FactC2;
<a name="l00594"></a>00594       v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[s*NSample+ss]*FactCN;
<a name="l00595"></a>00595       v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+1.5)*FactC1;
<a name="l00596"></a>00596       v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+.5)*FactC2;
<a name="l00597"></a>00597       v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[(s+1)*NSample+ss]*FactCN;
<a name="l00598"></a>00598       v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+1.5)*FactC1;
<a name="l00599"></a>00599       v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+1.5)*FactC2;
<a name="l00600"></a>00600       v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[(s+1)*NSample+(ss+1)]*FactCN;
<a name="l00601"></a>00601       v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+.5)*FactC1;
<a name="l00602"></a>00602       v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+1.5)*FactC2;
<a name="l00603"></a>00603       v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[s*NSample+ss+1]*FactCN;
<a name="l00604"></a>00604       <span class="comment">//glColor4f(.4,.4,.6,1.);</span>
<a name="l00605"></a>00605       <span class="comment">//DrDoubleTria(&amp;v00,&amp;v01,&amp;v11,&amp;v10,&amp;vN);</span>
<a name="l00606"></a>00606       glBegin(GL_POLYGON);
<a name="l00607"></a>00607       vN.<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(&amp;v00,&amp;v01,&amp;v11);
<a name="l00608"></a>00608       vN.<a class="code" href="classVettore.html#aef629c102c4d237ef6e4897238f5bc18" title="Normlizes a Vettore.">Normalize</a>();
<a name="l00609"></a>00609       glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00610"></a>00610       <span class="keywordtype">double</span> Depth = (v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]-Min)*Delta*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>+<a class="code" href="classElPoly.html#a669c83da48812050d13a2c63fff0fef9" title="External parameter (e.g. for MarchingCubes)">ExtParam</a>;
<a name="l00611"></a>00611       Dr-&gt;<a class="code" href="classDraw.html#ab3d9c36aceb9e5f4b158eb15b47c2003" title="Pointer to a generic function.">DepthMap</a>(Depth,Color);
<a name="l00612"></a>00612       glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color);
<a name="l00613"></a>00613       glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color);
<a name="l00614"></a>00614       glColor4fv(Color);
<a name="l00615"></a>00615       glVertex3d(v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00616"></a>00616       Depth = (v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]-Min)*Delta*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>+<a class="code" href="classElPoly.html#a669c83da48812050d13a2c63fff0fef9" title="External parameter (e.g. for MarchingCubes)">ExtParam</a>;
<a name="l00617"></a>00617       Dr-&gt;<a class="code" href="classDraw.html#ab3d9c36aceb9e5f4b158eb15b47c2003" title="Pointer to a generic function.">DepthMap</a>(Depth,Color);
<a name="l00618"></a>00618       glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color);
<a name="l00619"></a>00619       glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color);
<a name="l00620"></a>00620       glColor4fv(Color);
<a name="l00621"></a>00621       glVertex3d(v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00622"></a>00622       Depth = (v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]-Min)*Delta*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>+<a class="code" href="classElPoly.html#a669c83da48812050d13a2c63fff0fef9" title="External parameter (e.g. for MarchingCubes)">ExtParam</a>;
<a name="l00623"></a>00623       Dr-&gt;<a class="code" href="classDraw.html#ab3d9c36aceb9e5f4b158eb15b47c2003" title="Pointer to a generic function.">DepthMap</a>(Depth,Color);
<a name="l00624"></a>00624       glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color);
<a name="l00625"></a>00625       glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color);
<a name="l00626"></a>00626       glColor4fv(Color);
<a name="l00627"></a>00627       glVertex3d(v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00628"></a>00628       Depth = (v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]-Min)*Delta*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>+<a class="code" href="classElPoly.html#a669c83da48812050d13a2c63fff0fef9" title="External parameter (e.g. for MarchingCubes)">ExtParam</a>;
<a name="l00629"></a>00629       Dr-&gt;<a class="code" href="classDraw.html#ab3d9c36aceb9e5f4b158eb15b47c2003" title="Pointer to a generic function.">DepthMap</a>(Depth,Color);
<a name="l00630"></a>00630       glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color);
<a name="l00631"></a>00631       glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color);
<a name="l00632"></a>00632       glColor4fv(Color);
<a name="l00633"></a>00633       glVertex3d(v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00634"></a>00634       glEnd();
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636   }
<a name="l00637"></a>00637   glDisable(GL_LIGHTING);
<a name="l00638"></a>00638 }
<a name="l00639"></a><a class="code" href="classElPoly.html#a8a67d62cbd0dd7489e799e2f7871fb74">00639</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a8a67d62cbd0dd7489e799e2f7871fb74" title="Samples the surface and draws it in triangles.">ElPoly::DrSample</a>(<span class="keywordtype">int</span> NSample){
<a name="l00640"></a>00640   NSample *= 4;
<a name="l00641"></a>00641   <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> m1 = <a class="code" href="classVarData.html#ac4c0e38f73d520530288e3195983d71e" title="Allocate and fill PlotMem with the particle average position.">SampleSurfaceMem</a>(NSample);
<a name="l00642"></a>00642   printf(<span class="stringliteral">&quot;plane min=%lf av=%lf max=%lf\n&quot;</span>,m1.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>,m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,m1.<a class="code" href="structMOMENTI.html#a3b2b236fc7834236613c9a51e415be2e" title="Maximum value.">Max</a>);
<a name="l00643"></a>00643   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00644"></a>00644   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00645"></a>00645   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00646"></a>00646   <a class="code" href="classElPoly.html#a7681bc74a114ac4d7c4503a9dc39e957" title="Draw the surface in triangles.">DrSmooth</a>(<a class="code" href="classVarData.html#ac5723b66cbed09bdf120939a3434165a" title="Particle position/density on the square lattice.">PlotMem</a>,NSample,.9*m1.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>,.9*m1.<a class="code" href="structMOMENTI.html#a3b2b236fc7834236613c9a51e415be2e" title="Maximum value.">Max</a>);
<a name="l00647"></a>00647   glEndList();
<a name="l00648"></a>00648 }
<a name="l00649"></a><a class="code" href="classElPoly.html#a1003dbb97e1d997e641cc0b8c4d82ba2">00649</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a1003dbb97e1d997e641cc0b8c4d82ba2" title="Visualize the surface from Stalk.xvl.">ElPoly::DrStalk</a>(){
<a name="l00650"></a>00650   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00651"></a>00651   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00652"></a>00652   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00653"></a>00653   glDisable(GL_NORMALIZE);
<a name="l00654"></a>00654   <span class="keywordtype">double</span> Offset = 1./(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00655"></a>00655   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v1(3);
<a name="l00656"></a>00656   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v2(3);
<a name="l00657"></a>00657   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v3(3);
<a name="l00658"></a>00658   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v4(3);
<a name="l00659"></a>00659   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> vN(3);
<a name="l00660"></a>00660   glFrontFace(GL_CCW);
<a name="l00661"></a>00661   <span class="comment">//glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);</span>
<a name="l00662"></a>00662   <span class="comment">//glShadeModel(GL_SMOOTH);</span>
<a name="l00663"></a>00663   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0,c=0,t=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00664"></a>00664     <span class="keywordflow">if</span>( <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].NLink != 3 ) <span class="keywordflow">continue</span>;
<a name="l00665"></a>00665     <span class="keywordflow">if</span>(c == <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)) <span class="keywordflow">continue</span>;
<a name="l00666"></a>00666     <span class="keywordflow">if</span>( <a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a> != BEAD_EVERY  &amp;&amp; <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) != <a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a> &amp;&amp; <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) != BEAD_NANO) <span class="keywordflow">continue</span>;
<a name="l00667"></a>00667     c = <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p);
<a name="l00668"></a>00668     <span class="keywordtype">double</span> Red = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;<span class="comment">// + pPos(p,2)*Sat;</span>
<a name="l00669"></a>00669     <span class="keywordtype">double</span> Green = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00670"></a>00670     <span class="keywordtype">double</span> Blue = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00671"></a>00671     <span class="keywordtype">double</span> Alpha = 1.0;<span class="comment">//7.+(Green+Blue);</span>
<a name="l00672"></a>00672     <span class="keywordtype">int</span> l1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0];
<a name="l00673"></a>00673     <span class="comment">//if(l1 &gt; Gen-&gt;NPart) continue;</span>
<a name="l00674"></a>00674     <span class="keywordtype">int</span> l2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2];
<a name="l00675"></a>00675     <span class="comment">//if(l2 &gt; Gen-&gt;NPart) continue;</span>
<a name="l00676"></a>00676     <span class="keywordtype">int</span> l3 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1];
<a name="l00677"></a>00677     <span class="comment">//     Green = 0.; Blue = 0.;</span>
<a name="l00678"></a>00678     glColor4f(Red,Green,Blue,Alpha);
<a name="l00679"></a>00679     v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00680"></a>00680     v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00681"></a>00681     v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00682"></a>00682     v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00683"></a>00683     v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00684"></a>00684     v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00685"></a>00685     v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00686"></a>00686     v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00687"></a>00687     v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00688"></a>00688     v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00689"></a>00689     v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00690"></a>00690     v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00691"></a>00691     vN.<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(&amp;v1,&amp;v2,&amp;v3);
<a name="l00692"></a>00692     vN.<a class="code" href="classVettore.html#a735ba6810472f29b5158d6f266371c9b" title="Rescale the total length of the vector.">Rescale</a>(.2);
<a name="l00693"></a>00693     glPushMatrix();<span class="comment">//Particle</span>
<a name="l00694"></a>00694     glBegin(GL_QUADS);
<a name="l00695"></a>00695     glNormal3f(vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],-vN.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00696"></a>00696     glVertex3d(v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00697"></a>00697     glVertex3d(v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00698"></a>00698     glVertex3d(v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00699"></a>00699     glVertex3d(v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0],v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1],v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]);
<a name="l00700"></a>00700     glEnd();
<a name="l00701"></a>00701     glPopMatrix();<span class="comment">//Particle</span>
<a name="l00702"></a>00702   }
<a name="l00703"></a>00703   glEndList();
<a name="l00704"></a>00704 }
<a name="l00705"></a><a class="code" href="classElPoly.html#a62e3f72464b15b655d7c683ad3c1393f">00705</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a62e3f72464b15b655d7c683ad3c1393f" title="Visualize the surface calculated in Stalk()">ElPoly::DrCreateStalk</a>(){
<a name="l00706"></a>00706   <span class="keywordtype">int</span> NSample = 24;
<a name="l00707"></a>00707   <span class="keywordtype">double</span> Threshold = 0.;
<a name="l00708"></a>00708   <span class="keywordtype">int</span> NLevel = 4;
<a name="l00709"></a>00709   <span class="keywordtype">double</span> **Plot = (<span class="keywordtype">double</span> **) calloc(NLevel,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00710"></a>00710   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;NLevel;l++){
<a name="l00711"></a>00711     Plot[l] = (<span class="keywordtype">double</span> *)calloc(NSample*NSample,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00712"></a>00712   }
<a name="l00713"></a>00713   <a class="code" href="classVarData.html#a7521c027e75a7b726b1afb9f800301f6" title="Following the contour of a stalk.">Stalk</a>(NSample,NLevel,Plot,Threshold);
<a name="l00714"></a>00714   <span class="comment">//Drawing</span>
<a name="l00715"></a>00715   glColorMaterial(GL_FRONT_AND_BACK,GL_EMISSION);
<a name="l00716"></a>00716   glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
<a name="l00717"></a>00717   <span class="keywordtype">double</span> FactC1 = 1./(double)NSample*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>);
<a name="l00718"></a>00718   <span class="keywordtype">double</span> FactC2 = 1./(double)NSample*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>);
<a name="l00719"></a>00719   <span class="keywordtype">double</span> FactCN = <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00720"></a>00720   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v00(3);
<a name="l00721"></a>00721   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v01(3);
<a name="l00722"></a>00722   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v11(3);
<a name="l00723"></a>00723   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v10(3);
<a name="l00724"></a>00724   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> vN(3);
<a name="l00725"></a>00725   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00726"></a>00726   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00727"></a>00727   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00728"></a>00728   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample-1;s++){
<a name="l00729"></a>00729     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ss=0;ss&lt;NSample-1;ss++){
<a name="l00730"></a>00730       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;NLevel;l++){
<a name="l00731"></a>00731    <span class="keywordflow">if</span>(l==0 || l == 3) <span class="keywordflow">continue</span>;
<a name="l00732"></a>00732    glColor4f((<span class="keywordtype">double</span>)l*.25,.5,.8,1.);
<a name="l00733"></a>00733    v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+.5)*FactC1;
<a name="l00734"></a>00734    v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+.5)*FactC2;
<a name="l00735"></a>00735    v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[l][s*NSample+ss]*FactCN;
<a name="l00736"></a>00736    v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+1.5)*FactC1;
<a name="l00737"></a>00737    v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+.5)*FactC2;
<a name="l00738"></a>00738    v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[l][(s+1)*NSample+ss]*FactCN;
<a name="l00739"></a>00739    v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+1.5)*FactC1;
<a name="l00740"></a>00740    v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+1.5)*FactC2;
<a name="l00741"></a>00741    v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[l][(s+1)*NSample+ss+1]*FactCN;
<a name="l00742"></a>00742    v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>]=(s+.5)*FactC1;
<a name="l00743"></a>00743    v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>]=(ss+1.5)*FactC2;
<a name="l00744"></a>00744    v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[l][s*NSample+ss+1]*FactCN;
<a name="l00745"></a>00745    <span class="keywordflow">if</span>(Plot[l][(s)*NSample+ss] &lt;= 0.){
<a name="l00746"></a>00746      <span class="keywordflow">if</span>(l==0)
<a name="l00747"></a>00747        v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[3][(s)*NSample+ss+1]*FactCN;
<a name="l00748"></a>00748      <span class="keywordflow">if</span>(l==1)
<a name="l00749"></a>00749        v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[2][(s)*NSample+ss+1]*FactCN;
<a name="l00750"></a>00750      <span class="keywordflow">if</span>(l==2) 
<a name="l00751"></a>00751        v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[1][(s)*NSample+ss+1]*FactCN;
<a name="l00752"></a>00752      <span class="keywordflow">if</span>(l==3) 
<a name="l00753"></a>00753        v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[0][(s)*NSample+ss+1]*FactCN;
<a name="l00754"></a>00754      <span class="keywordflow">if</span>(v00.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00755"></a>00755    }
<a name="l00756"></a>00756    <span class="keywordflow">if</span>(Plot[l][(s+1)*NSample+ss] &lt;= 0.){
<a name="l00757"></a>00757      <span class="keywordflow">if</span>(l==0)
<a name="l00758"></a>00758        v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[3][(s)*NSample+ss]*FactCN;
<a name="l00759"></a>00759      <span class="keywordflow">if</span>(l==1)
<a name="l00760"></a>00760        v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[2][(s)*NSample+ss]*FactCN;
<a name="l00761"></a>00761      <span class="keywordflow">if</span>(l==2) 
<a name="l00762"></a>00762        v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[1][(s)*NSample+ss]*FactCN;
<a name="l00763"></a>00763      <span class="keywordflow">if</span>(l==3) 
<a name="l00764"></a>00764        v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[0][(s)*NSample+ss]*FactCN;
<a name="l00765"></a>00765      <span class="keywordflow">if</span>(v01.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00766"></a>00766    }
<a name="l00767"></a>00767    <span class="keywordflow">if</span>(Plot[l][s*NSample+ss+1] &lt;= 0.){
<a name="l00768"></a>00768      <span class="keywordflow">if</span>(l==0)
<a name="l00769"></a>00769        v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[3][(s)*NSample+ss]*FactCN;
<a name="l00770"></a>00770      <span class="keywordflow">if</span>(l==1)
<a name="l00771"></a>00771        v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[2][(s)*NSample+ss]*FactCN;
<a name="l00772"></a>00772      <span class="keywordflow">if</span>(l==2) 
<a name="l00773"></a>00773        v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[1][(s)*NSample+ss]*FactCN;
<a name="l00774"></a>00774      <span class="keywordflow">if</span>(l==3) 
<a name="l00775"></a>00775        v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[0][(s)*NSample+ss]*FactCN;
<a name="l00776"></a>00776      <span class="keywordflow">if</span>(v10.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00777"></a>00777    }
<a name="l00778"></a>00778    <span class="keywordflow">if</span>(Plot[l][(s+1)*NSample+(ss+1)] &lt;= 0.){
<a name="l00779"></a>00779      <span class="keywordflow">if</span>(l==0)
<a name="l00780"></a>00780        v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[3][(s)*NSample+ss+1]*FactCN;
<a name="l00781"></a>00781      <span class="keywordflow">if</span>(l==1)
<a name="l00782"></a>00782        v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[2][(s)*NSample+ss+1]*FactCN;
<a name="l00783"></a>00783      <span class="keywordflow">if</span>(l==2) 
<a name="l00784"></a>00784        v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[1][(s)*NSample+ss+1]*FactCN;
<a name="l00785"></a>00785      <span class="keywordflow">if</span>(l==3) 
<a name="l00786"></a>00786        v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]=Plot[0][(s)*NSample+ss+1]*FactCN;
<a name="l00787"></a>00787      <span class="keywordflow">if</span>(v11.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00788"></a>00788    }
<a name="l00789"></a>00789    <a class="code" href="classElPoly.html#a4f733cc712ac229489bff59b4b4f8c58" title="Double triangle defined by four vectors.">DrDoubleTria</a>(&amp;v00,&amp;v01,&amp;v11,&amp;v10,&amp;vN);
<a name="l00790"></a>00790       }
<a name="l00791"></a>00791     }
<a name="l00792"></a>00792   }
<a name="l00793"></a>00793   glEndList();
<a name="l00794"></a>00794   <span class="comment">//Freeing</span>
<a name="l00795"></a>00795   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;NLevel;l++){
<a name="l00796"></a>00796     free(Plot[l]);
<a name="l00797"></a>00797   }
<a name="l00798"></a>00798   free(Plot);
<a name="l00799"></a>00799 }
<a name="l00800"></a><a class="code" href="classElPoly.html#a487c5fd53a9d6527b47cfd003422be58">00800</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a487c5fd53a9d6527b47cfd003422be58" title="Calculate the spectrum of the surface and draws it in triangles.">ElPoly::DrSpectrum</a>(){
<a name="l00801"></a>00801   <span class="keywordtype">int</span> NSample = 32;
<a name="l00802"></a>00802   <span class="keywordtype">double</span> Unity = 1./(double)NSample*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00803"></a>00803   <span class="keywordtype">double</span> *Plot = (<span class="keywordtype">double</span> *) calloc(SQR(NSample),<span class="keyword">sizeof</span>(double));
<a name="l00804"></a>00804   <span class="keywordtype">double</span> *PlotR = (<span class="keywordtype">double</span> *) calloc(SQR(NSample),<span class="keyword">sizeof</span>(double));
<a name="l00805"></a>00805   <a class="code" href="classVarData.html#aba8419a8fffac92d2f0855c9507dda75" title="Define a normal coordinate for every patch.">SampleSurface</a>(Plot,NSample,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>);
<a name="l00806"></a>00806   <span class="comment">//InterBSpline2D(Plot,PlotR,NSample,NSample);</span>
<a name="l00807"></a>00807   <a class="code" href="classVarData.html#a2ad0f2350b0470eae15cfad3e6ce2343" title="1-d spectrum of a surface">Spettro2d</a>(Plot,NSample);
<a name="l00808"></a>00808   <span class="keywordtype">double</span> Min = 0.;
<a name="l00809"></a>00809   <span class="keywordtype">double</span> Max = 1000000.;
<a name="l00810"></a>00810   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;SQR(NSample);s++){
<a name="l00811"></a>00811     Plot[s] += .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>)/<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00812"></a>00812     <span class="keywordflow">if</span>(Max &lt; Plot[s]) Max = Plot[s];
<a name="l00813"></a>00813     <span class="keywordflow">if</span>(Min &gt; Plot[s]) Min = Plot[s];
<a name="l00814"></a>00814   }
<a name="l00815"></a>00815   <span class="comment">//Drawing</span>
<a name="l00816"></a>00816   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00817"></a>00817   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00818"></a>00818   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00819"></a>00819   <a class="code" href="classElPoly.html#a7681bc74a114ac4d7c4503a9dc39e957" title="Draw the surface in triangles.">DrSmooth</a>(Plot,NSample,Min,Max);
<a name="l00820"></a>00820   glEndList();
<a name="l00821"></a>00821   <span class="comment">//Freeing</span>
<a name="l00822"></a>00822   free(PlotR);
<a name="l00823"></a>00823   free(Plot);
<a name="l00824"></a>00824   <span class="keywordflow">return</span>;
<a name="l00825"></a>00825   <span class="keywordtype">double</span> *Points = (<span class="keywordtype">double</span> *)calloc(NSample,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00826"></a>00826   <a class="code" href="classVarData.html#a2ad0f2350b0470eae15cfad3e6ce2343" title="1-d spectrum of a surface">Spettro2d</a>(Points,NSample,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>);
<a name="l00827"></a>00827   <span class="keywordtype">double</span> Max1=0.,Max2=0.;
<a name="l00828"></a>00828   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample;s++){
<a name="l00829"></a>00829     <span class="keywordflow">if</span>(Max1 &lt; Points[s]){
<a name="l00830"></a>00830       Max2 = Max1;
<a name="l00831"></a>00831       Max1 = Points[s];
<a name="l00832"></a>00832       <span class="keywordflow">continue</span>;
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834     <span class="keywordflow">if</span>(Max2 &lt; Points[s]){
<a name="l00835"></a>00835       Max2 = Points[s];
<a name="l00836"></a>00836       <span class="keywordflow">continue</span>;
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838   }
<a name="l00839"></a>00839   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample;s++){
<a name="l00840"></a>00840     Points[s] /= Max2;
<a name="l00841"></a>00841   }
<a name="l00842"></a>00842   <span class="comment">//SampleSurface(Plot,NSample,2,CHAIN_DOWN);</span>
<a name="l00843"></a>00843   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=NSample/2;s&lt;NSample-1;s++){
<a name="l00844"></a>00844     glPushMatrix();
<a name="l00845"></a>00845     glBegin(GL_LINES);
<a name="l00846"></a>00846     glColor4f(1.,0.,1.,1.);
<a name="l00847"></a>00847     glVertex3d((2*s-NSample)*Unity,0.,Points[s]);
<a name="l00848"></a>00848     glVertex3d((2*(s+1)-NSample)*Unity,0.,Points[s+1]);
<a name="l00849"></a>00849     glEnd();
<a name="l00850"></a>00850     glPopMatrix();
<a name="l00851"></a>00851   }
<a name="l00852"></a>00852   glEndList();
<a name="l00853"></a>00853   free(Points);
<a name="l00854"></a>00854   free(Plot);
<a name="l00855"></a>00855 }
<a name="l00856"></a><a class="code" href="classElPoly.html#aaafb3fae855c37686197d2d1f66cea4c">00856</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aaafb3fae855c37686197d2d1f66cea4c" title="Samples the surface, applies a 2d matrix derivative and draws the surface in triangles.">ElPoly::DrDerivative</a>(){
<a name="l00857"></a>00857   <span class="keywordtype">int</span> NSample = 20;
<a name="l00858"></a>00858   <span class="keywordtype">double</span> Unity= 1./(double)NSample*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00859"></a>00859   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Weight;
<a name="l00860"></a>00860   Weight.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 1.; Weight.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = 0.; Weight.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>=1.;Weight.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>=0.;Weight.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>=0.;
<a name="l00861"></a>00861   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *<a class="code" href="classElPoly.html#a52844d3cee2d60eb47889fb021e10fc8" title="Area of a surfuce projected on the coordinate Coord  surf.">Surface</a>= <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(NSample,NSample);
<a name="l00862"></a>00862   <a class="code" href="classVarData.html#aba8419a8fffac92d2f0855c9507dda75" title="Define a normal coordinate for every patch.">SampleSurface</a>(Surface,NSample,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>);
<a name="l00863"></a>00863   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *Resp = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(NSample,NSample);
<a name="l00864"></a>00864   <a class="code" href="classVarData.html#a5d41a4adc43927d71fa72494b0a989ce" title="Perform a spatial derivative on a surface.">SpatialDerivative</a>(Surface,Resp,Weight,NSample);
<a name="l00865"></a>00865   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00866"></a>00866   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00867"></a>00867   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00868"></a>00868   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=1;s&lt;NSample-2;s++){
<a name="l00869"></a>00869     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ss=1;ss&lt;NSample-2;ss++){
<a name="l00870"></a>00870       <span class="comment">//printf(&quot;Plot[%d][%d]= %lf\n&quot;,s,ss,Plot[s][ss]);</span>
<a name="l00871"></a>00871       glPushMatrix();<span class="comment">//Particle</span>
<a name="l00872"></a>00872       glColor4f(0.,1.,1.,1.);
<a name="l00873"></a>00873       glBegin(GL_TRIANGLES);
<a name="l00874"></a>00874       glNormal3f(0.,0.,1.);
<a name="l00875"></a>00875       glVertex3d((s+.5)*Unity,(ss+.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s,ss)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00876"></a>00876       glVertex3d((s+1.5)*Unity,(ss+.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s+1,ss)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00877"></a>00877       glVertex3d((s+1.5)*Unity,(ss+1.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s+1,ss+1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);      
<a name="l00878"></a>00878       glEnd();
<a name="l00879"></a>00879       glPopMatrix();<span class="comment">//Particle</span>
<a name="l00880"></a>00880       glPushMatrix();<span class="comment">//Particle</span>
<a name="l00881"></a>00881       glColor4f(0.5,.0,0.5,1.);
<a name="l00882"></a>00882       glBegin(GL_TRIANGLES);
<a name="l00883"></a>00883       glNormal3f(0.,0.,1.);
<a name="l00884"></a>00884       glVertex3d((s+.5)*Unity,(ss+.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s,ss)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00885"></a>00885       glVertex3d((s+1.5)*Unity,(ss+1.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s+1,ss+1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00886"></a>00886       glVertex3d((s+.5)*Unity,(ss+1.5)*Unity,Resp-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(s,ss+1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00887"></a>00887       glEnd();
<a name="l00888"></a>00888       glPopMatrix();<span class="comment">//Particle</span>
<a name="l00889"></a>00889     }
<a name="l00890"></a>00890   }
<a name="l00891"></a>00891   <span class="keyword">delete</span> <a class="code" href="classElPoly.html#a52844d3cee2d60eb47889fb021e10fc8" title="Area of a surfuce projected on the coordinate Coord  surf.">Surface</a>;
<a name="l00892"></a>00892   <span class="keyword">delete</span> Resp;
<a name="l00893"></a>00893   glEndList();
<a name="l00894"></a>00894 }
<a name="l00895"></a><a class="code" href="classElPoly.html#a145b3b6aa1385444c9ea75dd93b94111">00895</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a145b3b6aa1385444c9ea75dd93b94111" title="Draws all the same quotes surfaces.">ElPoly::DrIsoipse</a>(<span class="keywordtype">int</span> Values,<span class="keywordtype">int</span> NIsoipse,<span class="keywordtype">int</span> CoordN){
<a name="l00896"></a>00896   <span class="keywordflow">if</span>(CoordN &lt; 0 || CoordN &gt; 3) <span class="keywordflow">return</span>;
<a name="l00897"></a>00897   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00898"></a>00898   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00899"></a>00899   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00900"></a>00900   <span class="keywordtype">double</span> InvIsoipse = 1./(double)NIsoipse;
<a name="l00901"></a>00901   <span class="keywordtype">int</span> Coord1 = (CoordN+1)%3;
<a name="l00902"></a>00902   <span class="keywordtype">int</span> Coord2 = (CoordN+2)%3;
<a name="l00903"></a>00903   <span class="keywordtype">int</span> *Plot = (<span class="keywordtype">int</span> *) calloc(Values*Values*NIsoipse,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00904"></a>00904   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00905"></a>00905     <span class="keywordtype">int</span> v = (int) (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Coord1)*NIsoipse/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(Coord1));
<a name="l00906"></a>00906     <span class="keywordflow">if</span>( v &lt; 0 || v &gt; Values) <span class="keywordflow">continue</span>;
<a name="l00907"></a>00907     <span class="keywordtype">int</span> vv = (int) (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Coord2)*NIsoipse/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(Coord2));
<a name="l00908"></a>00908     <span class="keywordflow">if</span>( vv &lt; 0 || vv &gt; Values) <span class="keywordflow">continue</span>;
<a name="l00909"></a>00909     <span class="keywordtype">int</span> i = (int) (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,CoordN)*NIsoipse/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(CoordN));
<a name="l00910"></a>00910     <span class="keywordflow">if</span>( i &lt; 0 || i &gt; NIsoipse) <span class="keywordflow">continue</span>;
<a name="l00911"></a>00911     Plot[(v*Values + vv)*NIsoipse + i] = p;
<a name="l00912"></a>00912   }
<a name="l00913"></a>00913   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NIsoipse;i++){
<a name="l00914"></a>00914     glBegin(GL_POLYGON);
<a name="l00915"></a>00915     glNormal3f(0.,0.,1.);
<a name="l00916"></a>00916     <span class="keywordtype">double</span> Zed = i*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(CoordN)*InvIsoipse*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00917"></a>00917     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00918"></a>00918       <span class="keywordtype">int</span> v = (int) (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,CoordN)*NIsoipse/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(CoordN));
<a name="l00919"></a>00919       <span class="keywordflow">if</span>( v != i) <span class="keywordflow">continue</span>;
<a name="l00920"></a>00920       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values-1;v++){
<a name="l00921"></a>00921    <span class="keywordtype">int</span> pMin = 0;
<a name="l00922"></a>00922    <span class="keywordtype">int</span> pMax = 0;
<a name="l00923"></a>00923    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vv=0;vv&lt;Values;vv++){
<a name="l00924"></a>00924      <span class="keywordflow">if</span>(Plot[(v*Values+vv)*NIsoipse+i] == 0 &amp;&amp; Plot[(v*Values+vv+1)*NIsoipse+i] != 0) 
<a name="l00925"></a>00925        pMin = Plot[(v*Values+vv+1)*NIsoipse+i];
<a name="l00926"></a>00926      <span class="keywordflow">if</span>(Plot[(v*Values+vv)*NIsoipse+i] != 0 &amp;&amp; Plot[(v*Values+vv+1)*NIsoipse+i] == 0){
<a name="l00927"></a>00927        pMax = Plot[(v*Values+vv)*NIsoipse+i];
<a name="l00928"></a>00928        <span class="keywordflow">break</span>;
<a name="l00929"></a>00929      }
<a name="l00930"></a>00930    }
<a name="l00931"></a>00931    glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pMin,Coord1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pMin,Coord2)*InvScaleUn,Zed);
<a name="l00932"></a>00932    glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pMax,Coord1)*InvScaleUn,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pMax,Coord2)*InvScaleUn,Zed);
<a name="l00933"></a>00933       }
<a name="l00934"></a>00934       glEnd();
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936   }
<a name="l00937"></a>00937   free(Plot);
<a name="l00938"></a>00938   glEndList();
<a name="l00939"></a>00939 }
<a name="l00940"></a><a class="code" href="classElPoly.html#af1718b93c06170aa9002bdbd0dc15bdd">00940</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#af1718b93c06170aa9002bdbd0dc15bdd" title="Draw the outer shell.">ElPoly::DrShell</a>(){
<a name="l00941"></a>00941   <span class="keywordtype">int</span> NSample = 40;
<a name="l00942"></a>00942   <a class="code" href="structPART.html" title="Information of every particle.">PART</a> *Pn = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(NSample*NSample,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00943"></a>00943 }
<a name="l00944"></a><a class="code" href="classElPoly.html#a5214a3da3e41c63d5c0d36e020ed295c">00944</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a5214a3da3e41c63d5c0d36e020ed295c" title="Voronoi tassellation.">ElPoly::DrVoronoi</a>(){
<a name="l00945"></a>00945   <span class="keywordtype">int</span> NDim = 2;
<a name="l00946"></a>00946   <span class="keywordtype">int</span> NCell = <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();
<a name="l00947"></a>00947   <span class="keywordtype">int</span> Batch = 1000;
<a name="l00948"></a>00948   <span class="keywordtype">int</span> DontCreate = 4;
<a name="l00949"></a>00949   <span class="keywordtype">int</span> SampleType = 1;<span class="comment">//Halton</span>
<a name="l00950"></a>00950   <span class="keywordtype">int</span> NSample = 1000;
<a name="l00951"></a>00951   <span class="keywordtype">int</span> NItMax = 4;
<a name="l00952"></a>00952   <span class="keywordtype">int</span> NItFix = 1;
<a name="l00953"></a>00953   <span class="keywordtype">int</span> Seme = 4532643;
<a name="l00954"></a>00954   <span class="keywordtype">int</span> NIt = 0;
<a name="l00955"></a>00955   <span class="keywordtype">double</span> ItDiff = 0.;
<a name="l00956"></a>00956   <span class="keywordtype">double</span> Energy = 0.;
<a name="l00957"></a>00957   <span class="keywordtype">double</span> *Pos = (<span class="keywordtype">double</span> *)calloc(NCell*NDim,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00958"></a>00958   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NCell;c++){
<a name="l00959"></a>00959     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;NDim;d++){
<a name="l00960"></a>00960       Pos[c*NDim+d] = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[d];
<a name="l00961"></a>00961     }
<a name="l00962"></a>00962   }
<a name="l00963"></a>00963   <span class="comment">//cvt(NDim,NCell,Batch,DontCreate,SampleType,NSample,NItMax,NItFix,&amp;Seme,Pos,&amp;NIt,&amp;ItDiff,&amp;Energy);  </span>
<a name="l00964"></a>00964   Hexagon = Dr-&gt;<a class="code" href="classDraw.html#a57d5c994950e11fb7e58680393213343" title="Hexagon.">DefHexagon</a>();
<a name="l00965"></a>00965   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00966"></a>00966   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00967"></a>00967   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00968"></a>00968   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NCell;c++){
<a name="l00969"></a>00969     glPushMatrix();
<a name="l00970"></a>00970     glColor4f(.2,.5,.3,1.);
<a name="l00971"></a>00971     glBegin(GL_POINTS);
<a name="l00972"></a>00972     glNormal3f(0.,0.,1.);
<a name="l00973"></a>00973     glVertex3d(Pos[c*NDim+0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l00974"></a>00974           Pos[c*NDim+1]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00975"></a>00975     glEnd();
<a name="l00976"></a>00976     <span class="comment">//glCallList(Hexagon);</span>
<a name="l00977"></a>00977     glPopMatrix();
<a name="l00978"></a>00978     glColor4f(.8,.2,.5,1.);
<a name="l00979"></a>00979     glPushMatrix();
<a name="l00980"></a>00980     glTranslated(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l00981"></a>00981              <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[1]*InvScaleUn,.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)*InvScaleUn);
<a name="l00982"></a>00982     glCallList(Hexagon);
<a name="l00983"></a>00983     glPopMatrix();
<a name="l00984"></a>00984   }
<a name="l00985"></a>00985   glEndList();
<a name="l00986"></a>00986 }
<a name="l00987"></a><a class="code" href="classElPoly.html#a892423f6e9f004d290645c0aefa7caee">00987</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a892423f6e9f004d290645c0aefa7caee" title="Draws the surface like a sheet using the chains position.">ElPoly::DrSurface</a>(){
<a name="l00988"></a>00988   <a class="code" href="classElPoly.html#a5214a3da3e41c63d5c0d36e020ed295c" title="Voronoi tassellation.">DrVoronoi</a>();
<a name="l00989"></a>00989   <span class="keywordtype">int</span> Vertex = 6;
<a name="l00990"></a>00990   <span class="keywordtype">int</span> **Triangle = (<span class="keywordtype">int</span> **)calloc(Vertex+1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00991"></a>00991   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Vertex+1;v++){
<a name="l00992"></a>00992     *(Triangle+v) = (<span class="keywordtype">int</span> *)calloc(<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>(),<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00993"></a>00993   }
<a name="l00994"></a>00994   <span class="comment">//Arrange(Triangle,Vertex);</span>
<a name="l00995"></a>00995   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00996"></a>00996   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00997"></a>00997   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00998"></a>00998   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00999"></a>00999     <span class="keywordtype">int</span> Chc = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a>;
<a name="l01000"></a>01000     <span class="keywordflow">if</span>(!CHAIN_IF_TYPE(Chc,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>)) <span class="keywordflow">continue</span>;
<a name="l01001"></a>01001     <span class="comment">// glBegin(GL_POLYGON);</span>
<a name="l01002"></a>01002     <span class="keywordtype">int</span> l = Triangle[Vertex-1][c];
<a name="l01003"></a>01003     <span class="keywordtype">int</span> l1 = Triangle[0][c];
<a name="l01004"></a>01004     glPushMatrix();<span class="comment">//Particle</span>
<a name="l01005"></a>01005     <span class="comment">// double PosX1 = .333*(Ch[l].Pos[0]+Ch[c].Pos[0]+Ch[l1].Pos[0])*InvScaleUn;</span>
<a name="l01006"></a>01006     <span class="comment">// double PosY1 = .333*(Ch[l].Pos[1]+Ch[c].Pos[1]+Ch[l1].Pos[1])*InvScaleUn;</span>
<a name="l01007"></a>01007     <span class="comment">// double PosZ1 = .333*(Ch[l].Pos[2]+Ch[c].Pos[2]+Ch[l1].Pos[2])*InvScaleUn;</span>
<a name="l01008"></a>01008     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Vertex;v++){
<a name="l01009"></a>01009       l = Triangle[v][c];
<a name="l01010"></a>01010       <span class="keywordflow">if</span>(v&lt;Vertex-1) l1 = Triangle[v+1][c];
<a name="l01011"></a>01011       <span class="keywordflow">else</span> l1 = Triangle[0][c];
<a name="l01012"></a>01012       <span class="comment">// double PosX = .333*(Ch[l].Pos[0]+Ch[c].Pos[0]+Ch[l1].Pos[0])*InvScaleUn;</span>
<a name="l01013"></a>01013       <span class="comment">// double PosY = .333*(Ch[l].Pos[1]+Ch[c].Pos[1]+Ch[l1].Pos[1])*InvScaleUn;</span>
<a name="l01014"></a>01014       <span class="comment">// double PosZ = .333*(Ch[l].Pos[2]+Ch[c].Pos[2]+Ch[l1].Pos[2])*InvScaleUn;</span>
<a name="l01015"></a>01015       <span class="keywordtype">double</span> Shift[3] = {0.,0.,0.};
<a name="l01016"></a>01016       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) Shift[d] = -floor((<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[d]-<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[l].Pos[d])/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l01017"></a>01017       glPushMatrix();<span class="comment">//Line</span>
<a name="l01018"></a>01018       glBegin(GL_LINES);
<a name="l01019"></a>01019       glNormal3f(0.,0.,1.);
<a name="l01020"></a>01020       glVertex3f(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[1]*InvScaleUn,<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l01021"></a>01021       glVertex3f((<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[l].Pos[0]-Shift[0])*InvScaleUn,(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[l].Pos[1]-Shift[1])*InvScaleUn,(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[l].Pos[2]-Shift[2])*InvScaleUn*ScaleFact);
<a name="l01022"></a>01022       glEnd();
<a name="l01023"></a>01023       <span class="comment">//PosX1 = PosX;PosY1=PosY;PosZ1=PosZ;</span>
<a name="l01024"></a>01024       glPopMatrix();<span class="comment">//Line</span>
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026     <span class="comment">//    printf(&quot;\n&quot;);</span>
<a name="l01027"></a>01027     <span class="comment">//    printf(&quot;(%lf %lf %lf) \n&quot;,Ch[c].Pos[0],Ch[c].Pos[1],Ch[c].Pos[2]);    </span>
<a name="l01028"></a>01028     glColor4f(1.,1.,0.,1.);
<a name="l01029"></a>01029     <span class="comment">//glEnd();</span>
<a name="l01030"></a>01030     glPopMatrix();<span class="comment">//Particle</span>
<a name="l01031"></a>01031     glPushMatrix();
<a name="l01032"></a>01032     glTranslated(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l01033"></a>01033        <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[1]*InvScaleUn,
<a name="l01034"></a>01034        <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l01035"></a>01035     glColor4f(1.,0.,0.,1.);
<a name="l01036"></a>01036     glCallList(Point);
<a name="l01037"></a>01037     <span class="comment">//    glutSolidSphere(.05,20,20);</span>
<a name="l01038"></a>01038     glPopMatrix();    
<a name="l01039"></a>01039     glPushMatrix();<span class="comment">//Info</span>
<a name="l01040"></a>01040     glColor3f(1.0,1.0,1.0);
<a name="l01041"></a>01041     <span class="comment">//    glTranslated(Ch[c].Pos[0]*InvScaleUn,Ch[c].Pos[1]*InvScaleUn,Ch[c].Pos[2]*InvScaleUn);</span>
<a name="l01042"></a>01042     glRasterPos3f(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[0]*InvScaleUn,
<a name="l01043"></a>01043         <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[1]*InvScaleUn,
<a name="l01044"></a>01044         <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[2]*InvScaleUn*ScaleFact);
<a name="l01045"></a>01045     <span class="keywordtype">char</span> *Numero = (<span class="keywordtype">char</span>*)calloc(20,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01046"></a>01046     sprintf(Numero,<span class="stringliteral">&quot;%d&quot;</span>,c);<span class="comment">//CalcnPos(Ch[c].Pos));</span>
<a name="l01047"></a>01047     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;strlen(Numero);i++)
<a name="l01048"></a>01048       glutBitmapCharacter(GLUT_BITMAP_TIMES_ROMAN_24,Numero[i]);
<a name="l01049"></a>01049     free(Numero);
<a name="l01050"></a>01050     glPopMatrix();<span class="comment">//Info</span>
<a name="l01051"></a>01051   }
<a name="l01052"></a>01052   glEndList();
<a name="l01053"></a>01053   free(Triangle);
<a name="l01054"></a>01054   <span class="comment">//   GLuint *Surface = (GLuint *)malloc(3*Gen-&gt;NChain*sizeof(GLuint));</span>
<a name="l01055"></a>01055   <span class="comment">//   for(int c=0,cc=0;c&lt;Gen-&gt;NChain;c++){</span>
<a name="l01056"></a>01056   <span class="comment">//     for(int d=0;d&lt;3;d++){</span>
<a name="l01057"></a>01057   <span class="comment">//       Surface[3*c+d] = (GLuint) Ch[c].Pos[d];</span>
<a name="l01058"></a>01058   <span class="comment">//     }</span>
<a name="l01059"></a>01059   <span class="comment">//     printf(&quot;(%u %u %u) (%lf %lf %lf) \n&quot;,Surface[3*c+0],Surface[3*c+1],Surface[3*c+2],Ch[c].Pos[0],Ch[c].Pos[1],Ch[c].Pos[2]);</span>
<a name="l01060"></a>01060   <span class="comment">//   }</span>
<a name="l01061"></a>01061   <span class="comment">//glEnable(GL_VERTEX_ARRAY);</span>
<a name="l01062"></a>01062   <span class="comment">//  glDrawElements(GL_TRIANGLES,Gen-&gt;NChain,GL_UNSIGNED_INT,Surface);</span>
<a name="l01063"></a>01063   <span class="comment">//free(Surface);</span>
<a name="l01064"></a>01064 }
<a name="l01065"></a><a class="code" href="classElPoly.html#a936b5ae489361c88bca90698f6316f27">01065</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a936b5ae489361c88bca90698f6316f27" title="Cover a regular square grid of points with tiles.">ElPoly::Tile</a>(){
<a name="l01066"></a>01066   <span class="keywordtype">double</span> Dx = sqrt(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>)/(<span class="keywordtype">double</span>)<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>());
<a name="l01067"></a>01067   <span class="keywordtype">int</span> NLat1 = (int)(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>)/Dx);
<a name="l01068"></a>01068   <span class="keywordtype">int</span> NLat2 = (int)(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>)/Dx);
<a name="l01069"></a>01069   printf(<span class="stringliteral">&quot;Dx %lf NLat1 %d NLat2 %d %d\n&quot;</span>,Dx,NLat1,NLat2,SQR(NLat1) + SQR(NLat2));
<a name="l01070"></a>01070   <span class="keywordflow">if</span>( NLat1*NLat2 != <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()) <span class="keywordflow">return</span>;
<a name="l01071"></a>01071   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l01072"></a>01072   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l01073"></a>01073   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l01074"></a>01074   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v1(3);
<a name="l01075"></a>01075   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v2(3);
<a name="l01076"></a>01076   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v3(3);
<a name="l01077"></a>01077   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v4(3);
<a name="l01078"></a>01078   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> vN(3);
<a name="l01079"></a>01079   printf(<span class="stringliteral">&quot;Ciccia\n&quot;</span>);
<a name="l01080"></a>01080   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx = 0;nx&lt;NLat1-2;nx+=2){
<a name="l01081"></a>01081     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ny = 0;ny&lt;NLat2-2;ny+=2){
<a name="l01082"></a>01082       <span class="keywordtype">int</span> l1 = nx*NLat2 + ny;
<a name="l01083"></a>01083       <span class="keywordtype">int</span> l2 = nx*NLat2 + ny + 1;
<a name="l01084"></a>01084       <span class="keywordtype">int</span> l3 = (nx+1)*NLat2 + ny + 1;
<a name="l01085"></a>01085       <span class="keywordtype">int</span> l4 = (nx+1)*NLat2 + ny;
<a name="l01086"></a>01086       v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01087"></a>01087       v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01088"></a>01088       v1.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l01089"></a>01089       v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01090"></a>01090       v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01091"></a>01091       v2.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l01092"></a>01092       v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01093"></a>01093       v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01094"></a>01094       v3.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l3,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l01095"></a>01095       v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[0]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l4,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01096"></a>01096       v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[1]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l4,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l01097"></a>01097       v4.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>[2]=<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l4,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l01098"></a>01098       vN.<a class="code" href="classVettore.html#a37c16d330917daaf77a01df8d54d2ffa" title="Computes the normal to the plane described by u,v,w.">NormalSurf</a>(&amp;v1,&amp;v2,&amp;v3);
<a name="l01099"></a>01099       <a class="code" href="classElPoly.html#a4f733cc712ac229489bff59b4b4f8c58" title="Double triangle defined by four vectors.">DrDoubleTria</a>(&amp;v1,&amp;v2,&amp;v3,&amp;v4,&amp;vN);
<a name="l01100"></a>01100     }
<a name="l01101"></a>01101   }
<a name="l01102"></a>01102   glEndList();
<a name="l01103"></a>01103 }
<a name="l01104"></a><a class="code" href="classElPoly.html#ac33065bd12bc1315d48c4fc60acf3e99">01104</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ac33065bd12bc1315d48c4fc60acf3e99" title="Defines the triangles at the boundaries of the density close to the IsoLevel value.">ElPoly::DrIsolevel</a>(<span class="keywordtype">int</span> NSample,<span class="keywordtype">double</span> IsoLevel){
<a name="l01105"></a>01105   NSample = 20;
<a name="l01106"></a>01106   <span class="keywordtype">double</span> VolEl = <a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>()/(double)CUB(NSample);
<a name="l01107"></a>01107   <span class="keywordtype">double</span> *Plot = (<span class="keywordtype">double</span> *)calloc(CUBE(NSample),<span class="keyword">sizeof</span>(double));
<a name="l01108"></a>01108   <span class="keywordtype">double</span> Min = 0.;
<a name="l01109"></a>01109   <span class="keywordtype">double</span> Max = 0.;
<a name="l01110"></a>01110   <a class="code" href="structVAR__TRIANGLE.html" title="Define a triangle.">VAR_TRIANGLE</a> *Tri = NULL;
<a name="l01111"></a>01111   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l01112"></a>01112     <span class="comment">//if(Pm[p].Typ != 1) continue;</span>
<a name="l01113"></a>01113     <span class="keywordtype">double</span> Posx = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0) - floor(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(0))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0);
<a name="l01114"></a>01114     <span class="keywordtype">double</span> Posy = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1) - floor(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(1))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l01115"></a>01115     <span class="keywordtype">double</span> Posz = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2) - floor(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(2))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l01116"></a>01116     <span class="keywordtype">int</span> sx = (int)(Posx*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(0)*NSample);
<a name="l01117"></a>01117     <span class="keywordtype">int</span> sy = (int)(Posy*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(1)*NSample);
<a name="l01118"></a>01118     <span class="keywordtype">int</span> sz = (int)(Posz*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(2)*NSample);
<a name="l01119"></a>01119     <span class="keywordtype">int</span> sTot = (sx*NSample+sy)*NSample+sz;
<a name="l01120"></a>01120     Plot[sTot] += VolEl;
<a name="l01121"></a>01121     <span class="keywordflow">if</span>(Max &lt; Plot[sTot]) Max = Plot[sTot];
<a name="l01122"></a>01122     <span class="keywordflow">if</span>(Min &gt; Plot[sTot]) Min = Plot[sTot];
<a name="l01123"></a>01123   }
<a name="l01124"></a>01124   <span class="comment">//IsoLevel = .1*Max;</span>
<a name="l01125"></a>01125   printf(<span class="stringliteral">&quot;Min %lf Max %lf Isolevel %lf\n&quot;</span>,Min,Max,IsoLevel);
<a name="l01126"></a>01126   <span class="keywordtype">int</span> NTri = 0;
<a name="l01127"></a>01127   Tri = <a class="code" href="classVarData.html#a3bc3dc1509a0daee21e6bdf7e7a39257" title="Defines the triangles close to the IsoLevel of the 3d density Plot.">MarchingCubes</a>(Plot,NSample,IsoLevel,&amp;NTri);
<a name="l01128"></a>01128   free(Plot);
<a name="l01129"></a>01129   <span class="keywordtype">int</span> NVertex = CUBE(2*NSample-1);
<a name="l01130"></a>01130   <span class="keywordtype">double</span> *WeightL = (<span class="keywordtype">double</span> *) calloc(NVertex,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01131"></a>01131   <span class="keywordtype">double</span> MaxW = 1.;
<a name="l01132"></a>01132   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTri;t++){
<a name="l01133"></a>01133     <span class="keywordtype">int</span> vRef = Tri[t].<a class="code" href="structVAR__TRIANGLE.html#adf75f0e81beb91b0ef5de318ab595455" title="Reference for the vectors.">v</a>[0];
<a name="l01134"></a>01134     <span class="comment">//printf(&quot;%d %lf\n&quot;,t,WeightL[vRef]);</span>
<a name="l01135"></a>01135   }
<a name="l01136"></a>01136   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l01137"></a>01137   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l01138"></a>01138   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l01139"></a>01139   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++) <a class="code" href="classElPoly.html#a15254dc837a01412ec79ec26e9019095" title="Pointer to a generic function.">DrawNano</a>(n);
<a name="l01140"></a>01140   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTri;t++){
<a name="l01141"></a>01141     <span class="comment">//if(Tri[t].p[0].x[2]&gt; Nano-&gt;Pos[2] + 3.||Tri[t].p[0].x[2] &lt; Nano-&gt;Pos[2] - 3.) continue;</span>
<a name="l01142"></a>01142     <span class="keywordtype">int</span> vRef = Tri[t].<a class="code" href="structVAR__TRIANGLE.html#adf75f0e81beb91b0ef5de318ab595455" title="Reference for the vectors.">v</a>[0];
<a name="l01143"></a>01143     <span class="keywordtype">double</span> Green = WeightL[vRef]*MaxW + .3 + .4*<a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970" title="Random uniform number.">Casuale</a>();
<a name="l01144"></a>01144     glColor4f(0.1,Green,0.2,1.);
<a name="l01145"></a>01145     <span class="comment">//glColor4f(HueUp[p].r,HueUp[p].g,HueUp[p].b,HueUp[p].a);</span>
<a name="l01146"></a>01146     glBegin(GL_TRIANGLES);
<a name="l01147"></a>01147     glNormal3f(Tri[t].n[0].x[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l01148"></a>01148              Tri[t].n[0].x[1]*InvScaleUn,
<a name="l01149"></a>01149              Tri[t].n[0].x[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l01150"></a>01150     glVertex3f(Tri[t].p[0].x[0]*InvScaleUn,
<a name="l01151"></a>01151              Tri[t].p[0].x[1]*InvScaleUn,
<a name="l01152"></a>01152              Tri[t].p[0].x[2]*InvScaleUn*ScaleFact);
<a name="l01153"></a>01153     glNormal3f(Tri[t].n[1].x[0]*InvScaleUn,
<a name="l01154"></a>01154              Tri[t].n[1].x[1]*InvScaleUn,
<a name="l01155"></a>01155              Tri[t].n[1].x[2]*InvScaleUn*ScaleFact);
<a name="l01156"></a>01156     glVertex3f(Tri[t].p[1].x[0]*InvScaleUn,
<a name="l01157"></a>01157              Tri[t].p[1].x[1]*InvScaleUn,
<a name="l01158"></a>01158              Tri[t].p[1].x[2]*InvScaleUn*ScaleFact);
<a name="l01159"></a>01159     glNormal3f(Tri[t].n[2].x[0]*InvScaleUn,
<a name="l01160"></a>01160              Tri[t].n[2].x[1]*InvScaleUn,
<a name="l01161"></a>01161              Tri[t].n[2].x[2]*InvScaleUn*ScaleFact);
<a name="l01162"></a>01162     glVertex3f(Tri[t].p[2].x[0]*InvScaleUn,
<a name="l01163"></a>01163              Tri[t].p[2].x[1]*InvScaleUn,
<a name="l01164"></a>01164              Tri[t].p[2].x[2]*InvScaleUn*ScaleFact);
<a name="l01165"></a>01165     glEnd();
<a name="l01166"></a>01166     <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a>){
<a name="l01167"></a>01167       glColor4f(0.1,.3,1.,1.);
<a name="l01168"></a>01168       glBegin(GL_LINES);
<a name="l01169"></a>01169       glVertex3d(Tri[t].c.x[0]*InvScaleUn,
<a name="l01170"></a>01170        Tri[t].<a class="code" href="structVAR__TRIANGLE.html#ae93aa7b3bc74295f6f1118a6b0a0e804" title="Centroid.">c</a>.<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[1]*InvScaleUn,
<a name="l01171"></a>01171        Tri[t].<a class="code" href="structVAR__TRIANGLE.html#ae93aa7b3bc74295f6f1118a6b0a0e804" title="Centroid.">c</a>.<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[2]*InvScaleUn*ScaleFact);
<a name="l01172"></a>01172       glVertex3d((Tri[t].c.x[0]+Tri[t].<a class="code" href="structVAR__TRIANGLE.html#a1db8f1be3299f0c5f218cf0142c6c687" title="Normal to the vertices.">n</a>[0].<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[0])*InvScaleUn,
<a name="l01173"></a>01173        (Tri[t].<a class="code" href="structVAR__TRIANGLE.html#ae93aa7b3bc74295f6f1118a6b0a0e804" title="Centroid.">c</a>.<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[1]+Tri[t].<a class="code" href="structVAR__TRIANGLE.html#a1db8f1be3299f0c5f218cf0142c6c687" title="Normal to the vertices.">n</a>[0].<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[1])*InvScaleUn,
<a name="l01174"></a>01174        (Tri[t].<a class="code" href="structVAR__TRIANGLE.html#ae93aa7b3bc74295f6f1118a6b0a0e804" title="Centroid.">c</a>.<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[2]+Tri[t].<a class="code" href="structVAR__TRIANGLE.html#a1db8f1be3299f0c5f218cf0142c6c687" title="Normal to the vertices.">n</a>[0].<a class="code" href="structXYZ.html#a8639a6dd4fb3c4aa452b708733d827b4" title="Cartesian coordinates.">x</a>[2])*InvScaleUn*ScaleFact);
<a name="l01175"></a>01175       glEnd();
<a name="l01176"></a>01176     }
<a name="l01177"></a>01177   }
<a name="l01178"></a>01178   glEndList();
<a name="l01179"></a>01179   free(WeightL);
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 <span class="preprocessor">#endif //USE_GL</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:18 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
