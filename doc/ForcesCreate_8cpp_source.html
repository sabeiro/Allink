<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/Addyn/ForcesCreate.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_9eb7b934b0b571f03e95a80abda3221c.html">Addyn</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ForcesCreate.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;Forces.h&quot;</span>
<a name="l00002"></a><a class="code" href="classForces.html#ab18de8ad228c4133d61e09f94ef4b33f">00002</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#ab18de8ad228c4133d61e09f94ef4b33f" title="Create an initial configuration and an appropriate force field.">Forces::CreateInitial</a>(){
<a name="l00003"></a>00003   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_1D)){
<a name="l00004"></a>00004     <a class="code" href="classForces.html#a150658611a20b7185df56cc52412bc3f" title="Create single line of connected monomers.">Create1d</a>();
<a name="l00005"></a>00005   }
<a name="l00006"></a>00006   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D)){
<a name="l00007"></a>00007     <a class="code" href="classForces.html#a9e66d18b6b637a388161c4310deb71e9" title="Create a plane of connected beads.">Create2d</a>();
<a name="l00008"></a>00008   }
<a name="l00009"></a>00009   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_3D)){
<a name="l00010"></a>00010     <a class="code" href="classForces.html#a71fdb49e2a01e439097a4cde373b639f" title="Create a lattice of connected beads.">Create3d</a>();
<a name="l00011"></a>00011   }
<a name="l00012"></a>00012   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_STALK)){
<a name="l00013"></a>00013     <a class="code" href="classForces.html#afea6ddedbed181a50906556f6075257f" title="Create the 1d representation of a stalk.">CreateStalk</a>();
<a name="l00014"></a>00014   }
<a name="l00015"></a>00015   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)){
<a name="l00016"></a>00016     <a class="code" href="classForces.html#ada62abd7228e54fbd365aba5aaf4ce8f" title="Create two connected sheets and add a protein.">CreateLeaves</a>();
<a name="l00017"></a>00017   }
<a name="l00018"></a>00018   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_PORE)){
<a name="l00019"></a>00019     <a class="code" href="classForces.html#a20cdf4594381226c7b142df535f41893" title="Create the 1d representation of a pore.">CreatePore</a>();
<a name="l00020"></a>00020   }
<a name="l00021"></a>00021   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00022"></a>00022     <a class="code" href="classForces.html#ae3378b62462d086cb39724e03074fb97" title="Create a initial disposition of particle for a stiff rod.">CreateRod</a>();
<a name="l00023"></a>00023   }
<a name="l00024"></a>00024   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_RIGID)){
<a name="l00025"></a>00025     <a class="code" href="classForces.html#a655ba1e4004f501b750638d781f45c82" title="Create rigid bodies.">CreateRigid</a>();
<a name="l00026"></a>00026   }
<a name="l00027"></a>00027   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD)){
<a name="l00028"></a>00028     <a class="code" href="classForces.html#a344629f905b1cbbcb311a4d3e6ff8818" title="Create a initial disposition of particle for the MD sim.">CreateMD</a>();
<a name="l00029"></a>00029   }
<a name="l00030"></a>00030   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC)){
<a name="l00031"></a>00031     <a class="code" href="classForces.html#a3f01e349d6a138fb20f9caa406c0d561" title="Create a initial disposition of particle for the MC sim.">CreateMC</a>();
<a name="l00032"></a>00032   }
<a name="l00033"></a>00033   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO)){
<a name="l00034"></a>00034     <a class="code" href="classForces.html#a6ef0b763f3b80142cda476d73e2753a5" title="Create a initial disposition of houses to collect on a line.">CreateElectro</a>();
<a name="l00035"></a>00035   }
<a name="l00036"></a>00036   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_TRIAL)){
<a name="l00037"></a>00037     <span class="keywordtype">int</span> NSect = 3;
<a name="l00038"></a>00038     <span class="keywordtype">double</span> Pos[3];
<a name="l00039"></a>00039     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00040"></a>00040       Pos[d] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)/(double)NSect;
<a name="l00041"></a>00041     }
<a name="l00042"></a>00042     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00043"></a>00043       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00044"></a>00044    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = Pos[d];
<a name="l00045"></a>00045       }
<a name="l00046"></a>00046       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00047"></a>00047       Pos[0] += <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)NSect;
<a name="l00048"></a>00048       <span class="keywordflow">if</span>(Pos[0] &gt; <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)){
<a name="l00049"></a>00049    Pos[0] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)NSect;
<a name="l00050"></a>00050    Pos[1] += <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)NSect;
<a name="l00051"></a>00051    <span class="keywordflow">if</span>(Pos[1] &gt; <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)){
<a name="l00052"></a>00052      Pos[1] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)NSect;
<a name="l00053"></a>00053      Pos[2] += <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)NSect;
<a name="l00054"></a>00054    }
<a name="l00055"></a>00055       }
<a name="l00056"></a>00056     }
<a name="l00057"></a>00057     <span class="comment">// Pm[0].Pos[0] = .1;Pm[0].Pos[1] = .5;Pm[0].Pos[2]= .5;</span>
<a name="l00058"></a>00058     <span class="comment">// Pm[1].Pos[0] = .2;Pm[1].Pos[1] = .6;Pm[1].Pos[2]= .7;</span>
<a name="l00059"></a>00059     <span class="comment">// Pm[2].Pos[0] = .3;Pm[2].Pos[1] = .9;Pm[2].Pos[2]= .2;</span>
<a name="l00060"></a>00060     <span class="comment">// Pm[3].Pos[0] = .4;Pm[3].Pos[1] = .3;Pm[3].Pos[2]= .5;</span>
<a name="l00061"></a>00061     <span class="comment">// Pm[4].Pos[0] = .5;Pm[4].Pos[1] = .4;Pm[4].Pos[2]= .6;</span>
<a name="l00062"></a>00062   }
<a name="l00063"></a>00063   <span class="keywordflow">else</span>{
<a name="l00064"></a>00064     printf(<span class="stringliteral">&quot;System shape not recognized %d\n&quot;</span>,<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>);
<a name="l00065"></a>00065     return ;
<a name="l00066"></a>00066   }
<a name="l00067"></a>00067   <a class="code" href="classForces.html#aca306e88f54f775febb7f1643d963416" title="Old part to move.">Old2Move</a> = <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>;
<a name="l00068"></a>00068   VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_SYS_TXVL);
<a name="l00069"></a>00069   VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_EDGE);
<a name="l00070"></a>00070 }
<a name="l00071"></a><a class="code" href="classForces.html#a9e66d18b6b637a388161c4310deb71e9">00071</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a9e66d18b6b637a388161c4310deb71e9" title="Create a plane of connected beads.">Forces::Create2d</a>(){
<a name="l00072"></a>00072   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]);
<a name="l00073"></a>00073   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1]);
<a name="l00074"></a>00074   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> px=0;px&lt;<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0];px++){
<a name="l00075"></a>00075     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> py=0;py&lt;nEdge[1];py++){
<a name="l00076"></a>00076       <span class="keywordtype">int</span> p = px*nEdge[1]+py;
<a name="l00077"></a>00077       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00078"></a>00078       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(double)px + .5*Dx;
<a name="l00079"></a>00079       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = Dy*(double)py + .5*Dy;
<a name="l00080"></a>00080       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = 0.;
<a name="l00081"></a>00081       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = py;
<a name="l00082"></a>00082       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00083"></a>00083       <span class="keywordflow">if</span>(px == 0 &amp;&amp; BoundCond[0]){
<a name="l00084"></a>00084          <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00085"></a>00085       }
<a name="l00086"></a>00086       <span class="keywordflow">if</span>(px == nEdge[0]-1 &amp;&amp; BoundCond[1]){
<a name="l00087"></a>00087          <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00088"></a>00088       }
<a name="l00089"></a>00089       <span class="keywordflow">if</span>(py == 0 &amp;&amp; BoundCond[2]){
<a name="l00090"></a>00090          <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00091"></a>00091       }
<a name="l00092"></a>00092       <span class="keywordflow">if</span>(py == nEdge[1]-1 &amp;&amp; BoundCond[3]){
<a name="l00093"></a>00093          <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00094"></a>00094       }
<a name="l00095"></a>00095       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 4;
<a name="l00096"></a>00096       <span class="keywordtype">int</span> pym1 = p-1;
<a name="l00097"></a>00097       <span class="keywordflow">if</span>( py-1 &lt; 0 ) pym1 += nEdge[1];
<a name="l00098"></a>00098       <span class="keywordflow">if</span>(pym1 &gt;= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>() ) pym1 -= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00099"></a>00099       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = pym1;
<a name="l00100"></a>00100       <span class="keywordtype">int</span> pyp1 = p+1;
<a name="l00101"></a>00101       <span class="keywordflow">if</span>( py+1 &gt;= nEdge[1]) pyp1 -= nEdge[1];
<a name="l00102"></a>00102       <span class="keywordflow">if</span>(pyp1 &lt; 0) pyp1 += <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00103"></a>00103       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = pyp1;
<a name="l00104"></a>00104       <span class="keywordtype">int</span> pxm1 = p-nEdge[1];
<a name="l00105"></a>00105       <span class="keywordflow">if</span>(pxm1 &lt; 0) pxm1 += <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00106"></a>00106       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2] = pxm1;
<a name="l00107"></a>00107       <span class="keywordtype">int</span> pxp1 = p+nEdge[1];
<a name="l00108"></a>00108       <span class="keywordflow">if</span>(pxp1 &gt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1) pxp1 -= <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00109"></a>00109       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[3] = pxp1;
<a name="l00110"></a>00110       <span class="comment">//printf(&quot;%d) %d %d %d %d \n&quot;,p,Ln[p].Link[0],Ln[p].Link[1],Ln[p].Link[2],Ln[p].Link[3]);</span>
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113   <span class="comment">//Ln[0].Link[0] = nEdge[0]-1;</span>
<a name="l00114"></a>00114   <a class="code" href="classForces.html#adee9a7de583494983844ed4378f51df4" title="Add all rigid bodies as a boundary condition.">AddRigid</a>();
<a name="l00115"></a>00115 }
<a name="l00116"></a><a class="code" href="classForces.html#a71fdb49e2a01e439097a4cde373b639f">00116</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a71fdb49e2a01e439097a4cde373b639f" title="Create a lattice of connected beads.">Forces::Create3d</a>(){
<a name="l00117"></a>00117   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00118"></a>00118   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00119"></a>00119   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00120"></a>00120   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[1] = <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a>;
<a name="l00121"></a>00121   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2] = Dy;
<a name="l00122"></a>00122   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = Dz;
<a name="l00123"></a>00123   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[0] = 11.;<span class="comment">//Elastic coupling</span>
<a name="l00124"></a>00124   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[1] = 11.;<span class="comment">//Elastic coupling</span>
<a name="l00125"></a>00125   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[2] = 11.;<span class="comment">//Elastic coupling</span>
<a name="l00126"></a>00126   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> px=0,ppp=0;px&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;px++){
<a name="l00127"></a>00127     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> py=0;py&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;py++){
<a name="l00128"></a>00128       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> pz=0;pz&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;pz++){
<a name="l00129"></a>00129    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[ppp].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = ppp;
<a name="l00130"></a>00130    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[ppp].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(double)px;
<a name="l00131"></a>00131    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[ppp].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = Dy*(double)py;<span class="comment">//Mate-&gt;Casuale();//Dy*(double)p;</span>
<a name="l00132"></a>00132    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[ppp].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = Dz*(double)pz;<span class="comment">//Mate-&gt;Casuale();</span>
<a name="l00133"></a>00133    <span class="comment">//     if( p == 20)</span>
<a name="l00134"></a>00134    <span class="comment">//       Pm[p].Pos[2] = .01;</span>
<a name="l00135"></a>00135    <span class="keywordtype">int</span> link = 0;
<a name="l00136"></a>00136    <span class="keywordflow">if</span>(pz != NEdge-1){      
<a name="l00137"></a>00137      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp+1;
<a name="l00138"></a>00138      link++;
<a name="l00139"></a>00139    }
<a name="l00140"></a>00140    <span class="keywordflow">if</span>(pz != 0){
<a name="l00141"></a>00141      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp-1;
<a name="l00142"></a>00142      link++;
<a name="l00143"></a>00143    }
<a name="l00144"></a>00144    <span class="keywordflow">if</span>(py != 0){
<a name="l00145"></a>00145      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp-<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00146"></a>00146      link++;
<a name="l00147"></a>00147    }
<a name="l00148"></a>00148    <span class="keywordflow">if</span>(py != NEdge-1){
<a name="l00149"></a>00149      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp+<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00150"></a>00150      link++;
<a name="l00151"></a>00151    }
<a name="l00152"></a>00152    <span class="keywordflow">if</span>(px != 0){
<a name="l00153"></a>00153      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp-NEdge*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00154"></a>00154      link++;
<a name="l00155"></a>00155    }
<a name="l00156"></a>00156    <span class="keywordflow">if</span>(px != NEdge-1){
<a name="l00157"></a>00157      <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = ppp+NEdge*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00158"></a>00158      link++;
<a name="l00159"></a>00159    }
<a name="l00160"></a>00160    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[ppp].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = link;
<a name="l00161"></a>00161    <span class="keywordflow">if</span>( (px == 0 || px == NEdge -1) &amp;&amp;
<a name="l00162"></a>00162        (py == 0 || py == NEdge -1) &amp;&amp;
<a name="l00163"></a>00163        (pz == 0 || pz == NEdge -1))
<a name="l00164"></a>00164      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[ppp].Typ = 2;
<a name="l00165"></a>00165    <span class="comment">//for(int l=0;l&lt;Ln[ppp].NLink;l++)</span>
<a name="l00166"></a>00166      <span class="comment">//printf(&quot;%d %d %lf %lf %lf\n&quot;,ppp,Pm[ppp].Link[l],Pm[ppp].Pos[0] - Pm[Pm[ppp].Link[l]].Pos[0],Pm[ppp].Pos[1] - Pm[Pm[ppp].Link[l]].Pos[1],Pm[ppp].Pos[2] - Pm[Pm[ppp].Link[l]].Pos[2]);</span>
<a name="l00167"></a>00167    ppp++;
<a name="l00168"></a>00168       }
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170   }
<a name="l00171"></a>00171 }
<a name="l00172"></a><a class="code" href="classForces.html#ada62abd7228e54fbd365aba5aaf4ce8f">00172</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#ada62abd7228e54fbd365aba5aaf4ce8f" title="Create two connected sheets and add a protein.">Forces::CreateLeaves</a>(){
<a name="l00173"></a>00173   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00174"></a>00174   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00175"></a>00175   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00176"></a>00176   <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a> = 0;
<a name="l00177"></a>00177   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p++){
<a name="l00178"></a>00178     <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a>;
<a name="l00179"></a>00179     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00180"></a>00180     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*p;
<a name="l00181"></a>00181     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l00182"></a>00182     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];
<a name="l00183"></a>00183     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = 0;
<a name="l00184"></a>00184     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;    
<a name="l00185"></a>00185     <span class="keywordflow">if</span>(p == <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>) <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00186"></a>00186     <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 2;
<a name="l00187"></a>00187     <span class="keywordflow">if</span>(p == 0){
<a name="l00188"></a>00188       <span class="keywordflow">if</span>(BoundCond[0])
<a name="l00189"></a>00189    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = NEdge-1;
<a name="l00190"></a>00190       <span class="keywordflow">else</span>
<a name="l00191"></a>00191    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 1;
<a name="l00192"></a>00192       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194     <span class="keywordflow">else</span>
<a name="l00195"></a>00195       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p-1;
<a name="l00196"></a>00196     <span class="keywordflow">if</span>(p == NEdge-1){
<a name="l00197"></a>00197       <span class="keywordflow">if</span>(BoundCond[1])
<a name="l00198"></a>00198    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = 0;
<a name="l00199"></a>00199       <span class="keywordflow">else</span>
<a name="l00200"></a>00200    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 1;
<a name="l00201"></a>00201       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203     <span class="keywordflow">else</span>
<a name="l00204"></a>00204       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = p+1;
<a name="l00205"></a>00205   }
<a name="l00206"></a>00206   <a class="code" href="classForces.html#adee9a7de583494983844ed4378f51df4" title="Add all rigid bodies as a boundary condition.">AddRigid</a>();
<a name="l00207"></a>00207 }
<a name="l00208"></a><a class="code" href="classForces.html#ae3378b62462d086cb39724e03074fb97">00208</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#ae3378b62462d086cb39724e03074fb97" title="Create a initial disposition of particle for a stiff rod.">Forces::CreateRod</a>(){
<a name="l00209"></a>00209   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00210"></a>00210   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00211"></a>00211   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00212"></a>00212   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p++){
<a name="l00213"></a>00213     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00214"></a>00214     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = p*Dx*.5;
<a name="l00215"></a>00215     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l00216"></a>00216     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00217"></a>00217     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = 0;
<a name="l00218"></a>00218     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00219"></a>00219     <span class="keywordflow">if</span>(p &lt; NEdge-1){
<a name="l00220"></a>00220       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 1;
<a name="l00221"></a>00221       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p+1;
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223   }
<a name="l00224"></a>00224   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;2;p++){
<a name="l00225"></a>00225     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227   <span class="comment">//SetkSpr(0.);</span>
<a name="l00228"></a>00228   <a class="code" href="classVarData.html#a8b0df96451468c9ee33e780d2415d41b" title="Bending coupling.">SetkBen</a>(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309" title="Prefactor of the square laplacian.">SLap</a>);
<a name="l00229"></a>00229   <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a> = NEdge - 1;
<a name="l00230"></a>00230   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00231"></a>00231   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>-1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00232"></a>00232 }
<a name="l00233"></a><a class="code" href="classForces.html#a20cdf4594381226c7b142df535f41893">00233</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a20cdf4594381226c7b142df535f41893" title="Create the 1d representation of a pore.">Forces::CreatePore</a>(){
<a name="l00234"></a>00234   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00235"></a>00235   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00236"></a>00236   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00237"></a>00237   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a>;
<a name="l00238"></a>00238   <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a> = 0;
<a name="l00239"></a>00239   <span class="keywordtype">int</span> NSegment = (int)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>/6.);
<a name="l00240"></a>00240   <span class="keywordtype">double</span> AngleS = .25*DUE_PI/(double)NSegment;
<a name="l00241"></a>00241   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00242"></a>00242     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>*(c+1);p++){
<a name="l00243"></a>00243       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(double)(p-c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00244"></a>00244       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l00245"></a>00245       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(c-.5)+.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00246"></a>00246       <span class="keywordflow">if</span>(p &gt;= c*NEdge + 2*NSegment &amp;&amp; p &lt;= c*NEdge + 4*NSegment){
<a name="l00247"></a>00247    <span class="comment">//double pa = (double)(p-c*NEdge + 4*NSegment);</span>
<a name="l00248"></a>00248    <span class="keywordtype">double</span> pa = (double)(p-2*NSegment);
<a name="l00249"></a>00249    <span class="keywordtype">double</span> x = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*sin(AngleS*pa);
<a name="l00250"></a>00250    <span class="keywordtype">double</span> z = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*cos(AngleS*pa);
<a name="l00251"></a>00251    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = x + Dx*2*NSegment;
<a name="l00252"></a>00252    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = -z + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(c)+.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00253"></a>00253       }
<a name="l00254"></a>00254       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &gt; c*NEdge + 4*NSegment){
<a name="l00255"></a>00255    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(6*NSegment - p);
<a name="l00256"></a>00256    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(c+.5)+.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00257"></a>00257       }
<a name="l00258"></a>00258       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00259"></a>00259       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = c;
<a name="l00260"></a>00260       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00261"></a>00261       <span class="keywordflow">if</span>(p == <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>) <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00262"></a>00262       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 3;
<a name="l00263"></a>00263       <span class="keywordflow">if</span>(p == c*NEdge ){
<a name="l00264"></a>00264    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p + 1;
<a name="l00265"></a>00265       }
<a name="l00266"></a>00266       <span class="keywordflow">else</span>
<a name="l00267"></a>00267    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p - 1;
<a name="l00268"></a>00268       <span class="keywordflow">if</span>(p == NEdge*(c+1) - 1){
<a name="l00269"></a>00269    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = p - 1;
<a name="l00270"></a>00270       }
<a name="l00271"></a>00271       <span class="keywordflow">else</span> 
<a name="l00272"></a>00272    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = p + 1;
<a name="l00273"></a>00273       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2] = NEdge - p - 1;
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275   }
<a name="l00276"></a>00276   <span class="keywordtype">int</span> pHalf = (int)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>/2.);
<a name="l00277"></a>00277   <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[pHalf].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 2;
<a name="l00278"></a>00278   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[0].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00279"></a>00279   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00280"></a>00280   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-2].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00281"></a>00281   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00282"></a>00282   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pHalf-1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00283"></a>00283   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pHalf].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00284"></a>00284   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pHalf+1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00285"></a>00285   <a class="code" href="classForces.html#adee9a7de583494983844ed4378f51df4" title="Add all rigid bodies as a boundary condition.">AddRigid</a>();
<a name="l00286"></a>00286   <span class="comment">// for(int p=0;p&lt;pNPart();p++)</span>
<a name="l00287"></a>00287   <span class="comment">//   printf(&quot;%d) %lf %lf %lf %d) %d %d %d\n&quot;,p,Pm[p].Pos[0],Pm[p].Pos[1],Pm[p].Pos[2],Ln[p].NLink,Ln[p].Link[0],Ln[p].Link[1],Ln[p].Link[2]);</span>
<a name="l00288"></a>00288 }
<a name="l00289"></a><a class="code" href="classForces.html#afea6ddedbed181a50906556f6075257f">00289</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#afea6ddedbed181a50906556f6075257f" title="Create the 1d representation of a stalk.">Forces::CreateStalk</a>(){
<a name="l00290"></a>00290   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00291"></a>00291   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00292"></a>00292   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00293"></a>00293   <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a> = 0;
<a name="l00294"></a>00294   <span class="keywordtype">int</span> c=0;
<a name="l00295"></a>00295   <span class="keywordtype">int</span> NSegment = (int)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>/3.);
<a name="l00296"></a>00296   <span class="keywordtype">double</span> AngleS = .5*DUE_PI/(double)NSegment;
<a name="l00297"></a>00297   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00298"></a>00298     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>*(c+1);p++){
<a name="l00299"></a>00299       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a>;
<a name="l00300"></a>00300       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00301"></a>00301       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(double)(p-c*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00302"></a>00302       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1);
<a name="l00303"></a>00303       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(double)c+.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)-1.5*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];
<a name="l00304"></a>00304       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = c;
<a name="l00305"></a>00305       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00306"></a>00306       <span class="keywordflow">if</span>(c==1){
<a name="l00307"></a>00307    <span class="keywordflow">if</span>(p &gt; c*NEdge + NSegment &amp;&amp; p &lt;= c*NEdge + 2*NSegment ){
<a name="l00308"></a>00308      <span class="keywordtype">double</span> x = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*sin(AngleS*(p-c*NEdge + NSegment));
<a name="l00309"></a>00309      <span class="keywordtype">double</span> z = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*cos(AngleS*(p-c*NEdge + NSegment));
<a name="l00310"></a>00310      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = x + Dx*NSegment;
<a name="l00311"></a>00311      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = z + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(double)c+.5-1.*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];<span class="comment">//+ Kf.Elong[2]/(double)NSegment;</span>
<a name="l00312"></a>00312    }
<a name="l00313"></a>00313    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &gt; c*NEdge + 2*NSegment ){
<a name="l00314"></a>00314      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(NEdge*(c+1)-p);
<a name="l00315"></a>00315      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(double)(c+1)+.5-1.5*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];
<a name="l00316"></a>00316    }
<a name="l00317"></a>00317       }
<a name="l00318"></a>00318       <span class="keywordflow">if</span>(c==2){
<a name="l00319"></a>00319    <span class="keywordflow">if</span>(p &lt; c*NEdge + NSegment ){
<a name="l00320"></a>00320      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] =  1. - Dx*(double)(p-c*NEdge);
<a name="l00321"></a>00321      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(double)(c-1)+.5-1.5*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];
<a name="l00322"></a>00322    }
<a name="l00323"></a>00323    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(p &gt;= c*NEdge + NSegment &amp;&amp; p &lt; c*NEdge + 2*NSegment ){
<a name="l00324"></a>00324      <span class="keywordtype">double</span> x = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*sin(AngleS*(p-c*NEdge + NSegment));
<a name="l00325"></a>00325      <span class="keywordtype">double</span> z = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*.5*cos(AngleS*(p-c*NEdge + NSegment));
<a name="l00326"></a>00326      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = - x + 2*Dx*NSegment;
<a name="l00327"></a>00327      <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = z + <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]*(double)(c-1)+.5-1.*<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2];   }
<a name="l00328"></a>00328       }
<a name="l00329"></a>00329       <span class="keywordflow">if</span>(p == <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>) <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00330"></a>00330       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 3;
<a name="l00331"></a>00331       <span class="keywordflow">if</span>(p == c*NEdge ){
<a name="l00332"></a>00332    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p + 1;
<a name="l00333"></a>00333    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00334"></a>00334       }
<a name="l00335"></a>00335       <span class="keywordflow">else</span>
<a name="l00336"></a>00336    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p - 1;
<a name="l00337"></a>00337       <span class="keywordflow">if</span>(p == NEdge*(c+1) - 1){
<a name="l00338"></a>00338    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = p - 1;
<a name="l00339"></a>00339    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00340"></a>00340       }
<a name="l00341"></a>00341       <span class="keywordflow">else</span> 
<a name="l00342"></a>00342    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1] = p + 1;
<a name="l00343"></a>00343       <span class="keywordflow">if</span>(c == 0)
<a name="l00344"></a>00344    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2] = p + <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00345"></a>00345       <span class="keywordflow">if</span>(c == 1)
<a name="l00346"></a>00346    <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2] = p - <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00347"></a>00347       <span class="keywordflow">if</span>(p == c*NEdge + 1 || p == (c+1)*NEdge - 2)
<a name="l00348"></a>00348    <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Typ =2;
<a name="l00349"></a>00349       <span class="comment">// if(p == c*NEdge + 2 || p == (c+1)*NEdge - 3)</span>
<a name="l00350"></a>00350       <span class="comment">//Pm[p].Typ =2;</span>
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352   }
<a name="l00353"></a>00353 }
<a name="l00354"></a><a class="code" href="classForces.html#a150658611a20b7185df56cc52412bc3f">00354</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a150658611a20b7185df56cc52412bc3f" title="Create single line of connected monomers.">Forces::Create1d</a>(){
<a name="l00355"></a>00355   <span class="keywordtype">double</span> <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00356"></a>00356   <span class="keywordtype">double</span> Dy = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00357"></a>00357   <span class="keywordtype">double</span> Dz = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00358"></a>00358   <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a> = <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>/2;
<a name="l00359"></a>00359   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00360"></a>00360     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00361"></a>00361     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = Dx*(double)p;
<a name="l00362"></a>00362     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = .5;<span class="comment">//Mate-&gt;Casuale();//Dy*(double)p;</span>
<a name="l00363"></a>00363     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = .45;<span class="comment">//Mate-&gt;Casuale();</span>
<a name="l00364"></a>00364     <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 2;
<a name="l00365"></a>00365     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00366"></a>00366     <span class="keywordflow">if</span>(p == <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>) <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 1;
<a name="l00367"></a>00367     <span class="keywordtype">int</span> link=0;
<a name="l00368"></a>00368     <span class="keywordflow">if</span>(p == 0 || p==1){
<a name="l00369"></a>00369       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>--;
<a name="l00370"></a>00370       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372     <span class="keywordflow">else</span>{
<a name="l00373"></a>00373       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = p - 1;
<a name="l00374"></a>00374       link++;
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     <span class="keywordflow">if</span>(p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1 || p == <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-2){
<a name="l00377"></a>00377       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>--;
<a name="l00378"></a>00378       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     <span class="keywordflow">else</span>{
<a name="l00381"></a>00381       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[link] = p + 1;
<a name="l00382"></a>00382       link++;
<a name="l00383"></a>00383     }
<a name="l00384"></a>00384   }
<a name="l00385"></a>00385 }
<a name="l00386"></a><a class="code" href="classForces.html#a655ba1e4004f501b750638d781f45c82">00386</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a655ba1e4004f501b750638d781f45c82" title="Create rigid bodies.">Forces::CreateRigid</a>(){
<a name="l00387"></a>00387   <a class="code" href="classVarData.html#ad5e77b3ade14f7be0d91ccd0f5397cb6" title="Set NNano.">SetNNano</a>(2);
<a name="l00388"></a>00388   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++){
<a name="l00389"></a>00389     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00390"></a>00390       <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[d] = .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00391"></a>00391       <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#ae3fae9edc78d8cadc33c5a52bebdb46c" title="Velocity.">Vel</a>[d] = .0;
<a name="l00392"></a>00392       <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a27de9c01526ba1025ed85f899b3fbc74" title="Angular velocity.">AVel</a>[d] = 0.;
<a name="l00393"></a>00393       <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a953bf4fe7bc5cd9cffa0f049f7fb0325" title="Rotation axis.">Axis</a>[d] = 0.;
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a953bf4fe7bc5cd9cffa0f049f7fb0325" title="Rotation axis.">Axis</a>[0] = 1.;
<a name="l00396"></a>00396     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#ae10d368b167a39a5905e047ba7083b2a" title="0 none, 1 spherical, 2 cylindrical 3 wall">Shape</a> = 2;
<a name="l00397"></a>00397     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487" title="Size.">Rad</a> = .03;
<a name="l00398"></a>00398     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57" title="Height of the cylinder.">Height</a> = .3;
<a name="l00399"></a>00399     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#ac33418187547ea28dda7063924f34df6" title="Mass.">Mass</a> = 1.;
<a name="l00400"></a>00400     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a1a0cbbb118b67bb2a3f1f682c0dad85b" title="Friction term.">Gamma</a> = 10.;
<a name="l00401"></a>00401     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a7e97ac28698cae83ebf4b304dbbae40a" title="Stochastic term.">Zeta</a> = 30.;
<a name="l00402"></a>00402   }
<a name="l00403"></a>00403   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[0].<a class="code" href="structNANO.html#ac33418187547ea28dda7063924f34df6" title="Mass.">Mass</a> = 1.;
<a name="l00404"></a>00404   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[1].<a class="code" href="structNANO.html#ae10d368b167a39a5905e047ba7083b2a" title="0 none, 1 spherical, 2 cylindrical 3 wall">Shape</a> = 1;
<a name="l00405"></a>00405   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00406"></a>00406     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[1].<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[d] = .0*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00407"></a>00407     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[1].<a class="code" href="structNANO.html#ae3fae9edc78d8cadc33c5a52bebdb46c" title="Velocity.">Vel</a>[d] = .01;
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409 }
<a name="l00410"></a><a class="code" href="classForces.html#a3f01e349d6a138fb20f9caa406c0d561">00410</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a3f01e349d6a138fb20f9caa406c0d561" title="Create a initial disposition of particle for the MC sim.">Forces::CreateMC</a>(){
<a name="l00411"></a>00411   <span class="keywordtype">int</span> NSect[3] = {3,3,3};
<a name="l00412"></a>00412   StatFile1 = fopen(<span class="stringliteral">&quot;StatisticsMC1.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00413"></a>00413   StatFile2 = fopen(<span class="stringliteral">&quot;StatisticsMC2.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00414"></a>00414   <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d" title="Count accepted moves.">NInsertion</a> = 0;
<a name="l00415"></a>00415   <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae" title="Count accepted moves.">NRemoval</a> = 0;
<a name="l00416"></a>00416   <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4" title="Define the parameters for calculating the force.">DefNanoForceParam</a>();
<a name="l00417"></a>00417   <a class="code" href="classForces.html#a7b92a25206538d578d6129879bfac183" title="Print the force and the potential.">PrintForce</a>();
<a name="l00418"></a>00418   <a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae" title="Set and reallocate the number of chains.">SetNChain</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00419"></a>00419   <a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972" title="Set and reallocate the number of particles per chains.">SetNPCh</a>(1);
<a name="l00420"></a>00420   OldNrgBead = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()];
<a name="l00421"></a>00421   OldNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>()];
<a name="l00422"></a>00422   <span class="keywordtype">double</span> Edge[3] = {<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00423"></a>00423   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) NSect[d] = (<span class="keywordtype">int</span>)(Edge[d]/(double)(2.*sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>)));
<a name="l00424"></a>00424   <span class="keywordtype">double</span> Dens = <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/<a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>();
<a name="l00425"></a>00425   <span class="keywordtype">double</span> Lambda3 = 1.;<span class="comment">//CUBE(sqrt(DUE_PI/SQR(hPlanck)));</span>
<a name="l00426"></a>00426   <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = sqrt(SQR(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>())/(<span class="keywordtype">double</span>)(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].NPCh-1.)/3.)/2.;
<a name="l00427"></a>00427   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00428"></a>00428     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00429"></a>00429       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970" title="Random uniform number.">Casuale</a>()*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00430"></a>00430     }
<a name="l00431"></a>00431   }
<a name="l00432"></a>00432   ChooseCalcMode(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00433"></a>00433   ChoosePot(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00434"></a>00434 }
<a name="l00435"></a><a class="code" href="classForces.html#a344629f905b1cbbcb311a4d3e6ff8818">00435</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a344629f905b1cbbcb311a4d3e6ff8818" title="Create a initial disposition of particle for the MD sim.">Forces::CreateMD</a>(){
<a name="l00436"></a>00436   <span class="keywordtype">int</span> NSect[3] = {3,3,3};
<a name="l00437"></a>00437   <span class="keywordtype">double</span> Edge[3] = {<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00438"></a>00438   <span class="keywordtype">double</span> Dens = <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/<a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>();
<a name="l00439"></a>00439   <span class="keywordtype">double</span> Lambda3 = 1.;<span class="comment">//CUBE(sqrt(DUE_PI/SQR(hPlanck)));</span>
<a name="l00440"></a>00440   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++)NSect[d] = (<span class="keywordtype">int</span>)(Edge[d]/(double)(2.*sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>)));
<a name="l00441"></a>00441   <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = sqrt(SQR(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>())/(<span class="keywordtype">double</span>)(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].NPCh-1.)/3.)/2.;
<a name="l00442"></a>00442   <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4" title="Define the parameters for calculating the force.">DefNanoForceParam</a>();
<a name="l00443"></a>00443   <span class="keywordtype">int</span> n3 = 2;
<a name="l00444"></a>00444   <span class="keywordflow">while</span> ((n3*n3*n3)&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()) n3++;
<a name="l00445"></a>00445   <span class="keywordtype">int</span> iix=0;
<a name="l00446"></a>00446   <span class="keywordtype">int</span> iiy=0;
<a name="l00447"></a>00447   <span class="keywordtype">int</span> iiz=0;
<a name="l00448"></a>00448   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00449"></a>00449     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[0] = ((double)iix+0.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)/n3;
<a name="l00450"></a>00450     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[1] = ((double)iiy+0.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)/n3;
<a name="l00451"></a>00451     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = ((double)iiz+0.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)/n3;
<a name="l00452"></a>00452     iix++;
<a name="l00453"></a>00453     <span class="keywordflow">if</span> (iix==n3) {
<a name="l00454"></a>00454       iix=0;
<a name="l00455"></a>00455       iiy++;
<a name="l00456"></a>00456       <span class="keywordflow">if</span> (iiy==n3) {
<a name="l00457"></a>00457    iiy=0;
<a name="l00458"></a>00458    iiz++;
<a name="l00459"></a>00459       }
<a name="l00460"></a>00460     }
<a name="l00461"></a>00461     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00462"></a>00462       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2" title="xyzr Velocity of the particle">Vel</a>[d] = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#ad14013038c5963ed49ca1236e681db10" title="Gaussian random number.">Gaussiano</a>(0.,1.0);
<a name="l00463"></a>00463     }
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465   ChooseCalcMode(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00466"></a>00466   ChoosePot(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00467"></a>00467 }
<a name="l00468"></a><a class="code" href="classForces.html#a6ef0b763f3b80142cda476d73e2753a5">00468</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a6ef0b763f3b80142cda476d73e2753a5" title="Create a initial disposition of houses to collect on a line.">Forces::CreateElectro</a>(){
<a name="l00469"></a>00469   <span class="keywordtype">int</span> NSect[3] = {3,3,3};
<a name="l00470"></a>00470   StatFile1 = fopen(<span class="stringliteral">&quot;StatisticsMC1.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00471"></a>00471   StatFile2 = fopen(<span class="stringliteral">&quot;StatisticsMC2.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00472"></a>00472   <a class="code" href="classForces.html#ae1da38d5d966b9236ebd3641d103546d" title="Count accepted moves.">NInsertion</a> = 0;
<a name="l00473"></a>00473   <a class="code" href="classForces.html#aeeef7711986a24838884d8ef8c12f4ae" title="Count accepted moves.">NRemoval</a> = 0;
<a name="l00474"></a>00474   <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4" title="Define the parameters for calculating the force.">DefNanoForceParam</a>();
<a name="l00475"></a>00475   <a class="code" href="classForces.html#a7b92a25206538d578d6129879bfac183" title="Print the force and the potential.">PrintForce</a>();
<a name="l00476"></a>00476   <a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae" title="Set and reallocate the number of chains.">SetNChain</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00477"></a>00477   <a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972" title="Set and reallocate the number of particles per chains.">SetNPCh</a>(1);
<a name="l00478"></a>00478   OldNrgBead = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()];
<a name="l00479"></a>00479   OldNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>()];
<a name="l00480"></a>00480   <span class="keywordtype">double</span> Edge[3] = {<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00481"></a>00481   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) NSect[d] = (<span class="keywordtype">int</span>)(Edge[d]/(double)(2.*sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>)));
<a name="l00482"></a>00482   <span class="keywordtype">double</span> Dens = <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/<a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>();
<a name="l00483"></a>00483   <span class="keywordtype">double</span> Lambda3 = 1.;<span class="comment">//CUBE(sqrt(DUE_PI/SQR(hPlanck)));</span>
<a name="l00484"></a>00484   <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = sqrt(SQR(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>())/(<span class="keywordtype">double</span>)(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].NPCh-1.)/3.)/2.;
<a name="l00485"></a>00485   <span class="keywordtype">int</span> NCenter = 6;
<a name="l00486"></a>00486   <span class="keywordtype">double</span> *PCenter = (<span class="keywordtype">double</span> *)calloc(NCenter*2,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00487"></a>00487   <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0];
<a name="l00488"></a>00488   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NCenter;c++){
<a name="l00489"></a>00489     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;2;d++){
<a name="l00490"></a>00490       PCenter[c*2+d] = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970" title="Random uniform number.">Casuale</a>()*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*.7 + <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*.2;
<a name="l00491"></a>00491     }
<a name="l00492"></a>00492   }
<a name="l00493"></a>00493   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p++){
<a name="l00494"></a>00494     <span class="keywordtype">int</span> c = (p%NCenter);
<a name="l00495"></a>00495     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;2;d++){
<a name="l00496"></a>00496       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#ad14013038c5963ed49ca1236e681db10" title="Gaussian random number.">Gaussiano</a>(PCenter[c*2+d],<a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a>);
<a name="l00497"></a>00497       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] -= floor(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[d]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(d))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00498"></a>00498       <span class="comment">// if(Pm[p].Pos[d] &gt; pEdge(d)) Pm[p].Pos[d] += pEdge(d) - Pm[p].Pos[d];</span>
<a name="l00499"></a>00499       <span class="comment">// if(Pm[p].Pos[d] &lt; 0) Pm[p].Pos[d] *= -1.;</span>
<a name="l00500"></a>00500     }
<a name="l00501"></a>00501     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = .2*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)*sin(6*<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[0]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(0))*sin(4*<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[1]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(1)) + .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00502"></a>00502   }
<a name="l00503"></a>00503   <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[1];
<a name="l00504"></a>00504   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=NEdge;p&lt;NEdge+<a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a>;p++){
<a name="l00505"></a>00505     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;2;d++){
<a name="l00506"></a>00506       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = (p-<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>)/(<span class="keywordtype">double</span>)NSpline*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00507"></a>00507       <span class="comment">// double Move = Mat-&gt;Gaussiano(Pm[p-1].Pos[d],GaussVar);</span>
<a name="l00508"></a>00508       <span class="comment">// if(p == NEdge){ Pm[p].Pos[d] = 0.; Move = 0.;}</span>
<a name="l00509"></a>00509       <span class="comment">// if(Move &gt; pEdge(d) ) Pm[p].Pos[d] = Move - pEdge(d);</span>
<a name="l00510"></a>00510       <span class="comment">// else if(Move &lt; 0. ) Pm[p].Pos[d] = -Move;</span>
<a name="l00511"></a>00511       <span class="comment">// else Pm[p].Pos[d] = Move;</span>
<a name="l00512"></a>00512       <span class="comment">// Pm[p].Pos[d] -= floor(Pm[p].Pos[d]*pInvEdge(d))*pEdge(d);      </span>
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[2] = .2*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)*sin(6*<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[0]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(0))*sin(4*<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[1]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(1)) + .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2);
<a name="l00515"></a>00515   }
<a name="l00516"></a>00516   ChooseCalcMode(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00517"></a>00517   ChoosePot(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00518"></a>00518 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:16 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
