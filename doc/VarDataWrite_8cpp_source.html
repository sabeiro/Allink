<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/VarData/VarDataWrite.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_4fd85bb7e60d3734b722333cda33b932.html">VarData</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">VarDataWrite.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">VarData: This  Program reads and writes a specific file format </span>
<a name="l00003"></a>00003 <span class="comment">storing all the information relative to a set of equal structure</span>
<a name="l00004"></a>00004 <span class="comment">polymers to the CHAIN, PART and GENERAL structures. It provides </span>
<a name="l00005"></a>00005 <span class="comment">two different ways to backfold the coordinates, a fanction that </span>
<a name="l00006"></a>00006 <span class="comment">creates an initial system with different option and some function</span>
<a name="l00007"></a>00007 <span class="comment">for the data analisys. The first calculate the distribution of the</span>
<a name="l00008"></a>00008 <span class="comment">monomer in the box, the second the distribution of the bonds.</span>
<a name="l00009"></a>00009 <span class="comment">Copyright (C) 2008 by Giovanni Marelli &lt;sabeiro@virgilio.it&gt;</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">This program is free software; you can redistribute it and/or modify</span>
<a name="l00013"></a>00013 <span class="comment">it under the terms of the GNU General Public License as published by</span>
<a name="l00014"></a>00014 <span class="comment">the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00015"></a>00015 <span class="comment">(at your option) any later version.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">This program is distributed in the hope that it will be useful,</span>
<a name="l00018"></a>00018 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00019"></a>00019 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00020"></a>00020 <span class="comment">GNU General Public License for more details.</span>
<a name="l00021"></a>00021 <span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">You should have received a copy of the GNU General Public License</span>
<a name="l00023"></a>00023 <span class="comment">along with this program; if not, write to the Free Software</span>
<a name="l00024"></a>00024 <span class="comment">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00025"></a>00025 <span class="comment">***********************************************************************/</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;../include/VarData.h&quot;</span>
<a name="l00027"></a>00027 ;
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef USE_BOOST</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="keywordtype">void</span> VarData::OpenComprWrite(<span class="keywordtype">char</span> *FName,filtering_ostream ZipFile){
<a name="l00030"></a>00030    ofstream OpenZipFile(FName, ios_base::binary);
<a name="l00031"></a>00031    <span class="comment">// create filter:</span>
<a name="l00032"></a>00032    ZipFile.push(bzip2_compressor());
<a name="l00033"></a>00033    ZipFile.push(OpenZipFile);
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 <span class="keywordtype">void</span> VarData::OpenComprRead(<span class="keywordtype">char</span> *FName,filtering_istream ZipFile){
<a name="l00036"></a>00036    ifstream OpenZipFile(FName, ios_base::binary);
<a name="l00037"></a>00037    <span class="comment">// create filter:</span>
<a name="l00038"></a>00038    ZipFile.push(bzip2_compressor());
<a name="l00039"></a>00039    ZipFile.push(OpenZipFile);
<a name="l00040"></a>00040 }
<a name="l00041"></a>00041 <span class="keywordtype">void</span> VarData::CloseCompr(filtering_istream ZipFile){
<a name="l00042"></a>00042   ZipFile.reset();
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 <span class="keywordtype">void</span> VarData::CloseCompr(filtering_ostream ZipFile){
<a name="l00045"></a>00045   ZipFile.reset();
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 <span class="preprocessor">#endif</span>
<a name="l00048"></a><a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb">00048</a> <span class="preprocessor"></span><span class="keywordtype">bool</span> <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">VarData::Write</a>(<span class="keywordtype">char</span> *OutFile){
<a name="l00049"></a>00049   <span class="keywordflow">if</span>( <a class="code" href="classVarData.html#acefa5842862d4587442db05af40e7490" title="Contains the definition of the file format.">SysFormat</a> == VAR_SYS_TXVL ){
<a name="l00050"></a>00050     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a76873542f36c8e36b790c90273c95cf1" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">WriteTxvl</a>(OutFile))
<a name="l00051"></a>00051       <span class="keywordflow">return</span> 1;
<a name="l00052"></a>00052   }
<a name="l00053"></a>00053   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classVarData.html#acefa5842862d4587442db05af40e7490" title="Contains the definition of the file format.">SysFormat</a> == VAR_SYS_XVT ){
<a name="l00054"></a>00054     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a4bed1297ee4f1c6966e1f8389e3b34c8" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">WriteXvt</a>(OutFile))
<a name="l00055"></a>00055       <span class="keywordflow">return</span> 1;
<a name="l00056"></a>00056   }
<a name="l00057"></a>00057   <span class="keywordflow">else</span> 
<a name="l00058"></a>00058     <a class="code" href="classVarData.html#a842c747bebda7f52b905605b1446c814" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">WriteXyz</a>(OutFile);
<a name="l00059"></a>00059   <span class="keywordflow">return</span> 0;
<a name="l00060"></a>00060 }
<a name="l00061"></a><a class="code" href="classVarData.html#a76873542f36c8e36b790c90273c95cf1">00061</a> <span class="keywordtype">bool</span> <a class="code" href="classVarData.html#a76873542f36c8e36b790c90273c95cf1" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">VarData::WriteTxvl</a>(<span class="keywordtype">char</span> *OutFile){
<a name="l00062"></a>00062   <a class="code" href="classVarData.html#a616b8e0974fde7798bb09b9af1b339ae" title="If enabled call the function position.">VarMessage</a>(<span class="stringliteral">&quot;Write&quot;</span>);
<a name="l00063"></a>00063   FILE *FileToWrite = fopen(OutFile,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00064"></a>00064   SigErr(FileToWrite==NULL,<span class="stringliteral">&quot;The output file %s could not be opened\n&quot;</span>,OutFile);
<a name="l00065"></a>00065   fprintf(FileToWrite,<span class="stringliteral">&quot;# &quot;</span>);
<a name="l00066"></a>00066   <span class="keywordflow">if</span>( VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_EDGE) ){
<a name="l00067"></a>00067     fprintf(FileToWrite,<span class="stringliteral">&quot;l( %.2g %.2g %.2g) &quot;</span>,
<a name="l00068"></a>00068        Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[0],Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[1],Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[2]);
<a name="l00069"></a>00069   }
<a name="l00070"></a>00070   fprintf(FileToWrite,<span class="stringliteral">&quot;c[%d] &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a>);
<a name="l00071"></a>00071   fprintf(FileToWrite,<span class="stringliteral">&quot;s[%d] &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#a7d089b5d5a5a8f8699325baad0ad85b5" title="Courrent step.">Step</a>);
<a name="l00072"></a>00072   fprintf(FileToWrite,<span class="stringliteral">&quot;n[%d] &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>);
<a name="l00073"></a>00073   fprintf(FileToWrite,<span class="stringliteral">&quot;L[%d] &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a>);
<a name="l00074"></a>00074   fprintf(FileToWrite,<span class="stringliteral">&quot;v[%d] &quot;</span>,<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00075"></a>00075   fprintf(FileToWrite,<span class="stringliteral">&quot;d[%s] &quot;</span>,<a class="code" href="classVarData.html#a7c997cd3acaf56afc44e01680323eb0e" title="What to draw.">cWhat2Draw</a>);
<a name="l00076"></a>00076   fprintf(FileToWrite,<span class="stringliteral">&quot;D(%lf) &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#ac321dc561843cb5d3f74604036a3a8da" title="Timestep.">Deltat</a>);
<a name="l00077"></a>00077   fprintf(FileToWrite,<span class="stringliteral">&quot;i(%.2f %.2f %.2f) &quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#a3ed57096651b587c2bf716fa78048153" title="Density coexistence.">rho</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a1b854697afb2af2e40431c4a10c83f6a" title="Incompatibility.">chiN</a>,Gen-&gt;<a class="code" href="structGENERAL.html#ade2b90e837653f48dc2bdb1d856dac32" title="Incompressibility.">kappaN</a>);
<a name="l00078"></a>00078   fprintf(FileToWrite,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00079"></a>00079   <a class="code" href="classVarData.html#af86d3fd2dc311c093cd03f65eb3fadd9" title="Write the nano section of the header to the file.">HeaderNano</a>(FileToWrite);
<a name="l00080"></a>00080   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>;p++){
<a name="l00081"></a>00081     fprintf(FileToWrite,<span class="stringliteral">&quot;{ t[%d %d %d] &quot;</span>,
<a name="l00082"></a>00082        <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Idx,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].CId,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Typ);
<a name="l00083"></a>00083     fprintf(FileToWrite,<span class="stringliteral">&quot;x(%lf %lf %lf) &quot;</span>,
<a name="l00084"></a>00084        <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[0],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[1],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[2]);
<a name="l00085"></a>00085     fprintf(FileToWrite,<span class="stringliteral">&quot;v(%lf %lf %lf) &quot;</span>,
<a name="l00086"></a>00086        <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Vel[0],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Vel[1],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Vel[2]);
<a name="l00087"></a>00087     <span class="comment">//   printf(&quot;Pm[%d].NLink %d\n&quot;,p,Pm[p].NLink);</span>
<a name="l00088"></a>00088     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">pNLink</a>() &gt; 0){
<a name="l00089"></a>00089       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>;i++)
<a name="l00090"></a>00090    fprintf(FileToWrite,<span class="stringliteral">&quot;l[%d] &quot;</span>,<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].Link[i]);
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092     fprintf(FileToWrite,<span class="stringliteral">&quot;}\n&quot;</span>);<span class="comment">//End of particle info</span>
<a name="l00093"></a>00093   }
<a name="l00094"></a>00094   <span class="comment">// for(int n=0;n&lt;Gen-&gt;NNano;n++){</span>
<a name="l00095"></a>00095   <span class="comment">//   fprintf(FileToWrite,&quot;{t[%d %d %d] &quot;,Gen-&gt;NPart-1+n,-1,2);</span>
<a name="l00096"></a>00096   <span class="comment">//   fprintf(FileToWrite,&quot;x(%lf %lf %lf) &quot;,Nano[n].Pos[0],Nano[n].Pos[1],Nano[n].Pos[2]);</span>
<a name="l00097"></a>00097   <span class="comment">//   fprintf(FileToWrite,&quot;v(%lf %lf %lf)}\n&quot;,0.,0.,0.);</span>
<a name="l00098"></a>00098   <span class="comment">// }</span>
<a name="l00099"></a>00099   fclose(FileToWrite);
<a name="l00100"></a>00100   <span class="keywordflow">return</span> 0;
<a name="l00101"></a>00101 }
<a name="l00102"></a><a class="code" href="classVarData.html#a4a4c970350675e5a82a935c754264d14">00102</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a4a4c970350675e5a82a935c754264d14" title="Header interactions.">VarData::HeaderInteraction</a>(FILE *FileToWrite){
<a name="l00103"></a>00103   <span class="keywordtype">double</span> Norm2 = CUBE(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>()) / SQR(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>());
<a name="l00104"></a>00104   <span class="keywordtype">double</span> Norm3 = CUBE(SQR(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>()) / <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>());
<a name="l00105"></a>00105   <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a25d6afd486f86374d8d0903a2a245074" title="Rescale entries.">Rescale</a>(1./Norm2,2);
<a name="l00106"></a>00106   <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a25d6afd486f86374d8d0903a2a245074" title="Rescale entries.">Rescale</a>(1./Norm3,3);
<a name="l00107"></a>00107   fprintf(FileToWrite,<span class="stringliteral">&quot;# v=%.2f %.2f %.2f %.2f %.2f %.2f &quot;</span>,<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,0),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,1),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(1,1),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(1,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(2,2));
<a name="l00108"></a>00108   fprintf(FileToWrite,<span class="stringliteral">&quot;w=%.2f %.2f %.2f %.2f %.2f %.2f %.2f %.2f %.2f %.2f\n&quot;</span>,<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,0,0),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,0,1),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,0,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,1,1),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,1,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(0,2,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(1,1,1),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(1,1,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(1,2,2),<a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a1c5a9c480e688013bf93d9d5409319e5" title="Prefactor of the force.">Coeff</a>(2,2,2));
<a name="l00109"></a>00109   fprintf(FileToWrite,<span class="stringliteral">&quot;# a2=%.1f a3=%.1f Re=%.1f N=%d ks=%.3f kb=%.3f l0=0\n&quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#a3e95eddffbcb7d50ef9588ced78a148c" title="Weighting function straight length.">WFuncStraight2</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a2db5cd020420567f6c9414964981a572" title="Weighting function straight length.">WFuncStraight3</a>,Gen-&gt;<a class="code" href="structGENERAL.html#aa72817c7da02760c6940e2e2fcea5f02" title="Convertion unit R_e over CutOff.">ReOverCutOff</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a907c197a31ff3bce70d5d86b03f91c02" title="Prefactor of the bond spring.">kappaSpring</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a2ff77637e8d30a6568475ce5808a8b9f" title="Prefactor of the bending potential.">kappaBend</a>);
<a name="l00110"></a>00110   <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a25d6afd486f86374d8d0903a2a245074" title="Rescale entries.">Rescale</a>(Norm2,2);
<a name="l00111"></a>00111   <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a25d6afd486f86374d8d0903a2a245074" title="Rescale entries.">Rescale</a>(Norm3,3);
<a name="l00112"></a>00112 }
<a name="l00113"></a><a class="code" href="classVarData.html#a3043b04de19ff9f50f6253ecbdf316bd">00113</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a3043b04de19ff9f50f6253ecbdf316bd" title="Identifier of the shape.">VarData::ShapeId</a>(<span class="keywordtype">int</span> iShape,<span class="keywordtype">char</span> *Shape){
<a name="l00114"></a>00114   sprintf(Shape,<span class="stringliteral">&quot;no&quot;</span>);
<a name="l00115"></a>00115   <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_SPH)) sprintf(Shape,<span class="stringliteral">&quot;sph&quot;</span>);
<a name="l00116"></a>00116   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TIP)) sprintf(Shape,<span class="stringliteral">&quot;tip&quot;</span>);
<a name="l00117"></a>00117   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_CYL)) sprintf(Shape,<span class="stringliteral">&quot;cyl&quot;</span>);
<a name="l00118"></a>00118   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_PILL)) sprintf(Shape,<span class="stringliteral">&quot;pill&quot;</span>);
<a name="l00119"></a>00119   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TILT)) sprintf(Shape,<span class="stringliteral">&quot;tilt&quot;</span>);
<a name="l00120"></a>00120   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_WALL)) sprintf(Shape,<span class="stringliteral">&quot;wall&quot;</span>); 
<a name="l00121"></a>00121   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_PORE)) sprintf(Shape,<span class="stringliteral">&quot;pore&quot;</span>); 
<a name="l00122"></a>00122   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_EXT)) sprintf(Shape,<span class="stringliteral">&quot;ext&quot;</span>); 
<a name="l00123"></a>00123   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_JANUS)) sprintf(Shape,<span class="stringliteral">&quot;janus&quot;</span>);
<a name="l00124"></a>00124   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_STALK)) sprintf(Shape,<span class="stringliteral">&quot;stalk&quot;</span>);
<a name="l00125"></a>00125   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_TORUS)) sprintf(Shape,<span class="stringliteral">&quot;torus&quot;</span>);
<a name="l00126"></a>00126   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_HARM)) sprintf(Shape,<span class="stringliteral">&quot;harm&quot;</span>);
<a name="l00127"></a>00127   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_UMBR)) sprintf(Shape,<span class="stringliteral">&quot;umbr&quot;</span>);
<a name="l00128"></a>00128   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(iShape,SHAPE_BOUND)) sprintf(Shape,<span class="stringliteral">&quot;bound&quot;</span>);
<a name="l00129"></a>00129 }
<a name="l00130"></a><a class="code" href="classVarData.html#ab0cc3088657341d2696949515927e91c">00130</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ab0cc3088657341d2696949515927e91c" title="String for the rigid inclusion in the header file.">VarData::StringNano</a>(<span class="keywordtype">char</span> *String,<span class="keywordtype">int</span> n){
<a name="l00131"></a>00131   <span class="keywordtype">char</span> Shape[60];
<a name="l00132"></a>00132   <a class="code" href="classVarData.html#a3043b04de19ff9f50f6253ecbdf316bd" title="Identifier of the shape.">ShapeId</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,Shape);
<a name="l00133"></a>00133   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_CLUSTER)){ 
<a name="l00134"></a>00134     sprintf(Shape,<span class="stringliteral">&quot;Architecture%d.dat&quot;</span>,n);
<a name="l00135"></a>00135     sprintf(String,<span class="stringliteral">&quot;# Pep x(%.2f %.2f %.2f) a(%.2f %.2f %.2f) g(%.2f %.2f %.2f) i[%d] d[%d %d] fn{%s}&quot;</span>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Height,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Hamaker,n,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].NCircle,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].NHeight,Shape);
<a name="l00136"></a>00136   }
<a name="l00137"></a>00137   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_CLINKS)){ 
<a name="l00138"></a>00138     sprintf(Shape,<span class="stringliteral">&quot;CrossLinks.dat&quot;</span>);
<a name="l00139"></a>00139     sprintf(String,<span class="stringliteral">&quot;# Ext i[%d] fn{%s}&quot;</span>,0,Shape);
<a name="l00140"></a>00140   }
<a name="l00141"></a>00141   <span class="keywordflow">else</span> 
<a name="l00142"></a>00142     sprintf(String,<span class="stringliteral">&quot;# Rigid x(%.2f %.2f %.2f) a(%.2f %.2f %.2f) c(%.2f %.2f %.2f %.4f) s{%s}&quot;</span>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Hamaker,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Height,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].OffSet,Shape);
<a name="l00143"></a>00143 }
<a name="l00144"></a><a class="code" href="classVarData.html#af86d3fd2dc311c093cd03f65eb3fadd9">00144</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#af86d3fd2dc311c093cd03f65eb3fadd9" title="Write the nano section of the header to the file.">VarData::HeaderNano</a>(FILE *FileToWrite){
<a name="l00145"></a>00145   <span class="keywordflow">if</span>(Gen-&gt;NNano == 0) <span class="keywordflow">return</span> 1;
<a name="l00146"></a>00146   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;Gen-&gt;NNano;n++){
<a name="l00147"></a>00147     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#ae10d368b167a39a5905e047ba7083b2a" title="0 none, 1 spherical, 2 cylindrical 3 wall">Shape</a> == SHAPE_NONE)<span class="keywordflow">continue</span>;
<a name="l00148"></a>00148     <span class="keywordtype">char</span> String[120];
<a name="l00149"></a>00149     <a class="code" href="classVarData.html#ab0cc3088657341d2696949515927e91c" title="String for the rigid inclusion in the header file.">StringNano</a>(String,n);
<a name="l00150"></a>00150     fprintf(FileToWrite,<span class="stringliteral">&quot;%s\n&quot;</span>,String);
<a name="l00151"></a>00151   }
<a name="l00152"></a>00152   <span class="keywordflow">return</span> 0;
<a name="l00153"></a>00153 }
<a name="l00154"></a><a class="code" href="classVarData.html#ad86f36df8d1ff2f5c4e8f9bf3e43dfa3">00154</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#ad86f36df8d1ff2f5c4e8f9bf3e43dfa3" title="Header soft.">VarData::HeaderSoft</a>(<span class="keywordtype">char</span> *Line){
<a name="l00155"></a>00155   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ae0d12816cef7153d2571b58556787c41" title="Number of soft bodies.">NSoft</a> == 0) <span class="keywordflow">return</span> 1;
<a name="l00156"></a>00156   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#ae0d12816cef7153d2571b58556787c41" title="Number of soft bodies.">NSoft</a>;n++){
<a name="l00157"></a>00157     <span class="keywordtype">char</span> Shape[60];
<a name="l00158"></a>00158     sprintf(Shape,<span class="stringliteral">&quot;no&quot;</span>);
<a name="l00159"></a>00159     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Topology == VAR_PLANAR) sprintf(Shape,<span class="stringliteral">&quot;planar&quot;</span>);
<a name="l00160"></a>00160     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Topology == VAR_VESICLE) sprintf(Shape,<span class="stringliteral">&quot;vesicle&quot;</span>);
<a name="l00161"></a>00161     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Topology == VAR_COATING) sprintf(Shape,<span class="stringliteral">&quot;coating&quot;</span>);
<a name="l00162"></a>00162     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Topology == VAR_DISTRIBUTED) sprintf(Shape,<span class="stringliteral">&quot;distributed&quot;</span>);
<a name="l00163"></a>00163     sprintf(Line,<span class="stringliteral">&quot;# Soft x(%.2f %.2f %.2f) c(%.2f %.2f) s{%s} n{%s}\n&quot;</span>,<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Pos[0],<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Pos[1],<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Pos[2],<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Size[0],<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Size[1],Shape,<a class="code" href="classVarData.html#aba4b9513e79903ba8a0f586f1cef52ef" title="Soft bodies.">Soft</a>[n].Name);
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165   <span class="keywordflow">return</span> 0;
<a name="l00166"></a>00166 }
<a name="l00167"></a><a class="code" href="classVarData.html#a4bed1297ee4f1c6966e1f8389e3b34c8">00167</a> <span class="keywordtype">bool</span> <a class="code" href="classVarData.html#a4bed1297ee4f1c6966e1f8389e3b34c8" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">VarData::WriteXvt</a>(<span class="keywordtype">char</span> *OutFile){
<a name="l00168"></a>00168   <a class="code" href="classVarData.html#a616b8e0974fde7798bb09b9af1b339ae" title="If enabled call the function position.">VarMessage</a>(<span class="stringliteral">&quot;Write&quot;</span>);
<a name="l00169"></a>00169   FILE *FileToWrite = NULL;
<a name="l00170"></a>00170   <span class="keywordtype">char</span> Line2Put[512];
<a name="l00171"></a>00171   FileToWrite = fopen(OutFile,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00172"></a>00172   SigErr(FileToWrite==NULL,<span class="stringliteral">&quot;The output file %s could not be opened\n&quot;</span>,OutFile);
<a name="l00173"></a>00173   fprintf(FileToWrite,<span class="stringliteral">&quot;# L=%lf %lf %lf t=%lf blocks=%d\n&quot;</span>,Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[0],Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[1],Gen-&gt;<a class="code" href="structGENERAL.html#a507c812f21f55c46378bfc7c30d0bc75" title="xyzr edges of the simulation box">Edge</a>[2],<a class="code" href="classVarData.html#ad5bf6099846e677cae330617688069c8" title="Total time.">pTime</a>(),Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>);
<a name="l00174"></a>00174   <a class="code" href="classVarData.html#a4a4c970350675e5a82a935c754264d14" title="Header interactions.">HeaderInteraction</a>(FileToWrite);
<a name="l00175"></a>00175   <a class="code" href="classVarData.html#af86d3fd2dc311c093cd03f65eb3fadd9" title="Write the nano section of the header to the file.">HeaderNano</a>(FileToWrite);
<a name="l00176"></a>00176   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0,cOff=0,pCurr=0;b&lt;Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>;b++,cOff+=<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>){
<a name="l00177"></a>00177     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].NChain == 0) <span class="keywordflow">continue</span>;
<a name="l00178"></a>00178     fprintf(FileToWrite,<span class="stringliteral">&quot;# n=%d N=%d name=%s\n&quot;</span>,<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].NChain,<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].NPCh,<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name);
<a name="l00179"></a>00179     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=cOff;c&lt;<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>+cOff;c++){
<a name="l00180"></a>00180       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a521663d12899e0fefe0a182332a8573f" title="# particles per chain">NPCh</a>;p++,pCurr++){
<a name="l00181"></a>00181    <span class="comment">// if(p &gt; 0){</span>
<a name="l00182"></a>00182    <span class="comment">//   for(int d=0;d&lt;3;d++){</span>
<a name="l00183"></a>00183    <span class="comment">//     if(Pm[pCurr].Pos[d] - Pm[pCurr-1].Pos[d] &gt; .5*pEdge(d))</span>
<a name="l00184"></a>00184    <span class="comment">//       Pm[pCurr].Pos[d] -= pEdge(d);</span>
<a name="l00185"></a>00185    <span class="comment">//     else if(Pm[pCurr].Pos[d] - Pm[pCurr-1].Pos[d] &lt; -.5*pEdge(d))</span>
<a name="l00186"></a>00186    <span class="comment">//       Pm[pCurr].Pos[d] += pEdge(d);</span>
<a name="l00187"></a>00187    <span class="comment">//   }</span>
<a name="l00188"></a>00188    <span class="comment">// }</span>
<a name="l00189"></a>00189    fprintf(FileToWrite,<span class="stringliteral">&quot;%lf %lf %lf &quot;</span>,
<a name="l00190"></a>00190       <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pCurr,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pCurr,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(pCurr,2));
<a name="l00191"></a>00191    fprintf(FileToWrite,<span class="stringliteral">&quot;%lf %lf %lf &quot;</span>,
<a name="l00192"></a>00192       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pCurr].Vel[0],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pCurr].Vel[1],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pCurr].Vel[2]);
<a name="l00193"></a>00193    fprintf(FileToWrite,<span class="stringliteral">&quot; %d &quot;</span>,
<a name="l00194"></a>00194       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[pCurr].Typ);
<a name="l00195"></a>00195    fprintf(FileToWrite,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00196"></a>00196       }
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199   fclose(FileToWrite);
<a name="l00200"></a>00200   <span class="keywordflow">return</span> 0;
<a name="l00201"></a>00201 }
<a name="l00202"></a><a class="code" href="classVarData.html#a842c747bebda7f52b905605b1446c814">00202</a> <span class="keywordtype">bool</span> <a class="code" href="classVarData.html#a842c747bebda7f52b905605b1446c814" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">VarData::WriteXyz</a>(<span class="keywordtype">char</span> *OutFile){
<a name="l00203"></a>00203   <a class="code" href="classVarData.html#a616b8e0974fde7798bb09b9af1b339ae" title="If enabled call the function position.">VarMessage</a>(<span class="stringliteral">&quot;Write&quot;</span>);
<a name="l00204"></a>00204   FILE *FileToWrite = NULL;
<a name="l00205"></a>00205   <span class="keywordflow">if</span>( (FileToWrite = fopen(OutFile,<span class="stringliteral">&quot;w&quot;</span>)) == 0){
<a name="l00206"></a>00206     printf(<span class="stringliteral">&quot;The output file %s could not be opened\n&quot;</span>,OutFile);
<a name="l00207"></a>00207     <span class="keywordflow">return</span> 0;
<a name="l00208"></a>00208   }
<a name="l00209"></a>00209   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>;p++){
<a name="l00210"></a>00210     fprintf(FileToWrite,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,
<a name="l00211"></a>00211        <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[0],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[1],<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[2]);
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213   fclose(FileToWrite);
<a name="l00214"></a>00214   <span class="keywordflow">return</span> 0;
<a name="l00215"></a>00215 }
<a name="l00216"></a><a class="code" href="classVarData.html#afaf46d635173dcc718ad3eb8870d4b91">00216</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#afaf46d635173dcc718ad3eb8870d4b91" title="Write the positions of the egdes of the rectangles.">VarData::WriteLinkedSurf</a>(FILE *FWrite,<span class="keywordtype">double</span> *Plot,<span class="keywordtype">int</span> Values,<span class="keywordtype">int</span> NType,<span class="keywordtype">double</span> *Bound,<span class="keywordtype">int</span>* PId){
<a name="l00217"></a>00217   <span class="keywordtype">int</span> p = PId[0];
<a name="l00218"></a>00218   <span class="keywordtype">int</span> c = PId[1];
<a name="l00219"></a>00219   <span class="keywordtype">int</span> t = PId[2];
<a name="l00220"></a>00220   <span class="keywordtype">double</span> InvValues = 1./(double)Values;
<a name="l00221"></a>00221   <span class="keywordtype">int</span> link[4] = {0,0,0,0};
<a name="l00222"></a>00222   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vv=0;vv&lt;Values-1;vv++){
<a name="l00223"></a>00223     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values-1;v++){
<a name="l00224"></a>00224       link[0] = (v+0)*Values + (vv+0);
<a name="l00225"></a>00225       <span class="keywordflow">if</span>(Plot[(link[0])*NType+t] &lt; .1) <span class="keywordflow">continue</span>;
<a name="l00226"></a>00226       <span class="comment">//------------defines-the-squares---------------------</span>
<a name="l00227"></a>00227       link[1] = (v+0)*Values + (vv+1);
<a name="l00228"></a>00228       link[2] = (v+1)*Values + (vv+0);
<a name="l00229"></a>00229       link[3] = (v+1)*Values + (vv+1);
<a name="l00230"></a>00230       <span class="keywordtype">int</span> pRef = p;
<a name="l00231"></a>00231       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> lx=0;lx&lt;2;lx++){
<a name="l00232"></a>00232    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ly=0;ly&lt;2;ly++){
<a name="l00233"></a>00233      <span class="keywordtype">int</span> l = 2*lx+ly;
<a name="l00234"></a>00234      <span class="keywordtype">double</span> NanoAdded = Plot[(link[l])*NType+2]/Bound[2]+Plot[(link[l])*NType+3]/Bound[3];
<a name="l00235"></a>00235      <span class="keywordtype">double</span> Phob = t == 0 ? Plot[(link[l])*NType+0]/Bound[0] : 0.;
<a name="l00236"></a>00236      <span class="keywordtype">double</span> Phil = t == 1 ? Plot[(link[l])*NType+1]/Bound[1] : 0.;
<a name="l00237"></a>00237      <span class="keywordtype">double</span> r = (v +lx)*InvValues*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(3);
<a name="l00238"></a>00238      <span class="keywordtype">double</span> z = (vv+ly)*InvValues*(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>));
<a name="l00239"></a>00239      <span class="keywordtype">double</span> dens = (Plot[(link[l])*NType+t]);<span class="comment">//+Plot[(v*Values+vv)*NType+1]+Plot[(v*Values+vv)*NType+2]);</span>
<a name="l00240"></a>00240      <span class="keywordtype">int</span> l1 = pRef + (p+1)%4;
<a name="l00241"></a>00241      <span class="keywordtype">int</span> l2 = pRef + (p+2)%4;
<a name="l00242"></a>00242      <span class="keywordtype">int</span> l3 = pRef + (p+3)%4;
<a name="l00243"></a>00243      fprintf(FWrite,<span class="stringliteral">&quot;{t[%d %d %d] x(%lf %lf %lf) v(%lf %lf %lf) l[%d] l[%d] l[%d] }\n&quot;</span>,p,c,t,r,z,dens,NanoAdded,Phob,Phil,l1,l2,l3);
<a name="l00244"></a>00244      p++;
<a name="l00245"></a>00245    }
<a name="l00246"></a>00246       }
<a name="l00247"></a>00247       c++;
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249   }
<a name="l00250"></a>00250   PId[0] = p;
<a name="l00251"></a>00251   PId[1] = c;
<a name="l00252"></a>00252   PId[2] = t;
<a name="l00253"></a>00253   return ;
<a name="l00254"></a>00254   <span class="keywordtype">double</span> Threshold = .1;
<a name="l00255"></a>00255   <span class="keywordtype">int</span> *IdSerial = (<span class="keywordtype">int</span> *)calloc(Values*Values*2,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00256"></a>00256   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vv=0,p=0;vv&lt;Values-1;vv++){
<a name="l00257"></a>00257     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values-1;v++){
<a name="l00258"></a>00258       <span class="keywordtype">int</span> l = (vv+0)*Values + (v+0);
<a name="l00259"></a>00259       IdSerial[l] = p;
<a name="l00260"></a>00260       printf(<span class="stringliteral">&quot;%d %d %d %d\n&quot;</span>,l,p,v,vv);
<a name="l00261"></a>00261       <span class="keywordflow">if</span>(Plot[l*NType+t] &lt; Threshold) <span class="keywordflow">continue</span>;
<a name="l00262"></a>00262       p++;
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264   }
<a name="l00265"></a>00265   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vv=0,p=0,c=0;vv&lt;Values-1;vv++){
<a name="l00266"></a>00266     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values-1;v++){
<a name="l00267"></a>00267       link[0] = (v+0)*Values + (vv+0);
<a name="l00268"></a>00268       <span class="keywordflow">if</span>(Plot[(link[0])*NType+t] &lt; Threshold) <span class="keywordflow">continue</span>;
<a name="l00269"></a>00269       <span class="comment">//------------defines-the-squares---------------------</span>
<a name="l00270"></a>00270       link[1] = (vv+0)*Values + (v+1);
<a name="l00271"></a>00271       link[2] = (vv+1)*Values + (v+0);
<a name="l00272"></a>00272       link[3] = (vv+1)*Values + (v+1);
<a name="l00273"></a>00273       printf(<span class="stringliteral">&quot;%d %d %d %d\n&quot;</span>,link[0],link[1],link[2],link[3]);
<a name="l00274"></a>00274       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;4;l++){
<a name="l00275"></a>00275    link[l] = IdSerial[link[l]];
<a name="l00276"></a>00276       }
<a name="l00277"></a>00277       printf(<span class="stringliteral">&quot;%d %d %d %d\n&quot;</span>,link[0],link[1],link[2],link[3]);
<a name="l00278"></a>00278       <span class="keywordtype">double</span> NanoAdded = Plot[(link[0])*NType+2]/Bound[2]+Plot[(link[0])*NType+3]/Bound[3];
<a name="l00279"></a>00279       <span class="keywordtype">double</span> Phob = t == 0 ? Plot[(link[0])*NType+0]/Bound[0] : 0.;
<a name="l00280"></a>00280       <span class="keywordtype">double</span> Phil = t == 1 ? Plot[(link[0])*NType+1]/Bound[1] : 0.;
<a name="l00281"></a>00281       <span class="keywordtype">double</span> r = (v)*InvValues*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(3);
<a name="l00282"></a>00282       <span class="keywordtype">double</span> z = (vv)*InvValues*(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>));
<a name="l00283"></a>00283       <span class="keywordtype">double</span> dens = (Plot[(link[0])*NType+t]);<span class="comment">//+Plot[(v*Values+vv)*NType+1]+Plot[(v*Values+vv)*NType+2]);</span>
<a name="l00284"></a>00284       fprintf(FWrite,<span class="stringliteral">&quot;{t[%d %d %d] x(%lf %lf %lf) v(%lf %lf %lf) l[%d] l[%d] l[%d] }\n&quot;</span>,link[0],c,t,r,z,dens,NanoAdded,Phob,Phil,link[1],link[2],link[3]);
<a name="l00285"></a>00285       p++;
<a name="l00286"></a>00286       c++;
<a name="l00287"></a>00287    }
<a name="l00288"></a>00288   }
<a name="l00289"></a>00289   free(IdSerial);
<a name="l00290"></a>00290 }
<a name="l00291"></a><a class="code" href="classVarData.html#a05977dbae3f034b4371646d6c1afbdcd">00291</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a05977dbae3f034b4371646d6c1afbdcd" title="Write the particle position as linked edges of squares.">VarData::WriteSurf</a>(FILE *F2Write,<span class="keywordtype">double</span> **Plot,<span class="keywordtype">int</span> NSample,<span class="keywordtype">int</span> OffSet){
<a name="l00292"></a>00292   <span class="keywordtype">double</span> InvNSample = 1./(double)NSample;
<a name="l00293"></a>00293   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> sx=0;sx&lt;NSample;sx++){
<a name="l00294"></a>00294     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> sy=0;sy&lt;NSample;sy++){
<a name="l00295"></a>00295       <span class="keywordtype">double</span> x = (sx+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>)*InvNSample;
<a name="l00296"></a>00296       <span class="keywordtype">double</span> y = (sy+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>)*InvNSample;
<a name="l00297"></a>00297       <span class="keywordtype">int</span> l01 = (sx+0)*NSample+(sy+1)+OffSet;
<a name="l00298"></a>00298       <span class="keywordflow">if</span>(sy == NSample - 1)
<a name="l00299"></a>00299    l01 = (sx+0)*NSample+(0)+OffSet;
<a name="l00300"></a>00300       <span class="keywordtype">int</span> l10 = (sx+1)*NSample+(sy+0)+OffSet;
<a name="l00301"></a>00301       <span class="keywordflow">if</span>(sx == NSample - 1)
<a name="l00302"></a>00302    l10 = (0)*NSample+(sy+0)+OffSet;
<a name="l00303"></a>00303       <span class="keywordtype">int</span> lm0 = (sx-1)*NSample+(sy+0)+OffSet;
<a name="l00304"></a>00304       <span class="keywordflow">if</span>(sx == 0)
<a name="l00305"></a>00305    lm0 = (NSample - 1)*NSample+(sy+0)+OffSet;
<a name="l00306"></a>00306       <span class="keywordtype">int</span> l0m = (sx+0)*NSample+(sy-1)+OffSet;
<a name="l00307"></a>00307       <span class="keywordflow">if</span>(sy == 0)
<a name="l00308"></a>00308    l0m = (sx)*NSample+(NSample-1)+OffSet;
<a name="l00309"></a>00309       fprintf(F2Write,<span class="stringliteral">&quot;{x(%lf %lf %lf) l[%d] l[%d] l[%d] l[%d]}\n&quot;</span>,x,y,Plot[sx][sy],l01,l10,lm0,l0m);
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311   }
<a name="l00312"></a>00312 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:21 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
