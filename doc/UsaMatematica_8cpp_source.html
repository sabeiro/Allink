<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/VarData/UsaMatematica.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_4fd85bb7e60d3734b722333cda33b932.html">VarData</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">UsaMatematica.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;../../include/Matematica.h&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;../../include/VarDatFile.h&quot;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00005"></a>00005 <span class="keyword">using namespace </span>std;
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv){
<a name="l00008"></a>00008   FILE *<a class="code" href="structSEGNALE.html">SEGNALE</a>;
<a name="l00009"></a>00009   <span class="keywordtype">char</span> Uscita[256];
<a name="l00010"></a>00010   <span class="keywordtype">char</span> Comando[50];
<a name="l00011"></a>00011   <span class="keywordtype">char</span> Executex[60];
<a name="l00012"></a>00012   <span class="keywordtype">char</span> Executey[60];
<a name="l00013"></a>00013   <span class="keywordtype">double</span> *Dis = <span class="keyword">new</span> double;
<a name="l00014"></a>00014   <span class="keywordtype">int</span> CoordX = 0;
<a name="l00015"></a>00015   <span class="keywordtype">int</span> NBin = 200;
<a name="l00016"></a>00016   <span class="keywordtype">int</span> NMax=0;
<a name="l00017"></a>00017   <span class="keywordtype">int</span> NVar =0;
<a name="l00018"></a>00018   <span class="keywordtype">int</span> CoordY = 1;
<a name="l00019"></a>00019   <span class="keywordtype">int</span> CoordY1 = 1;
<a name="l00020"></a>00020   <span class="keywordtype">int</span> CoordX1 = 1;
<a name="l00021"></a>00021   <span class="keywordtype">int</span> NMedia=10;
<a name="l00022"></a>00022   <span class="keywordtype">int</span> LogLog = 0;
<a name="l00023"></a>00023   <span class="keywordtype">int</span> IfNorm = 0;
<a name="l00024"></a>00024   <span class="keywordtype">int</span> IfBorder = 0;
<a name="l00025"></a>00025   <span class="keywordtype">int</span> NSample = 10;
<a name="l00026"></a>00026   <span class="keywordtype">double</span> *Intervalli;
<a name="l00027"></a>00027   <span class="keywordtype">double</span> *dInter;
<a name="l00028"></a>00028   <span class="comment">//vector &lt;double&gt; st;</span>
<a name="l00029"></a>00029   <span class="keywordtype">double</span> *sp;
<a name="l00030"></a>00030   <span class="keywordtype">double</span> *sw;
<a name="l00031"></a>00031   <span class="keywordtype">double</span> Border[4] = {0.,0.,0.,0.};
<a name="l00032"></a>00032   <span class="keywordtype">double</span> Param = 1.;
<a name="l00033"></a>00033   <a class="code" href="classVarDatFile.html" title="Reads and stores a data file to be elaborated via Matematica.">VarDatFile</a> *v1;
<a name="l00034"></a>00034   <a class="code" href="classMatematica.html" title="Implementation of useful algorythms.">Matematica</a> *m1 = <span class="keyword">new</span> <a class="code" href="classMatematica.html" title="Implementation of useful algorythms.">Matematica</a>();
<a name="l00035"></a>00035   <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> Mom;
<a name="l00036"></a>00036   sprintf(Uscita,<span class="stringliteral">&quot;Risposta.dat&quot;</span>);
<a name="l00037"></a>00037   <span class="comment">//  for(int i=0;i&lt;argc;i++){</span>
<a name="l00038"></a>00038   <span class="keywordtype">int</span> NFile = 0;
<a name="l00039"></a>00039   <span class="keywordtype">int</span> *ArgFile = (<span class="keywordtype">int</span> *)calloc(argc,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00040"></a>00040   <span class="keywordtype">int</span> IfUser = 1;
<a name="l00041"></a>00041   <span class="keywordtype">int</span> NElMin = 0;
<a name="l00042"></a>00042   <span class="keywordtype">int</span> NElMax = 0;
<a name="l00043"></a>00043   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;argc;i++){
<a name="l00044"></a>00044     <span class="keywordflow">if</span>(!strcmp(*(argv+i),<span class="stringliteral">&quot;--col&quot;</span>)){
<a name="l00045"></a>00045       <span class="keywordflow">if</span>(i&lt;argc-1){
<a name="l00046"></a>00046    i+=1;
<a name="l00047"></a>00047       }  
<a name="l00048"></a>00048     }
<a name="l00049"></a>00049     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(*(argv+i),<span class="stringliteral">&quot;--exec&quot;</span>)){
<a name="l00050"></a>00050       <span class="keywordflow">if</span>(i&lt;argc-1){
<a name="l00051"></a>00051    sprintf(Executex,<span class="stringliteral">&quot;%s&quot;</span>,*(argv+i+1));
<a name="l00052"></a>00052    sprintf(Executey,<span class="stringliteral">&quot;%s&quot;</span>,*(argv+i+2));
<a name="l00053"></a>00053    i+=2;
<a name="l00054"></a>00054    sprintf(Comando,<span class="stringliteral">&quot;exec&quot;</span>);
<a name="l00055"></a>00055    IfUser = 0;
<a name="l00056"></a>00056       }  
<a name="l00057"></a>00057     }
<a name="l00058"></a>00058     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--Border&quot;</span>,8)){
<a name="l00059"></a>00059       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;How many values?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00060"></a>00060       sscanf(argv[i+1],<span class="stringliteral">&quot;%lf&quot;</span>,Border);
<a name="l00061"></a>00061       sscanf(argv[i+2],<span class="stringliteral">&quot;%lf&quot;</span>,Border+1);
<a name="l00062"></a>00062       IfBorder=1;
<a name="l00063"></a>00063       i+=2;
<a name="l00064"></a>00064     }
<a name="l00065"></a>00065     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-l&quot;</span>,2)){
<a name="l00066"></a>00066       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Whic log scale?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00067"></a>00067       <span class="keywordtype">char</span> LogScale[12];
<a name="l00068"></a>00068       sscanf(argv[i+1],<span class="stringliteral">&quot;%s&quot;</span>,LogScale);
<a name="l00069"></a>00069       LogLog = 0;
<a name="l00070"></a>00070       <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;logx&quot;</span>))
<a name="l00071"></a>00071    DIS_ADD_TYPE(LogLog,DIS_LOGX);
<a name="l00072"></a>00072       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;logy&quot;</span>))
<a name="l00073"></a>00073    DIS_ADD_TYPE(LogLog,DIS_LOGY);
<a name="l00074"></a>00074       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;loglog&quot;</span>))
<a name="l00075"></a>00075    DIS_ADD_TYPE(LogLog,DIS_LOGLOG);
<a name="l00076"></a>00076       <span class="keywordflow">else</span>{
<a name="l00077"></a>00077    printf(<span class="stringliteral">&quot;Log scale not recognized\n&quot;</span>);
<a name="l00078"></a>00078       }
<a name="l00079"></a>00079       i+=1;
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--NElMin&quot;</span>,8)){
<a name="l00082"></a>00082       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;How many values?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00083"></a>00083       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;NElMin);
<a name="l00084"></a>00084       i+=1;
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--NElMax&quot;</span>,8)){
<a name="l00087"></a>00087       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;How many values?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00088"></a>00088       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;NElMax);
<a name="l00089"></a>00089       i+=1;
<a name="l00090"></a>00090     }
<a name="l00091"></a>00091     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-m&quot;</span>,2)){
<a name="l00092"></a>00092       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;which interval for the running average?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00093"></a>00093       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;NMedia);
<a name="l00094"></a>00094       i+=1;
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--norm&quot;</span>,6)){
<a name="l00097"></a>00097       IfNorm = 1;
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--NSample&quot;</span>,8)){
<a name="l00100"></a>00100       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;How many samples?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00101"></a>00101       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;NSample);
<a name="l00102"></a>00102       i+=1;
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-o&quot;</span>,2)){
<a name="l00105"></a>00105       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;which output file?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00106"></a>00106       sscanf(argv[i+1],<span class="stringliteral">&quot;%s&quot;</span>,Uscita);
<a name="l00107"></a>00107       i+=1;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-p&quot;</span>,2)){
<a name="l00110"></a>00110       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;what parameter?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00111"></a>00111       sscanf(argv[i+1],<span class="stringliteral">&quot;%lf&quot;</span>,&amp;Param);
<a name="l00112"></a>00112       i+=1;
<a name="l00113"></a>00113     }
<a name="l00114"></a>00114     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-v&quot;</span>,2)){
<a name="l00115"></a>00115       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;How many values?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00116"></a>00116       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;NBin);
<a name="l00117"></a>00117       i+=1;
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-x&quot;</span>,2)){
<a name="l00120"></a>00120       i+=1;
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-y&quot;</span>,2)){
<a name="l00123"></a>00123       i+=1;
<a name="l00124"></a>00124     }
<a name="l00125"></a>00125     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--&quot;</span>,2)){
<a name="l00126"></a>00126       sprintf(Comando,<span class="stringliteral">&quot;%s&quot;</span>,argv[i]+2);
<a name="l00127"></a>00127       IfUser = 0;
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strncmp(*(argv+i),<span class="stringliteral">&quot;-&quot;</span>,1)){
<a name="l00130"></a>00130       ArgFile[NFile] = i;
<a name="l00131"></a>00131       NFile++;
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133   }
<a name="l00134"></a>00134   <span class="keywordflow">if</span>(NFile == 0){
<a name="l00135"></a>00135     printf(<span class="stringliteral">&quot;File arguments are missing\n&quot;</span>);
<a name="l00136"></a>00136     <span class="comment">//return 0;</span>
<a name="l00137"></a>00137   }
<a name="l00138"></a>00138   v1 = <span class="keyword">new</span> <a class="code" href="classVarDatFile.html" title="Reads and stores a data file to be elaborated via Matematica.">VarDatFile</a>(argv,ArgFile,NFile,NBin);
<a name="l00139"></a>00139   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;argc;i++){
<a name="l00140"></a>00140     <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-a&quot;</span>,2)){
<a name="l00141"></a>00141       v1-&gt;<a class="code" href="classVarDatFile.html#a00eaf560508e46c0949042ab38af99de" title="Set the natural sequence as abscissa for the column Col.">ImpSequence</a>();
<a name="l00142"></a>00142       }
<a name="l00143"></a>00143     <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;--col&quot;</span>,5)){
<a name="l00144"></a>00144       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Which column?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00145"></a>00145       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;CoordY);
<a name="l00146"></a>00146       v1-&gt;<a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(CoordY);
<a name="l00147"></a>00147       i+=1;
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-l&quot;</span>,2)){
<a name="l00150"></a>00150       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Which coord for the  log scale?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00151"></a>00151       <span class="keywordtype">char</span> LogScale[12];
<a name="l00152"></a>00152       sscanf(argv[i+1],<span class="stringliteral">&quot;%s&quot;</span>,LogScale);
<a name="l00153"></a>00153       LogLog = 0;
<a name="l00154"></a>00154       <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;logx&quot;</span>))
<a name="l00155"></a>00155    DIS_ADD_TYPE(LogLog,DIS_LOGX);
<a name="l00156"></a>00156       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;logy&quot;</span>))
<a name="l00157"></a>00157    DIS_ADD_TYPE(LogLog,DIS_LOGY);
<a name="l00158"></a>00158       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(LogScale,<span class="stringliteral">&quot;loglog&quot;</span>))
<a name="l00159"></a>00159    DIS_ADD_TYPE(LogLog,DIS_LOGLOG);
<a name="l00160"></a>00160       <span class="keywordflow">else</span>{
<a name="l00161"></a>00161    printf(<span class="stringliteral">&quot;Log scale not recognized\n&quot;</span>);
<a name="l00162"></a>00162       }
<a name="l00163"></a>00163       i+=1;
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-y1&quot;</span>,3)){
<a name="l00166"></a>00166       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Which column?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00167"></a>00167       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;CoordY1);
<a name="l00168"></a>00168       i+=1;
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-x1&quot;</span>,3)){
<a name="l00171"></a>00171       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Which column?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00172"></a>00172       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;CoordX1);
<a name="l00173"></a>00173       i+=1;
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-x&quot;</span>,2)){
<a name="l00176"></a>00176       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;which x coord?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00177"></a>00177       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;CoordX);
<a name="l00178"></a>00178       v1-&gt;<a class="code" href="classVarDatFile.html#a963c1d12c9e593a16748f229bc5bd11f" title="Set the columns for the x array.">ImpCoordX</a>(CoordX);
<a name="l00179"></a>00179       i+=1;
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(*(argv+i),<span class="stringliteral">&quot;-y&quot;</span>,2)){
<a name="l00182"></a>00182       <span class="keywordflow">if</span>(argc &lt; i){printf(<span class="stringliteral">&quot;Which column?\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00183"></a>00183       sscanf(argv[i+1],<span class="stringliteral">&quot;%d&quot;</span>,&amp;CoordY);
<a name="l00184"></a>00184       v1-&gt;<a class="code" href="classVarDatFile.html#a4b08a81fa612f8cbeabb3618624fe7ca" title="Set the column for the y array.">ImpCoordY</a>(CoordY);
<a name="l00185"></a>00185       i+=1;
<a name="l00186"></a>00186     }
<a name="l00187"></a>00187   }
<a name="l00188"></a>00188   NMax = v1-&gt;<a class="code" href="classVarDatFile.html#a9dcafc8ed48e17a6980b121cb76e56fa" title="Print the maximum number of data in the array.">pNMax</a>();
<a name="l00189"></a>00189   <span class="keywordflow">if</span>(NElMax == 0 || NElMax &gt; NMax) NElMax = NMax;
<a name="l00190"></a>00190   <span class="keywordflow">if</span>(NElMin &gt; NMax || NElMin &lt; 0) NElMin = 0;
<a name="l00191"></a>00191   NVar = v1-&gt;<a class="code" href="classVarDatFile.html#aff25aa77a033788903eee04852e24cb6" title="Print the number of variables.">pNVar</a>();
<a name="l00192"></a>00192   sp = <span class="keyword">new</span> double;
<a name="l00193"></a>00193   sw = <span class="keyword">new</span> <span class="keywordtype">double</span>[NMax];
<a name="l00194"></a>00194   Intervalli = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00195"></a>00195   dInter = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00196"></a>00196   printf(<span class="stringliteral">&quot;Loaded a file of %d points %d cols from %d files: %s ... to write on %s\n&quot;</span>,NMax,NVar,NFile,argv[ArgFile[0]],Uscita);
<a name="l00197"></a>00197   <span class="comment">//goto vet;</span>
<a name="l00198"></a>00198   v1-&gt;<a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(NElMin,NElMax);
<a name="l00199"></a>00199   <span class="keywordflow">while</span>(strcmp(Comando,<span class="stringliteral">&quot;q&quot;</span>) ){
<a name="l00200"></a>00200     <span class="keywordflow">if</span>(IfUser){
<a name="l00201"></a>00201       printf(<span class="stringliteral">&quot;Matematica&gt; &quot;</span>);
<a name="l00202"></a>00202       scanf(<span class="stringliteral">&quot;%s&quot;</span>,Comando);
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;agg&quot;</span>)){
<a name="l00205"></a>00205       <span class="keywordtype">char</span> NomeFile[120];
<a name="l00206"></a>00206       printf(<span class="stringliteral">&quot;Nome file :&quot;</span>);
<a name="l00207"></a>00207       scanf(<span class="stringliteral">&quot;%s&quot;</span>,NomeFile);
<a name="l00208"></a>00208       v1-&gt;<a class="code" href="classVarDatFile.html#acd5ad8eb7d2e19f9341bbd969b8781f4" title="Add the content of the file into the memory.">Aggiungi</a>(NomeFile);
<a name="l00209"></a>00209       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;create&quot;</span>)){
<a name="l00212"></a>00212       FILE *Ciccia = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00213"></a>00213       <span class="keywordflow">if</span>(Ciccia == NULL){printf(<span class="stringliteral">&quot;%s could not be created\n&quot;</span>,Uscita);exit(0);}
<a name="l00214"></a>00214       <span class="keywordtype">int</span> NPassi = 100;
<a name="l00215"></a>00215       <span class="keywordtype">double</span> InvNPassi = 1./(double)NPassi;
<a name="l00216"></a>00216       <span class="keywordtype">double</span> Freq1 = 32.;
<a name="l00217"></a>00217       <span class="keywordtype">double</span> Freq2 = 4.;
<a name="l00218"></a>00218       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> px=0;px&lt;NPassi;px++){
<a name="l00219"></a>00219    <span class="keywordtype">double</span> x = px*InvNPassi*DUE_PI;
<a name="l00220"></a>00220    fprintf(Ciccia,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,sin(x*Freq1));
<a name="l00221"></a>00221       }
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;create2d&quot;</span>)){
<a name="l00224"></a>00224       FILE *Ciccia = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00225"></a>00225       <span class="keywordtype">int</span> NPassi = 100;
<a name="l00226"></a>00226       <span class="keywordtype">double</span> InvNPassi = 1./(double)NPassi;
<a name="l00227"></a>00227       <span class="keywordtype">double</span> Freq1 = 32.;
<a name="l00228"></a>00228       <span class="keywordtype">double</span> Freq2 = 4.;
<a name="l00229"></a>00229       <span class="keywordtype">int</span> IfOctave = 1;
<a name="l00230"></a>00230       <span class="keywordflow">if</span>(!IfOctave){
<a name="l00231"></a>00231    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> px=0;px&lt;NPassi;px++){
<a name="l00232"></a>00232      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> py=0;py&lt;NPassi;py++){
<a name="l00233"></a>00233        <span class="keywordtype">double</span> x = px*InvNPassi*DUE_PI;
<a name="l00234"></a>00234        <span class="keywordtype">double</span> y = py*InvNPassi*DUE_PI;
<a name="l00235"></a>00235        fprintf(Ciccia,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,x,y,sin(x*y*Freq1));
<a name="l00236"></a>00236      }
<a name="l00237"></a>00237    }
<a name="l00238"></a>00238       }
<a name="l00239"></a>00239       <span class="keywordflow">else</span>{
<a name="l00240"></a>00240    fprintf(Ciccia,<span class="stringliteral">&quot;# Created by ElPoly\n&quot;</span>);
<a name="l00241"></a>00241    fprintf(Ciccia,<span class="stringliteral">&quot;# name: tz\n&quot;</span>);
<a name="l00242"></a>00242    fprintf(Ciccia,<span class="stringliteral">&quot;# type: matrix\n&quot;</span>);
<a name="l00243"></a>00243    fprintf(Ciccia,<span class="stringliteral">&quot;# rows: %d\n&quot;</span>,NPassi); 
<a name="l00244"></a>00244    fprintf(Ciccia,<span class="stringliteral">&quot;# columns: %d\n&quot;</span>,NPassi); 
<a name="l00245"></a>00245    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> px=0;px&lt;NPassi;px++){
<a name="l00246"></a>00246      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> py=0;py&lt;NPassi;py++){
<a name="l00247"></a>00247        <span class="keywordtype">double</span> x = px*InvNPassi*DUE_PI;
<a name="l00248"></a>00248        <span class="keywordtype">double</span> y = py*InvNPassi*DUE_PI;
<a name="l00249"></a>00249        fprintf(Ciccia,<span class="stringliteral">&quot;%lf &quot;</span>,sin(x*y*Freq2));
<a name="l00250"></a>00250      }
<a name="l00251"></a>00251      fprintf(Ciccia,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00252"></a>00252    }
<a name="l00253"></a>00253       }
<a name="l00254"></a>00254       fclose(Ciccia);
<a name="l00255"></a>00255       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;dis&quot;</span>)){
<a name="l00258"></a>00258       Mom = v1-&gt;<a class="code" href="classVarDatFile.html#ac5e7b70f512f6a7a4dd83e942a65537a" title="Tests a gaussian distribution of the signal.">DistrGaussSegnale</a>(NElMin,NElMax,IfNorm);
<a name="l00259"></a>00259       FILE *USCITA;
<a name="l00260"></a>00260       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00261"></a>00261    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00262"></a>00262       }
<a name="l00263"></a>00263       fprintf(USCITA,<span class="stringliteral">&quot;# %lf %lf %lf\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>);
<a name="l00264"></a>00264       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00265"></a>00265    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>*i+Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>;
<a name="l00266"></a>00266    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(i));
<a name="l00267"></a>00267       }
<a name="l00268"></a>00268       fclose(USCITA);
<a name="l00269"></a>00269       printf(<span class="stringliteral">&quot;Media %lf Scarto %lf N %d\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>);
<a name="l00270"></a>00270       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00271"></a>00271     }
<a name="l00272"></a>00272     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;disErr&quot;</span>)){
<a name="l00273"></a>00273       Mom = v1-&gt;<a class="code" href="classVarDatFile.html#a418f05ea3f8e69dbc49adeccddbb8d66" title="Distribution of a signal with error.">DistrSignErr</a>(NElMin,NElMax,Border,IfNorm);
<a name="l00274"></a>00274       FILE *USCITA;
<a name="l00275"></a>00275       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00276"></a>00276    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00277"></a>00277       }
<a name="l00278"></a>00278       fprintf(USCITA,<span class="stringliteral">&quot;# %lf %lf %lf\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>);
<a name="l00279"></a>00279       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00280"></a>00280    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>*i+Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>;
<a name="l00281"></a>00281    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g %g\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(i),v1-&gt;<a class="code" href="classVarDatFile.html#ab59237e1fbf8ee4c45f7f189799ed008" title="Print the postion.">pError</a>(i));
<a name="l00282"></a>00282       }
<a name="l00283"></a>00283       fclose(USCITA);
<a name="l00284"></a>00284       printf(<span class="stringliteral">&quot;Media %lf Scarto %lf N %d\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>);
<a name="l00285"></a>00285       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;disB&quot;</span>)){
<a name="l00288"></a>00288       Mom = v1-&gt;<a class="code" href="classVarDatFile.html#a176c9a10a842e30206fe1ebece6917dc" title="Distribution of a signal.">DistrSegnale</a>(NElMin,NElMax,Border,IfNorm);
<a name="l00289"></a>00289       FILE *USCITA;
<a name="l00290"></a>00290       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00291"></a>00291    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,<span class="stringliteral">&quot;Distribuzione.dat&quot;</span>);
<a name="l00292"></a>00292       }
<a name="l00293"></a>00293       fprintf(USCITA,<span class="stringliteral">&quot;# %lf %lf %lf\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>);
<a name="l00294"></a>00294       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00295"></a>00295    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>*i+Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>;
<a name="l00296"></a>00296    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(i));
<a name="l00297"></a>00297       }
<a name="l00298"></a>00298       fclose(USCITA);
<a name="l00299"></a>00299       printf(<span class="stringliteral">&quot;Media %lf Scarto %lf N %d\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>);
<a name="l00300"></a>00300       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;disLog&quot;</span>)){
<a name="l00303"></a>00303       Mom = v1-&gt;<a class="code" href="classVarDatFile.html#a82c1693acb4e233005f36e72e10d8f84" title="Logarithmic distribution of a signal.">DistrLogSegnale</a>(NElMin,NElMax,IfNorm);
<a name="l00304"></a>00304       FILE *USCITA;
<a name="l00305"></a>00305       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00306"></a>00306    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,<span class="stringliteral">&quot;Distribuzione.dat&quot;</span>);
<a name="l00307"></a>00307       }
<a name="l00308"></a>00308       fprintf(USCITA,<span class="stringliteral">&quot;# %lf %lf %lf\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>);
<a name="l00309"></a>00309       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00310"></a>00310    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>*i+Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>;
<a name="l00311"></a>00311    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(i));
<a name="l00312"></a>00312       }
<a name="l00313"></a>00313       fclose(USCITA);
<a name="l00314"></a>00314       printf(<span class="stringliteral">&quot;Media %lf Scarto %lf N %d\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>);
<a name="l00315"></a>00315       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;disExp&quot;</span>)){
<a name="l00318"></a>00318       Mom = v1-&gt;<a class="code" href="classVarDatFile.html#a368bdb3c4de9a07c0ce1ea7edb331778" title="Exponential distribution of a signal.">DistrExpSegnale</a>(NElMin,NElMax,IfNorm);
<a name="l00319"></a>00319       FILE *USCITA;
<a name="l00320"></a>00320       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00321"></a>00321    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,<span class="stringliteral">&quot;Distribuzione.dat&quot;</span>);
<a name="l00322"></a>00322       }
<a name="l00323"></a>00323       fprintf(USCITA,<span class="stringliteral">&quot;# %lf %lf %lf\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>);
<a name="l00324"></a>00324       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00325"></a>00325    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>*i+Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>;
<a name="l00326"></a>00326    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(i));
<a name="l00327"></a>00327       }
<a name="l00328"></a>00328       fclose(USCITA);
<a name="l00329"></a>00329       printf(<span class="stringliteral">&quot;Media %lf Scarto %lf N %d\n&quot;</span>,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>,Mom.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>);
<a name="l00330"></a>00330       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;disSample&quot;</span>)){
<a name="l00333"></a>00333       <span class="keywordtype">double</span> xBound[2] = {Border[0],Border[1]};
<a name="l00334"></a>00334       <span class="keywordtype">double</span> **Distr;
<a name="l00335"></a>00335       Distr = <span class="keyword">new</span> <span class="keywordtype">double</span>*[NSample];
<a name="l00336"></a>00336       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample;s++){
<a name="l00337"></a>00337    Distr[s] = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00338"></a>00338       }
<a name="l00339"></a>00339       v1-&gt;<a class="code" href="classVarDatFile.html#ab0b5ef5ddc23685148eda453b09ba2f5" title="Distributions of data organized in different samples.">DistrSignSample</a>(NElMin,NElMax,Distr,NSample,IfNorm,xBound);
<a name="l00340"></a>00340       FILE *USCITA;
<a name="l00341"></a>00341       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00342"></a>00342    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,<span class="stringliteral">&quot;Distribuzione.dat&quot;</span>);
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344       fprintf(USCITA,<span class="stringliteral">&quot;# distribution per sample\n&quot;</span>);
<a name="l00345"></a>00345       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;NBin;b++){
<a name="l00346"></a>00346    <span class="keywordtype">double</span> x = b/(double)NBin*(xBound[1]-xBound[0]) + xBound[0];
<a name="l00347"></a>00347    fprintf(USCITA,<span class="stringliteral">&quot;%lf &quot;</span>,x);
<a name="l00348"></a>00348    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0;s&lt;NSample;s++){
<a name="l00349"></a>00349      fprintf(USCITA,<span class="stringliteral">&quot;%lf &quot;</span>,Distr[s][b]);
<a name="l00350"></a>00350    }
<a name="l00351"></a>00351    fprintf(USCITA,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00352"></a>00352       }
<a name="l00353"></a>00353       fclose(USCITA);
<a name="l00354"></a>00354       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;DrawEq&quot;</span>)){
<a name="l00357"></a>00357       FILE *FWrite = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00358"></a>00358       <span class="keywordflow">if</span>(!IfBorder){
<a name="l00359"></a>00359    Border[0] = v1-&gt;<a class="code" href="classVarDatFile.html#a6c9b0181c2505369c375bcb91f36409f" title="Print the abscissa minimum of all sets.">pxMinGlob</a>(NElMin,NElMax);
<a name="l00360"></a>00360    Border[1] = v1-&gt;<a class="code" href="classVarDatFile.html#ab594ce06a5fb24acf5c812f2d02fde06" title="Print the abscissa maximum of all sets.">pxMaxGlob</a>(NElMin,NElMax);
<a name="l00361"></a>00361       }
<a name="l00362"></a>00362       <span class="keywordtype">double</span> Dx = (Border[1]-Border[0])/(<span class="keywordtype">double</span>)NBin;
<a name="l00363"></a>00363       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NBin;i++){
<a name="l00364"></a>00364    <span class="keywordtype">double</span> x = i*Dx+Border[0];
<a name="l00365"></a>00365    fprintf(FWrite,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,v1-&gt;<a class="code" href="classMatematica.html#a4f67dd8ca48e4eccf15e32c736db6621" title="Trial function.">fProva</a>(x));
<a name="l00366"></a>00366       }
<a name="l00367"></a>00367       fclose(FWrite);
<a name="l00368"></a>00368       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00369"></a>00369     }    
<a name="l00370"></a>00370     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;coord&quot;</span>)){
<a name="l00371"></a>00371       printf(<span class="stringliteral">&quot;Number of coordinate: &quot;</span>);
<a name="l00372"></a>00372       <span class="keywordtype">int</span> NCoord = 0;
<a name="l00373"></a>00373       scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;NCoord);
<a name="l00374"></a>00374       <span class="keywordflow">if</span>(NCoord &gt;= 0 &amp;&amp; NCoord&lt;NVar)
<a name="l00375"></a>00375    v1-&gt;<a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(NCoord);
<a name="l00376"></a>00376       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00377"></a>00377     }
<a name="l00378"></a>00378     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;MatchCoord&quot;</span>)){
<a name="l00379"></a>00379       <span class="keywordtype">double</span> *st = (<span class="keywordtype">double</span> *)calloc(NMax,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00380"></a>00380       <span class="keywordtype">double</span> tInit = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX1,0);
<a name="l00381"></a>00381       <span class="keywordtype">int</span> mOld = 0;
<a name="l00382"></a>00382       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NElMin,m=0;n&lt;NElMax;n++){
<a name="l00383"></a>00383    mOld = m-1;
<a name="l00384"></a>00384    <span class="keywordflow">do</span> {
<a name="l00385"></a>00385      <span class="keywordtype">double</span> t = tInit + v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX,m);
<a name="l00386"></a>00386      <span class="comment">//printf(&quot;%d %d %lf &lt;= %lf &lt; %lf -&gt; %lf\n&quot;,n,m,v1-&gt;Val(CoordX1,n),t,v1-&gt;Val(CoordX1,n+1),st[n]);</span>
<a name="l00387"></a>00387      <span class="keywordflow">if</span>(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX1,n) &lt;= t &amp;&amp; t &lt; v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX1,n+1))
<a name="l00388"></a>00388        <span class="keywordflow">break</span>;
<a name="l00389"></a>00389      m++;
<a name="l00390"></a>00390      <span class="keywordflow">if</span>(m &gt;= NMax){
<a name="l00391"></a>00391        m = mOld;
<a name="l00392"></a>00392        <span class="keywordflow">break</span>;
<a name="l00393"></a>00393      }
<a name="l00394"></a>00394    } <span class="keywordflow">while</span>(1==1);
<a name="l00395"></a>00395    st[n] = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,m);
<a name="l00396"></a>00396    <span class="comment">//printf(&quot;%d %d %lf &lt;= %lf &lt; %lf -&gt; %lf\n&quot;,n,m,v1-&gt;Val(CoordX1,n),v1-&gt;Val(CoordX,m)+tInit,v1-&gt;Val(CoordX1,n+1),st[n]);</span>
<a name="l00397"></a>00397    m++;
<a name="l00398"></a>00398       }
<a name="l00399"></a>00399       FILE *USCITA;
<a name="l00400"></a>00400       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00401"></a>00401    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00402"></a>00402       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00403"></a>00403    fprintf(USCITA,<span class="stringliteral">&quot;%lf %.5g %.5g\n&quot;</span>,st[i],v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY1,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY1+1,i));
<a name="l00404"></a>00404       }
<a name="l00405"></a>00405       fclose(USCITA);
<a name="l00406"></a>00406       free(st);
<a name="l00407"></a>00407       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;norm&quot;</span>)){
<a name="l00410"></a>00410       FILE *USCITA;
<a name="l00411"></a>00411       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00412"></a>00412    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00413"></a>00413       v1-&gt;<a class="code" href="classVarDatFile.html#a0e495e387b74aaa6d55510a945236064" title="Normalize the signal.">NormalizzaSegnale</a>(NElMin,NElMax);
<a name="l00414"></a>00414       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00415"></a>00415    fprintf(USCITA,<span class="stringliteral">&quot;%lf %.5g\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i));
<a name="l00416"></a>00416       }
<a name="l00417"></a>00417       fclose(USCITA);
<a name="l00418"></a>00418       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00419"></a>00419     }
<a name="l00420"></a>00420     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;sin&quot;</span>)){
<a name="l00421"></a>00421       FILE *USCITA;
<a name="l00422"></a>00422       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00423"></a>00423    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00424"></a>00424       }
<a name="l00425"></a>00425       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;100;i++){
<a name="l00426"></a>00426    <span class="keywordtype">double</span> x = i*DUE_PI*.01;
<a name="l00427"></a>00427    fprintf(USCITA,<span class="stringliteral">&quot;%g\n&quot;</span>,sin(x));
<a name="l00428"></a>00428       }
<a name="l00429"></a>00429       fclose(USCITA);
<a name="l00430"></a>00430       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;sum&quot;</span>)){
<a name="l00433"></a>00433       <span class="keywordtype">double</span> Sum = 0.;
<a name="l00434"></a>00434       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00435"></a>00435    Sum += v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i);
<a name="l00436"></a>00436       }
<a name="l00437"></a>00437       printf(<span class="stringliteral">&quot;Sum: %lf\n&quot;</span>,Sum);
<a name="l00438"></a>00438       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;SpD&quot;</span>)){
<a name="l00441"></a>00441       printf(<span class="stringliteral">&quot;Calcolo lo spettro \n&quot;</span>);
<a name="l00442"></a>00442       m1-&gt;<a class="code" href="classMatematica.html#abe4888052d3a0b30d84f2b4c7a523328" title="Compute the spectrum.">Spettro</a>(sp,sw,NMax);
<a name="l00443"></a>00443       FILE *USCITA;
<a name="l00444"></a>00444       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00445"></a>00445    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00446"></a>00446    <span class="keywordflow">return</span> 0;
<a name="l00447"></a>00447       }
<a name="l00448"></a>00448       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax/2;i++){
<a name="l00449"></a>00449    fprintf(USCITA,<span class="stringliteral">&quot;%g\n&quot;</span>,sw[i]);
<a name="l00450"></a>00450       }
<a name="l00451"></a>00451       fclose(USCITA);
<a name="l00452"></a>00452       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00453"></a>00453     }
<a name="l00454"></a>00454     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;sort&quot;</span>)){
<a name="l00455"></a>00455       v1-&gt;<a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(0);
<a name="l00456"></a>00456       v1-&gt;<a class="code" href="classVarDatFile.html#ae424c3360277f457eba79fd25b4eed3b" title="Sort with respect to a coordinate.">Sort</a>();
<a name="l00457"></a>00457       v1-&gt;<a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d" title="Writes all the content in memory.">ScriviTutto</a>(Uscita,0,NElMin,NElMax);
<a name="l00458"></a>00458       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;Cas&quot;</span>)){
<a name="l00461"></a>00461       printf(<span class="stringliteral">&quot;Proviamo il generatore di numeri casuali \n&quot;</span>);
<a name="l00462"></a>00462       FILE *USCITA;
<a name="l00463"></a>00463       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00464"></a>00464    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00465"></a>00465       }
<a name="l00466"></a>00466       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;10000;i++){
<a name="l00467"></a>00467    fprintf(USCITA,<span class="stringliteral">&quot;%lf\n&quot;</span>,m1-&gt;<a class="code" href="classMatematica.html#a953e8be14f6a9c259f192683f3a5a970" title="Random uniform number.">Casuale</a>());
<a name="l00468"></a>00468       }
<a name="l00469"></a>00469       fclose(USCITA);
<a name="l00470"></a>00470        <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;Func&quot;</span>)){
<a name="l00473"></a>00473       FILE *USCITA;
<a name="l00474"></a>00474       printf(<span class="stringliteral">&quot;Proviamo una funzione \n&quot;</span>);
<a name="l00475"></a>00475       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00476"></a>00476    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00477"></a>00477       }
<a name="l00478"></a>00478       <span class="keywordflow">for</span>(<span class="keywordtype">double</span> x=0.,Dx=.001,Max=5.;x&lt;Max;x+=Dx){
<a name="l00479"></a>00479    printf(<span class="stringliteral">&quot;%lf\n&quot;</span>,x/Max);
<a name="l00480"></a>00480    fprintf(USCITA,<span class="stringliteral">&quot;%lf %g %g %g\n&quot;</span>,x,m1-&gt;<a class="code" href="classMatematica.html#af5ab240211f6f0aeada6022a32585acb" title="A faster Bessel.">QuasiBessel</a>(x,0),m1-&gt;<a class="code" href="classMatematica.html#af5ab240211f6f0aeada6022a32585acb" title="A faster Bessel.">QuasiBessel</a>(x,1),m1-&gt;<a class="code" href="classMatematica.html#af0a86b99b1cdbff64505cdef059e6d15" title="Bessel function.">Bessel</a>(x,0));
<a name="l00481"></a>00481    <span class="comment">//fprintf(USCITA,&quot;%lf %g %g %g\n&quot;,x,m1-&gt;Neumann(x,0),m1-&gt;Neumann(x,1),m1-&gt;Neumann(x,-1));</span>
<a name="l00482"></a>00482    x += Dx;
<a name="l00483"></a>00483       }
<a name="l00484"></a>00484       fclose(USCITA);
<a name="l00485"></a>00485       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;SpeLine&quot;</span>)){
<a name="l00488"></a>00488       <span class="keywordtype">int</span> NBin = NElMax-NElMin;
<a name="l00489"></a>00489       <span class="keywordtype">double</span> InvNVar = .5/(double)(NVar);
<a name="l00490"></a>00490       <span class="keywordtype">double</span> InvNBin = 1./(double)(NMax);
<a name="l00491"></a>00491       <span class="keywordtype">double</span> *Spe = (<span class="keywordtype">double</span> *)calloc(NBin,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00492"></a>00492       v1-&gt;<a class="code" href="classVarDatFile.html#a3a27fb16efc015da73aeb6d511d87252" title="Spectrum of a sequence of lines.">SpeLine</a>(NElMin,NElMax,NBin,Spe);
<a name="l00493"></a>00493       FILE *FWrite = fopen(<span class="stringliteral">&quot;StalkLineSpectrum.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00494"></a>00494       fprintf(FWrite,<span class="stringliteral">&quot;# q=2\\pi n/N &lt;h(q)^2&gt;\n&quot;</span>);
<a name="l00495"></a>00495       <span class="keywordtype">char</span> FName[120];
<a name="l00496"></a>00496       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NBin;n++){
<a name="l00497"></a>00497    fprintf(FWrite,<span class="stringliteral">&quot;%lf %g \n&quot;</span>,DUE_PI*InvNBin*n,Spe[n]*InvNVar*InvNBin);
<a name="l00498"></a>00498       }
<a name="l00499"></a>00499       fclose(FWrite);
<a name="l00500"></a>00500       free(Spe);
<a name="l00501"></a>00501       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;spe&quot;</span>) ){
<a name="l00504"></a>00504       FILE *USCITA;
<a name="l00505"></a>00505       m1-&gt;<a class="code" href="classMatematica.html#abe4888052d3a0b30d84f2b4c7a523328" title="Compute the spectrum.">Spettro</a>(v1-&gt;<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,sw,NMax);
<a name="l00506"></a>00506       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0){
<a name="l00507"></a>00507    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00508"></a>00508       }
<a name="l00509"></a>00509       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00510"></a>00510    fprintf(USCITA,<span class="stringliteral">&quot;%g\n&quot;</span>,sw[i]);
<a name="l00511"></a>00511       }
<a name="l00512"></a>00512       fclose(USCITA);
<a name="l00513"></a>00513       <span class="keywordflow">break</span>;
<a name="l00514"></a>00514       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;RadTens&quot;</span>) ){
<a name="l00517"></a>00517       <span class="keywordflow">if</span>(NFile != 4){
<a name="l00518"></a>00518    printf(<span class="stringliteral">&quot;I need the three components of the radial pressure\n&quot;</span>);
<a name="l00519"></a>00519    <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;   
<a name="l00520"></a>00520       }
<a name="l00521"></a>00521       FILE *RadTens = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00522"></a>00522       <span class="keywordtype">double</span> Vol1 = 0.;
<a name="l00523"></a>00523       <span class="keywordtype">double</span> Vol2 = 0.;
<a name="l00524"></a>00524       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax-1;n++){
<a name="l00525"></a>00525    Vol1 = DUE_PI*SQR(v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,n+1));
<a name="l00526"></a>00526    <span class="keywordtype">double</span> Prr = sqrt( SQR(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(1,n)) + SQR(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(6,n)));
<a name="l00527"></a>00527    <span class="keywordtype">double</span> Pzz = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(11,n);
<a name="l00528"></a>00528    <span class="keywordtype">double</span> PTrace = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(1,n)+v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(5,n)+v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(11,n);
<a name="l00529"></a>00529    <span class="keywordtype">double</span> Ptt = .5*(PTrace - Prr);
<a name="l00530"></a>00530    <span class="keywordtype">double</span> SurfTens = (Prr - .5*(Ptt+Pzz))/(Vol1-Vol2);
<a name="l00531"></a>00531    fprintf(RadTens,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,n),SurfTens);
<a name="l00532"></a>00532    Vol2 = Vol1;
<a name="l00533"></a>00533       }
<a name="l00534"></a>00534       fclose(RadTens);
<a name="l00535"></a>00535       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;perm&quot;</span>) ){
<a name="l00538"></a>00538       <span class="keywordtype">int</span> NMax = 16;
<a name="l00539"></a>00539       <a class="code" href="structPERMUTE.html" title="Indices for the permutation.">PERMUTE</a> *Perm = (<a class="code" href="structPERMUTE.html" title="Indices for the permutation.">PERMUTE</a> *)calloc(NMax,<span class="keyword">sizeof</span>(<a class="code" href="structPERMUTE.html" title="Indices for the permutation.">PERMUTE</a>));
<a name="l00540"></a>00540       m1-&gt;<a class="code" href="classMatematica.html#ab5122ddcd9bce12ff5049a5ad2b5cb6d" title="Permutes a sequence without repeating.">PermuteRandomAll</a>(Perm,NMax);
<a name="l00541"></a>00541       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;solve&quot;</span>) ){
<a name="l00544"></a>00544       <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *A = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(4,4);
<a name="l00545"></a>00545 <span class="comment">//       Matrice Pasquale(4);</span>
<a name="l00546"></a>00546 <span class="comment">//       Matrice Romualdo(4);</span>
<a name="l00547"></a>00547 <span class="comment">//       Matrice Adalgiso(4);</span>
<a name="l00548"></a>00548 <span class="comment">//       Matrice Goffredo(4);</span>
<a name="l00549"></a>00549 <span class="comment">//       Pasquale.RandomFill(1.);</span>
<a name="l00550"></a>00550 <span class="comment">//       Romualdo.RandomFill(1.);</span>
<a name="l00551"></a>00551 <span class="comment">//       //Pasquale = Romualdo;</span>
<a name="l00552"></a>00552 <span class="comment">//       Adalgiso.Mult(Pasquale,Romualdo);</span>
<a name="l00553"></a>00553 <span class="comment">//       Adalgiso.Print();</span>
<a name="l00554"></a>00554 <span class="comment">//       exit(0);</span>
<a name="l00555"></a>00555       A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(0,0,1.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(0,1,6.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(0,2,5.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(0,3,8.);
<a name="l00556"></a>00556       A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(1,0,5.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(1,1,2.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(1,2,5.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(1,3,5.);
<a name="l00557"></a>00557       A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(2,0,6.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(2,1,3.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(2,2,7.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(2,3,1.);
<a name="l00558"></a>00558       A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(3,0,8.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(3,1,7.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(3,2,2.);A-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(3,3,6.);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560 <span class="comment">//       A-&gt;Set(0,0,1.);A-&gt;Set(0,1,0.);A-&gt;Set(0,2,0.);A-&gt;Set(0,3,1.);</span>
<a name="l00561"></a>00561 <span class="comment">//       A-&gt;Set(1,0,0.);A-&gt;Set(1,1,1.);A-&gt;Set(1,2,0.);A-&gt;Set(1,3,0.);</span>
<a name="l00562"></a>00562 <span class="comment">//       A-&gt;Set(2,0,0.);A-&gt;Set(2,1,0.);A-&gt;Set(2,2,1.);A-&gt;Set(2,3,0.);</span>
<a name="l00563"></a>00563 <span class="comment">//       A-&gt;Set(3,0,2.);A-&gt;Set(3,1,0.);A-&gt;Set(3,2,0.);A-&gt;Set(3,3,1.);</span>
<a name="l00564"></a>00564       <span class="comment">//      A-&gt;RandomFill(20.);</span>
<a name="l00565"></a>00565       A-&gt;<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l00566"></a>00566       <span class="keywordtype">double</span> *Known = (<span class="keywordtype">double</span> *)calloc(4,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00567"></a>00567       Known[0] = 1.; Known[1] = 4.; Known[2] = 3.; Known[3] = 2.;
<a name="l00568"></a>00568       <span class="keywordtype">double</span> *UnKnown = (<span class="keywordtype">double</span> *)calloc(4,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00569"></a>00569       A-&gt;<a class="code" href="classMatrice.html#a660450c11d8e8ec196d63da73323a7cd" title="Solve a system A|b = y.">Solve</a>(Known,UnKnown);
<a name="l00570"></a>00570       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++){
<a name="l00571"></a>00571    printf(<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,Known[i],UnKnown[i]);
<a name="l00572"></a>00572       }
<a name="l00573"></a>00573       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00574"></a>00574     }
<a name="l00575"></a>00575     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;zeri&quot;</span>) ){
<a name="l00576"></a>00576       <span class="keywordtype">double</span> a=0.,b=0.;
<a name="l00577"></a>00577       <span class="keywordtype">int</span> rad;
<a name="l00578"></a>00578 <span class="comment">//       printf(&quot;Minimo valore: &quot;);</span>
<a name="l00579"></a>00579 <span class="comment">//       scanf(&quot;%lf&quot;,&amp;a);</span>
<a name="l00580"></a>00580 <span class="comment">//       printf(&quot;Massimo valore: &quot;);</span>
<a name="l00581"></a>00581 <span class="comment">//       scanf(&quot;%lf&quot;,&amp;b);</span>
<a name="l00582"></a>00582 <span class="comment">//%% 2.5 </span>
<a name="l00583"></a>00583 <span class="comment">//%% 2.0</span>
<a name="l00584"></a>00584 <span class="comment">//%% 1.5 23.376860  3817.700000</span>
<a name="l00585"></a>00585 <span class="comment">//%% 1.0 21.643605  3817.700000</span>
<a name="l00586"></a>00586       <span class="keywordtype">int</span> NRadici = 4;
<a name="l00587"></a>00587       <span class="keywordtype">double</span> *Radici;
<a name="l00588"></a>00588       m1-&gt;<a class="code" href="classMatematica.html#aa06af2f751c2d30f883911088239686e" title="External parameter to calculate the contact angle.">Ypsilon</a> = 23.37;
<a name="l00589"></a>00589       m1-&gt;<a class="code" href="classMatematica.html#a4eff9d128336501e44aac2b9524eb6b0" title="External parameter in the definition of the contact angle.">PreFact</a> = 3817.7;;
<a name="l00590"></a>00590       m1-&gt;<a class="code" href="classMatematica.html#aba8f98cb34b78863b26b00d33aabdc1d" title="Pointer to a function.">Func</a> = &amp;<a class="code" href="classMatematica.html#a2dd3ba2334c4444c4ef406347618c170" title="Definition of the contact angle.">Matematica::ContactAngle</a>;
<a name="l00591"></a>00591       Radici = (<span class="keywordtype">double</span> *)malloc(NRadici*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00592"></a>00592       rad = m1-&gt;<a class="code" href="classMatematica.html#af1e1e5332753626f39db69dca411ecfc" title="Find the.">Zeri</a>(0.,DUE_PI/2.,Radici,NRadici);
<a name="l00593"></a>00593       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;fal&quot;</span>) ){
<a name="l00596"></a>00596       <span class="keywordtype">double</span> a=0.,b=0.;
<a name="l00597"></a>00597       <a class="code" href="structRADICE.html" title="Where a root was searched.">RADICE</a> Zero;
<a name="l00598"></a>00598 <span class="comment">//       printf(&quot;Minimo valore: &quot;);</span>
<a name="l00599"></a>00599 <span class="comment">//       scanf(&quot;%lf&quot;,&amp;a);</span>
<a name="l00600"></a>00600 <span class="comment">//       printf(&quot;Massimo valore: &quot;);</span>
<a name="l00601"></a>00601 <span class="comment">//       scanf(&quot;%lf&quot;,&amp;b);</span>
<a name="l00602"></a>00602       Zero = m1-&gt;<a class="code" href="classMatematica.html#a5b8fbf8c761f9756710aeed5caed4c5e" title="Use regula falsi algorithm to find the roots.">RegulaFalsi</a>(.1,3.);
<a name="l00603"></a>00603       printf(<span class="stringliteral">&quot;Lo Zero e in x %lf\n&quot;</span>,Zero.<a class="code" href="structRADICE.html#a6d82c7bcdff1f26e7560b2fb295daf3e" title="Point of the zero.">Zero</a>);
<a name="l00604"></a>00604       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00605"></a>00605     }
<a name="l00606"></a>00606     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;new&quot;</span>) ){
<a name="l00607"></a>00607       <span class="keywordtype">double</span> a=0.;
<a name="l00608"></a>00608       <a class="code" href="structRADICE.html" title="Where a root was searched.">RADICE</a> Zero;
<a name="l00609"></a>00609       printf(<span class="stringliteral">&quot;Punto iniziale: &quot;</span>);
<a name="l00610"></a>00610       scanf(<span class="stringliteral">&quot;%lf&quot;</span>,&amp;a);
<a name="l00611"></a>00611       Zero = m1-&gt;<a class="code" href="classMatematica.html#a721bd6eae0ff0aa70b8b37327b084e78" title="Use Newton to find the roots.">Newton</a>(a);
<a name="l00612"></a>00612       printf(<span class="stringliteral">&quot;Lo Zero e in x %lf\n&quot;</span>,Zero.<a class="code" href="structRADICE.html#a6d82c7bcdff1f26e7560b2fb295daf3e" title="Point of the zero.">Zero</a>);
<a name="l00613"></a>00613       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00614"></a>00614     }
<a name="l00615"></a>00615     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;fun&quot;</span>) ){
<a name="l00616"></a>00616       FILE *USCITA;
<a name="l00617"></a>00617       USCITA = fopen(<span class="stringliteral">&quot;Funzione.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00618"></a>00618       <span class="keywordtype">double</span> A = 0.;
<a name="l00619"></a>00619       <span class="keywordtype">double</span> B = DUE_PI;
<a name="l00620"></a>00620       <span class="keywordtype">int</span> NPunti = 10000;
<a name="l00621"></a>00621       <span class="keywordtype">double</span> Delta = (B-A)/(<span class="keywordtype">double</span>)NPunti; 
<a name="l00622"></a>00622       m1-&gt;<a class="code" href="classMatematica.html#aa06af2f751c2d30f883911088239686e" title="External parameter to calculate the contact angle.">Ypsilon</a> = 3.814;
<a name="l00623"></a>00623       m1-&gt;<a class="code" href="classMatematica.html#a4eff9d128336501e44aac2b9524eb6b0" title="External parameter in the definition of the contact angle.">PreFact</a> = 0.169370;
<a name="l00624"></a>00624       m1-&gt;<a class="code" href="classMatematica.html#aba8f98cb34b78863b26b00d33aabdc1d" title="Pointer to a function.">Func</a> = &amp;<a class="code" href="classMatematica.html#a2dd3ba2334c4444c4ef406347618c170" title="Definition of the contact angle.">Matematica::ContactAngle</a>;
<a name="l00625"></a>00625       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NPunti;i++){
<a name="l00626"></a>00626    fprintf(USCITA,<span class="stringliteral">&quot;%g  %g\n&quot;</span>,Delta*(<span class="keywordtype">double</span>)i,m1-&gt;<a class="code" href="classMatematica.html#a628ac1d3c644d78362e0ec3aff1d2448" title="Pointer to a generic function.">Evalx</a>(Delta*(<span class="keywordtype">double</span>)i));
<a name="l00627"></a>00627       }
<a name="l00628"></a>00628       fclose(USCITA);
<a name="l00629"></a>00629       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;FitLin&quot;</span>) ){
<a name="l00632"></a>00632       FILE *USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00633"></a>00633       <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1 = v1-&gt;<a class="code" href="classVarDatFile.html#ad705e28f47a98707e3dd3c83d86e85b3" title="Computes a liner fit.">InterRettSegnale</a>(CoordY,NElMin,NElMax,LogLog);
<a name="l00634"></a>00634       printf(<span class="stringliteral">&quot;y = (%lf +- %lf)x + (%lf +- %lf)\n&quot;</span>,r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>,r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>,r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a>);
<a name="l00635"></a>00635       fprintf(USCITA,<span class="stringliteral">&quot;#y = (%lf +- %lf)x + (%lf +- %lf)\n&quot;</span>,r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>,r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>,r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a>);
<a name="l00636"></a>00636       <span class="keywordflow">if</span>(!LogLog){
<a name="l00637"></a>00637    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00638"></a>00638      fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)*r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>+r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>);
<a name="l00639"></a>00639    }
<a name="l00640"></a>00640       }
<a name="l00641"></a>00641       <span class="keywordflow">else</span>{
<a name="l00642"></a>00642    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00643"></a>00643      <span class="keywordflow">if</span>(v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i) &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00644"></a>00644      <span class="keywordflow">if</span>(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i) &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l00645"></a>00645      fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,log10(v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)),log10(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i)),log10(v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i))*r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>+r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>);
<a name="l00646"></a>00646    }
<a name="l00647"></a>00647       }
<a name="l00648"></a>00648       fclose(USCITA);
<a name="l00649"></a>00649       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;FitPara&quot;</span>) ){
<a name="l00652"></a>00652       FILE *USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00653"></a>00653       <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> p1 = v1-&gt;<a class="code" href="classVarDatFile.html#a670b0120b56b71deeb92a07dbc2d1a93" title="Computes a parabolic fit.">ParabolaSegnale</a>(CoordY,NElMin,NElMax,LogLog);
<a name="l00654"></a>00654       printf(<span class="stringliteral">&quot;%.2g + %.2g x + %.2g x^2\n&quot;</span>,p1.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a>,p1.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>,p1.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>);
<a name="l00655"></a>00655       printf(<span class="stringliteral">&quot;Minimum %.2g \n&quot;</span>,p1.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a>);
<a name="l00656"></a>00656       fprintf(USCITA,<span class="stringliteral">&quot;#%.2g + %.2g x + %.2g x^2\n&quot;</span>,p1.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a>,p1.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>,p1.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>);
<a name="l00657"></a>00657       fprintf(USCITA,<span class="stringliteral">&quot;#Minimum %.2g \n&quot;</span>,p1.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a>);
<a name="l00658"></a>00658       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00659"></a>00659    fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)*p1.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>+v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)*v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)*p1.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>+p1.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a>);
<a name="l00660"></a>00660       }
<a name="l00661"></a>00661       fclose(USCITA);
<a name="l00662"></a>00662       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;FitExp&quot;</span>) ){
<a name="l00665"></a>00665       FILE *USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00666"></a>00666       <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1 = v1-&gt;<a class="code" href="classVarDatFile.html#a7e8033bdeb05d587eb6ce7dedf3ffe8b" title="Computes a exponential fit.">InterExpSegnale</a>(CoordY,NElMin,NElMax,LogLog);
<a name="l00667"></a>00667       printf(<span class="stringliteral">&quot;y=(%.3g+-%.3g)exp(x/(%.3g+-%.3g))\n&quot;</span>,log10(r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>),log10(r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a>),1./r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>/SQR(r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>));
<a name="l00668"></a>00668       printf(<span class="stringliteral">&quot;decay t_d = %.4g +- %.4g\n&quot;</span>,1./r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>/SQR(r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>));
<a name="l00669"></a>00669       fprintf(USCITA,<span class="stringliteral">&quot;#y=(%.3g+-%.3g)exp(x/(%.3g+-%.3g))\n&quot;</span>,log10(r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>),log10(r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a>),1./r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>/SQR(r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>));
<a name="l00670"></a>00670       fprintf(USCITA,<span class="stringliteral">&quot;#decay t_d = %.4g +- %.4g\n&quot;</span>,1./r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>,r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a>/SQR(r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>));
<a name="l00671"></a>00671       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00672"></a>00672    fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i),exp(r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a>+r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>*v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i)));
<a name="l00673"></a>00673       }
<a name="l00674"></a>00674       fclose(USCITA);
<a name="l00675"></a>00675       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;Prob2Nrg&quot;</span>) ){
<a name="l00678"></a>00678       FILE *File2Write = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00679"></a>00679       <span class="keywordflow">if</span>(File2Write == NULL){
<a name="l00680"></a>00680    printf(<span class="stringliteral">&quot;Could not open %s\n&quot;</span>,Uscita);
<a name="l00681"></a>00681    <span class="keywordflow">return</span> 1;
<a name="l00682"></a>00682       }
<a name="l00683"></a>00683       <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> Mom = v1-&gt;<a class="code" href="classVarDatFile.html#a176c9a10a842e30206fe1ebece6917dc" title="Distribution of a signal.">DistrSegnale</a>(NElMin,NElMax,IfNorm);
<a name="l00684"></a>00684       v1-&gt;<a class="code" href="classVarDatFile.html#a2f01ea77260e98cb7edbb892988fd687" title="Normalize the intervals.">NormalizzaInter</a>();
<a name="l00685"></a>00685       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NBin;v++){
<a name="l00686"></a>00686    <span class="keywordtype">double</span> x = Mom.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a> + v*Mom.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>;
<a name="l00687"></a>00687    <span class="keywordflow">if</span>(v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(v) &gt; 0.)
<a name="l00688"></a>00688      fprintf(File2Write,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,-log(v1-&gt;<a class="code" href="classVarDatFile.html#ac9b6015f7712a2bffde3a609145331af" title="Print the postion.">pInter</a>(v)));
<a name="l00689"></a>00689       }
<a name="l00690"></a>00690       fclose(File2Write);
<a name="l00691"></a>00691       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;min&quot;</span>) ){
<a name="l00694"></a>00694       <span class="keywordtype">double</span> Min = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,0);
<a name="l00695"></a>00695       <span class="keywordtype">int</span> nMin = 0;
<a name="l00696"></a>00696       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00697"></a>00697    <span class="keywordflow">if</span>(Min &gt; v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,n)){
<a name="l00698"></a>00698      Min = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,n);
<a name="l00699"></a>00699      nMin = n;
<a name="l00700"></a>00700    }
<a name="l00701"></a>00701       }
<a name="l00702"></a>00702       printf(<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX,nMin),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,nMin));
<a name="l00703"></a>00703       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;mm&quot;</span>) ){
<a name="l00706"></a>00706       printf(<span class="stringliteral">&quot;Number of points per sample: %d\n&quot;</span>,NMedia);
<a name="l00707"></a>00707       <span class="keywordtype">int</span> NSample = v1-&gt;<a class="code" href="classVarDatFile.html#af61093b90aceaaeaabfaf6364db43abf" title="Running average.">MediaMobSegnale</a>(NMedia);
<a name="l00708"></a>00708       <span class="keywordtype">double</span> Deltax = 1.;<span class="comment">//(v1-&gt;pxMax()-v1-&gt;pxMin())/(double)NSample;</span>
<a name="l00709"></a>00709       FILE *USCITA;
<a name="l00710"></a>00710       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00711"></a>00711    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00712"></a>00712       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NSample;i++){
<a name="l00713"></a>00713    fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i*NMedia)+Deltax,v1-&gt;<a class="code" href="classVarDatFile.html#aceb09b397fee83699a8b810fcaa02d26" title="Value of the elaborated array at position.">pPunti</a>(i),v1-&gt;<a class="code" href="classVarDatFile.html#a3a14794e0583788d1cd614bfa4aa4a17" title="Value of the error array at postion.">pPuntiErr</a>(i));
<a name="l00714"></a>00714       }
<a name="l00715"></a>00715       fclose(USCITA);
<a name="l00716"></a>00716       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;WeightHisto&quot;</span>) ){
<a name="l00719"></a>00719       v1-&gt;<a class="code" href="classVarDatFile.html#ad6521d627ba809d5e253cefcd5090491" title="Weighted histogram analysis.">WeightHistoSign</a>(NFile);
<a name="l00720"></a>00720       <span class="comment">// FILE *USCITA;</span>
<a name="l00721"></a>00721       <span class="comment">// if((USCITA = fopen(Uscita,&quot;w&quot;))==0)</span>
<a name="l00722"></a>00722       <span class="comment">//    printf(&quot;Non s&#39;apre %s\n Permessi?\n&quot;,Uscita);</span>
<a name="l00723"></a>00723       <span class="comment">// for(int i=0;i&lt;NSample;i++){</span>
<a name="l00724"></a>00724       <span class="comment">//    fprintf(USCITA,&quot;%lf %lf %lf\n&quot;,v1-&gt;Abscissa(CoordY,i*NMedia)+Deltax,v1-&gt;pPunti(i),v1-&gt;pPuntiErr(i));</span>
<a name="l00725"></a>00725       <span class="comment">// }</span>
<a name="l00726"></a>00726       <span class="comment">// fclose(USCITA);</span>
<a name="l00727"></a>00727       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;int&quot;</span>)){
<a name="l00730"></a>00730       <span class="keywordtype">double</span> Int = v1-&gt;<a class="code" href="classVarDatFile.html#a43b771dc3214a9a36b2aa2a91ffb8edb" title="Numerical integration of the signal.">IntSegnale</a>();
<a name="l00731"></a>00731       FILE *USCITA;
<a name="l00732"></a>00732       <span class="keywordflow">if</span>((USCITA = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00733"></a>00733    printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n Permessi?\n&quot;</span>,Uscita);
<a name="l00734"></a>00734       printf(<span class="stringliteral">&quot;%d %d %d\n&quot;</span>,NElMin,NElMax,v1-&gt;<a class="code" href="classVarDatFile.html#a9dcafc8ed48e17a6980b121cb76e56fa" title="Print the maximum number of data in the array.">pNMax</a>());
<a name="l00735"></a>00735       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00736"></a>00736    fprintf(USCITA,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(CoordY,i),v1-&gt;<a class="code" href="classVarDatFile.html#aceb09b397fee83699a8b810fcaa02d26" title="Value of the elaborated array at position.">pPunti</a>(i));
<a name="l00737"></a>00737       }
<a name="l00738"></a>00738       printf(<span class="stringliteral">&quot;%lf\n&quot;</span>,Int);
<a name="l00739"></a>00739       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;mom&quot;</span>)){
<a name="l00742"></a>00742       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00743"></a>00743    v1-&gt;<a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(v);
<a name="l00744"></a>00744    Mom = v1-&gt;<a class="code" href="classVarDatFile.html#ac5e7b70f512f6a7a4dd83e942a65537a" title="Tests a gaussian distribution of the signal.">DistrGaussSegnale</a>(NElMin,NElMax,IfNorm);
<a name="l00745"></a>00745    printf(<span class="stringliteral">&quot;%d) %lf pm %lf\n&quot;</span>,v,Mom.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,Mom.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>);
<a name="l00746"></a>00746       }
<a name="l00747"></a>00747       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00748"></a>00748     }
<a name="l00749"></a>00749     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;exec&quot;</span>)){
<a name="l00750"></a>00750       <span class="keywordflow">if</span>(IfUser){
<a name="l00751"></a>00751    printf(<span class="stringliteral">&quot;Inserire la formula per x: &quot;</span>);
<a name="l00752"></a>00752    scanf(<span class="stringliteral">&quot;%s&quot;</span>,Executex);
<a name="l00753"></a>00753    printf(<span class="stringliteral">&quot;Inserire la formula per y: &quot;</span>);
<a name="l00754"></a>00754    scanf(<span class="stringliteral">&quot;%s&quot;</span>,Executey);
<a name="l00755"></a>00755       }
<a name="l00756"></a>00756       FILE *Ciccia = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00757"></a>00757       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00758"></a>00758    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00759"></a>00759      <span class="keywordtype">double</span> Val = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(v,i);
<a name="l00760"></a>00760      <span class="keywordflow">if</span>(v==CoordX) 
<a name="l00761"></a>00761        Val = v1-&gt;<a class="code" href="classMatematica.html#aa8b3417ffb15a1c67df01163d9d2fc35" title="Execute a formula.">ExecFormula</a>(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i),Executex);
<a name="l00762"></a>00762      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v==CoordY) 
<a name="l00763"></a>00763        Val = v1-&gt;<a class="code" href="classMatematica.html#aa8b3417ffb15a1c67df01163d9d2fc35" title="Execute a formula.">ExecFormula</a>(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordX,i),v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(CoordY,i),Executey);
<a name="l00764"></a>00764      fprintf(Ciccia,<span class="stringliteral">&quot;%.5g &quot;</span>,Val);
<a name="l00765"></a>00765    }
<a name="l00766"></a>00766    fprintf(Ciccia,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00767"></a>00767       }
<a name="l00768"></a>00768       fclose(Ciccia);
<a name="l00769"></a>00769       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;widom&quot;</span>)){
<a name="l00772"></a>00772       FILE *Widom = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00773"></a>00773       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00774"></a>00774    <span class="keywordflow">if</span>(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(3,i)*v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(1,i) &gt; 0.){
<a name="l00775"></a>00775      <span class="keywordtype">double</span> Arg = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(3,i)/(v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(1,i));
<a name="l00776"></a>00776      <span class="keywordtype">double</span> ChemPot = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(0,i) + log(Arg);
<a name="l00777"></a>00777      fprintf(Widom,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(0,i),ChemPot);
<a name="l00778"></a>00778    }
<a name="l00779"></a>00779       }
<a name="l00780"></a>00780       fclose(Widom);
<a name="l00781"></a>00781       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00782"></a>00782     }
<a name="l00783"></a>00783     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;DecayTime&quot;</span>)){
<a name="l00784"></a>00784       <span class="keywordtype">double</span> *st = <span class="keyword">new</span> <span class="keywordtype">double</span>[NVar];
<a name="l00785"></a>00785       <span class="keywordtype">double</span> *sw = <span class="keyword">new</span> <span class="keywordtype">double</span>[NVar];
<a name="l00786"></a>00786       FILE *DecayTime = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00787"></a>00787       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;NVar;f++){
<a name="l00788"></a>00788    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=NElMin;i&lt;NElMax;i++){
<a name="l00789"></a>00789      st[f] = v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(0,i)*v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(f,i);
<a name="l00790"></a>00790    }
<a name="l00791"></a>00791    st[f] /= (double)v1-&gt;<a class="code" href="classVarDatFile.html#a9dcafc8ed48e17a6980b121cb76e56fa" title="Print the maximum number of data in the array.">pNMax</a>();
<a name="l00792"></a>00792       }
<a name="l00793"></a>00793       m1-&gt;<a class="code" href="classMatematica.html#abe4888052d3a0b30d84f2b4c7a523328" title="Compute the spectrum.">Spettro</a>(st,sw,NVar);
<a name="l00794"></a>00794       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;NVar;f++){
<a name="l00795"></a>00795    fprintf(DecayTime,<span class="stringliteral">&quot;%d %g %g\n&quot;</span>,f,sw[f],st[f]);
<a name="l00796"></a>00796       }
<a name="l00797"></a>00797       fclose(DecayTime);
<a name="l00798"></a>00798       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;reverse&quot;</span>) ){
<a name="l00801"></a>00801       v1-&gt;<a class="code" href="classVarDatFile.html#ae1b551cc51c9d556342b27b466a7c7cb" title="Reverse the sets.">Reverse</a>();
<a name="l00802"></a>00802       v1-&gt;<a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d" title="Writes all the content in memory.">ScriviTutto</a>(Uscita,0,NElMin,NElMax);
<a name="l00803"></a>00803       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00804"></a>00804     }
<a name="l00805"></a>00805     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;DoubleDist&quot;</span>) ){
<a name="l00806"></a>00806       v1-&gt;<a class="code" href="classVarDatFile.html#a6ab47ee0a227e3e13f042327b1f8fe33" title="Distribution of distances.">DoubleDistFluct</a>();
<a name="l00807"></a>00807       v1-&gt;<a class="code" href="classVarDatFile.html#a15ad052575da97bec5b2bad38a52385e" title="Writes the content of the elaborated array.">ScriviPunti</a>(Uscita);
<a name="l00808"></a>00808       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;smooth&quot;</span>) ){
<a name="l00811"></a>00811       v1-&gt;<a class="code" href="classVarDatFile.html#a42240e743f2a3ea3b430b915e50c5350" title="Smooth the line.">Smooth</a>(Param,CoordY,NElMin,NElMax);
<a name="l00812"></a>00812       v1-&gt;<a class="code" href="classVarDatFile.html#a42240e743f2a3ea3b430b915e50c5350" title="Smooth the line.">Smooth</a>(Param,CoordY,NElMin,NElMax);
<a name="l00813"></a>00813       v1-&gt;<a class="code" href="classVarDatFile.html#a42240e743f2a3ea3b430b915e50c5350" title="Smooth the line.">Smooth</a>(Param,CoordY,NElMin,NElMax);
<a name="l00814"></a>00814       v1-&gt;<a class="code" href="classVarDatFile.html#a15ad052575da97bec5b2bad38a52385e" title="Writes the content of the elaborated array.">ScriviPunti</a>(Uscita);
<a name="l00815"></a>00815       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00816"></a>00816     }
<a name="l00817"></a>00817     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;smoothGauss&quot;</span>) ){
<a name="l00818"></a>00818       v1-&gt;<a class="code" href="classVarDatFile.html#a12fe98e58e8262bcbf3aef114673673d" title="Smooth the line.">SmoothGauss</a>(Param,CoordY,NElMin,NElMax);
<a name="l00819"></a>00819       v1-&gt;<a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d" title="Writes all the content in memory.">ScriviTutto</a>(Uscita,0,NElMin,NElMax);
<a name="l00820"></a>00820       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00821"></a>00821     }
<a name="l00822"></a>00822     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;salva&quot;</span>) ){
<a name="l00823"></a>00823       v1-&gt;<a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d" title="Writes all the content in memory.">ScriviTutto</a>(Uscita,0,NElMin,NElMax);
<a name="l00824"></a>00824       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;tecplot&quot;</span>) ){
<a name="l00827"></a>00827       v1-&gt;<a class="code" href="classVarDatFile.html#ace7cb52bc9334449375e6e0456161120" title="Export a contour plot.">TecPlot</a>(Uscita);
<a name="l00828"></a>00828       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;txvl&quot;</span>) ){
<a name="l00831"></a>00831       v1-&gt;<a class="code" href="classVarDatFile.html#a87e9980dd97eda060a3dcaddd1d692d4" title="Export in the txvl file format.">ExportTxvl</a>(Uscita,NElMin,NElMax);
<a name="l00832"></a>00832       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;ResBulk&quot;</span>) ){
<a name="l00835"></a>00835       v1-&gt;<a class="code" href="classVarDatFile.html#a50acf56d68429e9660e2bfc4f7530521" title="Rescale to bulk.">RescaleToBulk</a>(Uscita);
<a name="l00836"></a>00836       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;conv&quot;</span>) ){
<a name="l00839"></a>00839       FILE *FWrite = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00840"></a>00840       <span class="keywordtype">double</span> x = 0.;
<a name="l00841"></a>00841       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00842"></a>00842    x += .1;
<a name="l00843"></a>00843    fprintf(FWrite,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,v1-&gt;<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(0,n)*1e12);
<a name="l00844"></a>00844       }
<a name="l00845"></a>00845       fclose(FWrite);
<a name="l00846"></a>00846       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00847"></a>00847     }
<a name="l00848"></a>00848     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;salvacol&quot;</span>) ){
<a name="l00849"></a>00849       v1-&gt;<a class="code" href="classVarDatFile.html#acc513a8bb6bda4c6bbf7832a9dcdd19a" title="Writes the content of the pointed vector.">ScriviFile</a>(Uscita,CoordY,0,NElMin,NElMax);
<a name="l00850"></a>00850       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;col&quot;</span>) ){
<a name="l00853"></a>00853       printf(<span class="stringliteral">&quot;Number of column: &quot;</span>);
<a name="l00854"></a>00854       <span class="keywordtype">int</span> NCol=0;
<a name="l00855"></a>00855       scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;NCol);
<a name="l00856"></a>00856       v1-&gt;<a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(NCol);
<a name="l00857"></a>00857       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00858"></a>00858     }
<a name="l00859"></a>00859     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;print&quot;</span>) ){
<a name="l00860"></a>00860       v1-&gt;<a class="code" href="classVarDatFile.html#a9dcac18006ce057b8d78c847174c1362" title="Prints the content in memory.">Print</a>();
<a name="l00861"></a>00861       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;vet&quot;</span>)){
<a name="l00864"></a>00864       <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v(1.,0.,1.);
<a name="l00865"></a>00865       <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> u(0.,1.,0.);
<a name="l00866"></a>00866       <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> w(0.,0.,1.);
<a name="l00867"></a>00867       <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> n(3);
<a name="l00868"></a>00868       v.VetV(&amp;u);
<a name="l00869"></a>00869       <span class="comment">//printf(&quot;%lf %lf %lf\n&quot;,n.Angle(v,u)*RAD_DEG,n.SinAngle(v,u),n.CosAngle(v,u));</span>
<a name="l00870"></a>00870       n.Print();
<a name="l00871"></a>00871       <span class="keywordflow">break</span>;
<a name="l00872"></a>00872        <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00873"></a>00873     }
<a name="l00874"></a>00874     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;OrdAv&quot;</span>)){
<a name="l00875"></a>00875       <span class="keywordtype">double</span> *Distr = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00876"></a>00876       <span class="keywordflow">if</span>(!IfBorder){
<a name="l00877"></a>00877    v1-&gt;<a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(NElMin,NElMax);
<a name="l00878"></a>00878    v1-&gt;<a class="code" href="classVarDatFile.html#a8209ef54a8a7b2173ce491cba2008c56" title="Print global borders.">pGlobBorder</a>(Border,Border+1,Border+2,Border+3);
<a name="l00879"></a>00879    printf(<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,Border[0],Border[1]);
<a name="l00880"></a>00880    Border[1] = Border[1] - Border[0];
<a name="l00881"></a>00881    Border[1] = 1./(1.001*Border[1]);
<a name="l00882"></a>00882       }
<a name="l00883"></a>00883       <span class="keywordflow">else</span>{
<a name="l00884"></a>00884    Border[1] = Border[1] - Border[0];
<a name="l00885"></a>00885    Border[1] = 1./(1.001*Border[1]);
<a name="l00886"></a>00886       }
<a name="l00887"></a>00887       printf(<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,Border[0],Border[1]);
<a name="l00888"></a>00888       v1-&gt;<a class="code" href="classVarDatFile.html#a982e54013ecdf9dcadead5247def28be" title="Average of all ordinate.">AverageOrdinate</a>(NElMin,NElMax,Distr,Border);
<a name="l00889"></a>00889       FILE *WFile = fopen(Uscita,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00890"></a>00890       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;NBin;b++){
<a name="l00891"></a>00891    <span class="keywordtype">double</span> x = b/(Border[1]*NBin) + Border[0];
<a name="l00892"></a>00892    fprintf(WFile,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,x,Distr[b]);
<a name="l00893"></a>00893       }
<a name="l00894"></a>00894       free(Distr);
<a name="l00895"></a>00895       fclose(WFile);
<a name="l00896"></a>00896       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;WAv&quot;</span>)){
<a name="l00899"></a>00899       <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> m1 = v1-&gt;<a class="code" href="classVarDatFile.html#acc46e4201d7bdf288601a253bd569ed0" title="Weighted distribution.">WeightAverageSet</a>(CoordY,NElMin,NElMax);
<a name="l00900"></a>00900       printf(<span class="stringliteral">&quot;Mean %lf +- %lf\n&quot;</span>,m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>,m1.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>);
<a name="l00901"></a>00901       <span class="keywordflow">if</span>(!IfUser) <span class="keywordflow">return</span> 0;
<a name="l00902"></a>00902     }
<a name="l00903"></a>00903     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(Comando,<span class="stringliteral">&quot;q&quot;</span>) ){}
<a name="l00904"></a>00904     <span class="keywordflow">else</span>{
<a name="l00905"></a>00905       printf(<span class="stringliteral">&quot;Comando sbagliato, riprovare\n&quot;</span>);
<a name="l00906"></a>00906       IfUser = 1;
<a name="l00907"></a>00907     }
<a name="l00908"></a>00908   }
<a name="l00909"></a>00909   printf(<span class="stringliteral">&quot;Te se qe ve be te ne?\n&quot;</span>);
<a name="l00910"></a>00910   <span class="keyword">delete</span> m1;
<a name="l00911"></a>00911   <span class="keywordflow">return</span> 0;
<a name="l00912"></a>00912 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:20 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
