<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/Addyn/Forces.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_9eb7b934b0b571f03e95a80abda3221c.html">Addyn</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Forces.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;Forces.h&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00003"></a><a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f">00003</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Forces::Shout</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * s, ...){
<a name="l00004"></a>00004 <span class="preprocessor">#ifndef DIN_DEBUG</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>  va_list args;
<a name="l00006"></a>00006   va_start(args, s);
<a name="l00007"></a>00007   fprintf(stderr, <span class="stringliteral">&quot;&gt;&quot;</span>);
<a name="l00008"></a>00008   vfprintf(stderr, s, args);
<a name="l00009"></a>00009   fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00010"></a>00010   va_end(args);
<a name="l00011"></a>00011 <span class="preprocessor">#else  </span>
<a name="l00012"></a>00012 <span class="preprocessor"></span>  <span class="keywordflow">return</span>;
<a name="l00013"></a>00013 <span class="preprocessor">#endif</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>}
<a name="l00015"></a><a class="code" href="classForces.html#a0b40ef47e7e825a72223abc459561c10">00015</a> <a class="code" href="classForces.html#a0b40ef47e7e825a72223abc459561c10" title="Create an initial system and choose the simulation thecnique.">Forces::Forces</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv,<span class="keywordtype">int</span> NInEdge,<span class="keywordtype">char</span> *ConfFileExt){
<a name="l00016"></a>00016   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Constructor/no starting configuration&quot;</span>);
<a name="l00017"></a>00017   <a class="code" href="classForces.html#a2d9aa5d817b97aecdc4dc418d1be255c" title="Read the config file.">InitConst</a>();
<a name="l00018"></a>00018   sprintf(ConfFile,<span class="stringliteral">&quot;%s&quot;</span>,ConfFileExt);
<a name="l00019"></a>00019   <span class="keywordtype">char</span> ConfF[40];
<a name="l00020"></a>00020   sprintf(ConfF,ConfFile);
<a name="l00021"></a>00021   <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a54e451b95d534ac661b873f7c5773435" title="Read the config file.">ReadConfDinamica</a>(ConfF)){
<a name="l00022"></a>00022     <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = 1./(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00023"></a>00023   }
<a name="l00024"></a>00024   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D)){
<a name="l00025"></a>00025     <a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0] = <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00026"></a>00026     <span class="keywordtype">double</span> Ratio = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(0);
<a name="l00027"></a>00027     <a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1] = (int)(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]*Ratio + 0.0001);
<a name="l00028"></a>00028     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;;i++){
<a name="l00029"></a>00029       <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1]/Ratio) == <a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]) <span class="keywordflow">break</span>;
<a name="l00030"></a>00030       <a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]++;
<a name="l00031"></a>00031       <a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1] = (int)(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]*Ratio + 0.0001);
<a name="l00032"></a>00032       printf(<span class="stringliteral">&quot;using: nEdge[0] %d nEdge[1] %d\n&quot;</span>,<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0],<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1]);
<a name="l00033"></a>00033       <span class="keywordflow">if</span>(i&gt;=10){
<a name="l00034"></a>00034    printf(<span class="stringliteral">&quot;Could not find the appropriate border partition %d %d\n&quot;</span>,<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0],<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1]);
<a name="l00035"></a>00035    exit(0);
<a name="l00036"></a>00036       }
<a name="l00037"></a>00037     }
<a name="l00038"></a>00038     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(4);
<a name="l00039"></a>00039     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[0]*<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1]);
<a name="l00040"></a>00040     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(nEdge[1]);
<a name="l00041"></a>00041     <a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972" title="Set and reallocate the number of particles per chains.">SetNPCh</a>(nEdge[0]);
<a name="l00042"></a>00042   }
<a name="l00043"></a>00043   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_3D)){
<a name="l00044"></a>00044     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(6);
<a name="l00045"></a>00045     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00046"></a>00046     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(NEdge*NEdge*NEdge);
<a name="l00047"></a>00047   }
<a name="l00048"></a>00048   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00049"></a>00049     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(1);
<a name="l00050"></a>00050     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00051"></a>00051     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00052"></a>00052   }
<a name="l00053"></a>00053   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_STALK)){
<a name="l00054"></a>00054     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(3);
<a name="l00055"></a>00055     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(4*<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00056"></a>00056     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(4);
<a name="l00057"></a>00057     <span class="comment">//    Kf.El[0] *= Gen-&gt;NPart;</span>
<a name="l00058"></a>00058   }
<a name="l00059"></a>00059   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)){
<a name="l00060"></a>00060     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(3);
<a name="l00061"></a>00061     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00062"></a>00062     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00063"></a>00063     <span class="comment">//    Kf.El[0] *= Gen-&gt;NPart;</span>
<a name="l00064"></a>00064   }
<a name="l00065"></a>00065   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_PORE)){
<a name="l00066"></a>00066     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(3);
<a name="l00067"></a>00067     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00068"></a>00068     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00069"></a>00069   }
<a name="l00070"></a>00070   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_1D)){
<a name="l00071"></a>00071     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(2);
<a name="l00072"></a>00072     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00073"></a>00073     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00074"></a>00074   }
<a name="l00075"></a>00075   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_RIGID)){
<a name="l00076"></a>00076     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(0);
<a name="l00077"></a>00077     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(0);
<a name="l00078"></a>00078   }
<a name="l00079"></a>00079   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_TRIAL)){
<a name="l00080"></a>00080     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(3*3*3);
<a name="l00081"></a>00081     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(0);
<a name="l00082"></a>00082     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00083"></a>00083   }
<a name="l00084"></a>00084   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD)){
<a name="l00085"></a>00085     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(0);
<a name="l00086"></a>00086     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00087"></a>00087     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC)){
<a name="l00090"></a>00090     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(0);
<a name="l00091"></a>00091     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00092"></a>00092     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00093"></a>00093   }
<a name="l00094"></a>00094   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO)){
<a name="l00095"></a>00095     <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">SetNLink</a>(4);
<a name="l00096"></a>00096     <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">ReSetNPart</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>+<a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a>);
<a name="l00097"></a>00097     <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">ReSetNChain</a>(1);
<a name="l00098"></a>00098   }
<a name="l00099"></a>00099   <a class="code" href="classForces.html#aa95d72aa125333d83e91047bc8f4319a" title="Set a new number of particle per chain.">ReSetNPCh</a>(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>());
<a name="l00100"></a>00100   <span class="comment">//SetNPCh(NEdge);</span>
<a name="l00101"></a>00101   <a class="code" href="classVarData.html#a7cdf58edf248a9fdd2a49df8010b1b50" title="Set DeltaT.">SetDeltat</a>(<a class="code" href="classForces.html#ac321dc561843cb5d3f74604036a3a8da" title="Time step.">Deltat</a>);
<a name="l00102"></a>00102   <a class="code" href="classVarData.html#a21f1780aa73b8cf10dbaf3bde286dc8a" title="Set Step.">SetStep</a>(0);
<a name="l00103"></a>00103   <a class="code" href="classVarData.html#ab1caa779737fb8f3bb11375fd03cb4a7" title="Set the number of species.">SetNType</a>(2);
<a name="l00104"></a>00104   <a class="code" href="classForces.html#ab18de8ad228c4133d61e09f94ef4b33f" title="Create an initial configuration and an appropriate force field.">CreateInitial</a>();
<a name="l00105"></a>00105   {
<a name="l00106"></a>00106     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a> = <span class="keyword">new</span> <a class="code" href="classMatInt.html" title="Energy contribution from the density functional hamiltonian.">MatInt</a>(3,3);
<a name="l00107"></a>00107     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(-24.33,0,0);
<a name="l00108"></a>00108     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(-7.22,0,1);
<a name="l00109"></a>00109     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(-24.33,0,2);
<a name="l00110"></a>00110     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(-0.1,1,1);
<a name="l00111"></a>00111     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(-7.22,1,2);
<a name="l00112"></a>00112     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(0.,2,2);
<a name="l00113"></a>00113     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,0,0);
<a name="l00114"></a>00114     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,0,1);
<a name="l00115"></a>00115     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,0,2);
<a name="l00116"></a>00116     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,1,1);
<a name="l00117"></a>00117     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,1,2);
<a name="l00118"></a>00118     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,0,2,2);
<a name="l00119"></a>00119     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(0.,1,1,1);
<a name="l00120"></a>00120     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,1,1,2);
<a name="l00121"></a>00121     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(3.,1,2,2);
<a name="l00122"></a>00122     <a class="code" href="classVarData.html#a7bb96647a8e4b53477394d2538fdfb3f" title="Matrix of the prefactor of the interactions.">MInt</a>-&gt;<a class="code" href="classMatInt.html#a80ec8280d13d4c35f089d48a67e8e00b" title="Set the prefactor.">SetCoeff</a>(0.,2,2,2);
<a name="l00123"></a>00123   }
<a name="l00124"></a>00124   <a class="code" href="classForces.html#aa7040ce5b212b067b9edc0e48966f593" title="Allocated the structures needed for the corresponding simulation method.">AllocMethod</a>();
<a name="l00125"></a>00125   <a class="code" href="classForces.html#a053a9be7328b6a532baf8774f8479188" title="Calculate some initial quantities for the succesive calculations.">PrepareSys</a>();
<a name="l00126"></a>00126   <a class="code" href="classForces.html#afb0db3e5d9d3ca56511f4942b695a33c" title="Create the grid for the parallelisation.">PrepareParallel</a>(argc,argv);
<a name="l00127"></a>00127   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)) <a class="code" href="classForces.html#a2f3ad1a6e0b8ab8fbc82813879781139" title="Boh.">IfNano</a> = 2;
<a name="l00128"></a>00128   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_PORE)) <a class="code" href="classForces.html#a2f3ad1a6e0b8ab8fbc82813879781139" title="Boh.">IfNano</a> = 2;
<a name="l00129"></a>00129   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO)){
<a name="l00130"></a>00130     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00131"></a>00131     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>+1].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133   <span class="comment">//Pc-&gt;PrintCells();</span>
<a name="l00134"></a>00134   <span class="comment">//for(int p=0;p&lt;pNPart();p++) CheckDomDec(p);</span>
<a name="l00135"></a>00135   <span class="comment">//Interp();</span>
<a name="l00136"></a>00136 }
<a name="l00137"></a><a class="code" href="classForces.html#ad23deb6f28e0c4e08e69556f04028e82">00137</a> <a class="code" href="classForces.html#ad23deb6f28e0c4e08e69556f04028e82" title="Frees the memory.">Forces::~Forces</a>(){
<a name="l00138"></a>00138   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Freeing&quot;</span>);
<a name="l00139"></a>00139   fclose(StatFile1);
<a name="l00140"></a>00140   fclose(StatFile2);
<a name="l00141"></a>00141   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Freeing/md: forces domain decomposition&quot;</span>);  
<a name="l00142"></a>00142   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_FORCES)){
<a name="l00143"></a>00143     <span class="keyword">delete</span> [] <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>;
<a name="l00144"></a>00144   }
<a name="l00145"></a>00145   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MD)){
<a name="l00146"></a>00146     <span class="keyword">delete</span> <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>;
<a name="l00147"></a>00147   }
<a name="l00148"></a>00148   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MC)){
<a name="l00149"></a>00149     <span class="keyword">delete</span> <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>;
<a name="l00150"></a>00150     <span class="keyword">delete</span> [] OldNrgBead;
<a name="l00151"></a>00151     <span class="keyword">delete</span> [] OldNrgCh;
<a name="l00152"></a>00152     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();p++){
<a name="l00153"></a>00153       <span class="keyword">delete</span> [] OldPos[p];
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155     <span class="keyword">delete</span> [] OldPos;
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_BIAS)){
<a name="l00158"></a>00158     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTrialBias;t++){
<a name="l00159"></a>00159       <span class="keyword">delete</span> [] BondPosBias[t];
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161     <span class="keyword">delete</span> [] BondPosBias;
<a name="l00162"></a>00162     <span class="keyword">delete</span> [] CumProbBias;
<a name="l00163"></a>00163   }  
<a name="l00164"></a>00164   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_SPLINE)){
<a name="l00165"></a>00165     free(<a class="code" href="classForces.html#af6f3b943a0341846e18ac90f4f871b98" title="Splines.">Pl</a>);
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_DENS)){
<a name="l00168"></a>00168     free(LocDens2);
<a name="l00169"></a>00169     free(LocDens3);
<a name="l00170"></a>00170     free(Dens2);
<a name="l00171"></a>00171     free(Dens3);
<a name="l00172"></a>00172   }
<a name="l00173"></a>00173   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00174"></a>00174     <span class="keyword">delete</span> IntMatrix;
<a name="l00175"></a>00175   }
<a name="l00176"></a>00176   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D)){
<a name="l00177"></a>00177     <span class="keyword">delete</span> IntMatrix;
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)){
<a name="l00180"></a>00180     <span class="keyword">delete</span> IntMatrix;
<a name="l00181"></a>00181   }
<a name="l00182"></a>00182 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00183"></a>00183 <span class="preprocessor"></span>  free(<a class="code" href="classForces.html#a10385a058195a115177656da1926ee5b" title="List referring the cylinder.">Cylinder</a>);
<a name="l00184"></a>00184 <span class="preprocessor">#endif</span>
<a name="l00185"></a>00185 <span class="preprocessor"></span>}
<a name="l00186"></a><a class="code" href="classForces.html#abbcd2fc791d4ded94db5172ef1000e42">00186</a> <a class="code" href="classForces.html#a0b40ef47e7e825a72223abc459561c10" title="Create an initial system and choose the simulation thecnique.">Forces::Forces</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv,<span class="keywordtype">char</span> *ConfF,<span class="keywordtype">char</span> *Snapshot){
<a name="l00187"></a>00187   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;constructor with intial configuration&quot;</span>);
<a name="l00188"></a>00188   <a class="code" href="classForces.html#a2d9aa5d817b97aecdc4dc418d1be255c" title="Read the config file.">InitConst</a>();
<a name="l00189"></a>00189   <span class="keywordflow">if</span>(<a class="code" href="classForces.html#a54e451b95d534ac661b873f7c5773435" title="Read the config file.">ReadConfDinamica</a>(ConfF)){
<a name="l00190"></a>00190     <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = 1./(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00191"></a>00191   }
<a name="l00192"></a>00192   <a class="code" href="classVarData.html#a50a785f6295f7e7fb2494fcad2a2a7fc" title="Open the.">Open</a>(Snapshot,BF_PART);
<a name="l00193"></a>00193   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)) <a class="code" href="classForces.html#a2f3ad1a6e0b8ab8fbc82813879781139" title="Boh.">IfNano</a> = 2;
<a name="l00194"></a>00194   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_PORE)) <a class="code" href="classForces.html#a2f3ad1a6e0b8ab8fbc82813879781139" title="Boh.">IfNano</a> = 2;
<a name="l00195"></a>00195   <a class="code" href="classForces.html#aa7040ce5b212b067b9edc0e48966f593" title="Allocated the structures needed for the corresponding simulation method.">AllocMethod</a>();
<a name="l00196"></a>00196   <a class="code" href="classForces.html#afb0db3e5d9d3ca56511f4942b695a33c" title="Create the grid for the parallelisation.">PrepareParallel</a>(argc,argv);
<a name="l00197"></a>00197   <a class="code" href="classForces.html#a053a9be7328b6a532baf8774f8479188" title="Calculate some initial quantities for the succesive calculations.">PrepareSys</a>();
<a name="l00198"></a>00198  <span class="comment">//Interp();</span>
<a name="l00199"></a>00199 }
<a name="l00200"></a><a class="code" href="classForces.html#a053a9be7328b6a532baf8774f8479188">00200</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a053a9be7328b6a532baf8774f8479188" title="Calculate some initial quantities for the succesive calculations.">Forces::PrepareSys</a>(){
<a name="l00201"></a>00201   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Preparing system&quot;</span>);
<a name="l00202"></a>00202   OldNrgSys = 0.;
<a name="l00203"></a>00203   <a class="code" href="classForces.html#ae1187ff72e7ad2765b17948df1aff2b4" title="Define the parameters for calculating the force.">DefNanoForceParam</a>();
<a name="l00204"></a>00204   <span class="comment">/*calculate the energies per chain or per particle for</span>
<a name="l00205"></a>00205 <span class="comment">    the calculation of the MC.</span>
<a name="l00206"></a>00206 <span class="comment">  */</span>
<a name="l00207"></a>00207   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC)){
<a name="l00208"></a>00208     <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_DENS)){
<a name="l00209"></a>00209       <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Preparing system/adding densities\n&quot;</span>);
<a name="l00210"></a>00210       OldNrgSys = <a class="code" href="classForces.html#ad6b09c65169c95c3aff47220ad8327c6" title="Calculation of the energy from the density functional Hamiltonian for the system.">DensFuncNrgSys</a>();
<a name="l00211"></a>00211       <a class="code" href="classForces.html#ab7f8fa6b5791ce382b080bb3cb2ff87a" title="Chemical potential of the particles.">ChemPotEx</a> += <a class="code" href="classForces.html#a57e3c33b787c38c105cf9a2ed973326e" title="Average energy per particle.">NrgPBead</a>;
<a name="l00212"></a>00212       <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NcVT)){
<a name="l00213"></a>00213    <span class="comment">//CalcTotNrgCh();</span>
<a name="l00214"></a>00214       }
<a name="l00215"></a>00215       <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NVT)){
<a name="l00216"></a>00216    ;<span class="comment">//CalcTotNrgBead();</span>
<a name="l00217"></a>00217       }
<a name="l00218"></a>00218       <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_mcVT)){
<a name="l00219"></a>00219    <span class="keywordflow">if</span>(!VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_CONF_BIAS))
<a name="l00220"></a>00220      ;<span class="comment">//CalcTotNrgCh();</span>
<a name="l00221"></a>00221       }
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223     <span class="comment">//defining all the allocated chains</span>
<a name="l00224"></a>00224     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>();p++){
<a name="l00225"></a>00225       <span class="keywordtype">int</span> c = (int)(p/(<span class="keywordtype">double</span>)<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>());
<a name="l00226"></a>00226       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = c;
<a name="l00227"></a>00227       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00228"></a>00228       <span class="keywordflow">if</span>( p%<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() &gt;= <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#af914cf19bda574d081fa0a7b243bf7dc" title="Diblock limit of the chain.">Asym</a> ) <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Typ = 1;
<a name="l00229"></a>00229       <span class="keywordflow">if</span>( p%<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() == <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() - 1) <span class="keywordflow">continue</span>;
<a name="l00230"></a>00230       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 1;
<a name="l00231"></a>00231       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p+1;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233   }
<a name="l00234"></a>00234   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO)){
<a name="l00235"></a>00235     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;p++){
<a name="l00236"></a>00236       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 2;
<a name="l00237"></a>00237       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00238"></a>00238       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = p;
<a name="l00239"></a>00239       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 0;
<a name="l00240"></a>00240       <a class="code" href="classVarData.html#a7994a751e400e4df33a6a6fb8a8ba025" title="Set the back folded array for the particle p.">SetBkf</a>(p);
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=NEdge;p&lt;NEdge+<a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a>;p++){
<a name="l00243"></a>00243       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = 0;
<a name="l00244"></a>00244       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a26c51826a2d187b6baa0f5f249436abe" title="Particle identifier.">Idx</a> = p;
<a name="l00245"></a>00245       <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a> = <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;
<a name="l00246"></a>00246       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 1;
<a name="l00247"></a>00247       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0] = p+1;
<a name="l00248"></a>00248       <span class="keywordflow">if</span>(p==NEdge+NSpline-1) <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a> = 0;
<a name="l00249"></a>00249       <a class="code" href="classVarData.html#a7994a751e400e4df33a6a6fb8a8ba025" title="Set the back folded array for the particle p.">SetBkf</a>(p);
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD)){
<a name="l00253"></a>00253     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Preparing system/calculating forces\n&quot;</span>);
<a name="l00254"></a>00254     OldNrgSys = <a class="code" href="classForces.html#a791c1d5f301eb9c0d39c43a180eaf737" title="Iterate all over the particles and calculate the forces.">SumForcesMD</a>();
<a name="l00255"></a>00255   }
<a name="l00256"></a>00256   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00257"></a>00257     IntMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>());
<a name="l00258"></a>00258   }
<a name="l00259"></a>00259   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)){
<a name="l00260"></a>00260     IntMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>(),<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>());
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D)){
<a name="l00263"></a>00263     IntMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>());
<a name="l00264"></a>00264   }
<a name="l00265"></a>00265   <span class="comment">/*for the chemical potential, to avoid the calculation of</span>
<a name="l00266"></a>00266 <span class="comment">    large exponential */</span>
<a name="l00267"></a>00267   <a class="code" href="classForces.html#a57e3c33b787c38c105cf9a2ed973326e" title="Average energy per particle.">NrgPBead</a> = 0.;<span class="comment">//2.*OldNrgSys/(double)pNPart();</span>
<a name="l00268"></a>00268   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Prepared&quot;</span>);
<a name="l00269"></a>00269 }
<a name="l00270"></a><a class="code" href="classForces.html#a5d2e87f58183d51c11ed77483b0d8b4f">00270</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a5d2e87f58183d51c11ed77483b0d8b4f" title="Fill the entries of the interaction matrix.">Forces::FillMatrix</a>(){
<a name="l00271"></a>00271   <span class="keywordflow">if</span>(!<a class="code" href="classForces.html#a1d4b4e62a626434fc48475224ab89dca" title="If the matrix has to be changed.">IfFillMatrix</a>) <span class="keywordflow">return</span>;
<a name="l00272"></a>00272   IntMatrix-&gt;<a class="code" href="classMatrice.html#aa71d36872f416feaa853788a7a7a7ef8" title="Set all the entries to zero.">Clear</a>();
<a name="l00273"></a>00273   <span class="keywordtype">double</span> Inter = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>)/(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>;<span class="comment">//fabs(pPos(1,0) - pPos(0,0));</span>
<a name="l00274"></a>00274   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Weight;
<a name="l00275"></a>00275   Weight.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[2];
<a name="l00276"></a>00276   Weight.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = 0./Inter;
<a name="l00277"></a>00277   Weight.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e" title="Prefactor of the Laplacian.">Lap</a>/SQR(Inter);
<a name="l00278"></a>00278   Weight.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = 0./(Inter*SQR(Inter));
<a name="l00279"></a>00279   Weight.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309" title="Prefactor of the square laplacian.">SLap</a>/(SQR(Inter)*SQR(Inter));
<a name="l00280"></a>00280   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00281"></a>00281     <span class="keywordtype">int</span> NDim = 1;
<a name="l00282"></a>00282     <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *CoeffMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(Weight,NDim);
<a name="l00283"></a>00283     CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l00284"></a>00284     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();r++){
<a name="l00285"></a>00285       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[r].Typ != 0){ IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r,1.);<span class="keywordflow">continue</span>;}
<a name="l00286"></a>00286       <span class="keywordflow">if</span>(r &gt;= 2) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00287"></a>00287       <span class="keywordflow">if</span>(r &gt;= 1) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00288"></a>00288       <span class="keywordflow">if</span>(r &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00289"></a>00289       <span class="keywordflow">if</span>(r &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-2) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00290"></a>00290       IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,2));
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292     IntMatrix-&gt;<a class="code" href="classMatrice.html#acd68476b8afc6a2dcfb8663ead8b39cd" title="Invert.">Invert</a>();
<a name="l00293"></a>00293     <span class="comment">//IntMatrix-&gt;Print();</span>
<a name="l00294"></a>00294     <span class="keyword">delete</span> CoeffMatrix;
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES)){
<a name="l00297"></a>00297     <span class="keywordtype">int</span> NDim = 1;
<a name="l00298"></a>00298     <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *CoeffMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(Weight,NDim);
<a name="l00299"></a>00299     CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l00300"></a>00300     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();r++){
<a name="l00301"></a>00301       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[r].Typ != 0){ IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r,1.);<span class="keywordflow">continue</span>;}
<a name="l00302"></a>00302       <span class="keywordflow">if</span>(r &gt;= 2) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00303"></a>00303       <span class="keywordflow">if</span>(r &gt;= 1) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00304"></a>00304       <span class="keywordflow">if</span>(r &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-1) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00305"></a>00305       <span class="keywordflow">if</span>(r &lt; <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-2) IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00306"></a>00306       IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,2));
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308     <span class="comment">//IntMatrix-&gt;Invert();</span>
<a name="l00309"></a>00309     IntMatrix-&gt;<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l00310"></a>00310     <span class="keyword">delete</span> CoeffMatrix;
<a name="l00311"></a>00311   }
<a name="l00312"></a>00312   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D)){
<a name="l00313"></a>00313     <span class="keywordtype">int</span> NDim = 2;
<a name="l00314"></a>00314     <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *CoeffMatrix = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(Weight,NDim);
<a name="l00315"></a>00315     CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l00316"></a>00316     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00317"></a>00317       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Typ != 0){
<a name="l00318"></a>00318    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,p,1.);
<a name="l00319"></a>00319    <span class="keywordflow">continue</span>;
<a name="l00320"></a>00320       }
<a name="l00321"></a>00321       <span class="keywordtype">int</span> pym1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0];
<a name="l00322"></a>00322       <span class="keywordtype">int</span> pyp1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1];
<a name="l00323"></a>00323       <span class="keywordtype">int</span> pym2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[pym1].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[0];
<a name="l00324"></a>00324       <span class="keywordtype">int</span> pyp2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[pyp1].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[1];
<a name="l00325"></a>00325       <span class="keywordtype">int</span> pxm1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2];
<a name="l00326"></a>00326       <span class="keywordtype">int</span> pxp1 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[3];
<a name="l00327"></a>00327       <span class="keywordtype">int</span> pxm2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[pxm1].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[2];
<a name="l00328"></a>00328       <span class="keywordtype">int</span> pxp2 = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[pxp1].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[3];
<a name="l00329"></a>00329       <span class="comment">// printf(&quot;%d)\n&quot;,p);</span>
<a name="l00330"></a>00330       <span class="comment">//printf(&quot;%d %d %d %d\n&quot;,pym2,pym1,pyp1,pyp2);</span>
<a name="l00331"></a>00331       <span class="comment">// printf(&quot;%d %d %d %d\n&quot;,pxm2,pxm1,pxp1,pxp2);</span>
<a name="l00332"></a>00332       <span class="keywordflow">if</span>(PeriodicImage[0]){
<a name="l00333"></a>00333    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxm2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00334"></a>00334    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxm1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00335"></a>00335    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxp1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00336"></a>00336    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxp2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00337"></a>00337       }
<a name="l00338"></a>00338       <span class="keywordflow">else</span>{
<a name="l00339"></a>00339    <span class="keywordflow">if</span>(pxm2 == p-2*<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1])
<a name="l00340"></a>00340      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxm2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00341"></a>00341    <span class="keywordflow">if</span>(pxm1 == p-<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1])
<a name="l00342"></a>00342      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxm1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00343"></a>00343    <span class="keywordflow">if</span>(pxp1 == p+<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1])
<a name="l00344"></a>00344      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxp1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00345"></a>00345    <span class="keywordflow">if</span>(pxp2 == p+2*<a class="code" href="classForces.html#adcf19dc278dd27f0bba8cc1ae9375b4f" title="Number of particle per edge.">nEdge</a>[1])
<a name="l00346"></a>00346      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pxp2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00347"></a>00347       }
<a name="l00348"></a>00348       IntMatrix-&gt;<a class="code" href="classMatrice.html#aa0c2a276b9a17b75e9d689bbda62b1b5" title="Add the value of the coefficient to the previous one.">Add</a>(p,p,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,2));
<a name="l00349"></a>00349       <span class="keywordflow">if</span>(PeriodicImage[1]){
<a name="l00350"></a>00350    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pym2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00351"></a>00351    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pym1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00352"></a>00352    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pyp1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00353"></a>00353    IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pyp2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00354"></a>00354       }
<a name="l00355"></a>00355       <span class="keywordflow">else</span>{
<a name="l00356"></a>00356    <span class="keywordflow">if</span>(pym2 == p-2)
<a name="l00357"></a>00357      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pym2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,0));
<a name="l00358"></a>00358    <span class="keywordflow">if</span>(pym1 == p-1)
<a name="l00359"></a>00359      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pym1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,1));
<a name="l00360"></a>00360    <span class="keywordflow">if</span>(pyp1 == p+1)
<a name="l00361"></a>00361      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pyp1,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,3));
<a name="l00362"></a>00362    <span class="keywordflow">if</span>(pyp2 == p+2)
<a name="l00363"></a>00363      IntMatrix-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(p,pyp2,CoeffMatrix-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(2,4));
<a name="l00364"></a>00364       }
<a name="l00365"></a>00365     }
<a name="l00366"></a>00366     IntMatrix-&gt;<a class="code" href="classMatrice.html#acd68476b8afc6a2dcfb8663ead8b39cd" title="Invert.">Invert</a>();
<a name="l00367"></a>00367     <span class="comment">//IntMatrix-&gt;Print();</span>
<a name="l00368"></a>00368     <span class="keyword">delete</span> CoeffMatrix;
<a name="l00369"></a>00369   }
<a name="l00370"></a>00370   <a class="code" href="classForces.html#a1d4b4e62a626434fc48475224ab89dca" title="If the matrix has to be changed.">IfFillMatrix</a> = 0;
<a name="l00371"></a>00371 }
<a name="l00372"></a><a class="code" href="classForces.html#afb0db3e5d9d3ca56511f4942b695a33c">00372</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#afb0db3e5d9d3ca56511f4942b695a33c" title="Create the grid for the parallelisation.">Forces::PrepareParallel</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv){
<a name="l00373"></a>00373 <span class="preprocessor">#ifdef OMPI_MPI_H </span>
<a name="l00374"></a>00374 <span class="preprocessor"></span>  <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Preparing parallelisation&quot;</span>);
<a name="l00375"></a>00375   MPI_Init(&amp;argc,&amp;argv);
<a name="l00376"></a>00376   <span class="keywordtype">int</span> Rank=0,Size=0;
<a name="l00377"></a>00377   MPI_Comm_rank(MPI_COMM_WORLD, &amp;Rank);
<a name="l00378"></a>00378   MPI_Comm_size(MPI_COMM_WORLD, &amp;Size);
<a name="l00379"></a>00379   <span class="keywordtype">int</span> Partition = (int)(argc/(<span class="keywordtype">double</span>)Size);
<a name="l00380"></a>00380   <a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = Partition*Rank;
<a name="l00381"></a>00381   <a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = Partition*(Rank+1);
<a name="l00382"></a>00382   <span class="keywordflow">if</span>(Rank==Size-1) <a class="code" href="classForces.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] += argc%Size;
<a name="l00383"></a>00383   Proc = <span class="keyword">new</span> <a class="code" href="classSingProc.html" title="Basics class to start a MPI grid.">SingProc</a>(Size,Rank);
<a name="l00384"></a>00384 <span class="preprocessor">#endif</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span>}
<a name="l00386"></a><a class="code" href="classForces.html#aa7040ce5b212b067b9edc0e48966f593">00386</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#aa7040ce5b212b067b9edc0e48966f593" title="Allocated the structures needed for the corresponding simulation method.">Forces::AllocMethod</a>(){
<a name="l00387"></a>00387   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocation&quot;</span>);
<a name="l00388"></a>00388   StatFile1 = fopen(<span class="stringliteral">&quot;StatDyn1.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00389"></a>00389   StatFile2 = fopen(<span class="stringliteral">&quot;StatDyn2.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00390"></a>00390   ChooseCalcMode(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00391"></a>00391   ChoosePot(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>);
<a name="l00392"></a>00392   <a class="code" href="classForces.html#a8de191a7e9bb4c04ea140023c0bffaba" title="Choose a calculation mode.">ChooseThermostat</a>(<a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a>);
<a name="l00393"></a>00393   <span class="keywordtype">double</span> Edge[3] = {<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00394"></a>00394   <span class="keywordtype">double</span> Pos[3];
<a name="l00395"></a>00395   <span class="comment">//Pc-&gt;PrintCells();</span>
<a name="l00396"></a>00396   <span class="comment">//CheckPairList();</span>
<a name="l00397"></a>00397   <a class="code" href="classVarData.html#a7cdf58edf248a9fdd2a49df8010b1b50" title="Set DeltaT.">SetDeltat</a>(<a class="code" href="classForces.html#ac321dc561843cb5d3f74604036a3a8da" title="Time step.">Deltat</a>);
<a name="l00398"></a>00398   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD)){
<a name="l00399"></a>00399     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/md: forces, domain decomposition&quot;</span>);
<a name="l00400"></a>00400     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a> = (<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>(),<span class="keyword">sizeof</span>(<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a>));
<a name="l00401"></a>00401     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MD);
<a name="l00402"></a>00402     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_FORCES);
<a name="l00403"></a>00403     <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a> = <span class="keyword">new</span> <a class="code" href="classDdLinkedList.html" title="Domain decomposition as pointer to linked particles.">DomDec</a>(Edge,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>));
<a name="l00404"></a>00404     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Pos);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9" title="Add a particle to the cell c.">AddPart</a>(p,Pos);}
<a name="l00405"></a>00405   }
<a name="l00406"></a>00406   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD)){
<a name="l00407"></a>00407     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/rod: forces&quot;</span>);
<a name="l00408"></a>00408     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a> = (<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>(),<span class="keyword">sizeof</span>(<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a>));
<a name="l00409"></a>00409     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_FORCES);
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC)){
<a name="l00412"></a>00412     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/mc: domain decomposition old chain positions, old energies for particles and chains, first bead distribution, bias (cumulative probabilities and bead positions)&quot;</span>);  
<a name="l00413"></a>00413     <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a> = <span class="keyword">new</span> <a class="code" href="classDdLinkedList.html" title="Domain decomposition as pointer to linked particles.">DomDec</a>(Edge,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>));
<a name="l00414"></a>00414     <span class="keywordtype">double</span> Pos[3];
<a name="l00415"></a>00415     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Pos);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9" title="Add a particle to the cell c.">AddPart</a>(p,Pos);}
<a name="l00416"></a>00416     <span class="comment">//Pc-&gt;PrintCells();</span>
<a name="l00417"></a>00417     <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NVT)){
<a name="l00418"></a>00418       OldNrgBead = <span class="keyword">new</span> <span class="keywordtype">double</span>[3*<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()];
<a name="l00419"></a>00419       <span class="keywordflow">if</span>(!OldNrgBead){
<a name="l00420"></a>00420    printf(<span class="stringliteral">&quot;Could not allocate OldNrgPm \n&quot;</span>);
<a name="l00421"></a>00421    exit(1);
<a name="l00422"></a>00422       }
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424     OldNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[3*<a class="code" href="classVarData.html#a8ee69088ad7dd9ea55f50b1fc19ec4e2" title="Allocated number of chains.">pNAllocC</a>()];
<a name="l00425"></a>00425     FirstBeadDistr = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00426"></a>00426     <span class="keywordflow">if</span>(!OldNrgCh){
<a name="l00427"></a>00427       printf(<span class="stringliteral">&quot;Could not allocate OldNrgCh\n&quot;</span>);
<a name="l00428"></a>00428       exit(1);
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430     OldPos = (<span class="keywordtype">double</span> **)calloc(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00431"></a>00431     <span class="keywordflow">if</span>( !OldPos){
<a name="l00432"></a>00432       printf(<span class="stringliteral">&quot;Could not allocate OldPos\n&quot;</span>);
<a name="l00433"></a>00433       exit(1);
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();p++){
<a name="l00436"></a>00436       OldPos[p] = (<span class="keywordtype">double</span> *)calloc(3,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438     CumProbBias = <span class="keyword">new</span> <span class="keywordtype">double</span>[NTrialBias];
<a name="l00439"></a>00439     BondPosBias = <span class="keyword">new</span> <span class="keywordtype">double</span>*[NTrialBias];
<a name="l00440"></a>00440     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTrialBias;t++){
<a name="l00441"></a>00441       BondPosBias[t] = <span class="keyword">new</span> <span class="keywordtype">double</span>[3];
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MC);
<a name="l00444"></a>00444     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_BIAS);
<a name="l00445"></a>00445     <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = sqrt(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>()/(3.*(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>()-1)))/2.;
<a name="l00446"></a>00446     <a class="code" href="classForces.html#a0b6541f9bb6a818203ef208f3f5ee9ea" title="Standard deviation of the gaussian chain.">GaussVar</a> = sqrt(1./<a class="code" href="classVarData.html#a16f3b01ba84886cbaf53fa1238c434f3" title="Spring coupling.">pkSpr</a>());
<a name="l00447"></a>00447   }
<a name="l00448"></a>00448   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO)){
<a name="l00449"></a>00449     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/mc: domain decomposition old chain positions, old energies for particles and chains, first bead distribution, bias (cumulative probabilities and bead positions)&quot;</span>);  
<a name="l00450"></a>00450     <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a> = <span class="keyword">new</span> <a class="code" href="classDdLinkedList.html" title="Domain decomposition as pointer to linked particles.">DomDec</a>(Edge,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>));
<a name="l00451"></a>00451     <span class="keywordtype">double</span> Pos[3];
<a name="l00452"></a>00452     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Pos);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9" title="Add a particle to the cell c.">AddPart</a>(p,Pos);}
<a name="l00453"></a>00453     <span class="comment">//Pc-&gt;PrintCells();</span>
<a name="l00454"></a>00454     <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NVT)){
<a name="l00455"></a>00455       OldNrgBead = <span class="keyword">new</span> <span class="keywordtype">double</span>[3*<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()];
<a name="l00456"></a>00456       <span class="keywordflow">if</span>(!OldNrgBead){
<a name="l00457"></a>00457    printf(<span class="stringliteral">&quot;Could not allocate OldNrgPm \n&quot;</span>);
<a name="l00458"></a>00458    exit(1);
<a name="l00459"></a>00459       }
<a name="l00460"></a>00460     }
<a name="l00461"></a>00461     OldNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[3*<a class="code" href="classVarData.html#a8ee69088ad7dd9ea55f50b1fc19ec4e2" title="Allocated number of chains.">pNAllocC</a>()];
<a name="l00462"></a>00462     FirstBeadDistr = <span class="keyword">new</span> <span class="keywordtype">double</span>[NBin];
<a name="l00463"></a>00463     <span class="keywordflow">if</span>(!OldNrgCh){
<a name="l00464"></a>00464       printf(<span class="stringliteral">&quot;Could not allocate OldNrgCh\n&quot;</span>);
<a name="l00465"></a>00465       exit(1);
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467     OldPos = (<span class="keywordtype">double</span> **)calloc(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00468"></a>00468     <span class="keywordflow">if</span>( !OldPos){
<a name="l00469"></a>00469       printf(<span class="stringliteral">&quot;Could not allocate OldPos\n&quot;</span>);
<a name="l00470"></a>00470       exit(1);
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();p++){
<a name="l00473"></a>00473       OldPos[p] = (<span class="keywordtype">double</span> *)calloc(3,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475     CumProbBias = <span class="keyword">new</span> <span class="keywordtype">double</span>[NTrialBias];
<a name="l00476"></a>00476     BondPosBias = <span class="keyword">new</span> <span class="keywordtype">double</span>*[NTrialBias];
<a name="l00477"></a>00477     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;NTrialBias;t++){
<a name="l00478"></a>00478       BondPosBias[t] = <span class="keyword">new</span> <span class="keywordtype">double</span>[3];
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MC);
<a name="l00481"></a>00481     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_BIAS);
<a name="l00482"></a>00482   }
<a name="l00483"></a>00483   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_1D) || VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_TRIAL)){
<a name="l00484"></a>00484     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/splines&quot;</span>);  
<a name="l00485"></a>00485     <a class="code" href="classForces.html#af6f3b943a0341846e18ac90f4f871b98" title="Splines.">Pl</a> = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(<a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a>,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00486"></a>00486     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_SPLINE);
<a name="l00487"></a>00487   }
<a name="l00488"></a>00488   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_DENS)){
<a name="l00489"></a>00489     <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Allocating/particle densities, sum of local densities&quot;</span>);  
<a name="l00490"></a>00490     LocDens2 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00491"></a>00491     LocDens3 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00492"></a>00492     Dens2 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00493"></a>00493     Dens3 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00494"></a>00494     <span class="keywordflow">if</span>( !Dens2 || !Dens3){
<a name="l00495"></a>00495       printf(<span class="stringliteral">&quot;Could not allocate Dens2 Dens3\n&quot;</span>);
<a name="l00496"></a>00496       exit(1);
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498     VAR_ADD_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_DENS);
<a name="l00499"></a>00499   }
<a name="l00500"></a>00500 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span>  <a class="code" href="classForces.html#a10385a058195a115177656da1926ee5b" title="List referring the cylinder.">Cylinder</a> = (GLuint *)calloc(<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>(),<span class="keyword">sizeof</span>(GLuint));
<a name="l00502"></a>00502 <span class="preprocessor">#endif  </span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>  <a class="code" href="classForces.html#a2e25f2942dd28ddaf03d12e8ece82c9a" title="Chemical potential of the particles.">ChemPotId</a> = log(<a class="code" href="classForces.html#a1e6e0ae467497e3c8ed1e1cc017e74b9" title="Equilibrium number of particles/chains.">NChemPotId</a>/<a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>());
<a name="l00504"></a>00504 }
<a name="l00505"></a><a class="code" href="classForces.html#a2d9aa5d817b97aecdc4dc418d1be255c">00505</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a2d9aa5d817b97aecdc4dc418d1be255c" title="Read the config file.">Forces::InitConst</a>(){
<a name="l00506"></a>00506   <a class="code" href="classForces.html#ac11429f7ec42e6eb4806e77f8aa24e7f" title="Internal message.">Shout</a>(<span class="stringliteral">&quot;Init constants&quot;</span>);  
<a name="l00507"></a>00507   <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a> = 80+1;<span class="comment">//NInEdge;</span>
<a name="l00508"></a>00508   <a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a> = 1./(double)(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>-1);
<a name="l00509"></a>00509   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[0] = 11.;<span class="comment">//2.*NEdge/10.;//Elastic coupling</span>
<a name="l00510"></a>00510   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[1] = 11.;<span class="comment">//Elastic coupling</span>
<a name="l00511"></a>00511   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[2] = 11.;<span class="comment">//Elastic coupling</span>
<a name="l00512"></a>00512   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e" title="Prefactor of the Laplacian.">Lap</a> = 20.*pow(<a class="code" href="classForces.html#aea50b2cb321ee5dfaa107a0726838e1a" title="Spatial separation between particles.">Dx</a>,2.);<span class="comment">//bending rigidity</span>
<a name="l00513"></a>00513   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309" title="Prefactor of the square laplacian.">SLap</a> = 0.;<span class="comment">//.015*pow(Dx,2.);//Surface tension</span>
<a name="l00514"></a>00514   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a60a1f1fb24ef62e5433e4c50466a1624" title="External force.">Ext</a> = 1.;
<a name="l00515"></a>00515   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f" title="Lennard-Jones.">LJ</a> = 1.;
<a name="l00516"></a>00516   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da" title="Lennard-Jones.">LJMin</a> = .5;
<a name="l00517"></a>00517   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a> = 1.;
<a name="l00518"></a>00518   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a426ea6ec144b001fdfc9bf8044160465" title="Contact/Friction.">Cont</a> = 0.;<span class="comment">//.001;</span>
<a name="l00519"></a>00519   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = 0.1;
<a name="l00520"></a>00520   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[1] = 0.1;
<a name="l00521"></a>00521   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2] = 0.1;
<a name="l00522"></a>00522   <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ad631a0b43047f95f5bb991f5407b813e" title="Maximum force allowed.">ForThr</a> = 100.;
<a name="l00523"></a>00523   <a class="code" href="classForces.html#abcd718a03c5cbbd304b98012a6d89b48" title="Boh.">IntMax</a> = 100;
<a name="l00524"></a>00524   <a class="code" href="classForces.html#a3849139567c198e89d67104e61a42b79" title="Step to move a particle.">IncrDist</a> = 0.01;
<a name="l00525"></a>00525   <a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495" title="If interpolates with the splines.">IfInterp</a>=FIT_FORTH;
<a name="l00526"></a>00526   <a class="code" href="classForces.html#a1d4b4e62a626434fc48475224ab89dca" title="If the matrix has to be changed.">IfFillMatrix</a>=1;
<a name="l00527"></a>00527   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487" title="Size.">Rad</a> = .05;
<a name="l00528"></a>00528   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57" title="Height of the cylinder.">Height</a> = .3;
<a name="l00529"></a>00529   <a class="code" href="classForces.html#a2e25f2942dd28ddaf03d12e8ece82c9a" title="Chemical potential of the particles.">ChemPotId</a> = 0.;
<a name="l00530"></a>00530   <a class="code" href="classForces.html#ab7f8fa6b5791ce382b080bb3cb2ff87a" title="Chemical potential of the particles.">ChemPotEx</a> = 0.;
<a name="l00531"></a>00531   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[0] = 0.;
<a name="l00532"></a>00532   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[1] = 0.;
<a name="l00533"></a>00533   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[2] = .5;
<a name="l00534"></a>00534   BoundCond[0] = 1;BoundCond[1] = 1;
<a name="l00535"></a>00535   BoundCond[2] = 1;BoundCond[3] = 1;
<a name="l00536"></a>00536   BoundCond[4] = 1;BoundCond[5] = 1;
<a name="l00537"></a>00537   PeriodicImage[0] = 1;PeriodicImage[1] = 1;PeriodicImage[2] = 1;
<a name="l00538"></a>00538   <a class="code" href="classForces.html#af51ff88ae9c6c4b9907f516c09ebf68f" title="Total time.">Time</a> = 0.;
<a name="l00539"></a>00539   <a class="code" href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97" title="How many timesteps before redrawing.">NUpdate</a> = 100;
<a name="l00540"></a>00540   <a class="code" href="classForces.html#adcaf21deb47f48c1e25997f52ebd09d6" title="How many timesteps before write the snapshot.">NWrite</a> = 1000;
<a name="l00541"></a>00541   NBin = 100;
<a name="l00542"></a>00542   NTrialBias = 10;
<a name="l00543"></a>00543   <span class="comment">//  GaussVar = sqrt(1./pkSpr());</span>
<a name="l00544"></a>00544   <a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a> = THERM_LANG;
<a name="l00545"></a>00545   <a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a> = CALC_LJ39;
<a name="l00546"></a>00546   <span class="comment">//  Part2Move = NEdge/2+NEdge;</span>
<a name="l00547"></a>00547 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00548"></a>00548 <span class="preprocessor"></span>  <a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a> = 100;
<a name="l00549"></a>00549   <a class="code" href="classForces.html#a49498134a2a543fdb43ec67e5dca8e37" title="Visualize spheres or points.">IfSphere</a> = 0;
<a name="l00550"></a>00550   <a class="code" href="classForces.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a> = 1;
<a name="l00551"></a>00551   <a class="code" href="classForces.html#ae09e8643cb34f698b9d3dc6ffbf6c0e2" title="Boh.">IfSpline</a> = 0;
<a name="l00552"></a>00552   <a class="code" href="classForces.html#acebb58ed475923de8833745b19b76f69" title="Boh.">NShow</a> = 1;
<a name="l00553"></a>00553   <a class="code" href="classForces.html#a059f36969951363c4c2158e3a0d4f526" title="Produce the images for the video.">IfMovie</a>=0;
<a name="l00554"></a>00554   <a class="code" href="classForces.html#a2aa5389f98e8d550f84ceab92dc6bd86" title="Current number of frame.">Frame</a> = 0;
<a name="l00555"></a>00555   <a class="code" href="classForces.html#ae79e4c8bd829af6de9af7f31efd18936" title="Boh.">IfExt</a> = 0;
<a name="l00556"></a>00556   <a class="code" href="classForces.html#a2c1a353b3d35ac1fdcc12aca81f6bb9d" title="Boh.">IfRot</a> = 0;
<a name="l00557"></a>00557   BeadType = 0;
<a name="l00558"></a>00558 <span class="preprocessor">#endif</span>
<a name="l00559"></a>00559 <span class="preprocessor"></span>  <a class="code" href="classForces.html#a41cc954e53faed412468476c9ec715df" title="Exit from the loop.">IfExit</a> = 0;
<a name="l00560"></a>00560   <a class="code" href="classForces.html#a2f3ad1a6e0b8ab8fbc82813879781139" title="Boh.">IfNano</a> = 0;
<a name="l00561"></a>00561   DynFlag = 0;
<a name="l00562"></a>00562   <a class="code" href="classVarData.html#a1ba38db0d91819c6627dbac8de45b6a7" title="Set NBlock.">SetNBlock</a>(1);
<a name="l00563"></a>00563 }
<a name="l00564"></a><a class="code" href="classForces.html#a632d50bc6acb5d08614d0f99a7ed7293">00564</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a632d50bc6acb5d08614d0f99a7ed7293" title="System&#39;s info.">Forces::Info</a>(){
<a name="l00565"></a>00565   printf(<span class="stringliteral">&quot;-----INFO-------\n&quot;</span>);
<a name="l00566"></a>00566   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC)){
<a name="l00567"></a>00567     <span class="comment">// Pc-&gt;Erase();</span>
<a name="l00568"></a>00568     <span class="comment">// ClearDens();</span>
<a name="l00569"></a>00569     <span class="comment">// for(int p=0;p&lt;pNPart();p++)</span>
<a name="l00570"></a>00570     <span class="comment">//   Pc-&gt;AddPart(p,Pm[p].Pos);</span>
<a name="l00571"></a>00571     <span class="comment">// AddDens(0,pNPart());</span>
<a name="l00572"></a>00572     printf(<span class="stringliteral">&quot;Energy: Sys %lf Ch  Part \n&quot;</span>,OldNrgSys);
<a name="l00573"></a>00573     <span class="comment">// CalcTotNrgCh();</span>
<a name="l00574"></a>00574     <span class="comment">// for(int c=0;c&lt;pNChain();c++)</span>
<a name="l00575"></a>00575     <span class="comment">//   printf(&quot;%d %lf %lf %lf\n&quot;,c,OldNrgCh[c*3],OldNrgCh[c*3+1],OldNrgCh[c*3+2]);</span>
<a name="l00576"></a>00576   }
<a name="l00577"></a>00577   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD)){
<a name="l00578"></a>00578     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00579"></a>00579       <span class="keywordflow">if</span>(p == <a class="code" href="classForces.html#a9a870e91a0fb8ba626adc4c77b532c9c" title="Bead to move.">Bead2Move</a>) printf(<span class="stringliteral">&quot;p      &quot;</span>);
<a name="l00580"></a>00580       printf(<span class="stringliteral">&quot;%d) (%lf,%lf,%lf) (%lf %lf %lf) %lf-%lf-%lf\n&quot;</span>,p,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2),<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].Dir[2],<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].Dir[2],<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].Dir[2]);
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582   }
<a name="l00583"></a>00583   printf(<span class="stringliteral">&quot;------------\n&quot;</span>);
<a name="l00584"></a>00584 }
<a name="l00585"></a><a class="code" href="classForces.html#a54e451b95d534ac661b873f7c5773435">00585</a> <span class="keywordtype">int</span> <a class="code" href="classForces.html#a54e451b95d534ac661b873f7c5773435" title="Read the config file.">Forces::ReadConfDinamica</a>(<span class="keywordtype">char</span> *InFile){
<a name="l00586"></a>00586   <a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a> = 0;
<a name="l00587"></a>00587   <a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a> = 0;
<a name="l00588"></a>00588   <a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a> = 0;
<a name="l00589"></a>00589   FILE *FileToRead = fopen(InFile,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00590"></a>00590   <span class="keywordflow">if</span>(FileToRead == NULL){
<a name="l00591"></a>00591     printf(<span class="stringliteral">&quot;The conf file %s is missing\n&quot;</span>,InFile);
<a name="l00592"></a>00592     <span class="keywordflow">return</span> 1;
<a name="l00593"></a>00593   }
<a name="l00594"></a>00594   <span class="keywordtype">double</span> buff[12];
<a name="l00595"></a>00595   <span class="keywordtype">char</span> SysInit[20];
<a name="l00596"></a>00596   <span class="keywordtype">char</span> *Line = (<span class="keywordtype">char</span> *)malloc(256*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00597"></a>00597   <span class="comment">//fgets(Line,256,FileToRead);</span>
<a name="l00598"></a>00598   <span class="keywordtype">int</span> NNano = 0;
<a name="l00599"></a>00599   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;!(fgets(Line,256,FileToRead)==NULL);k++){
<a name="l00600"></a>00600     <span class="keywordflow">if</span>(strstr(Line, <span class="stringliteral">&quot;Rigid&quot;</span>) == Line) NNano++;
<a name="l00601"></a>00601   }
<a name="l00602"></a>00602   <a class="code" href="classVarData.html#ad5e77b3ade14f7be0d91ccd0f5397cb6" title="Set NNano.">SetNNano</a>(NNano);
<a name="l00603"></a>00603   NNano = 0;
<a name="l00604"></a>00604   rewind(FileToRead);
<a name="l00605"></a>00605   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;!(fgets(Line,256,FileToRead)==NULL);k++){
<a name="l00606"></a>00606     <span class="comment">//printf(&quot;%s&quot;,Line);</span>
<a name="l00607"></a>00607     <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NEdge %lf&quot;</span>,buff) )
<a name="l00608"></a>00608       <a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00609"></a>00609     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;SysShape %s&quot;</span>,SysInit) ){
<a name="l00610"></a>00610       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;leaves&quot;</span>) )
<a name="l00611"></a>00611    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_LEAVES);
<a name="l00612"></a>00612       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;pore&quot;</span>) )
<a name="l00613"></a>00613    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_PORE);
<a name="l00614"></a>00614       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;1d&quot;</span>) )
<a name="l00615"></a>00615    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_1D);
<a name="l00616"></a>00616       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;2d&quot;</span>) )
<a name="l00617"></a>00617    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_2D);
<a name="l00618"></a>00618       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;3d&quot;</span>) )
<a name="l00619"></a>00619    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_3D);
<a name="l00620"></a>00620       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;rod&quot;</span>) )
<a name="l00621"></a>00621    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ROD);
<a name="l00622"></a>00622       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;trial&quot;</span>) )
<a name="l00623"></a>00623    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_TRIAL);
<a name="l00624"></a>00624       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;rigid&quot;</span>) )
<a name="l00625"></a>00625    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_RIGID);
<a name="l00626"></a>00626       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;stalk&quot;</span>) )
<a name="l00627"></a>00627    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_STALK);
<a name="l00628"></a>00628       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;md&quot;</span>) )
<a name="l00629"></a>00629    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MD);
<a name="l00630"></a>00630       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;mc&quot;</span>) )
<a name="l00631"></a>00631    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_MC); 
<a name="l00632"></a>00632       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;electro&quot;</span>) ){
<a name="l00633"></a>00633    VAR_ADD_TYPE(<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SYS_ELECTRO);
<a name="l00634"></a>00634    <span class="comment">//VAR_ADD_TYPE(SysShape,SYS_MC); </span>
<a name="l00635"></a>00635       }
<a name="l00636"></a>00636       <span class="keywordflow">else</span>{
<a name="l00637"></a>00637    printf(<span class="stringliteral">&quot;system type not recognized\n&quot;</span>);
<a name="l00638"></a>00638    exit(1);
<a name="l00639"></a>00639       }
<a name="l00640"></a>00640     }
<a name="l00641"></a>00641     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;CalcMode %s&quot;</span>,SysInit) ){
<a name="l00642"></a>00642       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;NVT&quot;</span>) )
<a name="l00643"></a>00643    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NVT);
<a name="l00644"></a>00644       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;NcVT&quot;</span>) )
<a name="l00645"></a>00645    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_NcVT);
<a name="l00646"></a>00646       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;mcVT&quot;</span>) )
<a name="l00647"></a>00647    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_mcVT);
<a name="l00648"></a>00648       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;mVT&quot;</span>) )
<a name="l00649"></a>00649    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_mVT);
<a name="l00650"></a>00650       <span class="keywordflow">else</span>{
<a name="l00651"></a>00651    printf(<span class="stringliteral">&quot;calculation type not recognized\n&quot;</span>);
<a name="l00652"></a>00652    exit(1);
<a name="l00653"></a>00653       }
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Thermostat %s&quot;</span>,SysInit) ){
<a name="l00656"></a>00656       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Langevin&quot;</span>) )
<a name="l00657"></a>00657    <a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a> = THERM_LANG;
<a name="l00658"></a>00658       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Andersen&quot;</span>) )
<a name="l00659"></a>00659    <a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a> = THERM_AND;
<a name="l00660"></a>00660       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Berendsen&quot;</span>) )
<a name="l00661"></a>00661    <a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a> = THERM_BERE;
<a name="l00662"></a>00662       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;no&quot;</span>) )
<a name="l00663"></a>00663    <a class="code" href="classForces.html#a28654ea1667e43ab257cfbc040b51eda" title="Thermostat mode.">ThermMode</a> = THERM_NO;
<a name="l00664"></a>00664       <span class="keywordflow">else</span>{
<a name="l00665"></a>00665    printf(<span class="stringliteral">&quot;thermostat not recognized\n&quot;</span>);
<a name="l00666"></a>00666    exit(1);
<a name="l00667"></a>00667       }
<a name="l00668"></a>00668     }
<a name="l00669"></a>00669     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;PotentialMode %s&quot;</span>,SysInit) ){
<a name="l00670"></a>00670       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Pair&quot;</span>) )
<a name="l00671"></a>00671    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_PAIR);
<a name="l00672"></a>00672       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;DensFunc&quot;</span>) )
<a name="l00673"></a>00673    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_DENS);
<a name="l00674"></a>00674       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;DensFuncCh&quot;</span>) )
<a name="l00675"></a>00675    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_DENS);
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Potential %s&quot;</span>,SysInit) ){
<a name="l00678"></a>00678       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;LJ&quot;</span>) )
<a name="l00679"></a>00679    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_LJ);
<a name="l00680"></a>00680       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;LJ39&quot;</span>) )
<a name="l00681"></a>00681    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_LJ39);
<a name="l00682"></a>00682       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Harmonic&quot;</span>) )
<a name="l00683"></a>00683    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_HARM);
<a name="l00684"></a>00684       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Step&quot;</span>) )
<a name="l00685"></a>00685    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_STEP);
<a name="l00686"></a>00686       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;Electro&quot;</span>) )
<a name="l00687"></a>00687    VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_ELECTRO);
<a name="l00688"></a>00688       <span class="keywordflow">else</span>{
<a name="l00689"></a>00689    printf(<span class="stringliteral">&quot;interaction potential not recognized\n&quot;</span>);
<a name="l00690"></a>00690    exit(1);
<a name="l00691"></a>00691       }
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfInterp %lf&quot;</span>,buff) )
<a name="l00694"></a>00694       <a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495" title="If interpolates with the splines.">IfInterp</a> = (int)*buff;
<a name="l00695"></a>00695     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Lap %lf&quot;</span>,buff) )
<a name="l00696"></a>00696       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e" title="Prefactor of the Laplacian.">Lap</a> = *buff;
<a name="l00697"></a>00697     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;SLap %lf&quot;</span>,buff) )
<a name="l00698"></a>00698       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309" title="Prefactor of the square laplacian.">SLap</a> = *buff;
<a name="l00699"></a>00699     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Ext %lf&quot;</span>,buff) )
<a name="l00700"></a>00700       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a60a1f1fb24ef62e5433e4c50466a1624" title="External force.">Ext</a> = *buff;
<a name="l00701"></a>00701     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;LJ %lf&quot;</span>,buff) )
<a name="l00702"></a>00702       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f" title="Lennard-Jones.">LJ</a> = *buff;
<a name="l00703"></a>00703     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;LJMin %lf&quot;</span>,buff) )
<a name="l00704"></a>00704       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ae05456a79f8f4e14c02b374d188ba9da" title="Lennard-Jones.">LJMin</a> = *buff;
<a name="l00705"></a>00705     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;kSpr %lf&quot;</span>,buff) )
<a name="l00706"></a>00706       <a class="code" href="classVarData.html#aa06753ad7a63b8c66f00d123a41abab6" title="Spring coupling.">SetkSpr</a>(*buff);
<a name="l00707"></a>00707     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;SprRest %lf&quot;</span>,buff) )
<a name="l00708"></a>00708       <a class="code" href="classVarData.html#af7a6e7b2d5b68ac853cf2c9438d5ebda" title="Rest distance of the harmonic potential.">SetSprRest</a>(*buff);
<a name="l00709"></a>00709     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;kBen %lf&quot;</span>,buff) )
<a name="l00710"></a>00710       <a class="code" href="classVarData.html#a8b0df96451468c9ee33e780d2415d41b" title="Bending coupling.">SetkBen</a>(*buff);
<a name="l00711"></a>00711     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;SimLimit %lf&quot;</span>,buff) )
<a name="l00712"></a>00712       <a class="code" href="classForces.html#afa426c87de325a8eb41e1f2a29485003" title="Maximum number of time steps.">SimLimit</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00713"></a>00713     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;CutOff %lf&quot;</span>,buff) )
<a name="l00714"></a>00714       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a> = SQR(*buff);
<a name="l00715"></a>00715     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Cont %lf&quot;</span>,buff) )
<a name="l00716"></a>00716       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a426ea6ec144b001fdfc9bf8044160465" title="Contact/Friction.">Cont</a> = *buff;
<a name="l00717"></a>00717     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NWrite %lf&quot;</span>,buff) )
<a name="l00718"></a>00718       <a class="code" href="classForces.html#adcaf21deb47f48c1e25997f52ebd09d6" title="How many timesteps before write the snapshot.">NWrite</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00719"></a>00719     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NBin %lf&quot;</span>,buff) )
<a name="l00720"></a>00720       NBin = (<span class="keywordtype">int</span>)*buff;
<a name="l00721"></a>00721     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NGrid %lf&quot;</span>,buff) )
<a name="l00722"></a>00722       NGrid = (<span class="keywordtype">int</span>)*buff;
<a name="l00723"></a>00723     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NUpdate %lf&quot;</span>,buff) )
<a name="l00724"></a>00724       <a class="code" href="classForces.html#ab8c3546f48b68bd8fa59174d8a5afa97" title="How many timesteps before redrawing.">NUpdate</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00725"></a>00725     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strstr(Line, <span class="stringliteral">&quot;Rigid&quot;</span>) == Line){
<a name="l00726"></a>00726       <a class="code" href="classVarData.html#a0d71010a276631e9621af79f7a41a6bc" title="Reads and set the specifics of the nano.">NanoString</a>(Line,NNano++);
<a name="l00727"></a>00727     }
<a name="l00728"></a>00728 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00729"></a>00729 <span class="preprocessor"></span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfMovie %lf&quot;</span>,buff) )
<a name="l00730"></a>00730       <a class="code" href="classForces.html#a059f36969951363c4c2158e3a0d4f526" title="Produce the images for the video.">IfMovie</a> = (int)*buff;
<a name="l00731"></a>00731     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfLine %lf&quot;</span>,buff) )
<a name="l00732"></a>00732       <a class="code" href="classForces.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00733"></a>00733     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NSpline %lf&quot;</span>,buff) )
<a name="l00734"></a>00734       <a class="code" href="classForces.html#a41019c483f6a39b86e1e25d07b99ee58" title="Total number of points for drawing a spline.">NSpline</a> = *buff;
<a name="l00735"></a>00735     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfSphere %lf&quot;</span>,buff) )
<a name="l00736"></a>00736       <a class="code" href="classForces.html#a49498134a2a543fdb43ec67e5dca8e37" title="Visualize spheres or points.">IfSphere</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00737"></a>00737 <span class="preprocessor">#endif</span>
<a name="l00738"></a>00738 <span class="preprocessor"></span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(3 == sscanf(Line,<span class="stringliteral">&quot;Edge %lf %lf %lf&quot;</span>,buff,buff+1,buff+2) ){
<a name="l00739"></a>00739       <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30" title="Set Edge.">SetEdge</a>(buff[0],0);
<a name="l00740"></a>00740       <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30" title="Set Edge.">SetEdge</a>(buff[1],1);
<a name="l00741"></a>00741       <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30" title="Set Edge.">SetEdge</a>(buff[2],2);
<a name="l00742"></a>00742     }
<a name="l00743"></a>00743     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(3 == sscanf(Line,<span class="stringliteral">&quot;El %lf %lf %lf&quot;</span>,buff,buff+1,buff+2) ){
<a name="l00744"></a>00744       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[0] = *buff;
<a name="l00745"></a>00745       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[1] = *(buff+1);
<a name="l00746"></a>00746       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[2] = *(buff+2);
<a name="l00747"></a>00747     }
<a name="l00748"></a>00748     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(3 == sscanf(Line,<span class="stringliteral">&quot;Elong %lf %lf %lf&quot;</span>,buff,buff+1,buff+2) ){
<a name="l00749"></a>00749       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0] = *buff;
<a name="l00750"></a>00750       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[1] = *(buff+1);
<a name="l00751"></a>00751       <a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2] = *(buff+2);
<a name="l00752"></a>00752     }
<a name="l00753"></a>00753     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(6 == sscanf(Line,<span class="stringliteral">&quot;Boundary %lf %lf %lf %lf %lf %lf&quot;</span>,buff,buff+1,buff+2,buff+3,buff+4,buff+5)){
<a name="l00754"></a>00754       BoundCond[0] = (int)buff[0];
<a name="l00755"></a>00755       BoundCond[1] = (int)buff[1];
<a name="l00756"></a>00756       BoundCond[2] = (int)buff[2];
<a name="l00757"></a>00757       BoundCond[3] = (int)buff[3];
<a name="l00758"></a>00758       BoundCond[4] = (int)buff[4];
<a name="l00759"></a>00759       BoundCond[5] = (int)buff[5];
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(3 == sscanf(Line,<span class="stringliteral">&quot;Periodic  %lf %lf %lf&quot;</span>,buff,buff+1,buff+2)){
<a name="l00762"></a>00762       PeriodicImage[0] = (int)*buff;
<a name="l00763"></a>00763       PeriodicImage[1] = (int)*(buff+1);
<a name="l00764"></a>00764       PeriodicImage[2] = (int)*(buff+2);
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Deltat %lf&quot;</span>,buff) )
<a name="l00767"></a>00767       <a class="code" href="classForces.html#ac321dc561843cb5d3f74604036a3a8da" title="Time step.">Deltat</a> = *buff;
<a name="l00768"></a>00768     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Temp %lf&quot;</span>,buff) )
<a name="l00769"></a>00769       <a class="code" href="classVarData.html#ae1844a2443e011349732c9d9d1c61e1d" title="Set Temperature.">SetTemp</a>(buff[0]);
<a name="l00770"></a>00770     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NChemPotId %lf&quot;</span>,buff) )
<a name="l00771"></a>00771       <a class="code" href="classForces.html#a1e6e0ae467497e3c8ed1e1cc017e74b9" title="Equilibrium number of particles/chains.">NChemPotId</a> = *buff;
<a name="l00772"></a>00772     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;NTrialBias %lf&quot;</span>,buff) ){
<a name="l00773"></a>00773       NTrialBias =(int) *buff;
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;ChemPotEx %lf&quot;</span>,buff) )
<a name="l00776"></a>00776       <a class="code" href="classForces.html#ab7f8fa6b5791ce382b080bb3cb2ff87a" title="Chemical potential of the particles.">ChemPotEx</a> = *buff;
<a name="l00777"></a>00777     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfConfBias %lf&quot;</span>,buff) ){
<a name="l00778"></a>00778       <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)*buff == 1)
<a name="l00779"></a>00779       VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_CONF_BIAS);
<a name="l00780"></a>00780     }
<a name="l00781"></a>00781     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfBilBias %lf&quot;</span>,buff) ){
<a name="l00782"></a>00782       <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)*buff == 1){
<a name="l00783"></a>00783       VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_BIL_BIAS);
<a name="l00784"></a>00784    <a class="code" href="classForces.html#a5404beae7f264277208ee9e55cbea66e" title="Obtain informations for a better performance in inserting the chains.">StudySys</a>();
<a name="l00785"></a>00785       }
<a name="l00786"></a>00786     }
<a name="l00787"></a>00787     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;IfSphBias %lf&quot;</span>,buff) ){
<a name="l00788"></a>00788       <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)*buff == 1)
<a name="l00789"></a>00789       VAR_ADD_TYPE(<a class="code" href="classForces.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_SPH_BIAS);
<a name="l00790"></a>00790     }
<a name="l00791"></a>00791     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;Viscosity %lf&quot;</span>,buff) )
<a name="l00792"></a>00792       <a class="code" href="classForces.html#a0846f0b0f68bb4cbe7b44d53f6200139" title="Viscosity of the medium.">Viscosity</a> = *buff;
<a name="l00793"></a>00793     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;TNSlab %lf&quot;</span>,buff) )
<a name="l00794"></a>00794       <a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#afa1c775c96b6e779b58ff0ff084d8cee" title="# of slabs">NSlab</a> = (int)*buff;
<a name="l00795"></a>00795     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;TNComp %lf&quot;</span>,buff) )
<a name="l00796"></a>00796       <a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#a5a9396ca53c5306c34eb62ef4f02593b" title="# of components">NComp</a> = (<span class="keywordtype">int</span>)*buff;
<a name="l00797"></a>00797     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1 == sscanf(Line,<span class="stringliteral">&quot;TCalcMode %s&quot;</span>,SysInit) ){
<a name="l00798"></a>00798       <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;2d&quot;</span>) ){
<a name="l00799"></a>00799    VAR_ADD_TYPE(<a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_2d);
<a name="l00800"></a>00800    <a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#a3b5e7568c0a268ec8bbeef7f29ea111a" title="# of dimensions">NDim</a> = 2;
<a name="l00801"></a>00801       }
<a name="l00802"></a>00802       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(SysInit,<span class="stringliteral">&quot;3d&quot;</span>) ){
<a name="l00803"></a>00803    VAR_ADD_TYPE(<a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#ae7fd260630480928a069e7e536739df1" title="Calculation mode.">CalcMode</a>,CALC_3d);
<a name="l00804"></a>00804    <a class="code" href="classForces.html#a77e000512807ae8da791d650d739299a" title="Structure for the pressure calculation.">Tens</a>.<a class="code" href="structTENS.html#a3b5e7568c0a268ec8bbeef7f29ea111a" title="# of dimensions">NDim</a> = 3;
<a name="l00805"></a>00805       }
<a name="l00806"></a>00806       <span class="keywordflow">else</span>{
<a name="l00807"></a>00807    printf(<span class="stringliteral">&quot;Pressure summation not recognized\n&quot;</span>);
<a name="l00808"></a>00808    exit(1);
<a name="l00809"></a>00809       }
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811   }
<a name="l00812"></a>00812   <span class="comment">//for(int n=0;n&lt;pNNano();n++) for(int d=0;d&lt;3;d++) Nano[n].Pos[d] *= pEdge(d);</span>
<a name="l00813"></a>00813   <a class="code" href="classForces.html#a2e25f2942dd28ddaf03d12e8ece82c9a" title="Chemical potential of the particles.">ChemPotId</a> = log(<a class="code" href="classForces.html#a1e6e0ae467497e3c8ed1e1cc017e74b9" title="Equilibrium number of particles/chains.">NChemPotId</a>/<a class="code" href="classVarData.html#a3ccdbc4515f1de45728ef36368b9969a" title="xyzr edges of the simulation box">pVol</a>());
<a name="l00814"></a>00814   printf(<span class="stringliteral">&quot;Sys] NEdge %d SysShape %d %s Interp %d  \n&quot;</span>,<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>,<a class="code" href="classForces.html#abb0374374d00777fe085e4a163a0e9c5" title="Shape of system.">SysShape</a>,SysInit,<a class="code" href="classForces.html#a283f91fa3fbd05178f4b77ff3a585495" title="If interpolates with the splines.">IfInterp</a>);
<a name="l00815"></a>00815   printf(<span class="stringliteral">&quot;Forces] Lap %lf SLap %lf Ext %lf LJ %lf Cont %lf El %lf %lf %lf Elong %lf %lf %lf\n&quot;</span>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ad68dc62d6c1b859ad3abebc60476453e" title="Prefactor of the Laplacian.">Lap</a>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a348745786658bd8382be1fd25066a309" title="Prefactor of the square laplacian.">SLap</a>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a60a1f1fb24ef62e5433e4c50466a1624" title="External force.">Ext</a>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a014d64316c28b7014a2e8696ea99388f" title="Lennard-Jones.">LJ</a>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a426ea6ec144b001fdfc9bf8044160465" title="Contact/Friction.">Cont</a>,<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[0],<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[1],<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a682d0bf554363bfcb9698c55bd6a0527" title="Elastic force.">El</a>[2],<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[0],<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[1],<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#a3a05bdc0a320e2408242a0f5152debca" title="Elongation of the springs.">Elong</a>[2]);
<a name="l00816"></a>00816   printf(<span class="stringliteral">&quot;External] Center %lf %lf %lf Rad %lf Hei %lf\n&quot;</span>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487" title="Size.">Rad</a>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57" title="Height of the cylinder.">Height</a>);
<a name="l00817"></a>00817   fclose(FileToRead);
<a name="l00818"></a>00818   <span class="keywordflow">return</span> 0;
<a name="l00819"></a>00819 }
<a name="l00820"></a><a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6">00820</a> <span class="keywordtype">int</span> <a class="code" href="classForces.html#a2bd0476e620e68ae04990018f4520bf6" title="Realloc the number of particles.">Forces::ReSetNPart</a>(<span class="keywordtype">int</span> NewNPart){
<a name="l00821"></a>00821   <span class="keywordtype">int</span> OldNPart = <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00822"></a>00822   <span class="comment">//if the number of allocated particle is less then the new particles returns</span>
<a name="l00823"></a>00823   <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#abdcc792391d8c5092471dff191de47f4" title="# particles">NPart</a> = NewNPart;
<a name="l00824"></a>00824   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a2e0b2cd0414a0994122e1dfae41e57b8" title="Set and reallocate the number of particles.">SetNPart</a>(NewNPart)) <span class="keywordflow">return</span> 1;
<a name="l00825"></a>00825   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MC)){
<a name="l00826"></a>00826     <span class="keywordtype">double</span> *Dens2T = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00827"></a>00827     <span class="keywordtype">double</span> *Dens3T = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00828"></a>00828     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>();p++){
<a name="l00829"></a>00829       Dens2T[p] = Dens2[p];
<a name="l00830"></a>00830       Dens3T[p] = Dens3[p];
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832     <span class="comment">//memcpy(Dens2,Dens2T,OldNPart*pNType());</span>
<a name="l00833"></a>00833     <span class="comment">//memcpy(Dens3,Dens3T,OldNPart*pNType());</span>
<a name="l00834"></a>00834     free(Dens2);
<a name="l00835"></a>00835     free(Dens3);
<a name="l00836"></a>00836     Dens2 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00837"></a>00837     Dens3 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>(),<span class="keyword">sizeof</span>(double));
<a name="l00838"></a>00838     <span class="comment">// memcpy(Dens2T,Dens2,OldNPart*pNType());</span>
<a name="l00839"></a>00839     <span class="comment">// memcpy(Dens3T,Dens3,OldNPart*pNType());</span>
<a name="l00840"></a>00840     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart*<a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">pNType</a>();p++){
<a name="l00841"></a>00841       Dens2[p] = Dens2T[p];
<a name="l00842"></a>00842       Dens3[p] = Dens3T[p];
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844     free(Dens2T);
<a name="l00845"></a>00845     free(Dens3T);
<a name="l00846"></a>00846     <span class="keywordtype">double</span> *TempNrgPart = <span class="keyword">new</span> <span class="keywordtype">double</span>[OldNPart];
<a name="l00847"></a>00847     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart;p++){
<a name="l00848"></a>00848       TempNrgPart[p] = OldNrgBead[p];
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850     <span class="keyword">delete</span>[] OldNrgBead;
<a name="l00851"></a>00851     OldNrgBead = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>()];
<a name="l00852"></a>00852     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart;p++){
<a name="l00853"></a>00853       OldNrgBead[p] = TempNrgPart[p];
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855     <span class="keyword">delete</span> []TempNrgPart;
<a name="l00856"></a>00856   }
<a name="l00857"></a>00857   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MD)){
<a name="l00858"></a>00858     <a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a> *TmpFm = <span class="keyword">new</span> <a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a> [OldNPart];
<a name="l00859"></a>00859     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart;p++){
<a name="l00860"></a>00860       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00861"></a>00861    TmpFm[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba" title="Direction.">Dir</a>[d] = <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba" title="Direction.">Dir</a>[d];
<a name="l00862"></a>00862    TmpFm[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38" title="External.">Ext</a>[d] = <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38" title="External.">Ext</a>[d];
<a name="l00863"></a>00863       }
<a name="l00864"></a>00864     }
<a name="l00865"></a>00865     free(<a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>);
<a name="l00866"></a>00866     <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a> = (<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a> *)calloc(<a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">pNAllocP</a>(),<span class="keyword">sizeof</span>(<a class="code" href="structFORCES.html" title="Single contribution of the forces.">FORCES</a>));
<a name="l00867"></a>00867     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;OldNPart;p++){
<a name="l00868"></a>00868       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00869"></a>00869    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba" title="Direction.">Dir</a>[d] = TmpFm[p].<a class="code" href="structFORCES.html#ac77c91979738079508cf3f257a7164ba" title="Direction.">Dir</a>[d];
<a name="l00870"></a>00870    <a class="code" href="classForces.html#afca243db3841bf482910199bdb22e5f3" title="Array containing the forces for each particle.">Fm</a>[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38" title="External.">Ext</a>[d] = TmpFm[p].<a class="code" href="structFORCES.html#a034ef504c45f9a730ddb6053df710a38" title="External.">Ext</a>[d];
<a name="l00871"></a>00871       }
<a name="l00872"></a>00872     }
<a name="l00873"></a>00873     free(TmpFm);
<a name="l00874"></a>00874   }
<a name="l00875"></a>00875   <span class="keywordflow">return</span> 0;
<a name="l00876"></a>00876 }
<a name="l00877"></a><a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba">00877</a> <span class="keywordtype">int</span> <a class="code" href="classForces.html#a935982eadb27b11f47553c06e7aa77ba" title="Realloc the number of chains.">Forces::ReSetNChain</a>(<span class="keywordtype">int</span> NewNChain){
<a name="l00878"></a>00878   <span class="keywordtype">int</span> OldNChain = <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();
<a name="l00879"></a>00879   <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a> = NewNChain;
<a name="l00880"></a>00880   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae" title="Set and reallocate the number of chains.">SetNChain</a>(NewNChain))<span class="keywordflow">return</span> 1;
<a name="l00881"></a>00881   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MC)){
<a name="l00882"></a>00882     <span class="keywordtype">double</span> *TempNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[OldNChain];
<a name="l00883"></a>00883     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;3*OldNChain;c++){
<a name="l00884"></a>00884       TempNrgCh[c] = OldNrgCh[c];
<a name="l00885"></a>00885     }
<a name="l00886"></a>00886     <span class="keyword">delete</span>[] OldNrgCh;
<a name="l00887"></a>00887     OldNrgCh = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classVarData.html#a8ee69088ad7dd9ea55f50b1fc19ec4e2" title="Allocated number of chains.">pNAllocC</a>()];
<a name="l00888"></a>00888     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;3*OldNChain;c++){
<a name="l00889"></a>00889       OldNrgCh[c] = TempNrgCh[c];
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891     <span class="keyword">delete</span> []TempNrgCh;
<a name="l00892"></a>00892   }
<a name="l00893"></a>00893   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classForces.html#ab3f89c2d946d9c242d3d6061ae17ae78" title="Which arrays are allocated.">SysAlloc</a>,ALL_MD)){
<a name="l00894"></a>00894   }
<a name="l00895"></a>00895   <span class="keywordflow">return</span> 0;
<a name="l00896"></a>00896 }
<a name="l00897"></a><a class="code" href="classForces.html#aa95d72aa125333d83e91047bc8f4319a">00897</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#aa95d72aa125333d83e91047bc8f4319a" title="Set a new number of particle per chain.">Forces::ReSetNPCh</a>(<span class="keywordtype">int</span> NewNPCh){
<a name="l00898"></a>00898   <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#a521663d12899e0fefe0a182332a8573f" title="# particles per chain">NPCh</a> = NewNPCh;
<a name="l00899"></a>00899   <a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972" title="Set and reallocate the number of particles per chains.">SetNPCh</a>(NewNPCh);
<a name="l00900"></a>00900 }
<a name="l00901"></a><a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300">00901</a> <span class="keywordtype">void</span> <a class="code" href="classForces.html#a3f36144668126bc6bb1c682c5b10b300" title="Open a new file.">Forces::ReOpen</a>(<span class="keywordtype">char</span> *FName,<span class="keywordtype">int</span> Bf){
<a name="l00902"></a>00902   <span class="keywordtype">double</span> Edge[3] = {<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00903"></a>00903   <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a98ae2e78109ea826eea71da14c37ce95" title="Erase the pairlist.">Erase</a>();
<a name="l00904"></a>00904   <span class="keyword">delete</span> <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>;
<a name="l00905"></a>00905   <a class="code" href="classVarData.html#a50a785f6295f7e7fb2494fcad2a2a7fc" title="Open the.">Open</a>(FName,Bf);
<a name="l00906"></a>00906   <a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a> = <span class="keyword">new</span> <a class="code" href="classDdLinkedList.html" title="Domain decomposition as pointer to linked particles.">DomDec</a>(Edge,<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),sqrt(<a class="code" href="classForces.html#a774d65ef8685d2859fae66bad8c9b435" title="Prefactor of the forces.">Kf</a>.<a class="code" href="structKFORCES.html#ac448df5dbfd256324893075200dace49" title="CutOff of the lennard jones.">CutOff2</a>));
<a name="l00907"></a>00907   <span class="keywordtype">double</span> Pos[3];
<a name="l00908"></a>00908   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Pos);<a class="code" href="classForces.html#a5d8052dd63b08f01b581aeffa8506051" title="Pair list.">Pc</a>-&gt;<a class="code" href="classDdLinkedList.html#a9a64ea1512bb8d62f9f6a7a80a2bfec9" title="Add a particle to the cell c.">AddPart</a>(p,Pos);}
<a name="l00909"></a>00909   <a class="code" href="classForces.html#a053a9be7328b6a532baf8774f8479188" title="Calculate some initial quantities for the succesive calculations.">PrepareSys</a>();
<a name="l00910"></a>00910 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:16 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
