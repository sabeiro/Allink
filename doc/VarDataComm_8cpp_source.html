<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/VarData/VarDataComm.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_4fd85bb7e60d3734b722333cda33b932.html">VarData</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">VarDataComm.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;VarData.h&gt;</span>
<a name="l00002"></a><a class="code" href="classVarData.html#a2e0b2cd0414a0994122e1dfae41e57b8">00002</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a2e0b2cd0414a0994122e1dfae41e57b8" title="Set and reallocate the number of particles.">VarData::SetNPart</a>(<span class="keywordtype">int</span> NewNPart){
<a name="l00003"></a>00003   <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a> == NewNPart) <span class="keywordflow">return</span> 1;
<a name="l00004"></a>00004   <span class="keywordtype">int</span> OldNPart = <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();
<a name="l00005"></a>00005   Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a> = NewNPart;
<a name="l00006"></a>00006   <span class="keywordflow">if</span>( !VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_PART_ALLOCATED) ){
<a name="l00007"></a>00007     Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> = Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>;
<a name="l00008"></a>00008     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() &gt; 0 &amp;&amp; <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() &lt; 200 ) Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> += 2000*Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a>;
<a name="l00009"></a>00009     <span class="keywordflow">else</span> Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> += 2000;
<a name="l00010"></a>00010     Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> += 2000;
<a name="l00011"></a>00011     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00012"></a>00012     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> == NULL){
<a name="l00013"></a>00013       printf(<span class="stringliteral">&quot;Couldn&#39;t alloc the particles\n&quot;</span>);
<a name="l00014"></a>00014       exit(1);
<a name="l00015"></a>00015     }
<a name="l00016"></a>00016     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_PART_ALLOCATED);
<a name="l00017"></a>00017     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">pNLink</a>() &gt; 0){
<a name="l00018"></a>00018       <a class="code" href="classVarData.html#a6dc8858a41c1a3851b2215c6460347bf" title="(re)allocate the links">AllocLinks</a>(NewNPart);
<a name="l00019"></a>00019     }
<a name="l00020"></a>00020   }
<a name="l00021"></a>00021   <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> &lt; NewNPart){
<a name="l00022"></a>00022     Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> = NewNPart;
<a name="l00023"></a>00023     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() &gt; 0 &amp;&amp; <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>() &lt; 200 ) Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> += 2000*Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a>;
<a name="l00024"></a>00024     <span class="keywordflow">else</span> Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> += 2000;
<a name="l00025"></a>00025     <a class="code" href="structPART.html" title="Information of every particle.">PART</a> *Pn = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00026"></a>00026     <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">Copy</a>(Pn,<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>,OldNPart);
<a name="l00027"></a>00027     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)realloc(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>*<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00028"></a>00028     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> == NULL){
<a name="l00029"></a>00029       printf(<span class="stringliteral">&quot;Couldn&#39;t realloc the particles\n&quot;</span>);
<a name="l00030"></a>00030       exit(1);
<a name="l00031"></a>00031     }
<a name="l00032"></a>00032     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">pNLink</a>() &gt; 0){
<a name="l00033"></a>00033       <a class="code" href="classVarData.html#a6dc8858a41c1a3851b2215c6460347bf" title="(re)allocate the links">AllocLinks</a>(NewNPart);
<a name="l00034"></a>00034     }
<a name="l00035"></a>00035     <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">Copy</a>(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>,Pn,OldNPart);
<a name="l00036"></a>00036     free(Pn);
<a name="l00037"></a>00037   }
<a name="l00038"></a>00038   <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00039"></a>00039   <span class="keywordflow">return</span> 0;
<a name="l00040"></a>00040 }
<a name="l00041"></a><a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8">00041</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a1bc126dbe2154d5966e5d2c57af9c7c8" title="Set and reallocate the number of links.">VarData::SetNLink</a>(<span class="keywordtype">int</span> NewNLink){
<a name="l00042"></a>00042   <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a> == NewNLink) <span class="keywordflow">return</span> 1;
<a name="l00043"></a>00043   Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a> = NewNLink;
<a name="l00044"></a>00044   <span class="keywordflow">return</span> 0;
<a name="l00045"></a>00045 }
<a name="l00046"></a><a class="code" href="classVarData.html#a6dc8858a41c1a3851b2215c6460347bf">00046</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a6dc8858a41c1a3851b2215c6460347bf" title="(re)allocate the links">VarData::AllocLinks</a>(<span class="keywordtype">int</span> NewNPart){
<a name="l00047"></a>00047   <span class="keywordflow">if</span>( !VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_LINK_ALLOCATED) ){
<a name="l00048"></a>00048     <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> = (<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>,<span class="keyword">sizeof</span>(<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a>));
<a name="l00049"></a>00049     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> == NULL){
<a name="l00050"></a>00050       printf(<span class="stringliteral">&quot;Couldn&#39;t alloc the links\n&quot;</span>);
<a name="l00051"></a>00051       exit(1);
<a name="l00052"></a>00052     }
<a name="l00053"></a>00053     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>;p++){
<a name="l00054"></a>00054       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a> = (<span class="keywordtype">int</span> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00055"></a>00055       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].Link == NULL){
<a name="l00056"></a>00056    printf(<span class="stringliteral">&quot;Couldn&#39;t alloc the links\n&quot;</span>);
<a name="l00057"></a>00057    exit(1);
<a name="l00058"></a>00058       }
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_LINK_ALLOCATED);
<a name="l00061"></a>00061   }
<a name="l00062"></a>00062   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> &lt; NewNPart){
<a name="l00063"></a>00063     <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> = (<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a> *)realloc(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>*<span class="keyword">sizeof</span>(<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a>));
<a name="l00064"></a>00064     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> == NULL){
<a name="l00065"></a>00065       printf(<span class="stringliteral">&quot;Couldn&#39;t realloc the links\n&quot;</span>);
<a name="l00066"></a>00066       exit(1);
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>;p++){
<a name="l00069"></a>00069       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a> = (<span class="keywordtype">int</span> *)realloc(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].Link,Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00070"></a>00070       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].Link == NULL){
<a name="l00071"></a>00071    printf(<span class="stringliteral">&quot;Couldn&#39;t realloc the links\n&quot;</span>);
<a name="l00072"></a>00072    exit(1);
<a name="l00073"></a>00073       }
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075   }
<a name="l00076"></a>00076   <span class="keywordflow">return</span> 0;
<a name="l00077"></a>00077 }
<a name="l00078"></a><a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae">00078</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae" title="Set and reallocate the number of chains.">VarData::SetNChain</a>(<span class="keywordtype">int</span> NewNChain){
<a name="l00079"></a>00079   <span class="keywordtype">int</span> OldNChain = <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();
<a name="l00080"></a>00080   Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a> = NewNChain;
<a name="l00081"></a>00081   <span class="keywordflow">if</span>( !VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_CH_ALLOCATED) ){
<a name="l00082"></a>00082     Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a> = Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a>+200;
<a name="l00083"></a>00083     <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a> = (<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a>,<span class="keyword">sizeof</span>(<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a>));
<a name="l00084"></a>00084     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_CH_ALLOCATED);
<a name="l00085"></a>00085   }
<a name="l00086"></a>00086   <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a> &lt; NewNChain){
<a name="l00087"></a>00087     Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a> = NewNChain + 200;
<a name="l00088"></a>00088     <a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *Cn = (<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a>,<span class="keyword">sizeof</span>(<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a>));
<a name="l00089"></a>00089     <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">Copy</a>(Cn,<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>,OldNChain);
<a name="l00090"></a>00090     <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a> = (<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *)realloc(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a>*<span class="keyword">sizeof</span>(<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a>));
<a name="l00091"></a>00091     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a> == NULL){
<a name="l00092"></a>00092       printf(<span class="stringliteral">&quot;Couldn&#39;t realloc the chains\n&quot;</span>);
<a name="l00093"></a>00093       exit(1);
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095     <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">Copy</a>(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>,Cn,OldNChain);
<a name="l00096"></a>00096     free(Cn);
<a name="l00097"></a>00097   }
<a name="l00098"></a>00098   <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00099"></a>00099   <span class="keywordflow">return</span> 0;
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 <span class="comment">//obsolete?</span>
<a name="l00102"></a><a class="code" href="classVarData.html#a1a9b1fc0b7f08d25f507becdb57d531e">00102</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a1a9b1fc0b7f08d25f507becdb57d531e" title="Alloc the structures.">VarData::AllocPart</a>(){
<a name="l00103"></a>00103   <span class="keywordflow">if</span>(Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a> == 0){
<a name="l00104"></a>00104     printf(<span class="stringliteral">&quot;No particles or no particle tag: {} \n&quot;</span>);
<a name="l00105"></a>00105     return ;
<a name="l00106"></a>00106   }
<a name="l00107"></a>00107   <span class="keywordflow">if</span>( !VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_PART_ALLOCATED) ){
<a name="l00108"></a>00108     Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a> = Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a>+100;
<a name="l00109"></a>00109     Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a> = Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>+100*Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a>;
<a name="l00110"></a>00110     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>,<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00111"></a>00111     <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> = (<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>,<span class="keyword">sizeof</span>(<a class="code" href="structLINKS.html" title="Structure with the links of the particles.">LINKS</a>));
<a name="l00112"></a>00112     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a> == NULL || <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a> == NULL){
<a name="l00113"></a>00113       return ;
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>;p++){
<a name="l00116"></a>00116       <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a> = (<span class="keywordtype">int</span> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118     <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a> = (<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a>,<span class="keyword">sizeof</span>(<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a>));
<a name="l00119"></a>00119     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_PART_ALLOCATED);
<a name="l00120"></a>00120     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_CH_ALLOCATED);
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122   <span class="comment">//FIXME: doesn&#39;t realloc</span>
<a name="l00123"></a>00123   <span class="keywordflow">else</span> {
<a name="l00124"></a>00124     <span class="comment">//free(Ch);</span>
<a name="l00125"></a>00125     <span class="comment">//for(int p=0;p&lt;Gen-&gt;NPart;p++)  free(Pm[p].Link);</span>
<a name="l00126"></a>00126     <span class="comment">//free(Pm);</span>
<a name="l00127"></a>00127     <span class="comment">// Pm = (PART *)realloc(Pm,Gen-&gt;NPart*sizeof(PART));</span>
<a name="l00128"></a>00128     <span class="comment">//Pm = (PART *)calloc(Gen-&gt;NPart,sizeof(PART));</span>
<a name="l00129"></a>00129     <span class="comment">// for(int p=0;p&lt;Gen-&gt;NPart;p++){</span>
<a name="l00130"></a>00130     <span class="comment">//   Pm[p].Link = (int *)realloc(Pm[p].Link,Gen-&gt;NLink*sizeof(int));</span>
<a name="l00131"></a>00131     <span class="comment">//   //Pm[p].Link = (int *)calloc(Gen-&gt;NLink,sizeof(int));</span>
<a name="l00132"></a>00132     <span class="comment">// }</span>
<a name="l00133"></a>00133     <span class="comment">// Ch = (CHAIN *)realloc(Ch,Gen-&gt;NChain*sizeof(CHAIN));</span>
<a name="l00134"></a>00134     <span class="comment">//Ch = (CHAIN *)calloc(Gen-&gt;NChain,sizeof(CHAIN));</span>
<a name="l00135"></a>00135   }
<a name="l00136"></a>00136   <span class="keywordflow">if</span>(!<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>){ printf(<span class="stringliteral">&quot;Non alloca Pm\n&quot;</span>);return ;}
<a name="l00137"></a>00137   <span class="keywordflow">if</span>(!<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>){ printf(<span class="stringliteral">&quot;Non alloca Ch\n&quot;</span>);return ;}
<a name="l00138"></a>00138 }
<a name="l00139"></a><a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03">00139</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">VarData::Copy</a>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *P1,<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *P2,<span class="keywordtype">int</span> NPartOld){
<a name="l00140"></a>00140   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00141"></a>00141     <span class="keywordflow">if</span>(p &gt;= NPartOld) <span class="keywordflow">break</span>;
<a name="l00142"></a>00142     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00143"></a>00143       P1[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = P2[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d];
<a name="l00144"></a>00144       P1[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2" title="xyzr Velocity of the particle">Vel</a>[d] = P2[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2" title="xyzr Velocity of the particle">Vel</a>[d];
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146     P1[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = P2[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a>;
<a name="l00147"></a>00147   }
<a name="l00148"></a>00148 }
<a name="l00149"></a><a class="code" href="classVarData.html#a6b4ad600104f81b994be59a1e98be6a6">00149</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a4de27ea0167e58319a6848705a423e03" title="Copy the part P2 on part P1.">VarData::Copy</a>(<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *C1,<a class="code" href="structCHAIN.html" title="Information of every chain.">CHAIN</a> *C2,<span class="keywordtype">int</span> NChainOld){
<a name="l00150"></a>00150   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00151"></a>00151     <span class="keywordflow">if</span>(c &gt;= NChainOld) <span class="keywordflow">break</span>;
<a name="l00152"></a>00152     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00153"></a>00153       C1[c].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[d] = C2[c].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[d];
<a name="l00154"></a>00154       C1[c].<a class="code" href="structCHAIN.html#ae3fae9edc78d8cadc33c5a52bebdb46c" title="Chain velocity.">Vel</a>[d] = C2[c].<a class="code" href="structCHAIN.html#ae3fae9edc78d8cadc33c5a52bebdb46c" title="Chain velocity.">Vel</a>[d];
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156     C1[c].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a> = C2[c].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a>;
<a name="l00157"></a>00157   }
<a name="l00158"></a>00158 }
<a name="l00159"></a><a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972">00159</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a3e021ffdb31d5f94a22435e437dc6972" title="Set and reallocate the number of particles per chains.">VarData::SetNPCh</a>(<span class="keywordtype">int</span> NewNPCh){
<a name="l00160"></a>00160   <span class="comment">//blocks?</span>
<a name="l00161"></a>00161   Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a> = NewNPCh;
<a name="l00162"></a>00162 }
<a name="l00163"></a><a class="code" href="classVarData.html#a1ba38db0d91819c6627dbac8de45b6a7">00163</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a1ba38db0d91819c6627dbac8de45b6a7" title="Set NBlock.">VarData::SetNBlock</a>(<span class="keywordtype">int</span> Val){
<a name="l00164"></a>00164   <span class="keywordflow">if</span>(Val == Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>) <span class="keywordflow">return</span> 1;
<a name="l00165"></a>00165   <span class="keywordflow">if</span>(!VAR_IF_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_NBLOCK_ALL)){
<a name="l00166"></a>00166     Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a> = Val;
<a name="l00167"></a>00167     <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a> = (<a class="code" href="structBLOCK.html" title="Information for every block.">BLOCK</a> *)calloc(Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>,<span class="keyword">sizeof</span>(<a class="code" href="structBLOCK.html" title="Information for every block.">BLOCK</a>));
<a name="l00168"></a>00168     VAR_ADD_TYPE(<a class="code" href="classVarData.html#ad396ed53d4010dad8257a97973324c40" title="Contains the definition of the system.">SysType</a>,VAR_NBLOCK_ALL);
<a name="l00169"></a>00169   }
<a name="l00170"></a>00170   <span class="keywordflow">else</span>{
<a name="l00171"></a>00171     Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a> = Val;
<a name="l00172"></a>00172     <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a> = (<a class="code" href="structBLOCK.html" title="Information for every block.">BLOCK</a> *) realloc(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>,Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>*<span class="keyword">sizeof</span>(<a class="code" href="structBLOCK.html" title="Information for every block.">BLOCK</a>));
<a name="l00173"></a>00173   }
<a name="l00174"></a>00174   <span class="keywordflow">return</span> 0;
<a name="l00175"></a>00175 };
<a name="l00176"></a><a class="code" href="classVarData.html#ad5e77b3ade14f7be0d91ccd0f5397cb6">00176</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#ad5e77b3ade14f7be0d91ccd0f5397cb6" title="Set NNano.">VarData::SetNNano</a>(<span class="keywordtype">int</span> Val){
<a name="l00177"></a>00177   <span class="keywordflow">if</span>(Val == Gen-&gt;NNano) <span class="keywordflow">return</span> 1;
<a name="l00178"></a>00178   <span class="comment">//if(!VAR_IF_TYPE(SysType,VAR_NNANO_ALL)){</span>
<a name="l00179"></a>00179   <span class="comment">//  VAR_ADD_TYPE(SysType,VAR_NBLOCK_ALL);</span>
<a name="l00180"></a>00180   Gen-&gt;NNano = Val;
<a name="l00181"></a>00181   <span class="keywordflow">if</span>(Val == 0) Val = 1;
<a name="l00182"></a>00182   <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a> = (<a class="code" href="structNANO.html" title="Information about the nanoparticle.">NANO</a> *) realloc(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>,Val*<span class="keyword">sizeof</span>(<a class="code" href="structNANO.html" title="Information about the nanoparticle.">NANO</a>));
<a name="l00183"></a>00183   <span class="keywordflow">return</span> 0;
<a name="l00184"></a>00184 };
<a name="l00185"></a><a class="code" href="classVarData.html#ab1caa779737fb8f3bb11375fd03cb4a7">00185</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ab1caa779737fb8f3bb11375fd03cb4a7" title="Set the number of species.">VarData::SetNType</a>(<span class="keywordtype">int</span> NewNType){
<a name="l00186"></a>00186   <span class="comment">//blocks?</span>
<a name="l00187"></a>00187   Gen-&gt;<a class="code" href="structGENERAL.html#a4ad7cd0445491c0ba28c41907eba46b1" title="# of types of the particle">NType</a> = NewNType;
<a name="l00188"></a>00188 }
<a name="l00189"></a><a class="code" href="classVarData.html#a65d27f4def5d4f78e90663334bd50e1e">00189</a> <span class="keywordtype">double</span> <a class="code" href="classVarData.html#a65d27f4def5d4f78e90663334bd50e1e" title="Return back folded position.">VarData::pChPos</a>(<span class="keywordtype">int</span> c,<span class="keywordtype">int</span> d){
<a name="l00190"></a>00190   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[d];
<a name="l00191"></a>00191 };
<a name="l00192"></a><a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5">00192</a> <span class="keywordtype">double</span> <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">VarData::pPos</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> d){
<a name="l00193"></a>00193   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] + <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a77abbc20fd99f1fb464e7a922e543e19" title="xyz Backfold distance">Bkf</a>[d];
<a name="l00194"></a>00194 };
<a name="l00195"></a><a class="code" href="classVarData.html#a0085930a4b59bda42e6bf3146bae3d0b">00195</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">VarData::pPos</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">double</span> *Pos){
<a name="l00196"></a>00196   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) 
<a name="l00197"></a>00197     Pos[d] = <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[d] + <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Bkf[d];
<a name="l00198"></a>00198 };
<a name="l00199"></a><a class="code" href="classVarData.html#a24a0a89ff0f65b56c0f30a6949d56449">00199</a> <span class="keywordtype">double</span> <a class="code" href="classVarData.html#a24a0a89ff0f65b56c0f30a6949d56449" title="Return the velocity.">VarData::pPosNoBkf</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> d){
<a name="l00200"></a>00200   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d];
<a name="l00201"></a>00201 };
<a name="l00202"></a><a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0">00202</a> <span class="keywordtype">double</span> <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">VarData::pVel</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> d){
<a name="l00203"></a>00203   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2" title="xyzr Velocity of the particle">Vel</a>[d];
<a name="l00204"></a>00204 };
<a name="l00205"></a><a class="code" href="classVarData.html#a5b8f787336ad1a776f82be0a59c9f570">00205</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a5b8f787336ad1a776f82be0a59c9f570" title="Set the particle position.">VarData::SetPos</a>(<span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *Pos){
<a name="l00206"></a>00206   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++)
<a name="l00207"></a>00207     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[d] = Pos[d];
<a name="l00208"></a>00208 };
<a name="l00209"></a><a class="code" href="classVarData.html#a4138dc5653572cfd0e241d4a20da623c">00209</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a5b8f787336ad1a776f82be0a59c9f570" title="Set the particle position.">VarData::SetPos</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> d,<span class="keywordtype">double</span> Pos){
<a name="l00210"></a>00210   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = Pos;
<a name="l00211"></a>00211 };
<a name="l00212"></a><a class="code" href="classVarData.html#ae8d1cbd45a41409d2a76e73738003744">00212</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ae8d1cbd45a41409d2a76e73738003744" title="Set the particle velocity.">VarData::SetVel</a>(<span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *Vel){
<a name="l00213"></a>00213   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++)
<a name="l00214"></a>00214     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Vel[d] = Vel[d];
<a name="l00215"></a>00215 };
<a name="l00216"></a><a class="code" href="classVarData.html#a54f680d04a52452baf2d8e9852c425cd">00216</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a54f680d04a52452baf2d8e9852c425cd" title="Set the particle type.">VarData::SetType</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">int</span> t){
<a name="l00217"></a>00217   <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = t;
<a name="l00218"></a>00218 };
<a name="l00219"></a><a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c">00219</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">VarData::pType</a>(<span class="keywordtype">int</span> p){
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a>;
<a name="l00221"></a>00221 };
<a name="l00222"></a><a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68">00222</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">VarData::pChain</a>(<span class="keywordtype">int</span> p){
<a name="l00223"></a>00223   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#ae9c6df97c72d6a4af74acf24adbe81bf" title="Chain Identifier.">CId</a>;
<a name="l00224"></a>00224 };
<a name="l00225"></a><a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3">00225</a> <span class="keywordtype">double</span> <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">VarData::pNanoPos</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> d){
<a name="l00226"></a>00226   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[d] + <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].<a class="code" href="structNANO.html#a77abbc20fd99f1fb464e7a922e543e19" title="Backfolded position.">Bkf</a>[d];
<a name="l00227"></a>00227 };
<a name="l00228"></a><a class="code" href="classVarData.html#a7994a751e400e4df33a6a6fb8a8ba025">00228</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#a7994a751e400e4df33a6a6fb8a8ba025" title="Set the back folded array for the particle p.">VarData::SetBkf</a>(<span class="keywordtype">int</span> p){
<a name="l00229"></a>00229   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) 
<a name="l00230"></a>00230     <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Bkf[d] = -floor(<a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].Pos[d]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(d))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00231"></a>00231 };
<a name="l00232"></a><a class="code" href="classVarData.html#ae93d1705bac1b8fafb6feab474ac8f46">00232</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ae93d1705bac1b8fafb6feab474ac8f46" title="Set the back folded array for the nano n.">VarData::SetNanoBkf</a>(<span class="keywordtype">int</span> n){
<a name="l00233"></a>00233   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) 
<a name="l00234"></a>00234     <a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Bkf[d] = -floor(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[d]*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(d))*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00235"></a>00235 };
<a name="l00236"></a>00236 <span class="comment">// void VarData::pPos(int p){</span>
<a name="l00237"></a>00237 <span class="comment">//   printf(&quot;%lf %lf %lf\n&quot;,Pm[p].Pos[0],Pm[p].Pos[1],Pm[p].Pos[2]);</span>
<a name="l00238"></a>00238 <span class="comment">// };</span>
<a name="l00239"></a><a class="code" href="classVarData.html#a305923bc99c52d8011f98b58ea8054ae">00239</a> <span class="keywordtype">double</span> *<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">VarData::pPos</a>(<span class="keywordtype">int</span> p){
<a name="l00240"></a>00240   <span class="keywordflow">return</span> <a class="code" href="classVarData.html#a53eee20378b4a2c61407897d98a4b5d7" title="Particle information of all particle.">Pm</a>[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>;
<a name="l00241"></a>00241 }
<a name="l00242"></a><a class="code" href="classVarData.html#a08e1dc218828fb8e3b3c9c02fccd6950">00242</a> <span class="keywordtype">void</span> <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">VarData::pPos</a>(<span class="keywordtype">double</span> *Pos){
<a name="l00243"></a>00243   printf(<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,Pos[0],Pos[1],Pos[2]);
<a name="l00244"></a>00244 };
<a name="l00245"></a><a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0">00245</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0" title="Number of steps.">VarData::pStep</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a7d089b5d5a5a8f8699325baad0ad85b5" title="Courrent step.">Step</a>;};
<a name="l00246"></a><a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f">00246</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">VarData::pNPart</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#abdcc792391d8c5092471dff191de47f4" title="Number of particle.">NPart</a>;};
<a name="l00247"></a><a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2">00247</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">VarData::pNChain</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#aa49e4d7af0d71e79524ef6fb081707b5" title="Number of chain.">NChain</a>;};
<a name="l00248"></a><a class="code" href="classVarData.html#a183da1b56d3f02e3cc06bd73a6d3d548">00248</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">VarData::pNChain</a>(<span class="keywordtype">int</span> b){<span class="keywordflow">return</span> <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>;};
<a name="l00249"></a><a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f">00249</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">VarData::pNPCh</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a521663d12899e0fefe0a182332a8573f" title="Number of particle per chain.">NPCh</a>;};
<a name="l00250"></a><a class="code" href="classVarData.html#a049abed54dc9fd2fdc655edfdff8c5c4">00250</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">VarData::pNPCh</a>(<span class="keywordtype">int</span> b){<span class="keywordflow">return</span> <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a521663d12899e0fefe0a182332a8573f" title="# particles per chain">NPCh</a>;};
<a name="l00251"></a><a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88">00251</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a6496acd0cba8289e8306507336dd2f88" title="# of types of the particle">VarData::pNType</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a4ad7cd0445491c0ba28c41907eba46b1" title="# of types of the particle">NType</a>;};
<a name="l00252"></a><a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb">00252</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">VarData::pNLink</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a73918a2decc99bcf2317d2855dada6c8" title="Maximum number of bonds.">NLink</a>;};
<a name="l00253"></a><a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17">00253</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">VarData::pNNano</a>(){<span class="keywordflow">return</span> Gen-&gt;NNano;};
<a name="l00254"></a><a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d">00254</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d" title="Number of blocks.">VarData::pNBlock</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a6613c7ace95c4bff9b80a9bfd8f4a9f8" title="Number of blocks.">NBlock</a>;};
<a name="l00255"></a><a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c">00255</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a41757bbf6f3a1c9ba3b3795da44a3d6c" title="Allocated number of particles.">VarData::pNAllocP</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a4c6eee002f7cf6e171979efae96f56d9" title="Number of allocated particles.">NAllocP</a>;};
<a name="l00256"></a><a class="code" href="classVarData.html#a8ee69088ad7dd9ea55f50b1fc19ec4e2">00256</a> <span class="keywordtype">int</span> <a class="code" href="classVarData.html#a8ee69088ad7dd9ea55f50b1fc19ec4e2" title="Allocated number of chains.">VarData::pNAllocC</a>(){<span class="keywordflow">return</span> Gen-&gt;<a class="code" href="structGENERAL.html#a0d31c72beb19e7045ebd94aa02b454b5" title="Number of allocated chains.">NAllocC</a>;};
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:21 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
