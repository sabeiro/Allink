<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/ElPoly/ElPolyDraw.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_1bb97581e94de66daf7acda7f0e3ec00.html">ElPoly</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ElPolyDraw.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">ElPoly:This progam provide a graphical visualisation of the data </span>
<a name="l00003"></a>00003 <span class="comment">opend by VarData using openGL glut. The most important option are </span>
<a name="l00004"></a>00004 <span class="comment">the possibility of changing the backfold of the polymers with &#39;c&#39;, </span>
<a name="l00005"></a>00005 <span class="comment">see the subsequent file in the list with &#39;&gt;&#39;, see the bond with &#39;b&#39;. </span>
<a name="l00006"></a>00006 <span class="comment">Copyright (C) 2008 by Giovanni Marelli &lt;sabeiro@virgilio.it&gt;</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment">the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00012"></a>00012 <span class="comment">(at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment">GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment">along with this program; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00022"></a>00022 <span class="comment">***********************************************************************/</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;ElPoly.h&quot;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><a class="code" href="classDraw.html" title="Draw provides the basic configuration of the openGL libraries used in every derived program...">Draw</a> *Dr;
<a name="l00027"></a>00027 <span class="keywordtype">void</span> Figure(){
<a name="l00028"></a>00028   <span class="comment">//Dr-&gt;Draw1();</span>
<a name="l00029"></a>00029   Dr-&gt;<a class="code" href="classDraw.html#aa74f5eca0e42920b3ae0766299b85617" title="Definition of the scene on which the objects will be drawn.">DFigure</a>();
<a name="l00030"></a>00030 }
<a name="l00031"></a>00031 <span class="keywordtype">void</span> reshape(<span class="keywordtype">int</span> w,<span class="keywordtype">int</span> h){
<a name="l00032"></a>00032   Dr-&gt;<a class="code" href="classDraw.html#a0cd7542f249d2cef85422d5ae63de96a" title="Principal reshape function.">Dreshape</a>(w,h);
<a name="l00033"></a>00033 }
<a name="l00034"></a>00034 <span class="keywordtype">void</span> Timer(<span class="keywordtype">int</span> v){
<a name="l00035"></a>00035   Dr-&gt;<a class="code" href="classDraw.html#a3c4f3df21652856a8394a447d2afa61d" title="Not working.">DTimer</a>(v);
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 <span class="keywordtype">void</span> MouseMove(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00038"></a>00038   Dr-&gt;<a class="code" href="classDraw.html#a9794ec43c2f8cf4e106aad7e0c2e1b66" title="How the scene rotate (Camera view should be implemented)">DMouseMove</a>(x,y);
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 <span class="keywordtype">void</span> special(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y){
<a name="l00041"></a>00041   Dr-&gt;<a class="code" href="classDraw.html#ab63c111588287a2a7ccf27b480f49d06" title="Boh.">Dspecial</a>(k,x,y);
<a name="l00042"></a>00042 }
<a name="l00043"></a><a class="code" href="classElPoly.html#a7411c318f14258f65a45ba2572697aa2">00043</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a7411c318f14258f65a45ba2572697aa2" title="Boh.">ElPoly::Graphics</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv){
<a name="l00044"></a>00044   <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a> = 1./<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0);
<a name="l00045"></a>00045   Dr = <span class="keyword">new</span> <a class="code" href="classDraw.html" title="Draw provides the basic configuration of the openGL libraries used in every derived program...">Draw</a>();
<a name="l00046"></a>00046   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) Dr-&gt;<a class="code" href="classDraw.html#a8895c89605e91c6cf7430bad336f77c6" title="Box size.">Edge</a>[d] = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00047"></a>00047   Dr-&gt;<a class="code" href="classDraw.html#ae460da3c47449cbbd76b22e9c2501a69" title="Rescale the three orthogonal directions.">InvScaleUn</a> = <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00048"></a>00048   Dr-&gt;<a class="code" href="classDraw.html#a5b04d6b8d3fc2e33a6bf83d1fbbec2e9" title="Position of the info string.">xi</a> = -.4;Dr-&gt;yi = -.4;Dr-&gt;zi = .0;
<a name="l00049"></a>00049   Dr-&gt;<a class="code" href="classDraw.html#a455f01527a74815c61adaae99d0ed65c" title="Translation, wheel.">xp</a> = 0.;Dr-&gt;yp = 0.;Dr-&gt;zp = 0.;
<a name="l00050"></a>00050   Dr-&gt;<a class="code" href="classDraw.html#aee18a4afd2986ed1f3be1939903b9539" title="Angles.">xa</a> = 0.;Dr-&gt;ya = 0.;Dr-&gt;za = 0.;  
<a name="l00051"></a>00051   <a class="code" href="classElPoly.html#ae8d6419041af331f07d9992abef3a867" title="Boh.">Vicinanze</a> = 0.;
<a name="l00052"></a>00052   <a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a> = 1.;
<a name="l00053"></a>00053   <span class="comment">// IfColour = 0;</span>
<a name="l00054"></a>00054   <span class="comment">// IfChains = 0;</span>
<a name="l00055"></a>00055   Quad = 0;
<a name="l00056"></a>00056   Point = 0;
<a name="l00057"></a>00057   Cylinder = 0;
<a name="l00058"></a>00058   MetalCylinder = 0;
<a name="l00059"></a>00059   Hexagon = 0;
<a name="l00060"></a>00060   Cube = 0;
<a name="l00061"></a>00061   <a class="code" href="classElPoly.html#af2d26fec9f7faeae1c79eb64268776c0" title="Boh.">DrawOutput</a> = EL_OPENGL;
<a name="l00062"></a>00062   Cylinder = (GLuint *)calloc(<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>(),<span class="keyword">sizeof</span>(GLuint));
<a name="l00063"></a>00063   sprintf(<a class="code" href="classElPoly.html#a3ea47501772e8717e5d6fb04cc1999b2" title="Name of the block to draw.">Block2Draw</a>,<span class="stringliteral">&quot;ALL&quot;</span>);
<a name="l00064"></a>00064   Dr-&gt;<a class="code" href="classDraw.html#a6768324ebecaa6d87d6e65bf242b23f9" title="Initial definition of the window.">Window</a>(argc,argv);
<a name="l00065"></a>00065   <a class="code" href="classElPoly.html#a8b0db33648473b19696bb19c6282dc81" title="Creates the menu.">CreateMenu</a>();
<a name="l00066"></a>00066   <a class="code" href="classElPoly.html#a86e52eb42d4ead5eb6b800ab1fd3a4d2" title="Convert the internal definition for the menu of ElPoly in string.">ChooseDraw</a>(<a class="code" href="classVarData.html#a7c997cd3acaf56afc44e01680323eb0e" title="What to draw.">cWhat2Draw</a>);
<a name="l00067"></a>00067   <a class="code" href="classElPoly.html#a5c117667fbf63957d9f36808b5b4c942" title="Choose what to visualize.">ElMenuChoise</a>(<a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a>);
<a name="l00068"></a>00068   <a class="code" href="classElPoly.html#af63d4f8105b2cc36e7de437e9321f8f9" title="Choose what to visualize.">ElMenuVisual</a>(<a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a>);
<a name="l00069"></a>00069   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++){
<a name="l00070"></a>00070     Cylinder[n] = Dr-&gt;<a class="code" href="classDraw.html#af4ca54f4f60c7e6b3e44f81a82afa810" title="Cylinder.">DefCylinder</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Height);
<a name="l00071"></a>00071   }
<a name="l00072"></a>00072   <span class="comment">//Dr-&gt;Picture();exit(0);</span>
<a name="l00073"></a>00073   glutPostRedisplay();
<a name="l00074"></a>00074   glutMainLoop();
<a name="l00075"></a>00075 }
<a name="l00076"></a><a class="code" href="classElPoly.html#a28d17ecbad071d90ae8b571f068d865a">00076</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a28d17ecbad071d90ae8b571f068d865a" title="Draws in run time (expensive)">ElPoly::DrRunTime</a>(){  
<a name="l00077"></a>00077   <span class="comment">//DrSurface();</span>
<a name="l00078"></a>00078 }
<a name="l00079"></a><a class="code" href="classElPoly.html#a21b11a8a49dc2686cd23c41f24a3ec86">00079</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a21b11a8a49dc2686cd23c41f24a3ec86" title="Visualize only particles within a certain distance.">ElPoly::DrIntorno</a>(<span class="keywordtype">int</span> p,<span class="keywordtype">double</span> Blue){
<a name="l00080"></a>00080   <span class="keywordtype">double</span> Near = 0.;
<a name="l00081"></a>00081   <span class="keywordtype">double</span> PreChain = 0.;
<a name="l00082"></a>00082   <span class="keywordflow">if</span>(!<a class="code" href="classElPoly.html#aa08916cc778623ef039a8c2062b0e545" title="If it visualizes only the particles/chains within a certain distance.">IfIntorno</a>||<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p)==2)
<a name="l00083"></a>00083     Near = 0.;
<a name="l00084"></a>00084   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#aa08916cc778623ef039a8c2062b0e545" title="If it visualizes only the particles/chains within a certain distance.">IfIntorno</a> == 1){
<a name="l00085"></a>00085     Near = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[<a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[3]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00086"></a>00086     <span class="keywordflow">if</span>(PreChain != <a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)){
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089   <span class="keywordflow">if</span>(Near &gt; <a class="code" href="classElPoly.html#ae8d6419041af331f07d9992abef3a867" title="Boh.">Vicinanze</a>)
<a name="l00090"></a>00090     <span class="keywordflow">return</span> 1;
<a name="l00091"></a>00091   <span class="keywordflow">return</span> 0;
<a name="l00092"></a>00092 }
<a name="l00093"></a><a class="code" href="classElPoly.html#a008a495b2076738e496001e0ba8a8ea4">00093</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a008a495b2076738e496001e0ba8a8ea4" title="Draw the bonds.">ElPoly::DrBondOpenGl</a>(<span class="keywordtype">double</span> *Pos1,<span class="keywordtype">double</span> *Pos2,<span class="keywordtype">float</span> *Color){
<a name="l00094"></a>00094   glColor4fv(Color);
<a name="l00095"></a>00095   glPushMatrix();<span class="comment">//Line</span>
<a name="l00096"></a>00096   glBegin(GL_LINES);
<a name="l00097"></a>00097   glVertex3d(Pos1[0],Pos1[1],Pos1[2]);
<a name="l00098"></a>00098   glVertex3d(Pos2[0],Pos2[1],Pos2[2]);
<a name="l00099"></a>00099   glEnd();
<a name="l00100"></a>00100   glPopMatrix();<span class="comment">//Line</span>
<a name="l00101"></a>00101 }
<a name="l00102"></a><a class="code" href="classElPoly.html#abe58ec64ad127f7a85a62feefbfac4b6">00102</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#abe58ec64ad127f7a85a62feefbfac4b6" title="Finde the neighbour of the particle p and draw the bond.">ElPoly::DrBond</a>(<span class="keywordtype">int</span> p){
<a name="l00103"></a>00103   <span class="keywordflow">if</span>(!<a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">pNLink</a>())<span class="keywordflow">return</span>;
<a name="l00104"></a>00104   <span class="keywordtype">double</span> Pos1[3];
<a name="l00105"></a>00105   <span class="keywordtype">double</span> Pos2[3];
<a name="l00106"></a>00106   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>;l++){
<a name="l00107"></a>00107     <span class="keywordtype">int</span> link = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[l];
<a name="l00108"></a>00108     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00109"></a>00109       Pos1[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00110"></a>00110       Pos2[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link,d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00113"></a>00113       <span class="keywordflow">if</span>(Pos1[d] - Pos2[d] &gt; .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>){
<a name="l00114"></a>00114    Pos2[d] += <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00115"></a>00115       }
<a name="l00116"></a>00116       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Pos1[d] - Pos2[d] &lt; -.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*InvScaleUn){
<a name="l00117"></a>00117    Pos2[d] -= <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00118"></a>00118       }
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120     <a class="code" href="classElPoly.html#ab8aa99cf5632c9a9183e7881d25b1cf7" title="Pointer to a generic function.">DrawBond</a>(Pos1,Pos2,ColorType[<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p)]);
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122 }
<a name="l00123"></a><a class="code" href="classElPoly.html#a878c5cd187a779112e98485c1fd4fa7a">00123</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a878c5cd187a779112e98485c1fd4fa7a" title="Assign the pointer to the corrispondent draw function, intilize the visualization.">ElPoly::DrawFuncHeader</a>(){
<a name="l00124"></a>00124 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#af2d26fec9f7faeae1c79eb64268776c0" title="Boh.">DrawOutput</a> == EL_OPENGL){
<a name="l00126"></a>00126     glDisable(GL_LIGHTING);
<a name="l00127"></a>00127     <span class="comment">//glEnable(GL_LIGHTING);</span>
<a name="l00128"></a>00128     glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00129"></a>00129     Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00130"></a>00130     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>() &gt; 50000) <a class="code" href="classElPoly.html#ae1c44ad3d54bfd33bcd7be4a5d1e9a8c" title="How many lipids are skipped in the visualization.">NVisSkip</a> = 2;
<a name="l00131"></a>00131     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>() &gt; 100000) <a class="code" href="classElPoly.html#ae1c44ad3d54bfd33bcd7be4a5d1e9a8c" title="How many lipids are skipped in the visualization.">NVisSkip</a> = 4;
<a name="l00132"></a>00132     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++){
<a name="l00133"></a>00133       glDeleteLists(Cylinder[n],1);
<a name="l00134"></a>00134       Cylinder[n] = Dr-&gt;<a class="code" href="classDraw.html#af4ca54f4f60c7e6b3e44f81a82afa810" title="Cylinder.">DefCylinder</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Height);
<a name="l00135"></a>00135       <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_WALL)){
<a name="l00136"></a>00136    glDeleteLists(GlWall,1);
<a name="l00137"></a>00137    GlWall = Dr-&gt;<a class="code" href="classDraw.html#a9e8807139062d3d8e7a5ae14e98480da" title="Wall.">DefWall</a>();
<a name="l00138"></a>00138       }
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140     glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00141"></a>00141     glDisable(GL_LIGHTING);
<a name="l00142"></a>00142     <a class="code" href="classElPoly.html#a314a67afcac24f3f5d8b1e7cda4f9cf3" title="Pointer to a distance/field function.">Draw_Part</a> = &amp;<a class="code" href="classElPoly.html#a65249b90a9125f72098eee0fde2a2155" title="OpenGl draw function.">ElPoly::DrPartOpenGl</a>;
<a name="l00143"></a>00143     <a class="code" href="classElPoly.html#a59a87cfe4936eaafac9d4101a4cc4539" title="Pointer to a distance.">Draw_Nano</a> = &amp;<a class="code" href="classElPoly.html#a7bfac52311cca966565486c45b0b2097" title="OpenGl draw function.">ElPoly::DrNanoOpenGl</a>;
<a name="l00144"></a>00144     <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a>) <a class="code" href="classElPoly.html#a26c155813b6b8c503374eac31af31a34" title="Pointer to a distance/field function.">Draw_Bond</a> = &amp;<a class="code" href="classElPoly.html#a008a495b2076738e496001e0ba8a8ea4" title="Draw the bonds.">ElPoly::DrBondOpenGl</a>;
<a name="l00145"></a>00145     <span class="keywordflow">else</span> <a class="code" href="classElPoly.html#a26c155813b6b8c503374eac31af31a34" title="Pointer to a distance/field function.">Draw_Bond</a> = &amp;<a class="code" href="classElPoly.html#a6a54cbe2df971f838e96bef0ffb100d4" title="Null function.">ElPoly::DrBondNo</a>;
<a name="l00146"></a>00146   }
<a name="l00147"></a>00147   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#af2d26fec9f7faeae1c79eb64268776c0" title="Boh.">DrawOutput</a> == EL_POVRAY){
<a name="l00148"></a>00148 <span class="preprocessor">#endif // __glut_h_</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>    <a class="code" href="classElPoly.html#a314a67afcac24f3f5d8b1e7cda4f9cf3" title="Pointer to a distance/field function.">Draw_Part</a> = &amp;<a class="code" href="classElPoly.html#aedbaa04884ac62d32f3cce78fdfd92b8" title="PovRay draw function.">ElPoly::DrPartPovRay</a>;
<a name="l00150"></a>00150     <a class="code" href="classElPoly.html#a59a87cfe4936eaafac9d4101a4cc4539" title="Pointer to a distance.">Draw_Nano</a> = &amp;<a class="code" href="classElPoly.html#a760f4fa1edbecc53d532140617dbf8ab" title="PovRay draw function.">ElPoly::DrNanoPovRay</a>;
<a name="l00151"></a>00151     <a class="code" href="classElPoly.html#a26c155813b6b8c503374eac31af31a34" title="Pointer to a distance/field function.">Draw_Bond</a> = &amp;<a class="code" href="classElPoly.html#a1d6d8bfcdb851627bb183cb803353270" title="Draw the bonds.">ElPoly::DrBondPovRay</a>;
<a name="l00152"></a>00152     <a class="code" href="classElPoly.html#a79715be09324f2b58cc98385a5f62e7b" title="Print the header for povray.">HeaderPovRay</a>();
<a name="l00153"></a>00153     SigErr(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a> != NULL,<span class="stringliteral">&quot;DrawOutFile already allocated, can&#39;t use the file&quot;</span>);
<a name="l00154"></a>00154     <span class="keywordtype">char</span> FName[60];
<a name="l00155"></a>00155     sprintf(FName,<span class="stringliteral">&quot;PovSnap%05d.pov&quot;</span>,<a class="code" href="classVarData.html#acf2e386d659b56caeceb504cd74e90e0" title="Number of steps.">pStep</a>());
<a name="l00156"></a>00156     <a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a> = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00157"></a>00157     <span class="keywordtype">int</span> ImSize[2] = {1000,1000};
<a name="l00158"></a>00158     fprintf(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>,<span class="stringliteral">&quot;// POV 3.x input script : plot.pov\n// command: povray +W%d +H%d -I%s -O%s.tga +P +X +A +FT +C\n&quot;</span>,ImSize[0],ImSize[1],FName,FName);
<a name="l00159"></a>00159     fprintf(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>,<span class="stringliteral">&quot;#if (version &lt; 3.5)\n#error \&quot;POV3DisplayDevice has been compiled for POV-Ray 3.5 or above.\\nPlease upgrade POV-Ray.\&quot;\n#end\n&quot;</span>);
<a name="l00160"></a>00160     fprintf(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>,<span class="stringliteral">&quot;#include \&quot;PovHeader.inc\&quot;\n&quot;</span>);
<a name="l00161"></a>00161     fprintf(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>,<span class="stringliteral">&quot;// System \n&quot;</span>);
<a name="l00162"></a>00162 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>  }
<a name="l00164"></a>00164 <span class="preprocessor">#endif // __glut_h_</span>
<a name="l00165"></a>00165 <span class="preprocessor"></span>}
<a name="l00166"></a><a class="code" href="classElPoly.html#ae201022731c9c081b2c8575bb4d80929">00166</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ae201022731c9c081b2c8575bb4d80929" title="Dnd the visualization.">ElPoly::DrawFuncFooter</a>(){
<a name="l00167"></a>00167 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#af2d26fec9f7faeae1c79eb64268776c0" title="Boh.">DrawOutput</a> == EL_OPENGL){
<a name="l00169"></a>00169     glEndList();
<a name="l00170"></a>00170   }
<a name="l00171"></a>00171   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#af2d26fec9f7faeae1c79eb64268776c0" title="Boh.">DrawOutput</a> == EL_POVRAY){
<a name="l00172"></a>00172 <span class="preprocessor">#endif // __glut_h_</span>
<a name="l00173"></a>00173 <span class="preprocessor"></span>    fprintf(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>,<span class="stringliteral">&quot;// End of POV-Ray 3.x generation\n&quot;</span>);
<a name="l00174"></a>00174     fclose(<a class="code" href="classElPoly.html#a034d945a96ab42d2a57ac4e12c8aab9e" title="Output file for drawing.">DrawOutFile</a>);
<a name="l00175"></a>00175 <span class="preprocessor">#ifdef __glut_h__</span>
<a name="l00176"></a>00176 <span class="preprocessor"></span>  }
<a name="l00177"></a>00177 <span class="preprocessor">#endif // __glut_h_</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span>}
<a name="l00179"></a><a class="code" href="classElPoly.html#a65249b90a9125f72098eee0fde2a2155">00179</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a65249b90a9125f72098eee0fde2a2155" title="OpenGl draw function.">ElPoly::DrPartOpenGl</a>(<span class="keywordtype">int</span> p){
<a name="l00180"></a>00180   <span class="keywordtype">int</span> Typ = <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) &lt; 6 ? <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) : 5;
<a name="l00181"></a>00181   <span class="comment">//ColorType[Typ][0] = pVel(p,3);</span>
<a name="l00182"></a>00182   glColor4fv(ColorType[Typ]);
<a name="l00183"></a>00183   glPushMatrix();<span class="comment">//Particle</span>
<a name="l00184"></a>00184   glBegin(GL_POINTS);
<a name="l00185"></a>00185   glVertex3f(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00186"></a>00186   glEnd();
<a name="l00187"></a>00187   glPopMatrix();<span class="comment">//Particle</span>
<a name="l00188"></a>00188 }
<a name="l00189"></a><a class="code" href="classElPoly.html#aa295400ea854251339f20cdb30dd9ac0">00189</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ad36be1f2ea9bef2742992bfb62023fb8" title="Visualize the cross links.">ElPoly::DrCrossLinks</a>(<span class="keywordtype">char</span> *FileName){
<a name="l00190"></a>00190   FILE *FRead = fopen(FileName,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00191"></a>00191   <span class="keywordflow">if</span>(FRead == NULL) <span class="keywordflow">return</span>;
<a name="l00192"></a>00192   <span class="keywordtype">char</span> cLine[STRSIZE];
<a name="l00193"></a>00193   <span class="keywordtype">int</span> c1=0;
<a name="l00194"></a>00194   <span class="keywordtype">int</span> c2=0;
<a name="l00195"></a>00195   glDisable(GL_LIGHTING);
<a name="l00196"></a>00196   glColor4f(.5,0.0,.4,1.0);
<a name="l00197"></a>00197   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;!(fgets(cLine,STRSIZE,FRead)==NULL);k++){
<a name="l00198"></a>00198     fscanf(FRead,<span class="stringliteral">&quot;%d %d\n&quot;</span>,&amp;c1,&amp;c2);
<a name="l00199"></a>00199     glPushMatrix();<span class="comment">//Line</span>
<a name="l00200"></a>00200     glBegin(GL_LINES);
<a name="l00201"></a>00201     glVertex3d(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c1,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l00202"></a>00202           <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c1,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,
<a name="l00203"></a>00203           <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c1,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00204"></a>00204     <span class="keywordtype">double</span> Pos[3] = {<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c2,0),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c2,1),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c2,2)};
<a name="l00205"></a>00205     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00206"></a>00206       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c1,d) - Pos[d] &gt; .5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d))
<a name="l00207"></a>00207    Pos[d] += <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00208"></a>00208       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(c1,d) - Pos[d] &lt; -.5*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d))
<a name="l00209"></a>00209    Pos[d] -= <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211     glVertex3d(((Pos[0])*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00212"></a>00212           ((Pos[1])*InvScaleUn),
<a name="l00213"></a>00213           ((Pos[2])*InvScaleUn*ScaleFact));
<a name="l00214"></a>00214     glEnd();
<a name="l00215"></a>00215     glPopMatrix();<span class="comment">//Line</span>
<a name="l00216"></a>00216   }
<a name="l00217"></a>00217 }
<a name="l00218"></a><a class="code" href="classElPoly.html#ae89cedb0e996d10ec5f96e14f1f867cf">00218</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ae89cedb0e996d10ec5f96e14f1f867cf" title="Create a list of all the particles.">ElPoly::DrPartList</a>(){
<a name="l00219"></a>00219   <span class="keywordtype">double</span> Pos1[3];
<a name="l00220"></a>00220   <span class="keywordtype">double</span> Pos2[3];
<a name="l00221"></a>00221   <a class="code" href="classElPoly.html#a878c5cd187a779112e98485c1fd4fa7a" title="Assign the pointer to the corrispondent draw function, intilize the visualization.">DrawFuncHeader</a>();
<a name="l00222"></a>00222   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarData.html#aef94681f570cacf1a76aac1512563f17" title="Number of nanoparticles.">pNNano</a>();n++) <a class="code" href="classElPoly.html#a15254dc837a01412ec79ec26e9019095" title="Pointer to a generic function.">DrawNano</a>(n);
<a name="l00223"></a>00223   glDisable(GL_LIGHTING);
<a name="l00224"></a>00224   <a class="code" href="classElPoly.html#ad36be1f2ea9bef2742992bfb62023fb8" title="Visualize the cross links.">DrCrossLinks</a>(<span class="stringliteral">&quot;CrossLinks.dat&quot;</span>);
<a name="l00225"></a>00225   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0,NPep=0,cOff=0,pOff=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d" title="Number of blocks.">pNBlock</a>();cOff+=<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>(b++)){
<a name="l00226"></a>00226     <span class="keywordflow">if</span>(strcmp(<a class="code" href="classElPoly.html#a3ea47501772e8717e5d6fb04cc1999b2" title="Name of the block to draw.">Block2Draw</a>,<span class="stringliteral">&quot;ALL&quot;</span>)){
<a name="l00227"></a>00227       <span class="keywordflow">if</span>(strcmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name,<a class="code" href="classElPoly.html#a3ea47501772e8717e5d6fb04cc1999b2" title="Name of the block to draw.">Block2Draw</a>) ){
<a name="l00228"></a>00228    pOff += <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>(b)*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>(b);
<a name="l00229"></a>00229    <span class="keywordflow">continue</span>;
<a name="l00230"></a>00230       }
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232     <span class="keywordflow">if</span>(!strncmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name,<span class="stringliteral">&quot;PEP&quot;</span>,3)){
<a name="l00233"></a>00233       <a class="code" href="classElPoly.html#aebd566fd1ad758de2396c7fbae4b9513" title="Load and draw the linking of a protein.">DrProtein</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[NPep].ArchFile,b);
<a name="l00234"></a>00234       NPep++;
<a name="l00235"></a>00235       <span class="keywordflow">continue</span>;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].InitIdx;p&lt;<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a3fa6306dcea956ea84ce7b5f2b22f628" title="End particle position.">EndIdx</a>;p++){
<a name="l00238"></a>00238       <span class="keywordtype">int</span> Chc = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[<a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a>;
<a name="l00239"></a>00239       <span class="keywordflow">if</span>(!CHAIN_IF_TYPE(Chc,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>)) <span class="keywordflow">continue</span>;
<a name="l00240"></a>00240       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a> != BEAD_EVERY  &amp;&amp; <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) != <a class="code" href="classVarData.html#a4a5c47b800a1299ec5e54e369467dfeb" title="Type of particle selected.">NPType</a>) <span class="keywordflow">continue</span>;
<a name="l00241"></a>00241       <span class="comment">// if(Pm[p].CId != 3) continue;</span>
<a name="l00242"></a>00242       <span class="comment">// Dr-&gt;Numera(Pm[p].Pos,p);</span>
<a name="l00243"></a>00243       <a class="code" href="classElPoly.html#aefa30992af110f1b0e1b60ee028b9f38" title="Pointer to a generic function.">DrawPart</a>(p);
<a name="l00244"></a>00244       <a class="code" href="classElPoly.html#abe58ec64ad127f7a85a62feefbfac4b6" title="Finde the neighbour of the particle p and draw the bond.">DrBond</a>(p);
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246     <span class="comment">// for(int c=cOff;c&lt;cOff+pNChain(b);c+=NVisSkip,pOff+=pNPCh(b)*NVisSkip){</span>
<a name="l00247"></a>00247     <span class="comment">//   for(int p=pOff,link=0;p&lt;MIN(pOff+pNPCh(b),pNPart());p++){</span>
<a name="l00248"></a>00248     <span class="comment">//   int Chc = Ch[pChain(p)].Type;</span>
<a name="l00249"></a>00249     <span class="comment">//   if(!CHAIN_IF_TYPE(Chc,NChType)) continue;</span>
<a name="l00250"></a>00250     <span class="comment">//   DrawPart(p);</span>
<a name="l00251"></a>00251     <span class="comment">//   DrBond(p);</span>
<a name="l00252"></a>00252     <span class="comment">//   }</span>
<a name="l00253"></a>00253     <span class="comment">// }</span>
<a name="l00254"></a>00254   }
<a name="l00255"></a>00255   <a class="code" href="classElPoly.html#ae201022731c9c081b2c8575bb4d80929" title="Dnd the visualization.">DrawFuncFooter</a>();
<a name="l00256"></a>00256 }
<a name="l00257"></a><a class="code" href="classElPoly.html#a7bfac52311cca966565486c45b0b2097">00257</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a7bfac52311cca966565486c45b0b2097" title="OpenGl draw function.">ElPoly::DrNanoOpenGl</a>(<span class="keywordtype">int</span> n){
<a name="l00258"></a>00258   <span class="keywordflow">if</span>(Dr-&gt;<a class="code" href="classDraw.html#a2e742183addcbbee8c3d478448355b43" title="Activate the illumination for a specific material.">IfMaterial</a>){
<a name="l00259"></a>00259     glEnable(GL_LIGHTING);
<a name="l00260"></a>00260     glEnable( GL_LIGHT0 );
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262   <span class="keywordflow">else</span> 
<a name="l00263"></a>00263     glDisable(GL_LIGHTING);
<a name="l00264"></a>00264   <a class="code" href="classVarData.html#acd4e4b1e648b7d1ca3a169bb176e9f5c" title="Point to the shape function.">Point2Shape</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape);
<a name="l00265"></a>00265   <span class="keywordtype">double</span> Red = fabs(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Hamaker)/3.;
<a name="l00266"></a>00266   <span class="keywordtype">double</span> Alpha = 1.;<span class="comment">//Nano[n].Hamaker/10.;</span>
<a name="l00267"></a>00267   GLfloat Color[4] = {Red,.1,.1,Alpha};
<a name="l00268"></a>00268   glMaterialfv(GL_FRONT_AND_BACK,GL_AMBIENT,Color); 
<a name="l00269"></a>00269   glMaterialfv(GL_FRONT_AND_BACK,GL_DIFFUSE,Color); 
<a name="l00270"></a>00270   glColor4fv(Color);
<a name="l00271"></a>00271   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_NONE)) <span class="keywordflow">return</span>;
<a name="l00272"></a>00272   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_CLUSTER)){
<a name="l00273"></a>00273     Alpha = .2;
<a name="l00274"></a>00274     <a class="code" href="classElPoly.html#aebd566fd1ad758de2396c7fbae4b9513" title="Load and draw the linking of a protein.">DrProtein</a>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].ArchFile,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].nBlock);
<a name="l00275"></a>00275     <span class="keywordflow">return</span>;
<a name="l00276"></a>00276   }
<a name="l00277"></a>00277   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_JANUS)){
<a name="l00278"></a>00278     <span class="comment">// Point2Shape(Nano[n].Shape);</span>
<a name="l00279"></a>00279     <span class="comment">// DrField(64,Nano[n].Rad,n);</span>
<a name="l00280"></a>00280     <span class="comment">// continue;</span>
<a name="l00281"></a>00281   }
<a name="l00282"></a>00282   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_PORE)){
<a name="l00283"></a>00283     <a class="code" href="classVarData.html#a90139ee28a0c75803648d2b1d85e80ce" title="Find the position of the pore.">PorePos</a>();
<a name="l00284"></a>00284   }
<a name="l00285"></a>00285   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_CYL)){
<a name="l00286"></a>00286     <span class="comment">// Point2Shape(Nano[n].Shape);</span>
<a name="l00287"></a>00287     <span class="comment">// DrField(64,SQR(Nano[n].Rad),n);</span>
<a name="l00288"></a>00288     <span class="comment">// continue;</span>
<a name="l00289"></a>00289   }
<a name="l00290"></a>00290   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_TIP)){
<a name="l00291"></a>00291     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(32,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00292"></a>00292     <span class="keywordflow">return</span>;
<a name="l00293"></a>00293   }
<a name="l00294"></a>00294   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_BOUND)){
<a name="l00295"></a>00295     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(32,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00296"></a>00296     <span class="keywordflow">return</span>;
<a name="l00297"></a>00297   }
<a name="l00298"></a>00298   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_TORUS)){
<a name="l00299"></a>00299     <span class="keywordtype">double</span> OldPos[5] = {<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a863738e46f14b3bfc674ad87d35f143d" title="Position.">Pos</a>[2],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487" title="Size.">Rad</a>,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a18ece2127f70c26ead73bc24856a5c57" title="Height of the cylinder.">Height</a>};
<a name="l00300"></a>00300     <span class="comment">//StalkPos(OldPos);</span>
<a name="l00301"></a>00301     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(64,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00302"></a>00302     <span class="keywordflow">return</span>;
<a name="l00303"></a>00303   }
<a name="l00304"></a>00304   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_STALK)){
<a name="l00305"></a>00305     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(64,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00306"></a>00306     <span class="keywordflow">return</span>;
<a name="l00307"></a>00307   }
<a name="l00308"></a>00308   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_HARM)){
<a name="l00309"></a>00309     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(64,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00310"></a>00310     <span class="keywordflow">return</span>;
<a name="l00311"></a>00311   }
<a name="l00312"></a>00312   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_WALL)){
<a name="l00313"></a>00313     <a class="code" href="classElPoly.html#aee301bfab80a5bff74d1929e63cdbf0f" title="Draw a scalar field.">DrField</a>(16,SQR(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad),n);
<a name="l00314"></a>00314     <span class="keywordflow">return</span>;
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_UMBR)){
<a name="l00317"></a>00317     glPushMatrix();<span class="comment">//Nano</span>
<a name="l00318"></a>00318     glBegin(GL_QUADS);
<a name="l00319"></a>00319     glNormal3f(0.,0.,-1.);
<a name="l00320"></a>00320     glVertex3f(0.,0.,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00321"></a>00321     glVertex3f(0.,<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)*InvScaleUn,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]*InvScaleUn);
<a name="l00322"></a>00322     glVertex3f(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*InvScaleUn,<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)*InvScaleUn,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]*InvScaleUn);
<a name="l00323"></a>00323     glVertex3f(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*InvScaleUn,0.,<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Pos[<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>]*InvScaleUn);
<a name="l00324"></a>00324     glEnd();<span class="comment">//GL_QUADS</span>
<a name="l00325"></a>00325     glPopMatrix();<span class="comment">//Nano</span>
<a name="l00326"></a>00326     <span class="keywordflow">return</span>;
<a name="l00327"></a>00327   }
<a name="l00328"></a>00328   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Ax(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[0],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[1],<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Axis[2]);
<a name="l00329"></a>00329   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Zed(0.,0.,1.);
<a name="l00330"></a>00330   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Axis(3);
<a name="l00331"></a>00331   Ax.<a class="code" href="classVettore.html#aef629c102c4d237ef6e4897238f5bc18" title="Normlizes a Vettore.">Normalize</a>();
<a name="l00332"></a>00332   Axis.<a class="code" href="classVettore.html#a9b3422c7c865368c649cb008c6185250" title="Vectorial product between two Vettore returns the area.">VetV</a>(&amp;Zed,&amp;Ax);
<a name="l00333"></a>00333   <span class="keywordtype">double</span> <a class="code" href="classElPoly.html#ae3aab8086f988eecdd12b8f29f45a56a" title="Calculation of the contact angle  angle Boh?">Angle</a> = Zed.<a class="code" href="classVettore.html#a936e4b859237ce1643e932504dde2f22" title="Computes the angle between two Vetttore.">Angle</a>(&amp;Ax,&amp;Zed);
<a name="l00334"></a>00334   <span class="comment">//Quadri q(Axis.x,Angle);</span>
<a name="l00335"></a>00335   <span class="comment">//double data[16];</span>
<a name="l00336"></a>00336   <span class="comment">//q.RotMatrix(data,4);</span>
<a name="l00337"></a>00337   <span class="comment">//Matrice M(q,4);</span>
<a name="l00338"></a>00338   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> M(Axis.<a class="code" href="classVettore.html#a711aad4cbe735871dd9e91ab575c878b" title="Where the data are stored.">x</a>,Angle,4);
<a name="l00339"></a>00339   glPushMatrix();<span class="comment">//Nano</span>
<a name="l00340"></a>00340   glTranslated((<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00341"></a>00341           (<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00342"></a>00342           (<a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>));
<a name="l00343"></a>00343   glMultMatrixd(M.<a class="code" href="classMatrice.html#a23436a7a2b44939627b59df11be7ad75" title="Stored entries.">data</a>);
<a name="l00344"></a>00344   <span class="comment">//glRotatef(Angle*DEG_RAD,Axis.x[0],Axis.x[1],Axis.x[2]);</span>
<a name="l00345"></a>00345   <span class="comment">//glCallList(Cylinder[n]);</span>
<a name="l00346"></a>00346   <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_SPH)){
<a name="l00347"></a>00347     glutSolidSphere(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Rad*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,20,20);
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_EXT)){
<a name="l00350"></a>00350     glColor4f(Red,.1,.1,.5);
<a name="l00351"></a>00351     glCallList(Cylinder[n]);
<a name="l00352"></a>00352   }
<a name="l00353"></a>00353   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_PORE)){
<a name="l00354"></a>00354     glColor4f(Red,.1,.1,.5);
<a name="l00355"></a>00355     glCallList(Cylinder[n]);
<a name="l00356"></a>00356   }
<a name="l00357"></a>00357   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_JANUS)){
<a name="l00358"></a>00358     glCallList(Cylinder[n]);
<a name="l00359"></a>00359   }
<a name="l00360"></a>00360   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_CYL)){
<a name="l00361"></a>00361     glCallList(Cylinder[n]);
<a name="l00362"></a>00362   }
<a name="l00363"></a>00363   <span class="keywordflow">else</span>{
<a name="l00364"></a>00364     glCallList(Cylinder[n]);
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366   glPopMatrix();<span class="comment">//Nano</span>
<a name="l00367"></a>00367   <span class="keywordflow">return</span>;
<a name="l00368"></a>00368   Red = fabs(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Hamaker)/3.;
<a name="l00369"></a>00369   <span class="keywordflow">if</span>(!VAR_IF_TYPE(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>[n].Shape,SHAPE_WALL))<span class="keywordflow">return</span>;
<a name="l00370"></a>00370   glDisable(GL_LIGHTING);
<a name="l00371"></a>00371   <span class="comment">// double x = (pNanoPos(n,0) - .5*pEdge(0))*InvScaleUn;</span>
<a name="l00372"></a>00372   <span class="comment">// double y = (pNanoPos(n,1) - .5*pEdge(1))*InvScaleUn;</span>
<a name="l00373"></a>00373   <span class="comment">// double z = (pNanoPos(n,2))*InvScaleUn*ScaleFact;</span>
<a name="l00374"></a>00374   <span class="keywordtype">double</span> x = <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00375"></a>00375   <span class="keywordtype">double</span> y = <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00376"></a>00376   <span class="keywordtype">double</span> z = <a class="code" href="classVarData.html#a0f556f4717568ddf4b1a4b2111b8d8f3" title="Return back folded nano position.">pNanoPos</a>(n,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>;
<a name="l00377"></a>00377   <span class="comment">//Quadri q(Axis.x,Angle);</span>
<a name="l00378"></a>00378   <span class="comment">//double data[16];</span>
<a name="l00379"></a>00379   <span class="comment">//q.RotMatrix(data,4);</span>
<a name="l00380"></a>00380   <span class="comment">//Matrice M(q,4);</span>
<a name="l00381"></a>00381   glPushMatrix();<span class="comment">//Nano</span>
<a name="l00382"></a>00382   glTranslated(x,y,z);
<a name="l00383"></a>00383   glMultMatrixd(M.<a class="code" href="classMatrice.html#a23436a7a2b44939627b59df11be7ad75" title="Stored entries.">data</a>);
<a name="l00384"></a>00384   glCallList(GlWall);
<a name="l00385"></a>00385   glPopMatrix();<span class="comment">//Nano</span>
<a name="l00386"></a>00386   <span class="comment">// glPushMatrix();//Nano</span>
<a name="l00387"></a>00387   <span class="comment">// glTranslated(x,y,z);</span>
<a name="l00388"></a>00388   <span class="comment">// //glCallList(GlWall);</span>
<a name="l00389"></a>00389   <span class="comment">// glPopMatrix();//Nano</span>
<a name="l00390"></a>00390 }
<a name="l00391"></a><a class="code" href="classElPoly.html#aebd566fd1ad758de2396c7fbae4b9513">00391</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aebd566fd1ad758de2396c7fbae4b9513" title="Load and draw the linking of a protein.">ElPoly::DrProtein</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ArchFile,<span class="keywordtype">int</span> b){
<a name="l00392"></a>00392   glDisable(GL_LIGHTING);
<a name="l00393"></a>00393   FILE *Arch = fopen(ArchFile,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00394"></a>00394   <span class="keywordflow">if</span>(Arch == NULL) {printf(<span class="stringliteral">&quot;File %s not present \n&quot;</span>,ArchFile);<span class="keywordflow">return</span>;}
<a name="l00395"></a>00395   <span class="keywordtype">char</span> cLine[STRSIZE];
<a name="l00396"></a>00396   <span class="keywordtype">double</span> Pos1[3];
<a name="l00397"></a>00397   <span class="keywordtype">double</span> Pos2[3];
<a name="l00398"></a>00398   <span class="keywordtype">double</span> Mid[3];
<a name="l00399"></a>00399   <span class="keywordtype">int</span> l1 = 0;
<a name="l00400"></a>00400   <span class="keywordtype">int</span> l2 = 0;
<a name="l00401"></a>00401   <span class="keywordtype">double</span> Elong = 0.;
<a name="l00402"></a>00402   <span class="keywordtype">double</span> Alpha = 1.;
<a name="l00403"></a>00403   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].InitIdx;fgets(cLine,STRSIZE,Arch);p++){
<a name="l00404"></a>00404     <a class="code" href="classElPoly.html#aefa30992af110f1b0e1b60ee028b9f38" title="Pointer to a generic function.">DrawPart</a>(p);
<a name="l00405"></a>00405     sscanf(cLine,<span class="stringliteral">&quot;%d %d %lf %lf\n&quot;</span>,&amp;l1,&amp;l2,&amp;Elong,&amp;Alpha);
<a name="l00406"></a>00406     l1 += <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a71d10413e52e4e5aa82ac5e6189afdd0" title="Initial particle position.">InitIdx</a>;
<a name="l00407"></a>00407     l2 += <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a71d10413e52e4e5aa82ac5e6189afdd0" title="Initial particle position.">InitIdx</a>;
<a name="l00408"></a>00408     <span class="keywordflow">if</span>(l1 == l2) <span class="keywordflow">continue</span>;
<a name="l00409"></a>00409     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00410"></a>00410       Pos1[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00411"></a>00411       Pos2[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00412"></a>00412       Pos2[d] += floor((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l1,d) - <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(l2,d))*<a class="code" href="classVarData.html#a33833c025a5c9bf7ad5abab2cf9b1dac" title="Inverted xyzr edges of the simulation box.">pInvEdge</a>(d)+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00413"></a>00413       Mid[d] = .5*(Pos1[d]+Pos2[d]);
<a name="l00414"></a>00414     }
<a name="l00415"></a>00415     <a class="code" href="classElPoly.html#ab8aa99cf5632c9a9183e7881d25b1cf7" title="Pointer to a generic function.">DrawBond</a>(Pos1,Mid,ColorType[<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(l1)]);
<a name="l00416"></a>00416     <a class="code" href="classElPoly.html#ab8aa99cf5632c9a9183e7881d25b1cf7" title="Pointer to a generic function.">DrawBond</a>(Mid,Pos2,ColorType[<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(l2)]);
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418   fclose(Arch);
<a name="l00419"></a>00419 }
<a name="l00420"></a><a class="code" href="classElPoly.html#aef35a22a4138fad89d7329d9fd49d97e">00420</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aef35a22a4138fad89d7329d9fd49d97e" title="Visualisation of the particle system with velocity color scheme.">ElPoly::DrColor</a>(){
<a name="l00421"></a>00421   glDisable(GL_LIGHTING);
<a name="l00422"></a>00422   GLuint Cube = Dr-&gt;<a class="code" href="classDraw.html#a0ab1b8899eb5e75e63634120f152d532" title="Cube.">DefCube</a>(<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>);
<a name="l00423"></a>00423   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00424"></a>00424   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00425"></a>00425   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00426"></a>00426   <span class="keywordflow">if</span>(1==0){
<a name="l00427"></a>00427     glPushMatrix();<span class="comment">//RefPoint</span>
<a name="l00428"></a>00428     <span class="keywordtype">double</span> RefPos[3] = {(<a class="code" href="classVarData.html#aa2dd0176f89991418fa38a24db3f3381" title="Reference position.">ShiftPos</a>[0]+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0),(<a class="code" href="classVarData.html#aa2dd0176f89991418fa38a24db3f3381" title="Reference position.">ShiftPos</a>[1]+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1),(<a class="code" href="classVarData.html#aa2dd0176f89991418fa38a24db3f3381" title="Reference position.">ShiftPos</a>[2]+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)};
<a name="l00429"></a>00429     glTranslated((RefPos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00430"></a>00430        (RefPos[1]*InvScaleUn),
<a name="l00431"></a>00431        (RefPos[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>));
<a name="l00432"></a>00432     glColor4f( .7,.1,.1,1.);
<a name="l00433"></a>00433     glutSolidSphere(0.1,20,20);
<a name="l00434"></a>00434     glPopMatrix();<span class="comment">//RefPos</span>
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436   <span class="keywordtype">int</span> NDrawn = 0;
<a name="l00437"></a>00437   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0,link=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00438"></a>00438     <span class="keywordtype">double</span> Red = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(0)*<a class="code" href="classElPoly.html#a8f3e2abcdf9991d97b9fb04b77c1f308" title="Saturation of the color (increase intensity)">Saturation</a>;
<a name="l00439"></a>00439     <span class="keywordflow">if</span>(Red &lt; 0.) Red = -Red;
<a name="l00440"></a>00440     <span class="keywordtype">double</span> Green = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(1);
<a name="l00441"></a>00441     <span class="keywordtype">double</span> Blue = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(2);
<a name="l00442"></a>00442     <span class="comment">//if(Red &lt; .3) continue;</span>
<a name="l00443"></a>00443     <span class="keywordtype">double</span> Alpha = 1.;<span class="comment">//Pm[p].Vel[3]/pVel(3);</span>
<a name="l00444"></a>00444     <span class="keywordtype">double</span> Add = 1./(double)<a class="code" href="classVarData.html#ae2e67b49132b33a026b19c647cbf4f3c" title="Number of particles per edge.">NEdge</a>/3.;
<a name="l00445"></a>00445     <span class="keywordflow">if</span>(1==0){
<a name="l00446"></a>00446       <span class="keywordflow">if</span>(Green &gt; .1){
<a name="l00447"></a>00447    glColor4f(0.,Green,0.,Alpha);
<a name="l00448"></a>00448    glPushMatrix();<span class="comment">//Cube</span>
<a name="l00449"></a>00449    glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00450"></a>00450    glCallList(Cube);
<a name="l00451"></a>00451    glPopMatrix();<span class="comment">//Cube</span>
<a name="l00452"></a>00452       }
<a name="l00453"></a>00453       <span class="keywordflow">if</span>(Blue &gt; .1){
<a name="l00454"></a>00454    glColor4f(0.,0.,Blue,Alpha);
<a name="l00455"></a>00455    glPushMatrix();<span class="comment">//Cube</span>
<a name="l00456"></a>00456    glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>+Add)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00457"></a>00457    glCallList(Cube);
<a name="l00458"></a>00458    glPopMatrix();<span class="comment">//Cube</span>
<a name="l00459"></a>00459       }
<a name="l00460"></a>00460       <span class="keywordflow">if</span>(Red &gt; .1){
<a name="l00461"></a>00461    glColor4f(Red,0.,0.,Alpha);
<a name="l00462"></a>00462    glPushMatrix();<span class="comment">//Cube</span>
<a name="l00463"></a>00463    glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>+Add*2.)*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00464"></a>00464    glCallList(Cube);
<a name="l00465"></a>00465    glPopMatrix();<span class="comment">//Cube</span>
<a name="l00466"></a>00466       }
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468     <span class="keywordflow">else</span>{
<a name="l00469"></a>00469       <span class="keywordflow">if</span>(Green  + Blue + Red&gt; .01)
<a name="l00470"></a>00470    {
<a name="l00471"></a>00471    glColor4f(Red,Green,Blue,Alpha);
<a name="l00472"></a>00472    glPushMatrix();<span class="comment">//Cube</span>
<a name="l00473"></a>00473    glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00474"></a>00474    glCallList(Cube);
<a name="l00475"></a>00475    glPopMatrix();<span class="comment">//Cube</span>
<a name="l00476"></a>00476       }
<a name="l00477"></a>00477     }
<a name="l00478"></a>00478   }
<a name="l00479"></a>00479   glEndList();
<a name="l00480"></a>00480 }
<a name="l00481"></a><a class="code" href="classElPoly.html#a9968be2f08ada4e898c92c7e8552ac63">00481</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a9968be2f08ada4e898c92c7e8552ac63" title="Draw the chains as vectors.">ElPoly::DrVectors</a>(){
<a name="l00482"></a>00482   glDisable(GL_LIGHTING);
<a name="l00483"></a>00483   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00484"></a>00484   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00485"></a>00485   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00486"></a>00486   <a class="code" href="classVarData.html#a42c97b08cf848bfaa9d68951070243d2" title="Backfold the system wrt the reference position.">ShiftRef</a>(BF_CHAIN);
<a name="l00487"></a>00487   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Freccia(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,0.,0.);
<a name="l00488"></a>00488   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Axis(3);
<a name="l00489"></a>00489   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> ChDir(3);
<a name="l00490"></a>00490   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> ChPos(3);
<a name="l00491"></a>00491   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Ax0(1,0,0);
<a name="l00492"></a>00492   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Ax1(0,1,0);
<a name="l00493"></a>00493   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Ax2(0,0,1);
<a name="l00494"></a>00494   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0,c1=0,NPep=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d" title="Number of blocks.">pNBlock</a>();c1+=<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b++].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>){
<a name="l00495"></a>00495    <span class="keywordflow">if</span>(strcmp(<a class="code" href="classElPoly.html#a3ea47501772e8717e5d6fb04cc1999b2" title="Name of the block to draw.">Block2Draw</a>,<span class="stringliteral">&quot;ALL&quot;</span>)){
<a name="l00496"></a>00496       <span class="keywordflow">if</span>(strcmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name,<a class="code" href="classElPoly.html#a3ea47501772e8717e5d6fb04cc1999b2" title="Name of the block to draw.">Block2Draw</a>) ) <span class="keywordflow">continue</span>;
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498     <span class="keywordflow">if</span>(!strncmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name,<span class="stringliteral">&quot;PEP&quot;</span>,3)){
<a name="l00499"></a>00499       <span class="comment">//DrProtein(Nano[++NPep].ArchFile,b);</span>
<a name="l00500"></a>00500       <span class="keywordflow">continue</span>;
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502     <span class="comment">//    if(strncmp(Block[b].Name,&quot;TT&quot;,2))continue;</span>
<a name="l00503"></a>00503     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=c1;c&lt;c1+<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>(b);c++){
<a name="l00504"></a>00504       <span class="keywordflow">if</span>(!CHAIN_IF_TYPE(c,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>)) <span class="keywordflow">continue</span>;
<a name="l00505"></a>00505       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00506"></a>00506    ChDir.<a class="code" href="classVettore.html#af865716b201375aaca7c880377aa2426" title="Set the N column.">Set</a>(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Dir[d]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,d);
<a name="l00507"></a>00507    ChPos.<a class="code" href="classVettore.html#af865716b201375aaca7c880377aa2426" title="Set the N column.">Set</a>((<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[d]-<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Dir[d]*.5)*InvScaleUn,d);
<a name="l00508"></a>00508       }
<a name="l00509"></a>00509       <span class="keywordtype">double</span> Red   = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Angle/M_PI;
<a name="l00510"></a>00510       <span class="keywordtype">double</span> Green = 1.-Red;<span class="comment">//Ax2.Angle(&amp;Ax1,&amp;ChDir)/M_PI;</span>
<a name="l00511"></a>00511       <span class="keywordtype">double</span> Blue  = 0.;<span class="comment">//sin(Ax0.Angle(&amp;Ax2,&amp;ChDir))-Green;</span>
<a name="l00512"></a>00512       <span class="keywordtype">double</span> Alpha = 1.;
<a name="l00513"></a>00513       <span class="keywordflow">if</span>(Red &gt; 0.35 &amp;&amp; Red &lt; .65);
<a name="l00514"></a>00514       <span class="comment">// else Blue = 0.;</span>
<a name="l00515"></a>00515       <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00516"></a>00516       glColor4f(Red,Green,Blue,Alpha);
<a name="l00517"></a>00517       glPushMatrix();<span class="comment">//Arrow</span>
<a name="l00518"></a>00518       <span class="keywordtype">double</span> Length1 = ChDir.<a class="code" href="classVettore.html#ac3486702edb3f0a9835908841db69cfd" title="Return the norm of a Vettore.">Norm</a>();
<a name="l00519"></a>00519       <span class="keywordtype">double</span> Length2 = Freccia.<a class="code" href="classVettore.html#ac3486702edb3f0a9835908841db69cfd" title="Return the norm of a Vettore.">Norm</a>();
<a name="l00520"></a>00520       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00521"></a>00521    Axis.<a class="code" href="classVettore.html#af865716b201375aaca7c880377aa2426" title="Set the N column.">Set</a>(.5*(ChDir.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(d)/Length1+Freccia.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(d)/Length2),d);
<a name="l00522"></a>00522       }
<a name="l00523"></a>00523       glTranslated(ChPos.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(0),ChPos.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(1),ChPos.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(2));
<a name="l00524"></a>00524       glRotatef(180.,Axis.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(0),Axis.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(1),Axis.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(2));
<a name="l00525"></a>00525       glScaled(Length1/Length2,1.0,1.0);
<a name="l00526"></a>00526       glNormal3f(ChDir.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(0),ChDir.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(1),ChDir.<a class="code" href="classVettore.html#a8fcbd69726df0d5309a4f2d790f427fd" title="Value of the N column.">Val</a>(2));
<a name="l00527"></a>00527       glCallList(Arrow);
<a name="l00528"></a>00528       glPopMatrix();<span class="comment">//Arrow</span>
<a name="l00529"></a>00529       <span class="keywordtype">int</span> p1 = c*<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();
<a name="l00530"></a>00530       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ppc=0;ppc&lt;<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>();ppc++){
<a name="l00531"></a>00531    <span class="keywordtype">int</span> p = ppc+p1;
<a name="l00532"></a>00532    <a class="code" href="classElPoly.html#aefa30992af110f1b0e1b60ee028b9f38" title="Pointer to a generic function.">DrawPart</a>(p);
<a name="l00533"></a>00533    <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a>) <a class="code" href="classElPoly.html#abe58ec64ad127f7a85a62feefbfac4b6" title="Finde the neighbour of the particle p and draw the bond.">DrBond</a>(p);
<a name="l00534"></a>00534       }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537   glEndList();
<a name="l00538"></a>00538 }
<a name="l00539"></a><a class="code" href="classElPoly.html#a3eef417e007c18f604455cfb38a948cb">00539</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a3eef417e007c18f604455cfb38a948cb" title="Draw a vector.">ElPoly::DrVector</a>(<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> v,<a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Origin){
<a name="l00540"></a>00540   glDisable(GL_LIGHTING);
<a name="l00541"></a>00541   glPushMatrix();<span class="comment">//Arrow</span>
<a name="l00542"></a>00542   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Freccia(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,0.,0.);
<a name="l00543"></a>00543   <a class="code" href="classVettore.html" title="Geometrical operations on vectors.">Vettore</a> Axis(3);
<a name="l00544"></a>00544   <span class="keywordtype">double</span> Length1 = v.<a class="code" href="classVettore.html#ac3486702edb3f0a9835908841db69cfd" title="Return the norm of a Vettore.">Norm</a>();
<a name="l00545"></a>00545   <span class="keywordtype">double</span> Length2 = Freccia.<a class="code" href="classVettore.html#ac3486702edb3f0a9835908841db69cfd" title="Return the norm of a Vettore.">Norm</a>();
<a name="l00546"></a>00546   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00547"></a>00547     Axis.<a class="code" href="classVettore.html#af865716b201375aaca7c880377aa2426" title="Set the N column.">Set</a>(d,.5*(v[d]/Length1 + Freccia[d]/Length2));
<a name="l00548"></a>00548   }
<a name="l00549"></a>00549   glTranslated(Origin[0],Origin[1],Origin[2]);
<a name="l00550"></a>00550   glRotatef(180.,Axis[0],Axis[1],Axis[2]);
<a name="l00551"></a>00551   glScaled(Length1/Length2,1.0,1.0);
<a name="l00552"></a>00552   glNormal3f(v[0],v[1],v[2]);
<a name="l00553"></a>00553   glCallList(Arrow);
<a name="l00554"></a>00554   glPopMatrix();<span class="comment">//Arrow</span>
<a name="l00555"></a>00555 }
<a name="l00556"></a><a class="code" href="classElPoly.html#aee4f14af2142abdfefdb0b0cd7ac6db3">00556</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aee4f14af2142abdfefdb0b0cd7ac6db3" title="Position of every chain in hexagons.">ElPoly::DrChains</a>(){
<a name="l00557"></a>00557   glDisable(GL_LIGHTING);
<a name="l00558"></a>00558   <span class="keywordtype">double</span> Values=200.;
<a name="l00559"></a>00559   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00560"></a>00560   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00561"></a>00561   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00562"></a>00562   <a class="code" href="classVarData.html#af9a9613864841dab614784ea1f9e5f16" title="Boh...">Folding</a>();
<a name="l00563"></a>00563   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00564"></a>00564     <span class="comment">//Numera(Ch[c].Pos,c);</span>
<a name="l00565"></a>00565     <span class="keywordtype">int</span> Chc = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a>;
<a name="l00566"></a>00566     <span class="keywordflow">if</span>(!CHAIN_IF_TYPE(Chc,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>)) <span class="keywordflow">continue</span>;
<a name="l00567"></a>00567     <span class="keywordtype">double</span> Red = 0.;
<a name="l00568"></a>00568     <span class="keywordflow">if</span>(CHAIN_IF_TYPE(Chc,CHAIN_UP))
<a name="l00569"></a>00569       Red = 1.;
<a name="l00570"></a>00570     <span class="keywordtype">double</span> Blue=0.;
<a name="l00571"></a>00571     <span class="keywordflow">if</span>(CHAIN_IF_TYPE(Chc,CHAIN_FLABBY))
<a name="l00572"></a>00572       Blue =1.;
<a name="l00573"></a>00573     <span class="keywordtype">double</span> Green=.7;
<a name="l00574"></a>00574     <span class="keywordflow">if</span>(CHAIN_IF_TYPE(Chc,CHAIN_TILTED))
<a name="l00575"></a>00575       Green =.5;
<a name="l00576"></a>00576     glPushMatrix();
<a name="l00577"></a>00577     glTranslatef((GLfloat)(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[0]*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00578"></a>00578        (GLfloat)(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[1]*InvScaleUn),
<a name="l00579"></a>00579        (GLfloat)(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[2]*InvScaleUn*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>));
<a name="l00580"></a>00580     glColor4f(Red,Green,Blue,1.);
<a name="l00581"></a>00581     glCallList(Hexagon);
<a name="l00582"></a>00582     glPopMatrix();
<a name="l00583"></a>00583   }
<a name="l00584"></a>00584   glEndList();
<a name="l00585"></a>00585   return ;
<a name="l00586"></a>00586   <span class="keywordtype">double</span> Unity= 1./(double)Values*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>;
<a name="l00587"></a>00587   <span class="keywordtype">double</span> *dDensity;
<a name="l00588"></a>00588   dDensity = (<span class="keywordtype">double</span> *)calloc(Values,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00589"></a>00589   <a class="code" href="classVarData.html#a510c054d13fe1a0f08ce51e357943a83" title="1-d pair correlation">PairCorrelation</a>(dDensity,Values,1,CHAIN_UP);
<a name="l00590"></a>00590   <span class="keywordtype">double</span> Max=0.;
<a name="l00591"></a>00591   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values;v++){
<a name="l00592"></a>00592     <span class="keywordflow">if</span>(Max &lt; dDensity[v]){
<a name="l00593"></a>00593       Max = dDensity[v];
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595   }
<a name="l00596"></a>00596   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values;v++){
<a name="l00597"></a>00597     dDensity[v] /= Max;
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;Values-1;v++){
<a name="l00600"></a>00600     glPushMatrix();
<a name="l00601"></a>00601     glBegin(GL_LINES);
<a name="l00602"></a>00602     glColor4f(1.,0.,1.,1.);
<a name="l00603"></a>00603     glVertex3d((Values-v)*Unity,<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,dDensity[v]);
<a name="l00604"></a>00604     glVertex3d((Values-(v+1))*Unity,<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,dDensity[v+1]);
<a name="l00605"></a>00605     glEnd();
<a name="l00606"></a>00606     glPopMatrix();
<a name="l00607"></a>00607   }
<a name="l00608"></a>00608   glEndList();
<a name="l00609"></a>00609   free(dDensity);
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 <span class="comment">//obsolete?</span>
<a name="l00612"></a><a class="code" href="classElPoly.html#a6793bf2cb18afd12d89c95d402a80ca9">00612</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a6793bf2cb18afd12d89c95d402a80ca9" title="Boh.">ElPoly::DrPosCol</a>(){
<a name="l00613"></a>00613   glDisable(GL_LIGHTING);
<a name="l00614"></a>00614   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00615"></a>00615   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00616"></a>00616   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00617"></a>00617   glPointSize(3);
<a name="l00618"></a>00618   glLineWidth(3);
<a name="l00619"></a>00619   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0,link=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00620"></a>00620     glColor4f(<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,0)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(0),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,1)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(1),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(2),<a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,3)/<a class="code" href="classVarData.html#a0dd67b71b3296325972cd737b82f53c3" title="Maximum velocity.">pVelMax</a>(3));
<a name="l00621"></a>00621     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) == 2){
<a name="l00622"></a>00622       glPushMatrix();<span class="comment">//Particle</span>
<a name="l00623"></a>00623       glTranslated((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00624"></a>00624          (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00625"></a>00625          (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>));
<a name="l00626"></a>00626       glColor4f( 1.,.1,.1,1.);
<a name="l00627"></a>00627       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#ae10d368b167a39a5905e047ba7083b2a" title="0 none, 1 spherical, 2 cylindrical 3 wall">Shape</a> == SHAPE_CYL)
<a name="l00628"></a>00628    glCallList(Cylinder[0]);
<a name="l00629"></a>00629       <span class="keywordflow">else</span> 
<a name="l00630"></a>00630    glutSolidSphere(<a class="code" href="classVarData.html#aee5ea3e3c08ea9745e40192350f5d14b" title="Extra particle.">Nano</a>-&gt;<a class="code" href="structNANO.html#a860bef50013f57ab1a6437b7986a9487" title="Size.">Rad</a>*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,20,20);
<a name="l00631"></a>00631       glPopMatrix();<span class="comment">//Particle</span>
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633     <span class="keywordflow">else</span>{
<a name="l00634"></a>00634       glPushMatrix();<span class="comment">//Particle</span>
<a name="l00635"></a>00635       glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>);
<a name="l00636"></a>00636       glCallList(Cube);
<a name="l00637"></a>00637       glPopMatrix();<span class="comment">//Particle</span>
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639   }
<a name="l00640"></a>00640   glEndList();
<a name="l00641"></a>00641 }
<a name="l00642"></a><a class="code" href="classElPoly.html#ad36be1f2ea9bef2742992bfb62023fb8">00642</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#ad36be1f2ea9bef2742992bfb62023fb8" title="Visualize the cross links.">ElPoly::DrCrossLinks</a>(){
<a name="l00643"></a>00643   glDisable(GL_LIGHTING);
<a name="l00644"></a>00644   glDeleteLists(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,1);
<a name="l00645"></a>00645   Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a> = glGenLists(1);
<a name="l00646"></a>00646   glNewList(Dr-&gt;<a class="code" href="classDraw.html#a0fd83139e0b18df8d7beb2a83c5ab4d2" title="Refers to the list of the total position of the particles which will be generated in another program...">Particles</a>,GL_COMPILE);
<a name="l00647"></a>00647   glPointSize(3);
<a name="l00648"></a>00648   glLineWidth(3);
<a name="l00649"></a>00649   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0,link=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00650"></a>00650     <span class="keywordtype">int</span> Chc = <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[<a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)].<a class="code" href="structCHAIN.html#ae011432eaca3858364b05a111f4011d3" title="Type of the chain (see list CHAIN_)">Type</a>;
<a name="l00651"></a>00651     <span class="keywordflow">if</span>(!CHAIN_IF_TYPE(Chc,<a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a>) &amp;&amp; <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p)!=2) <span class="keywordflow">continue</span>;
<a name="l00652"></a>00652     <span class="keywordtype">int</span> Typ = <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) &lt; 6 ? <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p) : 5;
<a name="l00653"></a>00653     glColor4fv(ColorType[Typ]);
<a name="l00654"></a>00654     <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a>){
<a name="l00655"></a>00655      glColor4f(0.0,1.0,0.,1.0);
<a name="l00656"></a>00656       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;<a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#a73918a2decc99bcf2317d2855dada6c8" title="How many links per particle.">NLink</a>;l++){
<a name="l00657"></a>00657    link = <a class="code" href="classVarData.html#a8864e546987744c3b932ff2a3b8c1291" title="Array of linking between the particles.">Ln</a>[p].<a class="code" href="structLINKS.html#aefc83dee460fda66ca240e011e7ce0a7" title="with whom is bonded">Link</a>[l];
<a name="l00658"></a>00658    <span class="keywordtype">double</span> Shift[3] = {0.,0.,0.};
<a name="l00659"></a>00659    <span class="keywordflow">if</span>(link != p+1){ 
<a name="l00660"></a>00660      glColor4f(1.0,.0,0.,1.0);
<a name="l00661"></a>00661      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++)
<a name="l00662"></a>00662        Shift[d] = -floor((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d)-<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link,d))/<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d)+.5)*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(d);
<a name="l00663"></a>00663    }
<a name="l00664"></a>00664    <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00665"></a>00665    glPushMatrix();<span class="comment">//Line</span>
<a name="l00666"></a>00666    glBegin(GL_LINES);
<a name="l00667"></a>00667    glVertex3d((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00668"></a>00668          (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00669"></a>00669          (<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>*<a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a>));
<a name="l00670"></a>00670    glVertex3d(((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link,0)-Shift[0])*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>),
<a name="l00671"></a>00671          ((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link,1)-Shift[1])*InvScaleUn),
<a name="l00672"></a>00672          ((<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(link,2)-Shift[2])*InvScaleUn*ScaleFact));
<a name="l00673"></a>00673    glEnd();
<a name="l00674"></a>00674    glPopMatrix();<span class="comment">//Line</span>
<a name="l00675"></a>00675       }
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677     glPushMatrix();<span class="comment">//Particle</span>
<a name="l00678"></a>00678     glTranslated(<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,0)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,1)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>,<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,2)*<a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>);
<a name="l00679"></a>00679     <span class="comment">//glutSolidSphere(.007,20,20);</span>
<a name="l00680"></a>00680     glCallList(Point);
<a name="l00681"></a>00681     glPopMatrix();<span class="comment">//Particle</span>
<a name="l00682"></a>00682   }
<a name="l00683"></a>00683   glEndList();
<a name="l00684"></a>00684 }
<a name="l00685"></a><a class="code" href="classElPoly.html#afdf1ca9e7afc3e7ec41b47fea4b3d80d">00685</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#afdf1ca9e7afc3e7ec41b47fea4b3d80d" title="Creates the menu.">ElPoly::Menu</a>(){
<a name="l00686"></a>00686   <span class="comment">//   submenu = glutCreateMenu(processEvent);</span>
<a name="l00687"></a>00687   <span class="comment">//   glutAddMenuEntry(&quot;SottoPrima&quot;,3);</span>
<a name="l00688"></a>00688 
<a name="l00689"></a>00689   <span class="comment">//   menu = glutCreateMenu(processEvent);</span>
<a name="l00690"></a>00690   <span class="comment">//   glutAddMenuEntry(&quot;Move&quot;,1);</span>
<a name="l00691"></a>00691   <span class="comment">//   glutAddMenuEntry(&quot;Stop&quot;,2);</span>
<a name="l00692"></a>00692   <span class="comment">//   glutAddSubMenu(&quot;Altro&quot;,submenu);</span>
<a name="l00693"></a>00693   <span class="comment">//   glutAttachMenu(GLUT_RIGHT_BUTTON);</span>
<a name="l00694"></a>00694 }
<a name="l00695"></a><a class="code" href="classElPoly.html#a6a2fcfb542bf2fb11d876bf91caa4625">00695</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a6a2fcfb542bf2fb11d876bf91caa4625" title="Sequence of pictures.">ElPoly::ESlide1</a>(<span class="keywordtype">void</span>){
<a name="l00696"></a>00696   <span class="comment">//  if(Dr-&gt;Step &gt; 100) glutIdleFunc(NULL);</span>
<a name="l00697"></a>00697   Dr-&gt;zw += .1;
<a name="l00698"></a>00698   Dr-&gt;<a class="code" href="classDraw.html#a068515d973f897b4d629594f8a30aa3a" title="Removes the info line.">IfInfo</a> = 0;
<a name="l00699"></a>00699   glutPostRedisplay();
<a name="l00700"></a>00700   Dr-&gt;<a class="code" href="classDraw.html#a20146731f2945f9b0c25d61e11bb0217" title="Current step for the picture&#39;s name.">Step</a>++;
<a name="l00701"></a>00701   Dr-&gt;<a class="code" href="classDraw.html#a45ed15a0527d5ba75107645dc8467078" title="Write a tiff file of the data in pixel.">Picture</a>();
<a name="l00702"></a>00702   Dr-&gt;<a class="code" href="classDraw.html#a068515d973f897b4d629594f8a30aa3a" title="Removes the info line.">IfInfo</a> = 1;;
<a name="l00703"></a>00703   <span class="comment">//Dr-&gt;Picture();</span>
<a name="l00704"></a>00704   <span class="comment">//glutTimerFunc(30, Timer, 0);</span>
<a name="l00705"></a>00705 }
<a name="l00706"></a><a class="code" href="classElPoly.html#aefdc3015aefee9868dcb006c9e0832a7">00706</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#aefdc3015aefee9868dcb006c9e0832a7" title="Sequence of pictures.">ElPoly::ESlide</a>(<span class="keywordtype">void</span>){
<a name="l00707"></a>00707   Dr-&gt;<a class="code" href="classDraw.html#a068515d973f897b4d629594f8a30aa3a" title="Removes the info line.">IfInfo</a> = 0;
<a name="l00708"></a>00708   glutPostRedisplay();
<a name="l00709"></a>00709   <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a> &lt; <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>)
<a name="l00710"></a>00710     <a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a>++;
<a name="l00711"></a>00711     <span class="comment">//quando += 10;</span>
<a name="l00712"></a>00712   <span class="keywordflow">else</span>{
<a name="l00713"></a>00713     glutIdleFunc(NULL);
<a name="l00714"></a>00714   }
<a name="l00715"></a>00715   <a class="code" href="classElPoly.html#a3432306726a27b310ec27b3900894b11" title="Opens the f file of the list  open.">OpenFile</a>(<a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a>);
<a name="l00716"></a>00716   <a class="code" href="classElPoly.html#a6387005443a530d1a66a0833c72b23fd" title="Choose the visualisation (obsolete)">RenderPart</a>();
<a name="l00717"></a>00717   Dr-&gt;<a class="code" href="classDraw.html#a20146731f2945f9b0c25d61e11bb0217" title="Current step for the picture&#39;s name.">Step</a>++;
<a name="l00718"></a>00718   Dr-&gt;<a class="code" href="classDraw.html#a45ed15a0527d5ba75107645dc8467078" title="Write a tiff file of the data in pixel.">Picture</a>();
<a name="l00719"></a>00719   glutPostRedisplay();
<a name="l00720"></a>00720   Dr-&gt;<a class="code" href="classDraw.html#a068515d973f897b4d629594f8a30aa3a" title="Removes the info line.">IfInfo</a> = 1;
<a name="l00721"></a>00721   <span class="comment">//glutTimerFunc(30, Timer, 0);</span>
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 <span class="preprocessor">#endif //__glut_h__</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:18 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
