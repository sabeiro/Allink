<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/VarData/VarDatFile.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_4fd85bb7e60d3734b722333cda33b932.html">VarData</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">VarDatFile.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;../include/VarDatFile.h&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a><a class="code" href="classVarDatFile.html#aee213a28901788f8039811a1849fd829">00004</a> <a class="code" href="classVarDatFile.html#a21fde0fe885a9c32bed3f479030b932f" title="Moltiplication factor for a scaled set (MediaMob)">VarDatFile::VarDatFile</a>(<span class="keywordtype">int</span> ExtNMax,<span class="keywordtype">int</span> ExtNVar,<span class="keywordtype">int</span> ExtNBin){
<a name="l00005"></a>00005   Init();
<a name="l00006"></a>00006   NMax = ExtNMax;
<a name="l00007"></a>00007   NMaxPunti = NMax;
<a name="l00008"></a>00008   NVar = ExtNVar;
<a name="l00009"></a>00009   <a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a> = ExtNBin;
<a name="l00010"></a>00010   Allocate();
<a name="l00011"></a>00011   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[0];
<a name="l00012"></a>00012 }
<a name="l00013"></a><a class="code" href="classVarDatFile.html#a8a83d164588d4aadbf15e250d29b5a6b">00013</a> <a class="code" href="classVarDatFile.html#a21fde0fe885a9c32bed3f479030b932f" title="Moltiplication factor for a scaled set (MediaMob)">VarDatFile::VarDatFile</a>(<span class="keywordtype">double</span> **ExtSt,<span class="keywordtype">int</span> ExtNMax,<span class="keywordtype">int</span> ExtNVar,<span class="keywordtype">int</span> ExtNBin){
<a name="l00014"></a>00014   Init();
<a name="l00015"></a>00015   NMax = ExtNMax;
<a name="l00016"></a>00016   NMaxPunti = NMax;
<a name="l00017"></a>00017   NVar = ExtNVar;
<a name="l00018"></a>00018   <a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a> = ExtNBin;
<a name="l00019"></a>00019   Allocate();
<a name="l00020"></a>00020   st = ExtSt;
<a name="l00021"></a>00021   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[0];
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 <span class="comment">// VarDatFile::VarDatFile(char *file,int NNBin){</span>
<a name="l00024"></a>00024 <span class="comment">//   NMax = 0;</span>
<a name="l00025"></a>00025 <span class="comment">//   NVisMin = 0;</span>
<a name="l00026"></a>00026 <span class="comment">//   NVar=0;</span>
<a name="l00027"></a>00027 <span class="comment">//   NBin = NNBin;</span>
<a name="l00028"></a>00028 <span class="comment">//   FILE *InFile;</span>
<a name="l00029"></a>00029 <span class="comment">//   if((InFile = fopen(file,&quot;r&quot;))==0){</span>
<a name="l00030"></a>00030 <span class="comment">//     printf(&quot;Non s&#39;apre %s\n&quot;,file);</span>
<a name="l00031"></a>00031 <span class="comment">//     exit(0);</span>
<a name="l00032"></a>00032 <span class="comment">//   }</span>
<a name="l00033"></a>00033 <span class="comment">//   Init();</span>
<a name="l00034"></a>00034 <span class="comment">//   int NCol = 0;</span>
<a name="l00035"></a>00035 <span class="comment">//   NVisMax = NMax = FileInfo(InFile,&amp;NCol);</span>
<a name="l00036"></a>00036 <span class="comment">//   NVar = NCol;</span>
<a name="l00037"></a>00037 <span class="comment">//   Allocate();</span>
<a name="l00038"></a>00038 <span class="comment">//   char cLine[STRLEN];</span>
<a name="l00039"></a>00039 <span class="comment">//   double *dLine = (double *)calloc(NVar,sizeof(double));</span>
<a name="l00040"></a>00040 <span class="comment">//   for(int v=0;v&lt;NVar;v++) SetNMax[v] = NMax;</span>
<a name="l00041"></a>00041 <span class="comment">//   for(int l=0; l&lt;NMax;l++){</span>
<a name="l00042"></a>00042 <span class="comment">//     fgets(cLine,512,InFile);</span>
<a name="l00043"></a>00043 <span class="comment">//     if(ReadLine(cLine,dLine)){l--;continue;}</span>
<a name="l00044"></a>00044 <span class="comment">//     for(int v=0;v&lt;NVar;v++){</span>
<a name="l00045"></a>00045 <span class="comment">//       st[v][l] = dLine[v];</span>
<a name="l00046"></a>00046 <span class="comment">//       if(l==0){</span>
<a name="l00047"></a>00047 <span class="comment">//    sMin[v] = st[v][l];</span>
<a name="l00048"></a>00048 <span class="comment">//    sMax[v] = st[v][l];</span>
<a name="l00049"></a>00049 <span class="comment">//       }</span>
<a name="l00050"></a>00050 <span class="comment">//       if(sMin[v] &gt; st[v][l])</span>
<a name="l00051"></a>00051 <span class="comment">//    sMin[v] = st[v][l];</span>
<a name="l00052"></a>00052 <span class="comment">//       if(sMax[v] &lt; st[v][l])</span>
<a name="l00053"></a>00053 <span class="comment">//    sMax[v] = st[v][l];</span>
<a name="l00054"></a>00054 <span class="comment">//     }</span>
<a name="l00055"></a>00055 <span class="comment">//   }</span>
<a name="l00056"></a>00056 <span class="comment">//   free(dLine);</span>
<a name="l00057"></a>00057 <span class="comment">//   if(NVar &gt; 1){</span>
<a name="l00058"></a>00058 <span class="comment">//     CoordY = 1;</span>
<a name="l00059"></a>00059 <span class="comment">//     CoordX = 0;</span>
<a name="l00060"></a>00060 <span class="comment">//     RefAbsc[CoordX] = REF_ASC;</span>
<a name="l00061"></a>00061 <span class="comment">//     for(int v=1;v&lt;NVar;v++)</span>
<a name="l00062"></a>00062 <span class="comment">//       RefAbsc[v] = CoordX;</span>
<a name="l00063"></a>00063 <span class="comment">//   }</span>
<a name="l00064"></a>00064 <span class="comment">//   else{</span>
<a name="l00065"></a>00065 <span class="comment">//     CoordY = 0;</span>
<a name="l00066"></a>00066 <span class="comment">//     RefAbsc[CoordY] = REF_SEQ;</span>
<a name="l00067"></a>00067 <span class="comment">//   }</span>
<a name="l00068"></a>00068 <span class="comment">//   fclose(InFile);</span>
<a name="l00069"></a>00069 <span class="comment">//   sp = st[0];</span>
<a name="l00070"></a>00070 <span class="comment">// }</span>
<a name="l00071"></a><a class="code" href="classVarDatFile.html#ac31e8053d3ade20d6b08259849c87976">00071</a> <a class="code" href="classVarDatFile.html#a21fde0fe885a9c32bed3f479030b932f" title="Moltiplication factor for a scaled set (MediaMob)">VarDatFile::VarDatFile</a>(<span class="keywordtype">char</span> **FileList,<span class="keywordtype">int</span> *Pos,<span class="keywordtype">int</span> NFile,<span class="keywordtype">int</span> NNBin){
<a name="l00072"></a>00072   NMax=0;
<a name="l00073"></a>00073   NVar=0;
<a name="l00074"></a>00074   Init();
<a name="l00075"></a>00075   <a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a> = NNBin;
<a name="l00076"></a>00076   <span class="keywordtype">int</span> *NMaxFile = (<span class="keywordtype">int</span> *)calloc(NFile,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00077"></a>00077   <span class="keywordtype">int</span> *NColFile = (<span class="keywordtype">int</span> *)calloc(NFile+1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00078"></a>00078   NColFile[0] = 0;
<a name="l00079"></a>00079   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;NFile;f++){
<a name="l00080"></a>00080     FILE *FileIn = fopen(FileList[Pos[f]],<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00081"></a>00081     <span class="keywordflow">if</span>(FileIn == 0){
<a name="l00082"></a>00082       printf(<span class="stringliteral">&quot;File %s not found\n&quot;</span>,FileList[Pos[f]]);
<a name="l00083"></a>00083       <span class="keywordflow">return</span>;
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085     <span class="keywordtype">int</span> NCol = 0;
<a name="l00086"></a>00086     NMaxFile[f] = <a class="code" href="classVarDatFile.html#a63cfc9d080698099e7831515b4fa7625" title="Reads information contained in the file.">FileInfo</a>(FileIn,&amp;NCol);
<a name="l00087"></a>00087     NColFile[f+1] = NCol + NColFile[f];
<a name="l00088"></a>00088     <span class="keywordflow">if</span>(NMaxFile[f] &gt; NMax) NMax = NMaxFile[f];
<a name="l00089"></a>00089     NMaxPunti = NMax;
<a name="l00090"></a>00090     NVar += NCol;
<a name="l00091"></a>00091     fclose(FileIn);
<a name="l00092"></a>00092   }
<a name="l00093"></a>00093   Allocate();
<a name="l00094"></a>00094   <span class="keywordtype">char</span> cLine[STRLEN];
<a name="l00095"></a>00095   <span class="keywordtype">double</span> *dLine = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00096"></a>00096   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;NFile;f++){
<a name="l00097"></a>00097     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=NColFile[f];v&lt;NColFile[f+1];v++)
<a name="l00098"></a>00098       SetNMax[v] = NMaxFile[f];
<a name="l00099"></a>00099     FILE *FileIn = fopen(FileList[Pos[f]],<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00100"></a>00100     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;NMaxFile[f];l++){
<a name="l00101"></a>00101       <span class="keywordflow">if</span>(!fgets(cLine,512,FileIn))<span class="keywordflow">break</span>;
<a name="l00102"></a>00102       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#ade68053131c1d1ddd635f526f93e4ff3" title="Reads a single line.">ReadLine</a>(cLine,dLine)){l--;<span class="keywordflow">continue</span>;}
<a name="l00103"></a>00103       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=NColFile[f],vv=0;v&lt;NColFile[f+1];v++,vv++){
<a name="l00104"></a>00104    st[v][l] = dLine[vv];
<a name="l00105"></a>00105       }
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     fclose(FileIn);
<a name="l00108"></a>00108     <span class="keywordflow">if</span>(NColFile[f+1]-NColFile[f] == 1){
<a name="l00109"></a>00109       RefAbsc[NColFile[f]] = NVar;
<a name="l00110"></a>00110     }
<a name="l00111"></a>00111     <span class="keywordflow">else</span> {
<a name="l00112"></a>00112       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=NColFile[f];v&lt;NColFile[f+1];v++){
<a name="l00113"></a>00113    RefAbsc[v] = NColFile[f];
<a name="l00114"></a>00114       }
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116   }
<a name="l00117"></a>00117   <span class="keywordflow">if</span>(NVar == 1) <a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(0);
<a name="l00118"></a>00118   <span class="keywordflow">else</span> <a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">Punta</a>(1);
<a name="l00119"></a>00119   free(dLine);
<a name="l00120"></a>00120   free(NMaxFile);
<a name="l00121"></a>00121   free(NColFile);
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 <span class="keywordtype">void</span> VarDatFile::Allocate(){
<a name="l00124"></a>00124   dInter = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,<span class="keyword">sizeof</span>(*dInter));
<a name="l00125"></a>00125   dError = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,<span class="keyword">sizeof</span>(*dError));
<a name="l00126"></a>00126   dInter1 = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,<span class="keyword">sizeof</span>(*dInter));
<a name="l00127"></a>00127   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00128"></a>00128   sType = (<span class="keywordtype">int</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00129"></a>00129   SetNMax = (<span class="keywordtype">int</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00130"></a>00130   sColor = (<span class="keywordtype">int</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00131"></a>00131   sMin = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00132"></a>00132   sMax = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00133"></a>00133   sColor = (<span class="keywordtype">int</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00134"></a>00134   RefAbsc = (<span class="keywordtype">int</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00135"></a>00135   st = (<span class="keywordtype">double</span> **)calloc(NVar+1,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00136"></a>00136   <span class="keywordflow">if</span>(st == NULL){
<a name="l00137"></a>00137     printf(<span class="stringliteral">&quot;Could not allocate st \n&quot;</span>);
<a name="l00138"></a>00138     exit(0);
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140   <span class="comment">//if( !st){printf(&quot;st non s&#39;alloca\n&quot;);return ;}</span>
<a name="l00141"></a>00141   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar+1;v++){
<a name="l00142"></a>00142     st[v] = (<span class="keywordtype">double</span> *)calloc(NMax,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00143"></a>00143     <span class="keywordflow">if</span>(st[v] == NULL){
<a name="l00144"></a>00144       printf(<span class="stringliteral">&quot;Could not allocate st[%d] \n&quot;</span>,v);
<a name="l00145"></a>00145       exit(0);
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147     <span class="comment">//if( !st[v]){printf(&quot;st non s&#39;alloca\n&quot;);return ;}</span>
<a name="l00148"></a>00148   }
<a name="l00149"></a>00149   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00150"></a>00150     st[NVar][n] = (double)n;
<a name="l00151"></a>00151   }
<a name="l00152"></a>00152   <span class="comment">//sc = NULL;</span>
<a name="l00153"></a>00153   <span class="comment">//sc = (char **)calloc(NVar,sizeof(char));</span>
<a name="l00154"></a>00154   <span class="comment">//if(!sc){printf(&quot;sc non s&#39;alloca\n&quot;);return ;}</span>
<a name="l00155"></a>00155   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00156"></a>00156     <span class="comment">//sc[v] = (char *)calloc(120,sizeof(char));</span>
<a name="l00157"></a>00157     <span class="comment">//if(!sc[v]){printf(&quot;st non s&#39;alloca\n&quot;);return ;}</span>
<a name="l00158"></a>00158   }
<a name="l00159"></a>00159 }
<a name="l00160"></a><a class="code" href="classVarDatFile.html#acbe3dc1b93a2c0aa2cf310056bef0287">00160</a> <a class="code" href="classVarDatFile.html#acbe3dc1b93a2c0aa2cf310056bef0287" title="Freeing.">VarDatFile::~VarDatFile</a>(){
<a name="l00161"></a>00161   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00162"></a>00162     free(st[v]);
<a name="l00163"></a>00163     <span class="comment">//if(st[v]){printf(&quot;st %d is not freed\n&quot;,v);}</span>
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165   free(st);
<a name="l00166"></a>00166   <span class="comment">//if(st){printf(&quot;st is not freed\n&quot;);}</span>
<a name="l00167"></a>00167   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00168"></a>00168     <span class="comment">//free(sc[v]);</span>
<a name="l00169"></a>00169     <span class="comment">//if(sc[v] != NULL){printf(&quot;sc %d is not freed\n&quot;,v);}</span>
<a name="l00170"></a>00170   }
<a name="l00171"></a>00171   <span class="comment">//free(sc);//if(sc != NULL){printf(&quot;sc is not freed\n&quot;);}</span>
<a name="l00172"></a>00172   free(sMin);
<a name="l00173"></a>00173   free(sMax);
<a name="l00174"></a>00174   free(sType);
<a name="l00175"></a>00175   free(SetNMax);
<a name="l00176"></a>00176   free(sColor);
<a name="l00177"></a>00177   free(RefAbsc);
<a name="l00178"></a>00178   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = NULL;
<a name="l00179"></a>00179   free(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>);
<a name="l00180"></a>00180   free(dInter);
<a name="l00181"></a>00181   free(dInter1);
<a name="l00182"></a>00182   <a class="code" href="classVarDatFile.html#aab87873039820cc1aca0c444c43d9a5e" title="Free Punti if it is allocated.">PuntiFree</a>();
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 <span class="keywordtype">void</span> VarDatFile::Init(){
<a name="l00185"></a>00185   IfPuntiAlloc = 1;
<a name="l00186"></a>00186   IfPuntiFree = 0;
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 <span class="comment">//FIXME: there is still color, type... to be allocated</span>
<a name="l00189"></a><a class="code" href="classVarDatFile.html#acd5ad8eb7d2e19f9341bbd969b8781f4">00189</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#acd5ad8eb7d2e19f9341bbd969b8781f4" title="Add the content of the file into the memory.">VarDatFile::Aggiungi</a>(<span class="keywordtype">char</span> *file){
<a name="l00190"></a>00190   FILE *InFile;
<a name="l00191"></a>00191   <span class="keywordflow">if</span>((InFile = fopen(file,<span class="stringliteral">&quot;r&quot;</span>))==NULL){
<a name="l00192"></a>00192     printf(<span class="stringliteral">&quot;Non s&#39;apre %s\n&quot;</span>,file);
<a name="l00193"></a>00193     <span class="keywordflow">return</span> 1;
<a name="l00194"></a>00194   }
<a name="l00195"></a>00195   <span class="keywordtype">char</span> cLine[512];
<a name="l00196"></a>00196   <span class="keywordtype">double</span> **stTemp = (<span class="keywordtype">double</span> **)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00197"></a>00197   <span class="keywordflow">if</span>(stTemp == NULL){printf(<span class="stringliteral">&quot;stTemp non s&#39;alloca\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00198"></a>00198   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00199"></a>00199     stTemp[v] = (<span class="keywordtype">double</span> *)calloc(NMax,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00200"></a>00200     <span class="keywordflow">if</span>( stTemp[v] == NULL){printf(<span class="stringliteral">&quot;stTemp non s&#39;alloca\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00201"></a>00201   }
<a name="l00202"></a>00202   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00203"></a>00203     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00204"></a>00204       stTemp[v][n] = st[v][n];<span class="comment">//sign[v*NMax+n];</span>
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206   }
<a name="l00207"></a>00207   <span class="keywordtype">int</span> NVarOld = NVar;
<a name="l00208"></a>00208   <span class="keywordtype">int</span> NCol = 0;
<a name="l00209"></a>00209   <span class="keywordtype">int</span> nPoint = <a class="code" href="classVarDatFile.html#a63cfc9d080698099e7831515b4fa7625" title="Reads information contained in the file.">FileInfo</a>(InFile,&amp;NCol);
<a name="l00210"></a>00210   NVar += NCol;
<a name="l00211"></a>00211   <span class="keywordflow">if</span>(nPoint &gt; NMax) NMax = nPoint;
<a name="l00212"></a>00212   NMaxPunti = NMax;
<a name="l00213"></a>00213   {
<a name="l00214"></a>00214     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVarOld;v++){
<a name="l00215"></a>00215       free(st[v]);
<a name="l00216"></a>00216       <span class="comment">//free(sc[v]);</span>
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218     free(st);
<a name="l00219"></a>00219     <span class="comment">//free(sc);</span>
<a name="l00220"></a>00220     st = (<span class="keywordtype">double</span> **)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00221"></a>00221     <span class="keywordflow">if</span>( st  == NULL){printf(<span class="stringliteral">&quot;st non s&#39;alloca\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00222"></a>00222     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00223"></a>00223       st[v] = (<span class="keywordtype">double</span> *)calloc(NMax,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00224"></a>00224       <span class="keywordflow">if</span>( st[v] == NULL){printf(<span class="stringliteral">&quot;st non s&#39;alloca\n&quot;</span>);<span class="keywordflow">return</span> 0;}
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227   <span class="comment">// {</span>
<a name="l00228"></a>00228   <span class="comment">//   st = (double **)realloc(st,NVar*sizeof(double));</span>
<a name="l00229"></a>00229   <span class="comment">//   for(int v=0;v&lt;NVar;v++){</span>
<a name="l00230"></a>00230   <span class="comment">//     st[v] = (double *)realloc(st[v],NMax*sizeof(double));</span>
<a name="l00231"></a>00231   <span class="comment">//   }</span>
<a name="l00232"></a>00232   <span class="comment">// }</span>
<a name="l00233"></a>00233   <span class="keywordtype">double</span> *dLine = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00234"></a>00234   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0; l&lt;NMax;l++){
<a name="l00235"></a>00235     fgets(cLine,512,InFile);
<a name="l00236"></a>00236     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#ade68053131c1d1ddd635f526f93e4ff3" title="Reads a single line.">ReadLine</a>(cLine,dLine))<span class="keywordflow">continue</span>;
<a name="l00237"></a>00237     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=NVarOld;v&lt;NVar;v++){
<a name="l00238"></a>00238       st[v][l] = dLine[v-NVarOld];
<a name="l00239"></a>00239       <span class="keywordflow">if</span>(sMin[v] &gt; st[v][l])
<a name="l00240"></a>00240    sMin[v] = st[v][l];
<a name="l00241"></a>00241       <span class="keywordflow">if</span>(sMax[v] &lt; st[v][l])
<a name="l00242"></a>00242    sMax[v] = st[v][l];
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244   }
<a name="l00245"></a>00245   GlobMax = sMax[0];
<a name="l00246"></a>00246   GlobMin = sMin[0];
<a name="l00247"></a>00247   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00248"></a>00248     <span class="keywordflow">if</span>(GlobMax &lt; sMax[v])
<a name="l00249"></a>00249       GlobMax = sMax[v];
<a name="l00250"></a>00250     <span class="keywordflow">if</span>(GlobMin &gt; sMin[v])
<a name="l00251"></a>00251       GlobMin = sMin[v];
<a name="l00252"></a>00252   }
<a name="l00253"></a>00253   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++)
<a name="l00254"></a>00254     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVarOld;v++)
<a name="l00255"></a>00255       st[v][n] = stTemp[v][n];
<a name="l00256"></a>00256   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVarOld;v++)
<a name="l00257"></a>00257     free(stTemp[v]);
<a name="l00258"></a>00258   free(stTemp);
<a name="l00259"></a>00259   free(dLine);
<a name="l00260"></a>00260   fclose(InFile);
<a name="l00261"></a>00261   <a class="code" href="classVarDatFile.html#aab87873039820cc1aca0c444c43d9a5e" title="Free Punti if it is allocated.">PuntiFree</a>();
<a name="l00262"></a>00262   <span class="comment">//printf(&quot;Uscita\n&quot;);</span>
<a name="l00263"></a>00263   <span class="keywordflow">return</span> 0;
<a name="l00264"></a>00264 }
<a name="l00265"></a><a class="code" href="classVarDatFile.html#a63cfc9d080698099e7831515b4fa7625">00265</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a63cfc9d080698099e7831515b4fa7625" title="Reads information contained in the file.">VarDatFile::FileInfo</a>(FILE *InFile,<span class="keywordtype">int</span> *NCol){
<a name="l00266"></a>00266   <span class="keywordtype">int</span> nPoint = 0;
<a name="l00267"></a>00267   <span class="keywordtype">char</span> cLine[STRSIZE];
<a name="l00268"></a>00268   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;!(fgets(cLine,STRSIZE,InFile)==NULL);k++){
<a name="l00269"></a>00269     <span class="keywordflow">if</span>(k == 0 &amp;&amp; cLine[0] == <span class="charliteral">&#39;#&#39;</span>){
<a name="l00270"></a>00270       sprintf(Header,<span class="stringliteral">&quot;%s&quot;</span>,cLine);
<a name="l00271"></a>00271       <span class="keywordflow">continue</span>;
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273     <span class="keywordtype">int</span> iLen = (int) (strlen(cLine));
<a name="l00274"></a>00274     <span class="keywordflow">if</span>(cLine[0] != <span class="charliteral">&#39;#&#39;</span> &amp;&amp; cLine[0] != <span class="charliteral">&#39;\n&#39;</span>)
<a name="l00275"></a>00275       nPoint++;
<a name="l00276"></a>00276     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0,var=1;i&lt;iLen;i++){
<a name="l00277"></a>00277       <span class="keywordflow">if</span>(cLine[i] == <span class="charliteral">&#39;#&#39;</span>){
<a name="l00278"></a>00278    <span class="keywordflow">break</span>;<span class="comment">//Comment</span>
<a name="l00279"></a>00279       }
<a name="l00280"></a>00280       <span class="keywordflow">if</span>(cLine[i] == <span class="charliteral">&#39;\n&#39;</span>) <span class="keywordflow">break</span>;
<a name="l00281"></a>00281       <span class="keywordflow">if</span>(i&gt;0){
<a name="l00282"></a>00282    <span class="keywordflow">if</span>( (cLine[i-1] == <span class="charliteral">&#39; &#39;</span> || cLine[i-1] == <span class="charliteral">&#39;\t&#39;</span> ) &amp;&amp;
<a name="l00283"></a>00283        (cLine[i] != <span class="charliteral">&#39; &#39;</span> &amp;&amp; cLine[i] != <span class="charliteral">&#39;\t&#39;</span> ))
<a name="l00284"></a>00284      var++;
<a name="l00285"></a>00285       }
<a name="l00286"></a>00286       <span class="keywordflow">if</span>(*NCol &lt; var) *NCol = var;
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288   }
<a name="l00289"></a>00289   rewind(InFile);
<a name="l00290"></a>00290   <span class="keywordflow">return</span> nPoint;
<a name="l00291"></a>00291 }
<a name="l00292"></a><a class="code" href="classVarDatFile.html#ade68053131c1d1ddd635f526f93e4ff3">00292</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#ade68053131c1d1ddd635f526f93e4ff3" title="Reads a single line.">VarDatFile::ReadLine</a>(<span class="keywordtype">char</span> *cLine,<span class="keywordtype">double</span> *sLine){
<a name="l00293"></a>00293   <span class="keywordtype">int</span> iLen = (int) (strlen(cLine));
<a name="l00294"></a>00294   <span class="keywordflow">if</span>(cLine[0] == <span class="charliteral">&#39; &#39;</span> || cLine[0] == <span class="charliteral">&#39;\t&#39;</span>){
<a name="l00295"></a>00295     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;iLen;i++){
<a name="l00296"></a>00296       <span class="keywordflow">if</span>(cLine[i] != <span class="charliteral">&#39; &#39;</span> &amp;&amp; cLine[i] != <span class="charliteral">&#39;\t&#39;</span>){
<a name="l00297"></a>00297    cLine += i;
<a name="l00298"></a>00298    <span class="keywordflow">break</span>;
<a name="l00299"></a>00299       }
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301   }
<a name="l00302"></a>00302   sscanf(cLine,<span class="stringliteral">&quot;%lf&quot;</span>,sLine);
<a name="l00303"></a>00303   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0,v=1;i&lt;iLen;i++){
<a name="l00304"></a>00304     <span class="keywordflow">if</span>(cLine[i]==<span class="charliteral">&#39;#&#39;</span>) <span class="keywordflow">return</span> 1;
<a name="l00305"></a>00305     <span class="keywordflow">if</span>(v&gt;=NVar) <span class="keywordflow">return</span> 0;
<a name="l00306"></a>00306     <span class="keywordflow">if</span>(cLine[i]==<span class="charliteral">&#39; &#39;</span> || cLine[i] ==<span class="charliteral">&#39;\n&#39;</span> || cLine[i]==<span class="charliteral">&#39;\t&#39;</span>){
<a name="l00307"></a>00307       sscanf(cLine+i,<span class="stringliteral">&quot;%lf&quot;</span>,sLine+v);
<a name="l00308"></a>00308       <span class="comment">//printf(&quot;%d) %d %s %lf\n&quot;,v,i,cLine+i,st[v]);</span>
<a name="l00309"></a>00309       i++;
<a name="l00310"></a>00310       v++;
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312   }
<a name="l00313"></a>00313   <span class="keywordflow">return</span> 0;
<a name="l00314"></a>00314 }
<a name="l00315"></a><a class="code" href="classVarDatFile.html#acfb2b7579c38d629e6585e6f60373783">00315</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#ade68053131c1d1ddd635f526f93e4ff3" title="Reads a single line.">VarDatFile::ReadLine</a>(FILE *InFile, <span class="keyword">const</span> <span class="keywordtype">char</span> *Format, ...){
<a name="l00316"></a>00316   va_list ap;
<a name="l00317"></a>00317   <span class="keywordtype">int</span> NVariable;
<a name="l00318"></a>00318   <span class="keywordtype">char</span> line[256];
<a name="l00319"></a>00319   va_start(ap, Format);
<a name="l00320"></a>00320   fgets(line, 256, InFile);
<a name="l00321"></a>00321   NVariable = vsscanf(line, Format, ap);
<a name="l00322"></a>00322   va_end(ap);
<a name="l00323"></a>00323   <span class="keywordflow">return</span> NVariable;
<a name="l00324"></a>00324 }
<a name="l00325"></a><a class="code" href="classVarDatFile.html#a982e54013ecdf9dcadead5247def28be">00325</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a982e54013ecdf9dcadead5247def28be" title="Average of all ordinate.">VarDatFile::AverageOrdinate</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">double</span> *Distr,<span class="keywordtype">double</span> *xBound){
<a name="l00326"></a>00326   <span class="keywordtype">double</span> *Count = (<span class="keywordtype">double</span> *)calloc(<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00327"></a>00327   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00328"></a>00328     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00329"></a>00329       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00330"></a>00330       <span class="keywordflow">if</span>(isnan(st[v][n]))<span class="keywordflow">continue</span>;
<a name="l00331"></a>00331       <span class="keywordtype">int</span> bx = (int)((<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n) - xBound[0])*xBound[1]*<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>);
<a name="l00332"></a>00332       <span class="keywordflow">if</span>(bx &lt; 0 || bx &gt;= NBin) <span class="keywordflow">continue</span>;
<a name="l00333"></a>00333       Distr[bx] += st[v][n];
<a name="l00334"></a>00334       Count[bx] += 1.;
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> bx=0;bx&lt;<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>;bx++){
<a name="l00338"></a>00338     Distr[bx] /= Count[bx] &gt; 0. ? Count[bx] : 1.;
<a name="l00339"></a>00339   }
<a name="l00340"></a>00340   free(Count);
<a name="l00341"></a>00341 }
<a name="l00342"></a><a class="code" href="classVarDatFile.html#a176c9a10a842e30206fe1ebece6917dc">00342</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a176c9a10a842e30206fe1ebece6917dc" title="Distribution of a signal.">VarDatFile::DistrSegnale</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> IfNorm){
<a name="l00343"></a>00343   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a39b05b88f4b8ec478bd4da89c0e469d0" title="Moments of a signal.">Distribuzione</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin,dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,IfNorm);
<a name="l00344"></a>00344 }
<a name="l00345"></a><a class="code" href="classVarDatFile.html#a82c1693acb4e233005f36e72e10d8f84">00345</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a82c1693acb4e233005f36e72e10d8f84" title="Logarithmic distribution of a signal.">VarDatFile::DistrLogSegnale</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> IfNorm){
<a name="l00346"></a>00346   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00347"></a>00347   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00348"></a>00348     Punti[n] = log10(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>[n]);
<a name="l00349"></a>00349   }
<a name="l00350"></a>00350   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a39b05b88f4b8ec478bd4da89c0e469d0" title="Moments of a signal.">Distribuzione</a>(Punti+ElMin,ElMax-ElMin,dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,IfNorm);
<a name="l00351"></a>00351 }
<a name="l00352"></a><a class="code" href="classVarDatFile.html#a368bdb3c4de9a07c0ce1ea7edb331778">00352</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a368bdb3c4de9a07c0ce1ea7edb331778" title="Exponential distribution of a signal.">VarDatFile::DistrExpSegnale</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> IfNorm){
<a name="l00353"></a>00353   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00354"></a>00354   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00355"></a>00355     Punti[n] = exp(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>[n]);
<a name="l00356"></a>00356   }
<a name="l00357"></a>00357   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a39b05b88f4b8ec478bd4da89c0e469d0" title="Moments of a signal.">Distribuzione</a>(Punti+ElMin,ElMax-ElMin,dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,IfNorm);
<a name="l00358"></a>00358 }
<a name="l00359"></a><a class="code" href="classVarDatFile.html#a86ca74545b082ee1b6fc140c2d56b943">00359</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a176c9a10a842e30206fe1ebece6917dc" title="Distribution of a signal.">VarDatFile::DistrSegnale</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">double</span> *Border,<span class="keywordtype">int</span> IfNorm){
<a name="l00360"></a>00360   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a39b05b88f4b8ec478bd4da89c0e469d0" title="Moments of a signal.">Distribuzione</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin,dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,Border,IfNorm);
<a name="l00361"></a>00361 }
<a name="l00362"></a><a class="code" href="classVarDatFile.html#a418f05ea3f8e69dbc49adeccddbb8d66">00362</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a418f05ea3f8e69dbc49adeccddbb8d66" title="Distribution of a signal with error.">VarDatFile::DistrSignErr</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">double</span> *Border,<span class="keywordtype">int</span> IfNorm){
<a name="l00363"></a>00363   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a5e8fb8fff251f8594af3f6ec809bdd46" title="Moments and histogram of a signal between two values.">DistrErr</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin,dInter,dError,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,Border,IfNorm);
<a name="l00364"></a>00364 }
<a name="l00365"></a><a class="code" href="classVarDatFile.html#ab0b5ef5ddc23685148eda453b09ba2f5">00365</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ab0b5ef5ddc23685148eda453b09ba2f5" title="Distributions of data organized in different samples.">VarDatFile::DistrSignSample</a>(<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax,<span class="keywordtype">double</span> **Distr,<span class="keywordtype">int</span> NSample,<span class="keywordtype">int</span> IfNorm,<span class="keywordtype">double</span> *xBound){
<a name="l00366"></a>00366   <a class="code" href="classMatematica.html#ab160279d67e4266427d7de4983249bd4" title="Compare the distribution of a sample of data.">DistrSample</a>(st[0]+ElMin,<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin,Distr,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,NSample,IfNorm,xBound);
<a name="l00367"></a>00367 }
<a name="l00368"></a><a class="code" href="classVarDatFile.html#ac5e7b70f512f6a7a4dd83e942a65537a">00368</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#ac5e7b70f512f6a7a4dd83e942a65537a" title="Tests a gaussian distribution of the signal.">VarDatFile::DistrGaussSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> IfNorm){
<a name="l00369"></a>00369   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a558ecd17e8fec096693541f1d83545ae" title="Look for the Gaussian distribution.">DistribuzioneGauss</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin,dInter,dInter1,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>,IfNorm);
<a name="l00370"></a>00370 }
<a name="l00371"></a><a class="code" href="classVarDatFile.html#acc46e4201d7bdf288601a253bd569ed0">00371</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#acc46e4201d7bdf288601a253bd569ed0" title="Weighted distribution.">VarDatFile::WeightAverageSet</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin, <span class="keywordtype">int</span> ElMax){
<a name="l00372"></a>00372   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00373"></a>00373   <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> m1 = <a class="code" href="classMatematica.html#a54768724636e1877a0f515037f9c1dfd" title="Calculate the weighted average.">WeightAverage</a>(st[CoordX]+ElMin,<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin);
<a name="l00374"></a>00374   <span class="keywordflow">return</span> m1;
<a name="l00375"></a>00375 }
<a name="l00376"></a><a class="code" href="classVarDatFile.html#ab6e65ce9879959397314adb9c1f3d5e6">00376</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#ab6e65ce9879959397314adb9c1f3d5e6" title="Do a generic elaboration.">VarDatFile::ElabSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00377"></a>00377   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00378"></a>00378   <span class="comment">//  Elabora(sp+ElMin,Punti,ElMax-ElMin);</span>
<a name="l00379"></a>00379   <a class="code" href="classMatematica.html#aef286a585b6e7d30107ba8f36032e3ad" title="Pointer to a function which operates on.">ElabSt</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,Punti,ElMax-ElMin);
<a name="l00380"></a>00380   <span class="keywordflow">return</span> ElMax-ElMin;
<a name="l00381"></a>00381 }
<a name="l00382"></a><a class="code" href="classVarDatFile.html#a9aaf71e7c7f27423252d8359f746e4ff">00382</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a9aaf71e7c7f27423252d8359f746e4ff" title="Autocorrelation of the signal.">VarDatFile::AutocorSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00383"></a>00383   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00384"></a>00384   <a class="code" href="classMatematica.html#a6410e1f3b747f1e313e9d3bcffe004ce" title="Compute the autocorrelation of a boolean signal.">Autocor</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,Punti,ElMax-ElMin);
<a name="l00385"></a>00385   NMaxPunti = NMax/2;
<a name="l00386"></a>00386   <span class="keywordflow">return</span> NMaxPunti;
<a name="l00387"></a>00387 }
<a name="l00388"></a><a class="code" href="classVarDatFile.html#a1454407975f3283a2786d1f5a30c537f">00388</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a1454407975f3283a2786d1f5a30c537f" title="Calculate the spectrum.">VarDatFile::SpettroSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00389"></a>00389   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00390"></a>00390   <a class="code" href="classMatematica.html#abe4888052d3a0b30d84f2b4c7a523328" title="Compute the spectrum.">Spettro</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,Punti,ElMax-ElMin);
<a name="l00391"></a>00391   NMaxPunti = NMax;
<a name="l00392"></a>00392   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)( (NMax));
<a name="l00393"></a>00393 }
<a name="l00394"></a><a class="code" href="classVarDatFile.html#a3a27fb16efc015da73aeb6d511d87252">00394</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a3a27fb16efc015da73aeb6d511d87252" title="Spectrum of a sequence of lines.">VarDatFile::SpeLine</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> NBin,<span class="keywordtype">double</span> *Spe){
<a name="l00395"></a>00395 <span class="preprocessor">#ifdef USE_FFTW</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span>  <span class="keywordtype">double</span> InvNBin = 1./(double)(NBin);
<a name="l00397"></a>00397   fftw_complex *out = (fftw_complex *)fftw_malloc(NBin*<span class="keyword">sizeof</span>(fftw_complex));
<a name="l00398"></a>00398   fftw_complex *in = (fftw_complex *)fftw_malloc(NBin*<span class="keyword">sizeof</span>(fftw_complex));
<a name="l00399"></a>00399   fftw_plan plan = fftw_plan_dft_1d(NBin,in,out,FFTW_FORWARD,FFTW_ESTIMATE);
<a name="l00400"></a>00400   fftw_plan plan2 = fftw_plan_dft_1d(NBin,out,in,FFTW_BACKWARD,FFTW_ESTIMATE);
<a name="l00401"></a>00401   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00402"></a>00402     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l00403"></a>00403     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>;n++) in[n][0] = st[v][n];
<a name="l00404"></a>00404     fftw_execute(plan);
<a name="l00405"></a>00405     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>;n++){
<a name="l00406"></a>00406       Spe[n] += SQR(out[n][0]) + SQR(out[n][1]);
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409   fftw_free(out);
<a name="l00410"></a>00410   fftw_free(in);
<a name="l00411"></a>00411 <span class="preprocessor">#else</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>  printf(<span class="stringliteral">&quot;fftw not present\n&quot;</span>);
<a name="l00413"></a>00413 <span class="preprocessor">#endif</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span>}
<a name="l00415"></a><a class="code" href="classVarDatFile.html#a2f01ea77260e98cb7edbb892988fd687">00415</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a2f01ea77260e98cb7edbb892988fd687" title="Normalize the intervals.">VarDatFile::NormalizzaInter</a>(){
<a name="l00416"></a>00416   <a class="code" href="classMatematica.html#aa51fbe747c2dcd8d72980b9624be93a1" title="Normalize.">Normalizza</a>(dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>);
<a name="l00417"></a>00417 }
<a name="l00418"></a><a class="code" href="classVarDatFile.html#a0e495e387b74aaa6d55510a945236064">00418</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a0e495e387b74aaa6d55510a945236064" title="Normalize the signal.">VarDatFile::NormalizzaSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00419"></a>00419   <span class="keywordtype">int</span> Campioni = <a class="code" href="classMatematica.html#ac3425ea4b3f1bc9999c7b6442b106ebe" title="Normalize.">NormalizeArea</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,ElMax-ElMin);
<a name="l00420"></a>00420   <span class="keywordflow">return</span> Campioni;
<a name="l00421"></a>00421 }
<a name="l00422"></a><a class="code" href="classVarDatFile.html#ab68c66ee2972197a35b5225793337637">00422</a> <span class="keywordtype">bool</span> <a class="code" href="classVarDatFile.html#ab68c66ee2972197a35b5225793337637" title="Transforms the signal into its square root.">VarDatFile::RadiceSegnale</a>(){
<a name="l00423"></a>00423   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00424"></a>00424   <a class="code" href="classMatematica.html#aeac3632a9ced53cee7f0bda92208dd07" title="Compute the root of the signal.">Radice</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,Punti,NMax);
<a name="l00425"></a>00425   <span class="keywordflow">return</span> 1;
<a name="l00426"></a>00426 }
<a name="l00427"></a><a class="code" href="classVarDatFile.html#a43b771dc3214a9a36b2aa2a91ffb8edb">00427</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a43b771dc3214a9a36b2aa2a91ffb8edb" title="Numerical integration of the signal.">VarDatFile::IntSegnale</a>(){
<a name="l00428"></a>00428   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00429"></a>00429   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a7f6e9a0a72348c10d08e388e75978d25" title="Integral of.">Integrazione</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,Punti,NMax);
<a name="l00430"></a>00430 }
<a name="l00431"></a><a class="code" href="classVarDatFile.html#a6489d2b859470a4e034bc4f795336ae8">00431</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a6489d2b859470a4e034bc4f795336ae8" title="Sum the values between ElMin and ElMax.">VarDatFile::SumSegnale</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00432"></a>00432   <span class="keywordtype">double</span> Resp = 0.;
<a name="l00433"></a>00433   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00434"></a>00434   <span class="keywordtype">double</span> Dx = (st[CoordX][ElMax]-st[CoordX][ElMin]);
<a name="l00435"></a>00435   <span class="keywordtype">double</span> NumInv = 1./(double)(ElMax-ElMin);
<a name="l00436"></a>00436   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=ElMin;i&lt;ElMax;i++){
<a name="l00437"></a>00437     Resp += st[CoordY][ElMax];
<a name="l00438"></a>00438   }
<a name="l00439"></a>00439   <span class="keywordflow">return</span> Resp*Dx*NumInv;
<a name="l00440"></a>00440 }
<a name="l00441"></a><a class="code" href="classVarDatFile.html#a7a3685f3878bcb9e05a16bdadface9f9">00441</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a7a3685f3878bcb9e05a16bdadface9f9" title="Sums all the yCoordinates.">VarDatFile::SommaSegnali</a>(){
<a name="l00442"></a>00442   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00443"></a>00443   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nm=0;nm&lt;NMax;nm++){ 
<a name="l00444"></a>00444     Punti[nm] = 0.;
<a name="l00445"></a>00445     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nv=0;nv&lt;NVar;nv++){
<a name="l00446"></a>00446       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(nv)) <span class="keywordflow">continue</span>;
<a name="l00447"></a>00447       Punti[nm] += st[nv][nm];
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450 }
<a name="l00451"></a><a class="code" href="classVarDatFile.html#aa8c3dec822e735ee8835f0e19d8b15a3">00451</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#af79a8603c9c35b3f0b3018090697fca8" title="Points the function Elab to the square gradient, probably not working.">VarDatFile::VarieSegnale</a>(<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax){
<a name="l00452"></a>00452   <span class="keywordflow">if</span>(NVar &lt; 2) <span class="keywordflow">return</span> 0.;
<a name="l00453"></a>00453   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00454"></a>00454   <span class="keywordtype">double</span> *temp1 = (<span class="keywordtype">double</span> *)malloc(NMax*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00455"></a>00455   <span class="keywordtype">double</span> *temp2 = (<span class="keywordtype">double</span> *)malloc(NMax*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00456"></a>00456   <span class="keywordtype">double</span> VolA=0.,VolB=0.;
<a name="l00457"></a>00457   <span class="keywordtype">double</span> VolFracA=0.,VolFracB=0.;
<a name="l00458"></a>00458   <span class="keywordtype">double</span> SqrGradCoeff=0.;
<a name="l00459"></a>00459   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00460"></a>00460     temp1[n] = 0.;
<a name="l00461"></a>00461     temp2[n] = 0.;
<a name="l00462"></a>00462   }
<a name="l00463"></a>00463   <span class="keywordtype">double</span> Coeff[4] = {1.,0.,0.,1.};
<a name="l00464"></a>00464   <span class="keywordtype">double</span> MaxA=0.,MaxB=0.;
<a name="l00465"></a>00465   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00466"></a>00466     <span class="keywordflow">if</span>(MaxA &lt; st[1][n]) MaxA = st[1][n];
<a name="l00467"></a>00467     <span class="keywordflow">if</span>(MaxB &lt; st[2][n]) MaxB = st[2][n];
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00470"></a>00470     <span class="keywordflow">if</span>(st[1][n] &gt; MaxA*.5)
<a name="l00471"></a>00471       VolA += 1.;
<a name="l00472"></a>00472     <span class="keywordflow">if</span>(st[2][n] &gt; MaxB*.5)
<a name="l00473"></a>00473       VolB += 1.;
<a name="l00474"></a>00474   }
<a name="l00475"></a>00475   VolFracA = VolA / (VolA + VolB);
<a name="l00476"></a>00476   VolFracB = VolB / (VolA + VolB);
<a name="l00477"></a>00477   SqrGradCoeff = 19.13/(24.*VolFracA*VolA)+3.04/(24.*VolFracB*VolB);
<a name="l00478"></a>00478   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[1];
<a name="l00479"></a>00479   <a class="code" href="classMatematica.html#a0ffa5ec4ebf021c7e8b2e79bed9524e1" title="Derivate O(4) of.">DerO4</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,temp1,ElMax-ElMin);
<a name="l00480"></a>00480   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[2];
<a name="l00481"></a>00481   <a class="code" href="classMatematica.html#a0ffa5ec4ebf021c7e8b2e79bed9524e1" title="Derivate O(4) of.">DerO4</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>+ElMin,temp2,ElMax-ElMin);
<a name="l00482"></a>00482   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++){
<a name="l00483"></a>00483     Coeff[i] *= SqrGradCoeff;
<a name="l00484"></a>00484   }
<a name="l00485"></a>00485   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00486"></a>00486     Punti[n] = Coeff[0]*temp1[n]*temp1[n];
<a name="l00487"></a>00487     Punti[n] += Coeff[1]*temp1[n]*temp2[n];
<a name="l00488"></a>00488     Punti[n] += Coeff[2]*temp2[n]*temp1[n];
<a name="l00489"></a>00489     Punti[n] += Coeff[3]*temp2[n]*temp2[n];
<a name="l00490"></a>00490     Punti[n] /= 2.;
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492   <span class="keywordtype">double</span> Risp=0.;
<a name="l00493"></a>00493   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=75;n&lt;125;n++){
<a name="l00494"></a>00494     Risp += Punti[n];
<a name="l00495"></a>00495   }
<a name="l00496"></a>00496   free(temp1);
<a name="l00497"></a>00497   free(temp2);
<a name="l00498"></a>00498   <span class="keywordflow">return</span> Risp;
<a name="l00499"></a>00499 }
<a name="l00500"></a><a class="code" href="classVarDatFile.html#ad705e28f47a98707e3dd3c83d86e85b3">00500</a> <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> <a class="code" href="classVarDatFile.html#ad705e28f47a98707e3dd3c83d86e85b3" title="Computes a liner fit.">VarDatFile::InterRettSegnale</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> LogLog){
<a name="l00501"></a>00501   <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1;
<a name="l00502"></a>00502   <span class="keywordtype">double</span> *Puntix;
<a name="l00503"></a>00503   <span class="keywordtype">double</span> *Puntiy;
<a name="l00504"></a>00504   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00505"></a>00505   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGX)){
<a name="l00506"></a>00506     Puntix = (<span class="keywordtype">double</span> *)calloc(ElMax-ElMin,<span class="keyword">sizeof</span>(*Puntix));
<a name="l00507"></a>00507     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=ElMin;i&lt;ElMax;i++){
<a name="l00508"></a>00508       <span class="keywordflow">if</span>(st[CoordX][i] &gt; 0.)
<a name="l00509"></a>00509    Puntix[i-ElMin] = log10(st[CoordX][i]);
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511   }
<a name="l00512"></a>00512   <span class="keywordflow">else</span>{
<a name="l00513"></a>00513     Puntix = st[CoordX]+ElMin;
<a name="l00514"></a>00514   }
<a name="l00515"></a>00515   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGY)){
<a name="l00516"></a>00516     Puntiy = (<span class="keywordtype">double</span> *)calloc(ElMax-ElMin,<span class="keyword">sizeof</span>(*Puntiy));
<a name="l00517"></a>00517     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=ElMin;i&lt;ElMax;i++){
<a name="l00518"></a>00518       <span class="keywordflow">if</span>(st[CoordY][i] &gt; 0.)
<a name="l00519"></a>00519    Puntiy[i-ElMin] = log10(st[CoordY][i]);
<a name="l00520"></a>00520     }
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522   <span class="keywordflow">else</span>{
<a name="l00523"></a>00523     Puntiy = st[CoordY]+ElMin;
<a name="l00524"></a>00524   }
<a name="l00525"></a>00525   r1 = <a class="code" href="classMatematica.html#a704c5213772cd3d9fd7dd77d74461bf2" title="Linear interpolation.">InterRett</a>(Puntix,Puntiy,ElMax-ElMin);
<a name="l00526"></a>00526   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGX)) free(Puntix);
<a name="l00527"></a>00527   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGY)) free(Puntiy);
<a name="l00528"></a>00528   <span class="keywordflow">return</span> r1;
<a name="l00529"></a>00529 }
<a name="l00530"></a><a class="code" href="classVarDatFile.html#a7e8033bdeb05d587eb6ce7dedf3ffe8b">00530</a> <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> <a class="code" href="classVarDatFile.html#a7e8033bdeb05d587eb6ce7dedf3ffe8b" title="Computes a exponential fit.">VarDatFile::InterExpSegnale</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> LogLog){
<a name="l00531"></a>00531   <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1;
<a name="l00532"></a>00532   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00533"></a>00533   r1 = <a class="code" href="classMatematica.html#a54633464985cd9a4864e2d0245fa231c" title="Exponential interpolation.">InterExp</a>(st[CoordX]+ElMin,st[CoordY]+ElMin,ElMax-ElMin);
<a name="l00534"></a>00534   <span class="keywordflow">return</span> r1;
<a name="l00535"></a>00535 }
<a name="l00536"></a><a class="code" href="classVarDatFile.html#a77d32f56ea66cb8070e708766c7577ea">00536</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classVarDatFile.html#a77d32f56ea66cb8070e708766c7577ea" title="Computes a Gaussian fit.">VarDatFile::InterGaussSegnale</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> LogLog){
<a name="l00537"></a>00537   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00538"></a>00538   <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> m1 = <a class="code" href="classMatematica.html#ae9688b8f498233bf332032c7dafc1982" title="Gaussian interpolation.">InterGauss</a>(st[CoordX]+ElMin,st[CoordY]+ElMin,ElMax-ElMin);
<a name="l00539"></a>00539   <span class="keywordflow">return</span> m1;
<a name="l00540"></a>00540 }
<a name="l00541"></a><a class="code" href="classVarDatFile.html#a670b0120b56b71deeb92a07dbc2d1a93">00541</a> <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> <a class="code" href="classVarDatFile.html#a670b0120b56b71deeb92a07dbc2d1a93" title="Computes a parabolic fit.">VarDatFile::ParabolaSegnale</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> ElMin,<span class="keywordtype">int</span> ElMax,<span class="keywordtype">int</span> LogLog){
<a name="l00542"></a>00542   <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> p1;
<a name="l00543"></a>00543   <span class="keywordtype">double</span> *Puntix;
<a name="l00544"></a>00544   <span class="keywordtype">double</span> *Puntiy;
<a name="l00545"></a>00545   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00546"></a>00546   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGX)){
<a name="l00547"></a>00547     Puntix = (<span class="keywordtype">double</span> *)calloc(ElMax-ElMin,<span class="keyword">sizeof</span>(*Puntix));
<a name="l00548"></a>00548     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=ElMin;i&lt;ElMax;i++){
<a name="l00549"></a>00549       <span class="keywordflow">if</span>(st[CoordX][i] &gt; 0.)
<a name="l00550"></a>00550    Puntix[i] = log(st[CoordX][i]);
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552   }
<a name="l00553"></a>00553   <span class="keywordflow">else</span>{
<a name="l00554"></a>00554     Puntix = st[CoordX];
<a name="l00555"></a>00555   }
<a name="l00556"></a>00556   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGY)){
<a name="l00557"></a>00557     Puntiy = (<span class="keywordtype">double</span> *)calloc(ElMax-ElMin,<span class="keyword">sizeof</span>(*Puntix));
<a name="l00558"></a>00558     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=ElMin;i&lt;ElMax;i++){
<a name="l00559"></a>00559       <span class="keywordflow">if</span>(st[CoordY][i] &gt; 0.)
<a name="l00560"></a>00560    Puntiy[i] = log10(st[CoordY][i]);
<a name="l00561"></a>00561     }
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563   <span class="keywordflow">else</span>{
<a name="l00564"></a>00564     Puntiy = st[CoordY];
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566   p1 = <a class="code" href="classMatematica.html#a90a6e30254a3d26a422a173cdc46a823" title="Minimum of the Parabola between.">MinimoParabola</a>(Puntix+ElMin,Puntiy+ElMin,ElMax-ElMin);
<a name="l00567"></a>00567   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGX))
<a name="l00568"></a>00568     free(Puntix);
<a name="l00569"></a>00569   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGY))
<a name="l00570"></a>00570     free(Puntiy);
<a name="l00571"></a>00571   <span class="keywordflow">return</span> p1;
<a name="l00572"></a>00572 }
<a name="l00573"></a><a class="code" href="classVarDatFile.html#af61093b90aceaaeaabfaf6364db43abf">00573</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#af61093b90aceaaeaabfaf6364db43abf" title="Running average.">VarDatFile::MediaMobSegnale</a>(<span class="keywordtype">int</span> n){
<a name="l00574"></a>00574   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00575"></a>00575   NMaxPunti = <a class="code" href="classMatematica.html#a99d5aa828752a12f2c5bc2033e00d0ad" title="Running average.">MediaMobile</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,NMax,Punti,PuntiErr,n);
<a name="l00576"></a>00576   <span class="keywordflow">return</span> NMaxPunti;
<a name="l00577"></a>00577 }
<a name="l00578"></a><a class="code" href="classVarDatFile.html#ad6521d627ba809d5e253cefcd5090491">00578</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#ad6521d627ba809d5e253cefcd5090491" title="Weighted histogram analysis.">VarDatFile::WeightHistoSign</a>(<span class="keywordtype">int</span> NHisto){
<a name="l00579"></a>00579   <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a> = NMax;
<a name="l00580"></a>00580   <span class="keywordtype">double</span> **Histo = (<span class="keywordtype">double</span> **)calloc(NHisto,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00581"></a>00581   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> h=0;h&lt;NHisto;h++){
<a name="l00582"></a>00582     Histo[h] = (<span class="keywordtype">double</span> *)calloc(NBin,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00583"></a>00583   }
<a name="l00584"></a>00584   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0,h=0;v&lt;NVar;v++){
<a name="l00585"></a>00585     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00586"></a>00586     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>;b++){
<a name="l00587"></a>00587       Histo[h][b] = st[v][b];
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589     h++;
<a name="l00590"></a>00590   }
<a name="l00592"></a>00592   <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(0,NBin);  
<a name="l00593"></a>00593   <span class="keywordtype">double</span> Border[2] = {xGlobMin,xGlobMax};
<a name="l00594"></a>00594   <span class="keywordtype">double</span> tolerance = 0.00001;
<a name="l00595"></a>00595   <span class="keywordtype">double</span> *NanoDist = (<span class="keywordtype">double</span> *)calloc(NHisto,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00596"></a>00596   <span class="keywordtype">double</span> *kSpring = (<span class="keywordtype">double</span> *)calloc(NHisto,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00597"></a>00597   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> h=0;h&lt;NHisto;h++){
<a name="l00598"></a>00598     kSpring[h] = Histo[h][NBin-2];
<a name="l00599"></a>00599     NanoDist[h] = Histo[h][NBin-1];
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601   <span class="comment">// NanoDist[1]=3.5;</span>
<a name="l00602"></a>00602   <span class="comment">// NanoDist[2]=4.0;</span>
<a name="l00603"></a>00603   <span class="comment">// NanoDist[3]=5.07;                      </span>
<a name="l00604"></a>00604   <span class="comment">// NanoDist[4]=5.6;                 </span>
<a name="l00605"></a>00605   <span class="comment">// NanoDist[5]=6.4;</span>
<a name="l00606"></a>00606   <span class="comment">// NanoDist[6]=7.2;                     </span>
<a name="l00607"></a>00607   <span class="comment">// NanoDist[7]=8;</span>
<a name="l00608"></a>00608   <span class="comment">// NanoDist[8]=8.8;                          </span>
<a name="l00609"></a>00609   <span class="comment">// NanoDist[9]=9.6;</span>
<a name="l00610"></a>00610   <span class="comment">// NanoDist[10]=10.4;                        </span>
<a name="l00611"></a>00611   <span class="comment">// NanoDist[11]=10.76;</span>
<a name="l00612"></a>00612   <span class="comment">// NanoDist[12]=11.56;               </span>
<a name="l00613"></a>00613   <span class="comment">// NanoDist[13]=12.8;</span>
<a name="l00614"></a>00614   <a class="code" href="classMatematica.html#abfe1241dc3eb4896ae7e45cf740aebde" title="Weighted histogram analysis.">WeightHisto</a>(Histo,Border,NBin-2,NHisto,tolerance,NanoDist,kSpring);
<a name="l00615"></a>00615   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> h=0;h&lt;NHisto;h++)
<a name="l00616"></a>00616     free(Histo[h]);
<a name="l00617"></a>00617   free(Histo);
<a name="l00618"></a>00618   free(NanoDist);
<a name="l00619"></a>00619   free(kSpring);
<a name="l00620"></a>00620 }
<a name="l00621"></a><a class="code" href="classVarDatFile.html#aa6212bdcf240e866f234a41d6b98a224">00621</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#aa6212bdcf240e866f234a41d6b98a224" title="To point correlation at a distance dist.">VarDatFile::CorrelaADuePunti</a>(<span class="keywordtype">int</span> n){
<a name="l00622"></a>00622   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00623"></a>00623   NMaxPunti = <a class="code" href="classMatematica.html#acc472956dae6f7628bad8d4ca7f7ed68" title="Two points correlation.">CorrelaDuePunti</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,NMax,Punti,n);
<a name="l00624"></a>00624   <span class="keywordflow">return</span> NMaxPunti;
<a name="l00625"></a>00625 }
<a name="l00626"></a><a class="code" href="classVarDatFile.html#ae1058d878c5370add56411e3998b9d51">00626</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ae1058d878c5370add56411e3998b9d51" title="Selfsimilarity.">VarDatFile::AutosimilaritaSegnale</a>(<span class="keywordtype">int</span> n){
<a name="l00627"></a>00627   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l00628"></a>00628   <a class="code" href="classMatematica.html#ac6fad3beb60e7a8d3b35e40a1eb98fb3" title="Self similarity.">Autosimilarita</a>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>,NMax,Punti,n);
<a name="l00629"></a>00629   NMaxPunti = NMax;
<a name="l00630"></a>00630 }
<a name="l00631"></a><a class="code" href="classVarDatFile.html#af0b16f63863e97d7c86f9ac00e67f11b">00631</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#af0b16f63863e97d7c86f9ac00e67f11b" title="Reallocate the pointer dInter dInter1.">VarDatFile::CambiaNBin</a>(<span class="keywordtype">int</span> n){
<a name="l00632"></a>00632   <span class="keywordflow">if</span>(n &lt; 0)
<a name="l00633"></a>00633     <span class="keywordflow">return</span>;
<a name="l00634"></a>00634   <a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a> = n;
<a name="l00635"></a>00635   dInter = (<span class="keywordtype">double</span> *)realloc(dInter,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00636"></a>00636   dInter1 = (<span class="keywordtype">double</span> *)realloc(dInter1,<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00637"></a>00637 }
<a name="l00638"></a><a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613">00638</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">VarDatFile::Punta</a>(<span class="keywordtype">int</span> n){
<a name="l00639"></a>00639   <span class="keywordflow">if</span>(n &lt; 0 || n &gt; NVar) 
<a name="l00640"></a>00640     <span class="keywordflow">return</span>;
<a name="l00641"></a>00641   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[n];
<a name="l00642"></a>00642 }
<a name="l00643"></a><a class="code" href="classVarDatFile.html#a3459dd82527a16fe552b58f9bbb3beca">00643</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">VarDatFile::Punta</a>(<span class="keywordtype">double</span> *spExt,<span class="keywordtype">int</span> n){
<a name="l00644"></a>00644   <span class="keywordflow">if</span>(n &lt; 0 || n &gt;= NVar) 
<a name="l00645"></a>00645     <span class="keywordflow">return</span>;
<a name="l00646"></a>00646   spExt = st[n];
<a name="l00647"></a>00647 }
<a name="l00648"></a><a class="code" href="classVarDatFile.html#ad4ea52d09ccc5d7b38b2952c4fdaa1a6">00648</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ad4ea52d09ccc5d7b38b2952c4fdaa1a6" title="Point the internal pointer to an external memory.">VarDatFile::PuntaInt</a>(<span class="keywordtype">double</span> *spExt){
<a name="l00649"></a>00649   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = spExt;
<a name="l00650"></a>00650 }
<a name="l00651"></a><a class="code" href="classVarDatFile.html#ad2642e22b919be30857ed370e8d22acc">00651</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a9bb9fb6bb48e6c597ba31a271e1be613" title="Points to a different column.">VarDatFile::Punta</a>(<span class="keywordtype">double</span> **ExtSt,<span class="keywordtype">int</span> n){
<a name="l00652"></a>00652   <span class="keywordflow">if</span>(n &lt;0 || n&gt;NVar) 
<a name="l00653"></a>00653     <span class="keywordflow">return</span>;
<a name="l00654"></a>00654   st = ExtSt;
<a name="l00655"></a>00655   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = ExtSt[n];
<a name="l00656"></a>00656 }
<a name="l00657"></a><a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f">00657</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">VarDatFile::Val</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> n){
<a name="l00658"></a>00658 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00659"></a>00659 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(n&lt;0 || n&gt;NMax-1 ){printf(<span class="stringliteral">&quot;Wrong row\n&quot;</span>);<span class="keywordflow">return</span> 0.;}
<a name="l00660"></a>00660   <span class="keywordflow">if</span>(CoordY&lt;0 || v&gt;<a class="code" href="classVarDatFile.html#a6a683d7b3c08aafd7a5329b0d293eab6" title="Number of point of the distribution.">NBin</a>-1){printf(<span class="stringliteral">&quot;Wrong col\n&quot;</span>); <span class="keywordflow">return</span> 0.;}
<a name="l00661"></a>00661 <span class="preprocessor">#endif</span>
<a name="l00662"></a>00662 <span class="preprocessor"></span>  <span class="keywordflow">return</span> st[CoordY][n];
<a name="l00663"></a>00663 }
<a name="l00664"></a><a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27">00664</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">VarDatFile::pNRow</a>(<span class="keywordtype">int</span> CoordY){
<a name="l00665"></a>00665   <span class="keywordflow">return</span> SetNMax[CoordY];
<a name="l00666"></a>00666 }
<a name="l00667"></a><a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15">00667</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">VarDatFile::Abscissa</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> n){
<a name="l00668"></a>00668 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00669"></a>00669 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(CoordY&lt;0 || n&gt;NMax-1){ printf(<span class="stringliteral">&quot;Wrong row\n&quot;</span>);<span class="keywordflow">return</span> 0.;}
<a name="l00670"></a>00670 <span class="preprocessor">#endif</span>
<a name="l00671"></a>00671 <span class="preprocessor"></span>  <span class="keywordflow">return</span> st[RefAbsc[CoordY]][n];
<a name="l00672"></a>00672 }
<a name="l00673"></a><a class="code" href="classVarDatFile.html#aceb09b397fee83699a8b810fcaa02d26">00673</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#aceb09b397fee83699a8b810fcaa02d26" title="Value of the elaborated array at position.">VarDatFile::pPunti</a>(<span class="keywordtype">int</span> n){
<a name="l00674"></a>00674 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00675"></a>00675 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(n&lt;0 || n&gt;NMax-1){ printf(<span class="stringliteral">&quot;Wrong row\n&quot;</span>);<span class="keywordflow">return</span> 0.;}
<a name="l00676"></a>00676   <span class="keywordflow">if</span>(IfPuntiAlloc) <span class="keywordflow">return</span> 0.;
<a name="l00677"></a>00677 <span class="preprocessor">#endif</span>
<a name="l00678"></a>00678 <span class="preprocessor"></span>  <span class="keywordflow">return</span> Punti[n];
<a name="l00679"></a>00679 }
<a name="l00680"></a><a class="code" href="classVarDatFile.html#a3a14794e0583788d1cd614bfa4aa4a17">00680</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a3a14794e0583788d1cd614bfa4aa4a17" title="Value of the error array at postion.">VarDatFile::pPuntiErr</a>(<span class="keywordtype">int</span> n){
<a name="l00681"></a>00681 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(n&lt;0 || n&gt;NMax-1){ printf(<span class="stringliteral">&quot;Wrong row\n&quot;</span>);<span class="keywordflow">return</span> 0.;}
<a name="l00683"></a>00683   <span class="keywordflow">if</span>(IfPuntiAlloc) <span class="keywordflow">return</span> 0.;
<a name="l00684"></a>00684 <span class="preprocessor">#endif</span>
<a name="l00685"></a>00685 <span class="preprocessor"></span>  <span class="keywordflow">return</span> PuntiErr[n];
<a name="l00686"></a>00686 }
<a name="l00687"></a><a class="code" href="classVarDatFile.html#ac6c6d90214b93afffeab31fd2bbe5715">00687</a> <span class="keywordtype">char</span> *<a class="code" href="classVarDatFile.html#ac6c6d90214b93afffeab31fd2bbe5715" title="Print the header.">VarDatFile::PrintHeader</a>(){
<a name="l00688"></a>00688   <span class="keywordflow">return</span> Header;
<a name="l00689"></a>00689 }
<a name="l00690"></a><a class="code" href="classVarDatFile.html#a9998056e2576481a913421ae6e148179">00690</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a9998056e2576481a913421ae6e148179" title="Print the minimum of.">VarDatFile::PuntiMin</a>(){
<a name="l00691"></a>00691 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00692"></a>00692 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(IfPuntiAlloc) <span class="keywordflow">return</span> 0.;
<a name="l00693"></a>00693 <span class="preprocessor">#endif</span>
<a name="l00694"></a>00694 <span class="preprocessor"></span>  <span class="keywordtype">double</span> Min = Punti[0];
<a name="l00695"></a>00695   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;NMaxPunti;p++)
<a name="l00696"></a>00696     <span class="keywordflow">if</span>(Min &gt; Punti[p])
<a name="l00697"></a>00697       Min = Punti[p];
<a name="l00698"></a>00698   <span class="keywordflow">return</span> Min;
<a name="l00699"></a>00699 }
<a name="l00700"></a><a class="code" href="classVarDatFile.html#a0a3ba11d08ae946dfdf46d0b33047211">00700</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a0a3ba11d08ae946dfdf46d0b33047211" title="Print the maximum of.">VarDatFile::PuntiMax</a>(){
<a name="l00701"></a>00701 <span class="preprocessor">#ifdef FILE_DEBUG</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(IfPuntiAlloc) <span class="keywordflow">return</span> 0.;
<a name="l00703"></a>00703 <span class="preprocessor">#endif</span>
<a name="l00704"></a>00704 <span class="preprocessor"></span>  <span class="keywordtype">double</span> Max = Punti[0];
<a name="l00705"></a>00705   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;NMaxPunti;p++)
<a name="l00706"></a>00706     <span class="keywordflow">if</span>(Max &lt; Punti[p])
<a name="l00707"></a>00707       Max = Punti[p];
<a name="l00708"></a>00708   <span class="keywordflow">return</span> Max;
<a name="l00709"></a>00709 }
<a name="l00710"></a><a class="code" href="classVarDatFile.html#ad399f5baf6ac6cda47416f07b69b3ca8">00710</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ad399f5baf6ac6cda47416f07b69b3ca8" title="Copies Punti in Punti1 to store the information of the already elaborated array, to be fixed...">VarDatFile::CambiaPunti</a>(){
<a name="l00711"></a>00711   <span class="keywordflow">if</span>(!IfPuntiFree)
<a name="l00712"></a>00712     <span class="keywordflow">return</span>;
<a name="l00713"></a>00713   Punti1 = (<span class="keywordtype">double</span> *)realloc(Punti1,NMaxPunti*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00714"></a>00714   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00715"></a>00715     Punti1[n] = Punti[n];
<a name="l00716"></a>00716   }
<a name="l00717"></a>00717   <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = Punti1;
<a name="l00718"></a>00718 }
<a name="l00719"></a><a class="code" href="classVarDatFile.html#a9dcac18006ce057b8d78c847174c1362">00719</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a9dcac18006ce057b8d78c847174c1362" title="Prints the content in memory.">VarDatFile::Print</a>(){
<a name="l00720"></a>00720   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NVar;c++){
<a name="l00721"></a>00721     printf(<span class="stringliteral">&quot;%d &quot;</span>,RefAbsc[c]);
<a name="l00722"></a>00722   }
<a name="l00723"></a>00723   printf(<span class="stringliteral">&quot;\n--------------\n&quot;</span>);
<a name="l00724"></a>00724   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;NMax;r++){
<a name="l00725"></a>00725     printf(<span class="stringliteral">&quot;%d) &quot;</span>,r);
<a name="l00726"></a>00726     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NVar;c++){
<a name="l00727"></a>00727       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(r)) printf(<span class="stringliteral">&quot;%.5g &quot;</span>,<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(r,c));
<a name="l00728"></a>00728       printf(<span class="stringliteral">&quot;%.5g &quot;</span>,st[r][c]);
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730     printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00731"></a>00731   }
<a name="l00732"></a>00732 }
<a name="l00733"></a><a class="code" href="classVarDatFile.html#ae424c3360277f457eba79fd25b4eed3b">00733</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ae424c3360277f457eba79fd25b4eed3b" title="Sort with respect to a coordinate.">VarDatFile::Sort</a>(){
<a name="l00734"></a>00734   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00735"></a>00735     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=i;j&gt;0;j--){
<a name="l00736"></a>00736       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>[j] &lt; <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a>[j-1])
<a name="l00737"></a>00737    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NVar;n++){
<a name="l00738"></a>00738      <a class="code" href="classMatematica.html#a73416c2f40f207ac8a0ee0c620094c8f" title="Swap to indices.">Swap</a>(j,j-1,st[n]);
<a name="l00739"></a>00739    }
<a name="l00740"></a>00740       <span class="keywordflow">else</span>
<a name="l00741"></a>00741    <span class="keywordflow">break</span>;
<a name="l00742"></a>00742     }
<a name="l00743"></a>00743   }
<a name="l00744"></a>00744 }
<a name="l00745"></a><a class="code" href="classVarDatFile.html#a15ad052575da97bec5b2bad38a52385e">00745</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a15ad052575da97bec5b2bad38a52385e" title="Writes the content of the elaborated array.">VarDatFile::ScriviPunti</a>(<span class="keywordtype">char</span> *file){
<a name="l00746"></a>00746   FILE *SALVA;
<a name="l00747"></a>00747   <span class="keywordflow">if</span>((SALVA = fopen(file,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00748"></a>00748      printf(<span class="stringliteral">&quot;Non s&#39;apre %s, Permessi?\n&quot;</span>,file);
<a name="l00749"></a>00749   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMaxPunti;n++)
<a name="l00750"></a>00750     fprintf(SALVA,<span class="stringliteral">&quot;%lf %lf\n&quot;</span>,Punti1[n],Punti[n]);
<a name="l00751"></a>00751   fclose(SALVA);
<a name="l00752"></a>00752 }
<a name="l00753"></a><a class="code" href="classVarDatFile.html#acc513a8bb6bda4c6bbf7832a9dcdd19a">00753</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#acc513a8bb6bda4c6bbf7832a9dcdd19a" title="Writes the content of the pointed vector.">VarDatFile::ScriviFile</a>(<span class="keywordtype">char</span> *file,<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> LogLog,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l00754"></a>00754   FILE *SALVA;
<a name="l00755"></a>00755   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l00756"></a>00756   <span class="keywordflow">if</span>((SALVA = fopen(file,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00757"></a>00757     printf(<span class="stringliteral">&quot;Non s&#39;apre %s, Permessi?\n&quot;</span>,file);
<a name="l00758"></a>00758   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l00759"></a>00759     <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGLOG))
<a name="l00760"></a>00760       fprintf(SALVA,<span class="stringliteral">&quot;%lf %lf \n&quot;</span>,log10(st[CoordX][n]),log10(st[CoordY][n]));
<a name="l00761"></a>00761     <span class="keywordflow">else</span> 
<a name="l00762"></a>00762       fprintf(SALVA,<span class="stringliteral">&quot;%lf %lf \n&quot;</span>,st[CoordX][n],st[CoordY][n]);
<a name="l00763"></a>00763   }
<a name="l00764"></a>00764   fclose(SALVA);
<a name="l00765"></a>00765 }
<a name="l00766"></a><a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d">00766</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#aef5b55b7d54d1a01e9e507d3c4d23e4d" title="Writes all the content in memory.">VarDatFile::ScriviTutto</a>(<span class="keywordtype">char</span> *file,<span class="keywordtype">int</span> LogLog,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l00767"></a>00767   FILE *SALVA;
<a name="l00768"></a>00768   <span class="keywordflow">if</span>((SALVA = fopen(file,<span class="stringliteral">&quot;w&quot;</span>))==0)
<a name="l00769"></a>00769      printf(<span class="stringliteral">&quot;Non s&#39;apre %s, Permessi?\n&quot;</span>,file);
<a name="l00770"></a>00770   <span class="keywordflow">if</span>(DIS_IF_TYPE(LogLog,DIS_LOGLOG)){
<a name="l00771"></a>00771     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l00772"></a>00772       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00773"></a>00773    fprintf(SALVA,<span class="stringliteral">&quot;%.4g &quot;</span>,log10(st[v][n]));
<a name="l00774"></a>00774       }
<a name="l00775"></a>00775       fprintf(SALVA,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00776"></a>00776     }
<a name="l00777"></a>00777   }
<a name="l00778"></a>00778   <span class="keywordflow">else</span> {
<a name="l00779"></a>00779     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l00780"></a>00780       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00781"></a>00781    fprintf(SALVA,<span class="stringliteral">&quot;%.4g &quot;</span>,st[v][n]);
<a name="l00782"></a>00782       }
<a name="l00783"></a>00783       fprintf(SALVA,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785   }
<a name="l00786"></a>00786   fclose(SALVA);
<a name="l00787"></a>00787 }
<a name="l00788"></a><a class="code" href="classVarDatFile.html#a50acf56d68429e9660e2bfc4f7530521">00788</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a50acf56d68429e9660e2bfc4f7530521" title="Rescale to bulk.">VarDatFile::RescaleToBulk</a>(<span class="keywordtype">char</span> *FName){
<a name="l00789"></a>00789   <span class="keywordtype">double</span> *BulkVal = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00790"></a>00790   <span class="keywordtype">double</span> Count = 0;
<a name="l00791"></a>00791   <span class="keywordtype">int</span> NCol = 0;
<a name="l00792"></a>00792   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00793"></a>00793     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00794"></a>00794     NCol++;
<a name="l00795"></a>00795   }
<a name="l00796"></a>00796   <span class="keywordtype">int</span> NThick = (int)(NMax/(<span class="keywordtype">double</span>)NCol);
<a name="l00797"></a>00797   <span class="keywordtype">int</span> Nx = NMax;
<a name="l00798"></a>00798   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00799"></a>00799     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=NMax/2;nx&lt;3*(NMax/4);nx++){
<a name="l00800"></a>00800       <span class="keywordflow">if</span>(isnan(st[v][nx]))<span class="keywordflow">continue</span>;
<a name="l00801"></a>00801       BulkVal[v] += st[v][nx];
<a name="l00802"></a>00802       Count += 1.;
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804   }
<a name="l00805"></a>00805   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00806"></a>00806     BulkVal[v] /= Count &gt; 0. ? Count/(double)NVar : 1.;
<a name="l00807"></a>00807     BulkVal[v] = fabs(BulkVal[v]) &gt; 0. ? 1./BulkVal[v] : 1.;
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809   FILE *FWrite = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00810"></a>00810   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=0;nx&lt;NMax;nx++){
<a name="l00811"></a>00811     fprintf(FWrite,<span class="stringliteral">&quot;%lf &quot;</span>,<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(1,nx));
<a name="l00812"></a>00812     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=1;v&lt;NVar;v++){
<a name="l00813"></a>00813       fprintf(FWrite,<span class="stringliteral">&quot;%lf &quot;</span>,st[v][nx]*BulkVal[v]);
<a name="l00814"></a>00814     }
<a name="l00815"></a>00815     fprintf(FWrite,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00816"></a>00816   }
<a name="l00817"></a>00817   fclose(FWrite);
<a name="l00818"></a>00818   free(BulkVal);
<a name="l00819"></a>00819 }
<a name="l00820"></a><a class="code" href="classVarDatFile.html#a87e9980dd97eda060a3dcaddd1d692d4">00820</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a87e9980dd97eda060a3dcaddd1d692d4" title="Export in the txvl file format.">VarDatFile::ExportTxvl</a>(<span class="keywordtype">char</span> *FName,<span class="keywordtype">int</span> NElMin,<span class="keywordtype">int</span> NElMax){
<a name="l00821"></a>00821   FILE *FOut = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00822"></a>00822   <span class="keywordtype">int</span> p=0;
<a name="l00823"></a>00823   <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(0,NMax);
<a name="l00824"></a>00824   <span class="keywordtype">double</span> Dx = 1./(xGlobMax-xGlobMin);
<a name="l00825"></a>00825   Dx = 0.05/1.;
<a name="l00826"></a>00826   <span class="keywordtype">double</span> Dz = 1./(GlobMax-GlobMin);
<a name="l00827"></a>00827   fprintf(FOut,<span class="stringliteral">&quot;# l(1 1 1) v[%d] d[part] \n&quot;</span>,NMax/2);
<a name="l00828"></a>00828   <span class="keywordtype">double</span> *Cm = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00829"></a>00829   <span class="keywordtype">double</span> CmTot = 0.;
<a name="l00830"></a>00830   <span class="keywordtype">double</span> *Bulk = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00831"></a>00831   <span class="keywordtype">int</span> NBulk = NElMax-NElMin;
<a name="l00832"></a>00832   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00833"></a>00833     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00834"></a>00834       <span class="keywordflow">if</span>(n &gt;= NBulk) Cm[v] += <a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(v,n);
<a name="l00835"></a>00835     }
<a name="l00836"></a>00836   }
<a name="l00837"></a>00837   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00838"></a>00838     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00839"></a>00839     Cm[v] /= (double)(NMax-NBulk);
<a name="l00840"></a>00840     CmTot += Cm[v];
<a name="l00841"></a>00841   }
<a name="l00842"></a>00842   CmTot = CmTot/(double)(NVar-1);
<a name="l00843"></a>00843   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00844"></a>00844     Bulk[v] = .1/fabs(Cm[v]-CmTot);
<a name="l00845"></a>00845   }
<a name="l00846"></a>00846   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00847"></a>00847     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00848"></a>00848     <span class="keywordtype">double</span> OffSet = .6 - .2*(v-1);
<a name="l00849"></a>00849     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l00850"></a>00850       <span class="keywordtype">double</span> Zed = (<a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(v,n)-Cm[v])*Bulk[v]+OffSet;
<a name="l00851"></a>00851       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n)*Dx &gt; 1.) <span class="keywordflow">continue</span>;
<a name="l00852"></a>00852       fprintf(FOut,<span class="stringliteral">&quot;{t[%d %d %d] x(%lf %lf %lf)}\n&quot;</span>,p++,2,2,<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n)*Dx,.5,Zed);
<a name="l00853"></a>00853     }
<a name="l00854"></a>00854   }
<a name="l00855"></a>00855   free(Cm);
<a name="l00856"></a>00856   free(Bulk);
<a name="l00857"></a>00857   fclose(FOut);
<a name="l00858"></a>00858 }
<a name="l00859"></a><a class="code" href="classVarDatFile.html#ace7cb52bc9334449375e6e0456161120">00859</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ace7cb52bc9334449375e6e0456161120" title="Export a contour plot.">VarDatFile::TecPlot</a>(<span class="keywordtype">char</span> *FName){
<a name="l00860"></a>00860   FILE *<a class="code" href="classVarDatFile.html#ace7cb52bc9334449375e6e0456161120" title="Export a contour plot.">TecPlot</a> = fopen(FName,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00861"></a>00861   <span class="keywordtype">double</span> *BulkVal = (<span class="keywordtype">double</span> *)calloc(NVar,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00862"></a>00862   <span class="keywordtype">double</span> Count = 0;
<a name="l00863"></a>00863   <span class="keywordtype">int</span> NCol = 0;
<a name="l00864"></a>00864   <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(0,NMax);
<a name="l00865"></a>00865   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00866"></a>00866     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00867"></a>00867     NCol++;
<a name="l00868"></a>00868   }
<a name="l00869"></a>00869   <span class="keywordtype">int</span> NThick = (int)(NMax/(<span class="keywordtype">double</span>)NCol);
<a name="l00870"></a>00870   <span class="keywordtype">int</span> Nx = 2*(int)(NMax/3.);
<a name="l00871"></a>00871   <span class="keywordtype">int</span> Ny = Nx;
<a name="l00872"></a>00872   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00873"></a>00873     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=NMax/2;nx&lt;3*(NMax/4);nx++){
<a name="l00874"></a>00874       <span class="keywordflow">if</span>(isnan(st[v][nx]))<span class="keywordflow">continue</span>;
<a name="l00875"></a>00875       BulkVal[v] += st[v][nx];
<a name="l00876"></a>00876       Count += 1.;
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878   }
<a name="l00879"></a>00879   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00880"></a>00880     BulkVal[v] /= Count &gt; 0. ? Count/(double)NVar : 1.;
<a name="l00881"></a>00881     printf(<span class="stringliteral">&quot;%d %lf\n&quot;</span>,v,BulkVal[v]);
<a name="l00882"></a>00882     BulkVal[v] = fabs(BulkVal[v]) &gt; 0. ? 1./BulkVal[v] : 1.;
<a name="l00883"></a>00883   }
<a name="l00884"></a>00884   fprintf(TecPlot,<span class="stringliteral">&quot;VARIABLES = \&quot;R\&quot;, \&quot;Z\&quot;, \&quot;percentage\&quot;\n&quot;</span>);
<a name="l00885"></a>00885   fprintf(TecPlot,<span class="stringliteral">&quot;ZONE J=%d, K=%d, F=POINT\n&quot;</span>,Nx,Ny);
<a name="l00886"></a>00886   <span class="keywordtype">double</span> Int = .5*(xGlobMax-xGlobMin)/(<span class="keywordtype">double</span>)(Ny);
<a name="l00887"></a>00887   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=0,v=0;nx&lt;Nx;nx++){
<a name="l00888"></a>00888     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ny=0;ny&lt;Ny;ny++){
<a name="l00889"></a>00889       <span class="keywordflow">if</span>((ny%(NThick/2))==0) v++;
<a name="l00890"></a>00890       <span class="keywordflow">if</span>(v &gt;= NVar) v=0;
<a name="l00891"></a>00891       <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) v++;
<a name="l00892"></a>00892       <span class="keywordtype">double</span> z = <a class="code" href="classVarDatFile.html#a2b1e58fd6ed28920042681b8e27f369f" title="Value at the position.">Val</a>(v,nx)*BulkVal[v];
<a name="l00893"></a>00893       <span class="keywordflow">if</span>(isnan(z)) z = 1.;
<a name="l00894"></a>00894       fprintf(TecPlot,<span class="stringliteral">&quot;%lf %lf %lf\n&quot;</span>,<a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,nx),Int*ny,z);
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896   }
<a name="l00897"></a>00897   fclose(TecPlot);
<a name="l00898"></a>00898   free(BulkVal);
<a name="l00899"></a>00899 }
<a name="l00900"></a><a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03">00900</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">VarDatFile::PuntiAlloc</a>(){
<a name="l00901"></a>00901   <span class="keywordflow">if</span>(IfPuntiAlloc){
<a name="l00902"></a>00902     Punti = (<span class="keywordtype">double</span> *)calloc(NMaxPunti,<span class="keyword">sizeof</span>(*Punti));
<a name="l00903"></a>00903     <span class="keywordflow">if</span>( Punti  == NULL){printf(<span class="stringliteral">&quot;Punti non s&#39;alloca\n&quot;</span>);return ;}
<a name="l00904"></a>00904     Punti1 = (<span class="keywordtype">double</span> *)calloc(NMaxPunti,<span class="keyword">sizeof</span>(*Punti));
<a name="l00905"></a>00905     <span class="keywordflow">if</span>( Punti1  == NULL){printf(<span class="stringliteral">&quot;Punti non s&#39;alloca\n&quot;</span>);return ;}
<a name="l00906"></a>00906     PuntiErr = (<span class="keywordtype">double</span> *)calloc(NMaxPunti,<span class="keyword">sizeof</span>(*Punti));
<a name="l00907"></a>00907     <span class="keywordflow">if</span>( PuntiErr  == NULL){printf(<span class="stringliteral">&quot;Punti non s&#39;alloca\n&quot;</span>);return ;}
<a name="l00908"></a>00908     IfPuntiAlloc = 0;
<a name="l00909"></a>00909     IfPuntiFree = 0;
<a name="l00910"></a>00910   }  
<a name="l00911"></a>00911 }
<a name="l00912"></a><a class="code" href="classVarDatFile.html#a00eaf560508e46c0949042ab38af99de">00912</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ad0ccdbdedaf66f5c01e3b850148a6b00" title="Set the natural sequence as abscissa for all sets.">VarDatFile::ImpSequence</a>(<span class="keywordtype">int</span> v){
<a name="l00913"></a>00913   RefAbsc[v] = NVar;
<a name="l00914"></a>00914 }
<a name="l00915"></a><a class="code" href="classVarDatFile.html#ad0ccdbdedaf66f5c01e3b850148a6b00">00915</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ad0ccdbdedaf66f5c01e3b850148a6b00" title="Set the natural sequence as abscissa for all sets.">VarDatFile::ImpSequence</a>(){
<a name="l00916"></a>00916   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00917"></a>00917     RefAbsc[v] = NVar;
<a name="l00918"></a>00918   }
<a name="l00919"></a>00919 }
<a name="l00920"></a><a class="code" href="classVarDatFile.html#ac4e4ea335271e56d3a3dbc54bf0e8847">00920</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a963c1d12c9e593a16748f229bc5bd11f" title="Set the columns for the x array.">VarDatFile::ImpCoordX</a>(<span class="keywordtype">int</span> vSet,<span class="keywordtype">int</span> vAbs){
<a name="l00921"></a>00921   <span class="keywordflow">if</span>(vAbs &gt; NVar) <span class="keywordflow">return</span>;
<a name="l00922"></a>00922   <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(vSet)) <span class="keywordflow">return</span>;
<a name="l00923"></a>00923   <span class="comment">// one set refers to the sequence</span>
<a name="l00924"></a>00924   <span class="keywordflow">if</span>(NVar == 1) RefAbsc[vSet] = NVar;
<a name="l00925"></a>00925   <span class="comment">// set to the sequence set</span>
<a name="l00926"></a>00926   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(vAbs == REF_SEQ) RefAbsc[vSet] = NVar;
<a name="l00927"></a>00927   <span class="keywordflow">else</span> RefAbsc[vSet] = vAbs;
<a name="l00928"></a>00928 }
<a name="l00929"></a><a class="code" href="classVarDatFile.html#a963c1d12c9e593a16748f229bc5bd11f">00929</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a963c1d12c9e593a16748f229bc5bd11f" title="Set the columns for the x array.">VarDatFile::ImpCoordX</a>(<span class="keywordtype">int</span> vAbs){
<a name="l00930"></a>00930   <span class="keywordflow">if</span>(vAbs &gt; NVar || vAbs &lt; REF_ASC) <span class="keywordflow">return</span>;
<a name="l00931"></a>00931   <span class="comment">// one set refers to the sequence</span>
<a name="l00932"></a>00932   <span class="keywordflow">if</span>(NVar == 1){ RefAbsc[0] = NVar;<span class="keywordflow">return</span>;}
<a name="l00933"></a>00933   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00934"></a>00934     <span class="keywordflow">if</span>(vAbs == REF_SEQ) RefAbsc[v] = NVar;
<a name="l00935"></a>00935     <span class="keywordflow">else</span> RefAbsc[v] = vAbs;
<a name="l00936"></a>00936   }
<a name="l00937"></a>00937 }
<a name="l00938"></a><a class="code" href="classVarDatFile.html#a4b08a81fa612f8cbeabb3618624fe7ca">00938</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a4b08a81fa612f8cbeabb3618624fe7ca" title="Set the column for the y array.">VarDatFile::ImpCoordY</a>(<span class="keywordtype">int</span> Ext){
<a name="l00939"></a>00939   <span class="keywordflow">if</span>(Ext &lt; NVar &amp;&amp; Ext &gt;= 0){
<a name="l00940"></a>00940     <a class="code" href="classVarDatFile.html#a0e376f4d59c4a98b04daf57047cad5f9" title="Points to a column of st.">sp</a> = st[Ext];
<a name="l00941"></a>00941   }
<a name="l00942"></a>00942 }
<a name="l00943"></a><a class="code" href="classVarDatFile.html#aab87873039820cc1aca0c444c43d9a5e">00943</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#aab87873039820cc1aca0c444c43d9a5e" title="Free Punti if it is allocated.">VarDatFile::PuntiFree</a>(){
<a name="l00944"></a>00944   <span class="keywordflow">if</span>(IfPuntiFree){
<a name="l00945"></a>00945     free(Punti);
<a name="l00946"></a>00946     IfPuntiAlloc = 1;
<a name="l00947"></a>00947   }
<a name="l00948"></a>00948 }
<a name="l00949"></a><a class="code" href="classVarDatFile.html#a3842ee06d27e5ffab8330b9a42abe651">00949</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a3842ee06d27e5ffab8330b9a42abe651" title="Print the maximum of all sets.">VarDatFile::pMaxGlob</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l00950"></a>00950   <span class="keywordtype">double</span> Resp = st[0][0];
<a name="l00951"></a>00951   <span class="comment">// set the initial value</span>
<a name="l00952"></a>00952   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00953"></a>00953     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l00954"></a>00954     Resp = st[v][NVisMin];
<a name="l00955"></a>00955   }
<a name="l00956"></a>00956   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00957"></a>00957     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l00958"></a>00958     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l00959"></a>00959       <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00960"></a>00960       <span class="keywordflow">if</span>(isnan(st[v][n]))<span class="keywordflow">continue</span>;
<a name="l00961"></a>00961       <span class="keywordflow">if</span>(Resp &lt; st[v][n])
<a name="l00962"></a>00962    Resp = st[v][n];
<a name="l00963"></a>00963     }
<a name="l00964"></a>00964   }
<a name="l00965"></a>00965   GlobMax = Resp;
<a name="l00966"></a>00966   <span class="keywordflow">return</span> Resp;
<a name="l00967"></a>00967 }
<a name="l00968"></a><a class="code" href="classVarDatFile.html#abb5cfc85ebb62f7226afe58ab7f70f68">00968</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#abb5cfc85ebb62f7226afe58ab7f70f68" title="Print the minimum of all sets.">VarDatFile::pMinGlob</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l00969"></a>00969   <span class="keywordtype">double</span> Resp = st[0][0];
<a name="l00970"></a>00970   <span class="comment">// set the initial value</span>
<a name="l00971"></a>00971   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00972"></a>00972     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l00973"></a>00973     Resp = st[v][NVisMin];
<a name="l00974"></a>00974   }
<a name="l00975"></a>00975   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00976"></a>00976     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l00977"></a>00977     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l00978"></a>00978       <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l00979"></a>00979       <span class="keywordflow">if</span>(isnan(st[v][n])) <span class="keywordflow">continue</span>;
<a name="l00980"></a>00980       <span class="keywordflow">if</span>(Resp &gt; st[v][n])
<a name="l00981"></a>00981    Resp = st[v][n];
<a name="l00982"></a>00982     }
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984   <span class="keywordflow">return</span> Resp;  
<a name="l00985"></a>00985 }
<a name="l00986"></a><a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555">00986</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">VarDatFile::pMinMaxGlob</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l00987"></a>00987   <span class="keywordtype">double</span> Border[4];
<a name="l00988"></a>00988   <span class="comment">// set the initial value</span>
<a name="l00989"></a>00989   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l00990"></a>00990     <span class="keywordflow">if</span>(!<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)){
<a name="l00991"></a>00991       Border[0] = <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,NVisMin);
<a name="l00992"></a>00992       Border[1] = <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,NVisMin);
<a name="l00993"></a>00993       Border[2] = st[v][NVisMin];
<a name="l00994"></a>00994       Border[3] = st[v][NVisMin];
<a name="l00995"></a>00995       <span class="keywordflow">break</span>;
<a name="l00996"></a>00996     }
<a name="l00997"></a>00997   }
<a name="l00998"></a>00998   <span class="comment">// find the borders</span>
<a name="l00999"></a>00999   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01000"></a>01000     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01001"></a>01001     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01002"></a>01002       <span class="keywordflow">if</span>(n &gt;= <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01003"></a>01003       <span class="keywordflow">if</span>(isnan(st[v][n])) <span class="keywordflow">continue</span>;
<a name="l01004"></a>01004       <span class="keywordflow">if</span>(Border[0] &gt; <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n)) Border[0] = <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n);
<a name="l01005"></a>01005       <span class="keywordflow">if</span>(Border[1] &lt; <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n)) Border[1] = <a class="code" href="classVarDatFile.html#a3f23e3592344b829371e42e77ed02d15" title="Value of the Abscissa at position.">Abscissa</a>(v,n);
<a name="l01006"></a>01006       <span class="keywordflow">if</span>(Border[2] &gt; st[v][n]) Border[2] = st[v][n];
<a name="l01007"></a>01007       <span class="keywordflow">if</span>(Border[3] &lt; st[v][n]) Border[3] = st[v][n];
<a name="l01008"></a>01008     }
<a name="l01009"></a>01009   }
<a name="l01010"></a>01010   xGlobMin = Border[0];
<a name="l01011"></a>01011   xGlobMax = Border[1];
<a name="l01012"></a>01012   GlobMin = Border[2];
<a name="l01013"></a>01013   GlobMax = Border[3];
<a name="l01014"></a>01014 }
<a name="l01015"></a><a class="code" href="classVarDatFile.html#ab594ce06a5fb24acf5c812f2d02fde06">01015</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#ab594ce06a5fb24acf5c812f2d02fde06" title="Print the abscissa maximum of all sets.">VarDatFile::pxMaxGlob</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01016"></a>01016   <span class="keywordtype">double</span> Resp = st[0][NVisMin];
<a name="l01017"></a>01017   <span class="comment">// set the initial value</span>
<a name="l01018"></a>01018   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01019"></a>01019     <span class="keywordflow">if</span>(RefAbsc[v] == NVar) <span class="keywordflow">return</span> NVisMin;
<a name="l01020"></a>01020     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)){
<a name="l01021"></a>01021       Resp = st[v][NVisMin];
<a name="l01022"></a>01022       <span class="keywordflow">break</span>;
<a name="l01023"></a>01023     }
<a name="l01024"></a>01024   }
<a name="l01025"></a>01025   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01026"></a>01026     <span class="keywordflow">if</span>(!<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v))<span class="keywordflow">continue</span>;
<a name="l01027"></a>01027     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01028"></a>01028       <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01029"></a>01029       <span class="keywordflow">if</span>(isnan(st[v][n]))<span class="keywordflow">continue</span>;
<a name="l01030"></a>01030       <span class="keywordflow">if</span>(isinf(st[v][n]))<span class="keywordflow">continue</span>;
<a name="l01031"></a>01031       <span class="keywordflow">if</span>(Resp &lt; st[v][n])
<a name="l01032"></a>01032    Resp = st[v][n];
<a name="l01033"></a>01033     }
<a name="l01034"></a>01034   }
<a name="l01035"></a>01035   xGlobMax = Resp;
<a name="l01036"></a>01036   printf(<span class="stringliteral">&quot;%lf\n&quot;</span>,Resp);
<a name="l01037"></a>01037   <span class="keywordflow">return</span> Resp;
<a name="l01038"></a>01038 }
<a name="l01039"></a><a class="code" href="classVarDatFile.html#a6c9b0181c2505369c375bcb91f36409f">01039</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a6c9b0181c2505369c375bcb91f36409f" title="Print the abscissa minimum of all sets.">VarDatFile::pxMinGlob</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01040"></a>01040   <span class="keywordtype">double</span> Resp = st[0][NVisMin];
<a name="l01041"></a>01041   <span class="comment">// set the initial value</span>
<a name="l01042"></a>01042   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01043"></a>01043     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)){
<a name="l01044"></a>01044       Resp = st[v][NVisMin];
<a name="l01045"></a>01045       <span class="keywordflow">break</span>;
<a name="l01046"></a>01046     }
<a name="l01047"></a>01047   }
<a name="l01048"></a>01048   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01049"></a>01049     <span class="keywordflow">if</span>(!<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01050"></a>01050     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01051"></a>01051       <span class="keywordflow">if</span>(n &gt;= <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01052"></a>01052       <span class="keywordflow">if</span>(Resp &gt; st[v][n]){
<a name="l01053"></a>01053    Resp = st[v][n];
<a name="l01054"></a>01054       }
<a name="l01055"></a>01055     }
<a name="l01056"></a>01056   }
<a name="l01057"></a>01057   xGlobMin = Resp;
<a name="l01058"></a>01058   <span class="keywordflow">return</span> Resp;  
<a name="l01059"></a>01059 }
<a name="l01060"></a><a class="code" href="classVarDatFile.html#ad89c34d0afecf90978d5e36bf57e1bf0">01060</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#ad89c34d0afecf90978d5e36bf57e1bf0" title="Print the maximum of all sets.">VarDatFile::pMaxGlobLog</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01061"></a>01061   <span class="keywordtype">double</span> Resp = st[0][NVisMin];
<a name="l01062"></a>01062   <span class="keywordtype">int</span> IfContinue = 1;
<a name="l01063"></a>01063   <span class="comment">// set the initial value</span>
<a name="l01064"></a>01064   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01065"></a>01065     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01066"></a>01066     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l01067"></a>01067       <span class="keywordflow">if</span>(st[v][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01068"></a>01068       Resp = st[v][n];
<a name="l01069"></a>01069       IfContinue = 0;
<a name="l01070"></a>01070       <span class="keywordflow">break</span>;
<a name="l01071"></a>01071     }
<a name="l01072"></a>01072     <span class="keywordflow">if</span>(IfContinue) <span class="keywordflow">break</span>;
<a name="l01073"></a>01073   }
<a name="l01074"></a>01074   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01075"></a>01075     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01076"></a>01076     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01077"></a>01077       <span class="keywordflow">if</span>(st[v][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01078"></a>01078       <span class="keywordflow">if</span>(n &gt;= <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01079"></a>01079       <span class="keywordflow">if</span>(Resp &lt; st[v][n]) Resp = st[v][n];
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081   }
<a name="l01082"></a>01082   <span class="keywordflow">return</span> log10(Resp &gt; 0. ? Resp : 1.);
<a name="l01083"></a>01083 }
<a name="l01084"></a><a class="code" href="classVarDatFile.html#ad47c958de7bca595ab42666050cac660">01084</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#ad47c958de7bca595ab42666050cac660" title="Print the minimum of all sets.">VarDatFile::pMinGlobLog</a>(<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01085"></a>01085   <span class="keywordtype">double</span> Resp = st[0][NVisMin];
<a name="l01086"></a>01086   <span class="keywordtype">int</span> IfContinue = 1;
<a name="l01087"></a>01087   <span class="comment">// set the initial value</span>
<a name="l01088"></a>01088   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01089"></a>01089     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01090"></a>01090     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l01091"></a>01091       <span class="keywordflow">if</span>(st[v][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01092"></a>01092       Resp = st[v][n];
<a name="l01093"></a>01093       IfContinue = 0;
<a name="l01094"></a>01094       <span class="keywordflow">break</span>;
<a name="l01095"></a>01095     }
<a name="l01096"></a>01096     <span class="keywordflow">if</span>(!IfContinue) <span class="keywordflow">break</span>;
<a name="l01097"></a>01097   }
<a name="l01098"></a>01098   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01099"></a>01099     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01100"></a>01100     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01101"></a>01101       <span class="keywordflow">if</span>(st[v][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01102"></a>01102       <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01103"></a>01103       <span class="keywordflow">if</span>(Resp &gt; st[v][n]) Resp = st[v][n];
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105   }
<a name="l01106"></a>01106   <span class="keywordflow">return</span> log10(Resp &gt; 0. ? Resp : 1.);  
<a name="l01107"></a>01107 }
<a name="l01108"></a><a class="code" href="classVarDatFile.html#a3aea9835fc67f13c5b334e1a34af1be9">01108</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#a3aea9835fc67f13c5b334e1a34af1be9" title="Print the maximum of the column.">VarDatFile::pMax</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01109"></a>01109   <span class="keywordtype">double</span> Resp = st[CoordY][NVisMin];
<a name="l01110"></a>01110   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01111"></a>01111     <span class="keywordflow">if</span>(Resp &lt; st[CoordY][n])
<a name="l01112"></a>01112       Resp = st[CoordY][n];
<a name="l01113"></a>01113   }
<a name="l01114"></a>01114   <span class="keywordflow">return</span> Resp;
<a name="l01115"></a>01115 }
<a name="l01116"></a><a class="code" href="classVarDatFile.html#afd9d7e4b40e8991b685d17cb65a38441">01116</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#afd9d7e4b40e8991b685d17cb65a38441" title="Print the minimum of the column.">VarDatFile::pMin</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01117"></a>01117   <span class="keywordtype">double</span> Resp = st[CoordY][NVisMin];
<a name="l01118"></a>01118   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01119"></a>01119     <span class="keywordflow">if</span>(Resp &gt; st[CoordY][n])
<a name="l01120"></a>01120       Resp = st[CoordY][n];
<a name="l01121"></a>01121   }
<a name="l01122"></a>01122   <span class="keywordflow">return</span> Resp;
<a name="l01123"></a>01123 }
<a name="l01124"></a><a class="code" href="classVarDatFile.html#abb42c2238af97f451a3ebf3226d13639">01124</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#abb42c2238af97f451a3ebf3226d13639" title="Print the maximum of the column.">VarDatFile::pMaxLog</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01125"></a>01125   <span class="keywordtype">double</span> Resp = st[CoordY][NVisMin];
<a name="l01126"></a>01126   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01127"></a>01127     <span class="keywordflow">if</span>(st[CoordY][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01128"></a>01128     <span class="keywordflow">if</span>(Resp &lt; st[CoordY][n])
<a name="l01129"></a>01129       Resp = st[CoordY][n];
<a name="l01130"></a>01130   }
<a name="l01131"></a>01131   <span class="keywordflow">return</span> log10(Resp &gt; 0. ? Resp : 1.);
<a name="l01132"></a>01132 }
<a name="l01133"></a><a class="code" href="classVarDatFile.html#af5ebcfc4c951d36ead08fdc20974b5ff">01133</a> <span class="keywordtype">double</span> <a class="code" href="classVarDatFile.html#af5ebcfc4c951d36ead08fdc20974b5ff" title="Print the minimum of the column.">VarDatFile::pMinLog</a>(<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01134"></a>01134   <span class="keywordtype">double</span> Resp = 0.;
<a name="l01135"></a>01135   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01136"></a>01136     <span class="keywordflow">if</span>(st[CoordY][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01137"></a>01137     Resp = st[CoordY][n];
<a name="l01138"></a>01138     <span class="keywordflow">break</span>;
<a name="l01139"></a>01139   }
<a name="l01140"></a>01140   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=NVisMin;n&lt;NVisMax;n++){
<a name="l01141"></a>01141     <span class="keywordflow">if</span>(st[CoordY][n] &lt;= 0.) <span class="keywordflow">continue</span>;
<a name="l01142"></a>01142     <span class="keywordflow">if</span>(Resp &gt; st[CoordY][n])
<a name="l01143"></a>01143       Resp = st[CoordY][n];
<a name="l01144"></a>01144   }
<a name="l01145"></a>01145  <span class="keywordflow">return</span> log10(Resp &gt; 0. ? Resp : 1.);  
<a name="l01146"></a>01146 }
<a name="l01147"></a><a class="code" href="classVarDatFile.html#a589e6b70b557686f8a829acf53ec6b0c">01147</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a589e6b70b557686f8a829acf53ec6b0c" title="Set the value of XFormula.">VarDatFile::setXFormula</a>(<span class="keywordtype">char</span> *str){
<a name="l01148"></a>01148   strcpy(XFormula,str);
<a name="l01149"></a>01149 }
<a name="l01150"></a><a class="code" href="classVarDatFile.html#adb4227dfb05be39d72d1b89cdc44eb5a">01150</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#adb4227dfb05be39d72d1b89cdc44eb5a" title="Set the value of YFormula.">VarDatFile::setYFormula</a>(<span class="keywordtype">char</span> *str){
<a name="l01151"></a>01151   strcpy(YFormula,str);
<a name="l01152"></a>01152 }
<a name="l01153"></a><a class="code" href="classVarDatFile.html#ae1b551cc51c9d556342b27b466a7c7cb">01153</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#ae1b551cc51c9d556342b27b466a7c7cb" title="Reverse the sets.">VarDatFile::Reverse</a>(){
<a name="l01154"></a>01154   <span class="keywordtype">double</span> Temp = 0.;
<a name="l01155"></a>01155   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax/2;n++){
<a name="l01156"></a>01156     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01157"></a>01157       Temp = st[v][n];
<a name="l01158"></a>01158       st[v][n] = st[v][NMax-n-1];
<a name="l01159"></a>01159       st[v][NMax-n-1] = Temp;
<a name="l01160"></a>01160     }
<a name="l01161"></a>01161   }
<a name="l01162"></a>01162 }
<a name="l01163"></a><a class="code" href="classVarDatFile.html#a42240e743f2a3ea3b430b915e50c5350">01163</a> <span class="keywordtype">int</span> <a class="code" href="classVarDatFile.html#a42240e743f2a3ea3b430b915e50c5350" title="Smooth the line.">VarDatFile::Smooth</a>(<span class="keywordtype">double</span> Fact,<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01164"></a>01164   <span class="keywordtype">int</span> NOrder = 3+1;
<a name="l01165"></a>01165   <span class="comment">//still not working for Fact != 1.</span>
<a name="l01166"></a>01166   Fact = 1.;
<a name="l01167"></a>01167   <span class="keywordtype">int</span> NOut = (int)(NMax*Fact);
<a name="l01168"></a>01168   NMaxPunti = NOut;
<a name="l01169"></a>01169   <span class="keywordtype">int</span> NSmooth = 2;
<a name="l01170"></a>01170   <span class="keywordtype">double</span> *sw = (<span class="keywordtype">double</span> *)calloc(NOut,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01171"></a>01171   <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(NVisMin,NVisMax);
<a name="l01172"></a>01172   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l01173"></a>01173   <span class="keywordtype">double</span> Max=st[CoordY][0];
<a name="l01174"></a>01174   <span class="keywordtype">double</span> Min=st[CoordY][0];
<a name="l01175"></a>01175   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l01176"></a>01176     <span class="keywordflow">if</span>(Max &lt; st[CoordY][n]) Max = st[CoordY][n];
<a name="l01177"></a>01177     <span class="keywordflow">if</span>(Min &gt; st[CoordY][n]) Min = st[CoordY][n];
<a name="l01178"></a>01178   }
<a name="l01179"></a>01179   <span class="keywordtype">double</span> DeltaIn=(Max-Min)/(<span class="keywordtype">double</span>)(NMax-1);
<a name="l01180"></a>01180   <span class="keywordtype">double</span> DeltaOut=(Max-Min)/(<span class="keywordtype">double</span>)(NOut-1);
<a name="l01181"></a>01181   <span class="keywordtype">double</span> *dArray = (<span class="keywordtype">double</span> *)calloc(NMax+2*NOrder+2,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01182"></a>01182   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l01183"></a>01183   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vi=0;vi&lt;NMax;vi++){
<a name="l01184"></a>01184     Punti1[vi] = st[CoordX][vi];
<a name="l01185"></a>01185   }
<a name="l01186"></a>01186   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vi=0;vi&lt;=NMax+2*NOrder;vi++){
<a name="l01187"></a>01187     <span class="keywordflow">if</span>(vi&lt;NOrder){
<a name="l01188"></a>01188       dArray[vi] = Min;
<a name="l01189"></a>01189     }
<a name="l01190"></a>01190     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(vi &gt; NMax){
<a name="l01191"></a>01191       dArray[vi] = (vi-NOrder+2)*DeltaIn+Min;
<a name="l01192"></a>01192     }
<a name="l01193"></a>01193     <span class="keywordflow">else</span> {
<a name="l01194"></a>01194       dArray[vi] = (vi-NOrder+1)*DeltaIn+Min;
<a name="l01195"></a>01195     }
<a name="l01196"></a>01196   }
<a name="l01197"></a>01197   Punti[0] = st[CoordY][0];
<a name="l01198"></a>01198   Punti[NOut-1] = st[CoordY][NMax-1];
<a name="l01199"></a>01199   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vo=1;vo&lt;NOut-1;vo++){
<a name="l01200"></a>01200     Punti[vo] = 0.;
<a name="l01201"></a>01201     <span class="keywordtype">double</span> x = DeltaOut*vo+Min;
<a name="l01202"></a>01202     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> vi=vo-1,vn=0;vi&lt;vo+NOrder+1;vi++){
<a name="l01203"></a>01203       vn = vi;
<a name="l01204"></a>01204       <span class="keywordflow">if</span>(vi &lt; 0){
<a name="l01205"></a>01205    vn = NMax + vi;
<a name="l01206"></a>01206       }
<a name="l01207"></a>01207       <span class="keywordflow">if</span>(vi &gt;= NMax){
<a name="l01208"></a>01208    vn = vi - NMax;
<a name="l01209"></a>01209       }
<a name="l01210"></a>01210       <span class="keywordtype">double</span> Blendx = <a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dArray,x,vn,NOrder);
<a name="l01211"></a>01211       Punti[vo] += Blendx*st[CoordY][vn];
<a name="l01212"></a>01212     }
<a name="l01213"></a>01213   }
<a name="l01214"></a>01214   free(dArray);
<a name="l01215"></a>01215   <span class="keywordflow">return</span> NOut;
<a name="l01216"></a>01216 }
<a name="l01217"></a><a class="code" href="classVarDatFile.html#a12fe98e58e8262bcbf3aef114673673d">01217</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a12fe98e58e8262bcbf3aef114673673d" title="Smooth the line.">VarDatFile::SmoothGauss</a>(<span class="keywordtype">double</span> Fact,<span class="keywordtype">int</span> CoordY,<span class="keywordtype">int</span> NVisMin,<span class="keywordtype">int</span> NVisMax){
<a name="l01218"></a>01218   <span class="comment">//still not working for Fact != 1.</span>
<a name="l01219"></a>01219   Fact = 1.;
<a name="l01220"></a>01220   <span class="keywordtype">int</span> NOut = (int)(NMax*Fact);
<a name="l01221"></a>01221   NMaxPunti = NOut;
<a name="l01222"></a>01222   <a class="code" href="classVarDatFile.html#a46c8b0d765845804061b9ed216e96555" title="Find the borders globally.">pMinMaxGlob</a>(NVisMin,NVisMax);
<a name="l01223"></a>01223   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l01224"></a>01224   <span class="keywordtype">int</span> CoordX = RefAbsc[CoordY];
<a name="l01225"></a>01225   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l01226"></a>01226     Punti[n] = st[CoordY][n];
<a name="l01227"></a>01227     Punti1[n] = st[CoordX][n];
<a name="l01228"></a>01228   }
<a name="l01229"></a>01229   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> Mask(5);
<a name="l01230"></a>01230   Mask.<a class="code" href="classMatrice.html#a5ceb29f59f80d11657e7d9cb7ab442d0" title="Fill the entries for the Gauss blur.">FillGaussian</a>(.5,3.);
<a name="l01231"></a>01231   Mask.<a class="code" href="classMatrice.html#a9dcac18006ce057b8d78c847174c1362" title="Print the entries.">Print</a>();
<a name="l01232"></a>01232   <span class="keywordtype">int</span> NDim = 1;
<a name="l01233"></a>01233   <span class="keywordtype">int</span> IfMinImConv = 0;
<a name="l01234"></a>01234   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> v=0;v&lt;NVar;v++){
<a name="l01235"></a>01235     <span class="keywordflow">if</span>(<a class="code" href="classVarDatFile.html#a2d7aa499f16ec4d2e15ac60bccbb8441" title="If the column is an ascissa.">IsAbscissa</a>(v)) <span class="keywordflow">continue</span>;
<a name="l01236"></a>01236     Mask.<a class="code" href="classMatrice.html#a99c8b7cc887b83243200255862b1491c" title="Convolute with a matrix.">ConvoluteMatrix</a>(st[v],NVisMax-NVisMin,NDim,IfMinImConv);
<a name="l01237"></a>01237   }
<a name="l01238"></a>01238 }
<a name="l01239"></a><a class="code" href="classVarDatFile.html#a6ab47ee0a227e3e13f042327b1f8fe33">01239</a> <span class="keywordtype">void</span> <a class="code" href="classVarDatFile.html#a6ab47ee0a227e3e13f042327b1f8fe33" title="Distribution of distances.">VarDatFile::DoubleDistFluct</a>(){
<a name="l01240"></a>01240   <a class="code" href="classVarDatFile.html#a38ef005b54f94a56824e7240876e9c03" title="Allocates.">PuntiAlloc</a>();
<a name="l01241"></a>01241   SigErr(NVar &lt; 8,<span class="stringliteral">&quot;Two files are with the coordinate positions are expected\n&quot;</span>);
<a name="l01242"></a>01242   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0;n&lt;NMax;n++){
<a name="l01243"></a>01243     <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(0)) <span class="keywordflow">continue</span>;
<a name="l01244"></a>01244     <span class="keywordflow">if</span>(n &gt; <a class="code" href="classVarDatFile.html#a48d99b519007370b7b0657a1f6665c27" title="Print the maximum number of data for the column.">pNRow</a>(1)) <span class="keywordflow">continue</span>;
<a name="l01245"></a>01245     <span class="keywordtype">double</span> Dist = 0.;
<a name="l01246"></a>01246     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l01247"></a>01247       Dist += SQR(st[1+d][n] - st[5+d][n]);
<a name="l01248"></a>01248     }
<a name="l01249"></a>01249     Dist = sqrt(Dist);
<a name="l01250"></a>01250     Punti[n] = Dist;
<a name="l01251"></a>01251     Punti1[n] = (double)n;
<a name="l01252"></a>01252   }
<a name="l01253"></a>01253 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:22 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
