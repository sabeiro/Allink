<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/Matematica/MatematicaInterp.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_d3aaf10f5e13657c742aaadcee9f6de1.html">Matematica</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">MatematicaInterp.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;../include/Matematica.h&quot;</span>
<a name="l00002"></a>00002 
<a name="l00003"></a><a class="code" href="classMatematica.html#a2cd9afb9e7613f99ea679738094c5c82">00003</a> <span class="keywordtype">double</span> <a class="code" href="classMatematica.html#a2cd9afb9e7613f99ea679738094c5c82" title="QBezier curve of three points.">Matematica::QBezier</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">double</span> x,<span class="keywordtype">int</span> y){
<a name="l00004"></a>00004   <span class="keywordtype">double</span> Resp;
<a name="l00005"></a>00005 <span class="comment">//   int Order = 3;</span>
<a name="l00006"></a>00006 <span class="comment">//   double *Coeff;</span>
<a name="l00007"></a>00007 <span class="comment">//   Coeff = (double *)malloc(Order*sizeof(double));</span>
<a name="l00008"></a>00008 <span class="comment">//   for(int i=0;i&lt;Order;i++){</span>
<a name="l00009"></a>00009 <span class="comment">//     Coeff[i] = Binomial(Order,i)*P1[y];</span>
<a name="l00010"></a>00010 <span class="comment">//   }//deCasteljau algorithm</span>
<a name="l00011"></a>00011 <span class="comment">//   //P(x) = sum_i Coeff[i]*t^i*(t-1)^(n-1)</span>
<a name="l00012"></a>00012   Resp = QUAD((1-x))*P1[y]+2*(1-x)*x*P2[y]+QUAD(x)*P3[y];
<a name="l00013"></a>00013   <span class="keywordflow">return</span> Resp;
<a name="l00014"></a>00014 }
<a name="l00015"></a><a class="code" href="classMatematica.html#aa2836a8f43d770c560eb34c3cafa4ceb">00015</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#aa2836a8f43d770c560eb34c3cafa4ceb" title="Three order spline first boundary.">Matematica::Spline3Beg</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00016"></a>00016   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00017"></a>00017   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00018"></a>00018     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00019"></a>00019     <span class="keywordflow">return</span> Sp;
<a name="l00020"></a>00020   }
<a name="l00021"></a>00021   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00022"></a>00022   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00023"></a>00023   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00024"></a>00024   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = 0.;
<a name="l00025"></a>00025   <span class="comment">//  printf(&quot;%lf %lf\n&quot;,Sp.a2,Par.A);</span>
<a name="l00026"></a>00026   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = (Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/(3.*Deltax);
<a name="l00027"></a>00027   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax;
<a name="l00028"></a>00028   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00029"></a>00029   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>+2*Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax+3*Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax;
<a name="l00030"></a>00030   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00031"></a>00031   <span class="comment">//printf(&quot;%lf %lf|%lf %lf %lf\n&quot;,Sp.a0,Sp.a1,SplineA1,Sp.a2,Sp.a3);</span>
<a name="l00032"></a>00032   <span class="keywordflow">return</span> Sp;
<a name="l00033"></a>00033 }
<a name="l00034"></a><a class="code" href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492">00034</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a69f1211856d5b0cd58178a21156d0492" title="Three order spline.">Matematica::Spline3</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00035"></a>00035   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00036"></a>00036   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00037"></a>00037     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00038"></a>00038     <span class="keywordflow">return</span> Sp;
<a name="l00039"></a>00039   }
<a name="l00040"></a>00040   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00041"></a>00041   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00042"></a>00042   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00043"></a>00043   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00044"></a>00044   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = (Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/(3.*Deltax);
<a name="l00045"></a>00045   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax;
<a name="l00046"></a>00046   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00047"></a>00047   <span class="comment">//printf(&quot;%lf %lf|%lf %lf|%lf %lf\n&quot;,Sp.a0,SplineA1,Sp.a1,Sp.a2,SplineA2,Sp.a3);</span>
<a name="l00048"></a>00048   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00049"></a>00049   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00050"></a>00050   <span class="keywordflow">return</span> Sp;
<a name="l00051"></a>00051 }
<a name="l00052"></a><a class="code" href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128">00052</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a9f4d9bbeaf65d0ee820dc906aaee0128" title="Three order spline last boundary.">Matematica::Spline3End</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00053"></a>00053   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00054"></a>00054   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00055"></a>00055     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00056"></a>00056     <span class="keywordflow">return</span> Sp;
<a name="l00057"></a>00057   }
<a name="l00058"></a>00058   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00059"></a>00059   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00060"></a>00060   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00061"></a>00061   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = (0. - SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/(3.*Deltax);
<a name="l00062"></a>00062   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax;
<a name="l00063"></a>00063   <span class="comment">//  printf(&quot;%lf %lf %lf %lf\n&quot;,Sp.a0,Sp.a1,Sp.a2,Sp.a3);</span>
<a name="l00064"></a>00064   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = 0.;
<a name="l00065"></a>00065   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00066"></a>00066   <span class="keywordflow">return</span> Sp;
<a name="l00067"></a>00067 }
<a name="l00068"></a><a class="code" href="classMatematica.html#a4166dfd1c333203677c8caf040ead05b">00068</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a4166dfd1c333203677c8caf040ead05b" title="Four order spline first boundary.">Matematica::Spline4Beg</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">double</span> *P4,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00069"></a>00069   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00070"></a>00070   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00071"></a>00071     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00072"></a>00072     <span class="keywordflow">return</span> Sp;
<a name="l00073"></a>00073   }
<a name="l00074"></a>00074   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00075"></a>00075   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Cub = <a class="code" href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb" title="Four point cubic interpolation.">Cubica</a>(P1,P2,P3,P4,x,y);
<a name="l00076"></a>00076   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00077"></a>00077   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00078"></a>00078   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = 0.;
<a name="l00079"></a>00079   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 3.*Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>/Deltax + (Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/QUAD(Deltax);
<a name="l00080"></a>00080   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> /= 12.;
<a name="l00081"></a>00081   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - 6.*Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax;
<a name="l00082"></a>00082   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax - Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax*Deltax*Deltax;
<a name="l00083"></a>00083   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00084"></a>00084   SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>;
<a name="l00085"></a>00085   <span class="keywordflow">return</span> Sp;
<a name="l00086"></a>00086 }
<a name="l00087"></a><a class="code" href="classMatematica.html#a6b6c8217f2c75492c48cd60e4d9c17cf">00087</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a6b6c8217f2c75492c48cd60e4d9c17cf" title="Four order spline.">Matematica::Spline4</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">double</span> *P4,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00088"></a>00088   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00089"></a>00089   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00090"></a>00090     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00091"></a>00091     <span class="keywordflow">return</span> Sp;
<a name="l00092"></a>00092   }
<a name="l00093"></a>00093   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00094"></a>00094   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Cub = <a class="code" href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb" title="Four point cubic interpolation.">Cubica</a>(P1,P2,P3,P4,x,y);
<a name="l00095"></a>00095   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00096"></a>00096   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00097"></a>00097   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00098"></a>00098   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 3.*Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>/Deltax + (Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/QUAD(Deltax);
<a name="l00099"></a>00099   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> /= 12.;
<a name="l00100"></a>00100   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - 6.*Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax;
<a name="l00101"></a>00101   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax - Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax*Deltax*Deltax;
<a name="l00102"></a>00102   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00103"></a>00103   <span class="comment">//  printf(&quot;%lf %lf|%lf %lf|%lf %lf %lf\n&quot;,Sp.a0,SpMem.a1,Sp.a1,Sp.a2,SpMem.a2,Sp.a3,Sp.a4);</span>
<a name="l00104"></a>00104   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00105"></a>00105   SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>;
<a name="l00106"></a>00106   <span class="keywordflow">return</span> Sp;
<a name="l00107"></a>00107 }
<a name="l00108"></a><a class="code" href="classMatematica.html#aacb11b0728e0fbaaa3597c7e03b562c7">00108</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a6b6c8217f2c75492c48cd60e4d9c17cf" title="Four order spline.">Matematica::Spline4</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00109"></a>00109   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00110"></a>00110   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00111"></a>00111     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00112"></a>00112     <span class="keywordflow">return</span> Sp;
<a name="l00113"></a>00113   }
<a name="l00114"></a>00114   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00115"></a>00115   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00116"></a>00116   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00117"></a>00117   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00118"></a>00118   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00119"></a>00119 <span class="comment">//   Sp.a1 = Par.B - 13.*Sp.a2*Deltax/2. - 3.*(P2[y] - P1[y])/Deltax - Par.A*Deltax/2.;</span>
<a name="l00120"></a>00120 <span class="comment">//   Sp.a1 /= 13.;</span>
<a name="l00121"></a>00121   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> + 2.*Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - 3.*(P2[y] - P1[y])/(Deltax*Deltax) + 3.*Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>/Deltax;
<a name="l00122"></a>00122   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> /= 3.;
<a name="l00123"></a>00123   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = (P2[y] - P1[y])/(Deltax*Deltax*Deltax) - Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>/(Deltax*Deltax) - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>/Deltax - Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax;
<a name="l00124"></a>00124   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00125"></a>00125   <span class="comment">//printf(&quot;%lf %lf|%lf %lf|%lf %lf %lf\n&quot;,Sp.a0,SpMem.a1,Sp.a1,Sp.a2,SpMem.a2,Sp.a3,Sp.a4);</span>
<a name="l00126"></a>00126   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Par.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00127"></a>00127   <span class="keywordflow">return</span> Sp;
<a name="l00128"></a>00128 }
<a name="l00129"></a><a class="code" href="classMatematica.html#a0b3e535c3c50459ad85fbb27d8ab0ca3">00129</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a0b3e535c3c50459ad85fbb27d8ab0ca3" title="Four order spline just before the end.">Matematica::Spline4PreEnd</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00130"></a>00130   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00131"></a>00131   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00132"></a>00132     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00133"></a>00133     <span class="keywordflow">return</span> Sp;
<a name="l00134"></a>00134   }
<a name="l00135"></a>00135   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00136"></a>00136   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par = <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Parab2</a>(P1,P2,P3,x,y);
<a name="l00137"></a>00137   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00138"></a>00138   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00139"></a>00139   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = (Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>)/Deltax + 4.*SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>;
<a name="l00140"></a>00140   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = (SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>)/(6.*Deltax);
<a name="l00141"></a>00141   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax - Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax*Deltax*Deltax;
<a name="l00142"></a>00142   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00143"></a>00143   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00144"></a>00144   SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>;
<a name="l00145"></a>00145   <span class="keywordflow">return</span> Sp;
<a name="l00146"></a>00146 }
<a name="l00147"></a><a class="code" href="classMatematica.html#a13fad8c692fb52f3ccd8a5f47b7db2cb">00147</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a13fad8c692fb52f3ccd8a5f47b7db2cb" title="Four order spline last boundary.">Matematica::Spline4End</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00148"></a>00148   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Sp; Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00149"></a>00149   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00150"></a>00150     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00151"></a>00151     <span class="keywordflow">return</span> Sp;
<a name="l00152"></a>00152   }
<a name="l00153"></a>00153   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00154"></a>00154   Sp.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y];
<a name="l00155"></a>00155   Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>;
<a name="l00156"></a>00156   <span class="comment">//Sp.a3 = (Sp.a2 - 0.)/Deltax + 4.*SpMem.a3;</span>
<a name="l00157"></a>00157   Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = 0.;
<a name="l00158"></a>00158   Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = (SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>)/(6.*Deltax);
<a name="l00159"></a>00159   Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = (P2[y] - P1[y])/Deltax - Sp.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*Deltax - Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*Deltax*Deltax - Sp.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*Deltax*Deltax*Deltax;
<a name="l00160"></a>00160   SpMem.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = 0.;
<a name="l00161"></a>00161   SpMem.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = Sp.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>;
<a name="l00162"></a>00162   SpMem.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Sp.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>;
<a name="l00163"></a>00163   <span class="keywordflow">return</span> Sp;
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 <span class="comment">//BSplines</span>
<a name="l00166"></a>00166 <span class="comment">//   double w = x - floor(x) - 1.;</span>
<a name="l00167"></a>00167 <span class="comment">//   xSp.a3 = (1./6.)*w * w * w;</span>
<a name="l00168"></a>00168 <span class="comment">//   xSp.a0 = (1./6.) + (1./2.)*w*(w-1.)-xSp.a3;</span>
<a name="l00169"></a>00169 <span class="comment">//   xSp.a2 = w + xSp.a0 - 2*xSp.a3;</span>
<a name="l00170"></a>00170 <span class="comment">//   xSp.a1 = 1. - xSp.a0 - xSp.a2 - xSp.a3;</span>
<a name="l00171"></a>00171 <span class="comment">//   Resp = xSp.a0*P1[0]+xSp.a1*P2[0]+xSp.a2*P3[0];</span>
<a name="l00172"></a>00172   <span class="comment">//  w = y - 3.;</span>
<a name="l00173"></a>00173 <span class="comment">//   ySp.a3 = (1./6.)*w * w * w;</span>
<a name="l00174"></a>00174 <span class="comment">//   ySp.a0 = (1./6.) + (1./2.)*w*(w-1.)-ySp.a3;</span>
<a name="l00175"></a>00175 <span class="comment">//   ySp.a2 = w + ySp.a0 - 2*ySp.a3;</span>
<a name="l00176"></a>00176 <span class="comment">//   ySp.a1 = 1. - ySp.a0 - ySp.a2 - ySp.a3;</span>
<a name="l00177"></a>00177   <span class="comment">//  Resp *= ySp.a0*P1[1]+ySp.a1*P2[1]+ySp.a2*P3[1];</span>
<a name="l00178"></a><a class="code" href="classMatematica.html#a0bf66137177a5078071d2da064fa3a72">00178</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a0bf66137177a5078071d2da064fa3a72" title="Three points parabolic interpolation.">Matematica::Parab</a>(<span class="keywordtype">double</span> *P1,<span class="keywordtype">double</span> *P2,<span class="keywordtype">double</span> *P3,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00179"></a>00179   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par; Par.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00180"></a>00180   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00181"></a>00181     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00182"></a>00182     <span class="keywordflow">return</span> Par;
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184   <span class="keywordtype">double</span> Deltax = P2[x] - P1[x];
<a name="l00185"></a>00185   <span class="keywordtype">double</span> Deltax2 = QUAD(P2[x]) - QUAD(P1[x]);
<a name="l00186"></a>00186   <span class="keywordtype">double</span> Dx = P3[x] - P1[x];
<a name="l00187"></a>00187   <span class="keywordtype">double</span> Dx2 = QUAD(P3[x]) - QUAD(P1[x]);
<a name="l00188"></a>00188   <span class="keywordtype">double</span> Deltay = P2[y] - P1[y];
<a name="l00189"></a>00189   <span class="keywordtype">double</span> Dy = P3[y] - P1[y];
<a name="l00190"></a>00190   <span class="keywordtype">double</span> b1= Dy - Deltay/Deltax2*Dx2;
<a name="l00191"></a>00191   <span class="keywordtype">double</span> b2= Dx - Deltax/Deltax2*Dx2;
<a name="l00192"></a>00192   Par.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = b1/b2;
<a name="l00193"></a>00193   Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = Deltay/Deltax2 - Par.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>*Deltax/Deltax2;
<a name="l00194"></a>00194   Par.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = P1[y] - Par.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a>*P1[x] - Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*QUAD(P1[x]);
<a name="l00195"></a>00195   Par.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = 0.;
<a name="l00196"></a>00196   Par.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00197"></a>00197   <span class="keywordflow">return</span> Par;
<a name="l00198"></a>00198 }
<a name="l00199"></a><a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300">00199</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a000dcbdd9b1b4f62dd4c4b2fc19ff300" title="Three points parabolic interpolation.">Matematica::Parab2</a>(<span class="keywordtype">double</span> *PA,<span class="keywordtype">double</span> *PB,<span class="keywordtype">double</span> *PC,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00200"></a>00200   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Par; Par.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00201"></a>00201   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00202"></a>00202     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00203"></a>00203     <span class="keywordflow">return</span> Par;
<a name="l00204"></a>00204   }
<a name="l00205"></a>00205   <span class="keywordtype">double</span> DxAB = PA[x] - PB[x];
<a name="l00206"></a>00206   <span class="keywordtype">double</span> DxCB = PC[x] - PB[x];
<a name="l00207"></a>00207   <span class="keywordtype">double</span> DyCB = PC[y] - PB[y];
<a name="l00208"></a>00208   <span class="keywordtype">double</span> DyAB = PA[y] - PB[y];
<a name="l00209"></a>00209   <span class="keywordtype">double</span> a1 = DyCB * DxAB - DyAB * DxCB;
<a name="l00210"></a>00210   <span class="keywordtype">double</span> a2 = DxCB*DxCB*DxAB - DxCB*DxAB*DxAB;
<a name="l00211"></a>00211   Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = a1/a2;
<a name="l00212"></a>00212   Par.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = DyAB/DxAB - Par.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*DxAB;
<a name="l00213"></a>00213   Par.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = PB[y];
<a name="l00214"></a>00214   Par.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = 0.;
<a name="l00215"></a>00215   Par.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00216"></a>00216   <span class="keywordflow">return</span> Par;
<a name="l00217"></a>00217 }
<a name="l00218"></a><a class="code" href="classMatematica.html#a40a33aaca86667162b5772e49e969d56">00218</a> <a class="code" href="structCIRCLE.html" title="Radius and center of a circle.">CIRCLE</a> <a class="code" href="classMatematica.html#a40a33aaca86667162b5772e49e969d56" title="Osculant circle.">Matematica::Osculante</a>(<span class="keywordtype">double</span> *PA,<span class="keywordtype">double</span> *PB,<span class="keywordtype">double</span> *PC,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00219"></a>00219   <a class="code" href="structCIRCLE.html" title="Radius and center of a circle.">CIRCLE</a> Cir; Cir.<a class="code" href="structCIRCLE.html#a7d873dd60d81fee341939655db765355" title="y position of the center">yC</a> = 0.;
<a name="l00220"></a>00220   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00221"></a>00221     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00222"></a>00222     <span class="keywordflow">return</span> Cir;
<a name="l00223"></a>00223   }
<a name="l00224"></a>00224   <span class="keywordtype">double</span> DxCA = PC[x] - PA[x];
<a name="l00225"></a>00225   <span class="keywordtype">double</span> DxBA = PB[x] - PA[x];
<a name="l00226"></a>00226   <span class="keywordtype">double</span> DyAC = PA[y] - PC[y];
<a name="l00227"></a>00227   <span class="keywordtype">double</span> DyAB = PA[y] - PB[y];
<a name="l00228"></a>00228   <span class="keywordtype">double</span> DxAB2 = QUAD(PA[x]) - QUAD(PB[x]);
<a name="l00229"></a>00229   <span class="keywordtype">double</span> DxAC2 = QUAD(PA[x]) - QUAD(PC[x]);
<a name="l00230"></a>00230   <span class="keywordtype">double</span> DyBA2 = QUAD(PB[y]) - QUAD(PA[y]);
<a name="l00231"></a>00231   <span class="keywordtype">double</span> DyCA2 = QUAD(PC[y]) - QUAD(PA[y]);
<a name="l00232"></a>00232   <span class="keywordtype">double</span> a1 = DxCA*(DyBA2 - DxAB2) - DxBA*(DyCA2 - DxAB2);
<a name="l00233"></a>00233   <span class="keywordtype">double</span> a2 = 2.*(DyAC*DxBA - DyAB*DxCA);
<a name="l00234"></a>00234   Cir.<a class="code" href="structCIRCLE.html#a7d873dd60d81fee341939655db765355" title="y position of the center">yC</a> = a1/a2;
<a name="l00235"></a>00235   Cir.<a class="code" href="structCIRCLE.html#a948efd29e2703858b2752cdba79b89c2" title="x position of the center">xC</a> = (DyBA2 - DxAB2 + 2.*Cir.<a class="code" href="structCIRCLE.html#a7d873dd60d81fee341939655db765355" title="y position of the center">yC</a>*DyAB)/DxBA;
<a name="l00236"></a>00236   Cir.<a class="code" href="structCIRCLE.html#a860bef50013f57ab1a6437b7986a9487" title="Radius of the circle.">Rad</a> = sqrt( QUAD((PA[x] - Cir.<a class="code" href="structCIRCLE.html#a948efd29e2703858b2752cdba79b89c2" title="x position of the center">xC</a>)) + QUAD((PA[y] - Cir.<a class="code" href="structCIRCLE.html#a7d873dd60d81fee341939655db765355" title="y position of the center">yC</a>)) );
<a name="l00237"></a>00237   <span class="keywordflow">return</span> Cir;
<a name="l00238"></a>00238 }
<a name="l00239"></a><a class="code" href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb">00239</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#acc21ee420953fcc9d0587f56324631cb" title="Four point cubic interpolation.">Matematica::Cubica</a>(<span class="keywordtype">double</span> *PA,<span class="keywordtype">double</span> *PB,<span class="keywordtype">double</span> *PC,<span class="keywordtype">double</span> *PD,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00240"></a>00240   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Cub; Cub.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = 0.;
<a name="l00241"></a>00241   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00242"></a>00242     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00243"></a>00243     <span class="keywordflow">return</span> Cub;
<a name="l00244"></a>00244   }
<a name="l00245"></a>00245   <span class="keywordtype">double</span> DyDB = PD[y] - PB[y];
<a name="l00246"></a>00246   <span class="keywordtype">double</span> DyCB = PC[y] - PB[y];
<a name="l00247"></a>00247   <span class="keywordtype">double</span> DyAB = PA[y] - PB[y];
<a name="l00248"></a>00248   <span class="keywordtype">double</span> DxDB = PD[x] - PB[x];
<a name="l00249"></a>00249   <span class="keywordtype">double</span> DxCB = PC[x] - PB[x];
<a name="l00250"></a>00250   <span class="keywordtype">double</span> DxAB = PA[x] - PB[x];
<a name="l00251"></a>00251   <span class="keywordtype">double</span> DxCA = PC[x] - PA[x];
<a name="l00252"></a>00252   <span class="keywordtype">double</span> Num3 = DyDB/DxDB - DyAB/DxAB - (DyCB/DxCB - DyAB/DxAB)*(DxDB - DxAB)/DxCA;
<a name="l00253"></a>00253   <span class="keywordtype">double</span> Den3 = DxDB*DxDB - DxAB*DxAB - (DxCB*DxCB - DxAB*DxAB)*(DxDB - DxAB)/DxCA;
<a name="l00254"></a>00254   Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Num3/Den3;
<a name="l00255"></a>00255   Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = DyCB/DxCB - DyAB/DxAB - Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*(DxCB*DxCB - DxAB*DxAB);
<a name="l00256"></a>00256   Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> /= DxCA;
<a name="l00257"></a>00257   Cub.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = DyAB/DxAB - Cub.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*DxAB - Cub.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*DxAB*DxAB;
<a name="l00258"></a>00258   Cub.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = PB[y];
<a name="l00259"></a>00259   Cub.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = 0.;
<a name="l00260"></a>00260   <span class="keywordflow">return</span> Cub;
<a name="l00261"></a>00261 }
<a name="l00262"></a><a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424">00262</a> <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424" title="Five points four order interpolation.">Matematica::Forth</a>(<span class="keywordtype">double</span> *PA,<span class="keywordtype">double</span> *PB,<span class="keywordtype">double</span> *PC,<span class="keywordtype">double</span> *PD,<span class="keywordtype">double</span> *PE,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y){
<a name="l00263"></a>00263   <a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> <a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424" title="Five points four order interpolation.">Forth</a>; Forth.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a>=0.;
<a name="l00264"></a>00264   <span class="keywordflow">if</span>(x &lt; 0 || x&gt;3 || y &lt; 0 || y&gt;3){
<a name="l00265"></a>00265     printf(<span class="stringliteral">&quot;x,y must be 0 &lt;= %d , %d &lt; 3\n&quot;</span>,x,y);
<a name="l00266"></a>00266     <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424" title="Five points four order interpolation.">Forth</a>;
<a name="l00267"></a>00267   }
<a name="l00268"></a>00268   <span class="keywordtype">double</span> Dx = ASS((PC[x] - PB[x]));
<a name="l00269"></a>00269   Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = PA[y]/12. - PB[y]/6. + PD[y]/6. - PE[y]/12.;
<a name="l00270"></a>00270   Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> /= -Dx*Dx*Dx;
<a name="l00271"></a>00271   Forth.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = - PA[y]/12. + 4.*PB[y]/6. - 4.*PD[y]/6. + PE[y]/12.;
<a name="l00272"></a>00272   Forth.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> /= -Dx;
<a name="l00273"></a>00273   Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = PA[y]/24. - PB[y]/6. + 1./4.*PC[y] - PD[y]/6. + PE[y]/24.;
<a name="l00274"></a>00274   Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> /= Dx*Dx*Dx*Dx;
<a name="l00275"></a>00275   Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = -PA[y]/24. + 2./3.*PB[y] - 5./4.*PC[y] + 2./3.*PD[y] - PE[y]/24.;
<a name="l00276"></a>00276   Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> /= Dx*Dx;
<a name="l00277"></a>00277   Forth.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = PC[y];
<a name="l00278"></a>00278   <span class="comment">//printf(&quot;Dx %lf Coeff %lf %lf %lf %lf %lf \n&quot;,Dx,Forth.a0,Forth.a1,Forth.a2,Forth.a3,Forth.a4);</span>
<a name="l00279"></a>00279   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424" title="Five points four order interpolation.">Forth</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281   <span class="keywordtype">double</span> DxCA = PC[x] - PA[x];
<a name="l00282"></a>00282   <span class="keywordtype">double</span> DxCB = PC[x] - PB[x];
<a name="l00283"></a>00283   <span class="keywordtype">double</span> DxCD = PC[x] - PD[x];
<a name="l00284"></a>00284   <span class="keywordtype">double</span> DxCE = PC[x] - PE[x];
<a name="l00285"></a>00285   <span class="keywordtype">double</span> DxAB = PA[x] - PB[x];
<a name="l00286"></a>00286   <span class="keywordtype">double</span> DxAD = PA[x] - PD[x];
<a name="l00287"></a>00287   <span class="keywordtype">double</span> DyAC = (PA[y] - PC[y])/DxCA;
<a name="l00288"></a>00288   <span class="keywordtype">double</span> DyBC = (PB[y] - PC[y])/DxCB;
<a name="l00289"></a>00289   <span class="keywordtype">double</span> DyDC = (PD[y] - PC[y])/DxCD;
<a name="l00290"></a>00290   <span class="keywordtype">double</span> DyEC = (PE[y] - PC[y])/DxCE;
<a name="l00291"></a>00291   <span class="comment">//if(DxCB == DxCD)</span>
<a name="l00292"></a>00292   <span class="keywordflow">if</span> (1==1)
<a name="l00293"></a>00293     {
<a name="l00294"></a>00294       <span class="keywordtype">double</span> DxDB = PD[x] - PB[x];
<a name="l00295"></a>00295       <span class="keywordtype">double</span> DxEA = PE[x] - PA[x];
<a name="l00296"></a>00296       <span class="keywordtype">double</span> DyBD = (PB[y] - PD[y])/DxDB;
<a name="l00297"></a>00297       <span class="keywordtype">double</span> DyAE = (PA[y] - PE[y])/DxEA;
<a name="l00298"></a>00298       <span class="comment">//      Forth.a4 = - Noto34/Num34;</span>
<a name="l00299"></a>00299       Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = DyBC - DyDC - DyEC + DyAC;
<a name="l00300"></a>00300       Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> /= (DxCE*DxCE*DxCE - DxCA*DxCA*DxCA) - (DxCB*DxCB*DxCB - DxCD*DxCD*DxCD);
<a name="l00301"></a>00301       Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = DyBC - DyDC - Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*(DxCB*DxCB*DxCB - DxCD*DxCD*DxCD);
<a name="l00302"></a>00302       Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = DyBD - DyAE;
<a name="l00303"></a>00303       Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> /= (DxCB*DxCB*DxCB - DxCD*DxCD*DxCD)/DxDB - 
<a name="l00304"></a>00304    (DxCA*DxCA*DxCA - DxCE*DxCE*DxCE)/DxEA;
<a name="l00305"></a>00305       Forth.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = DyAE - Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*(DxCA*DxCA*DxCA - DxCE*DxCE*DxCE)/DxEA;
<a name="l00306"></a>00306     }
<a name="l00307"></a>00307   <span class="keywordflow">else</span>
<a name="l00308"></a>00308     {
<a name="l00309"></a>00309       <span class="keywordtype">double</span> DxAE = PA[x] - PE[x];
<a name="l00310"></a>00310       <span class="keywordtype">double</span> Den34 = DxAB*(DxCB*DxCB - DxCA*DxCA) - DxAB*(DxCD*DxCD - DxCA*DxCA);<span class="comment">// 0.;</span>
<a name="l00311"></a>00311       <span class="keywordtype">double</span> Num34 = DxAB*(DxCD*DxCD*DxCD - DxCA*DxCA*DxCA) - DxAD*(DxCB*DxCB*DxCB - DxCA*DxCA*DxCA);<span class="comment">//21Dx</span>
<a name="l00312"></a>00312       <span class="keywordtype">double</span> Noto34 = DyBC*DxAD - DyAC*DxAD - DyDC*DxAB + DyAC*DxAB;
<a name="l00313"></a>00313       <span class="keywordtype">double</span> Num4 = -DxAB*(Noto34*(DxCE*DxCE - DxCA*DxCA) - DyEC + DyAC) + 
<a name="l00314"></a>00314    DxAE*(Noto34*(DxCB*DxCB - DxCA*DxCA) - DyBC + DyAC);
<a name="l00315"></a>00315       <span class="keywordtype">double</span> Den4 = DxAB*(Num34/Den34*(DxCE*DxCE - DxCA*DxCA) + (DxCE*DxCE*DxCE -  DxCA*DxCA*DxCA) ) - 
<a name="l00316"></a>00316    DxAE*(Num34/Den34*(DxCB*DxCB - DxCA*DxCA) + (DxCB*DxCB*DxCB - DxCA*DxCA*DxCA));
<a name="l00317"></a>00317       <span class="comment">//printf(&quot;Dx %lf %lf %lf %lf %lf %lf %lf\n&quot;,DxCB,Den34,Num34,Noto34,Num4,Den4,Num34/Den34);</span>
<a name="l00318"></a>00318       Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> = Num4/Den4;
<a name="l00319"></a>00319       Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> = Num34/Den34*Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a> + Noto34;
<a name="l00320"></a>00320       Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> = DyBC - DyAC - Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*(DxCB*DxCB - DxCA*DxCA) - Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>* (DxCB*DxCB*DxCB - DxCA*DxCA*DxCA);
<a name="l00321"></a>00321       Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> /= DxAB;
<a name="l00322"></a>00322       Forth.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> = DyAC - Forth.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a>*DxCA - Forth.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a>*DxCA*DxCA - Forth.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>*DxCA*DxCA*DxCA;
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324   Forth.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> = PC[y];
<a name="l00325"></a>00325   <span class="comment">//printf(&quot;%lf %lf %lf %lf %lf \n&quot;,Forth.a0,Forth.a1,Forth.a2,Forth.a3,Forth.a4);</span>
<a name="l00326"></a>00326   <span class="keywordflow">return</span> <a class="code" href="classMatematica.html#a7eb694853e69b9cbd2020788e9665424" title="Five points four order interpolation.">Forth</a>;
<a name="l00327"></a>00327 }
<a name="l00328"></a><a class="code" href="classMatematica.html#a4811dba3bc03279d94c49e2a480dae4f">00328</a> <span class="keywordtype">int</span> <a class="code" href="classMatematica.html#a4811dba3bc03279d94c49e2a480dae4f" title="Polinimial interpolation of  NMass order.">Matematica::Polinomio</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass,<a class="code" href="classSpline.html" title="coeficients of a N order spline">Spline</a> *Sp){
<a name="l00329"></a>00329   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *Coeff = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(NMass,NMass);
<a name="l00330"></a>00330   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;NMass;r++){
<a name="l00331"></a>00331     Sp-&gt;<a class="code" href="classSpline.html#ae74ad20f1ff215326c2ef49911e605b1" title="Set the n coefficient.">SetCoe</a>( 0. , r);
<a name="l00332"></a>00332     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NMass;c++){
<a name="l00333"></a>00333       Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,c,<a class="code" href="classMatematica.html#a81f44d652f61225a2725c0cb3cbc9524" title="Integer power.">Elevato</a>(Px[r],c));
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335   }
<a name="l00336"></a>00336   Coeff-&gt;<a class="code" href="classMatrice.html#acd68476b8afc6a2dcfb8663ead8b39cd" title="Invert.">Invert</a>();
<a name="l00337"></a>00337   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NMass;c++){
<a name="l00338"></a>00338     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;NMass;r++){
<a name="l00339"></a>00339       Sp-&gt;<a class="code" href="classSpline.html#aeda17df26c0620cbf9e634c00de774df" title="Add to the n coefficient.">AddCoe</a>( Coeff-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(r,c)*Py[c] , r);
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341   }
<a name="l00342"></a>00342   <span class="keyword">delete</span>  Coeff;
<a name="l00343"></a>00343   <span class="keywordflow">return</span> 1;
<a name="l00344"></a>00344 }
<a name="l00345"></a><a class="code" href="classMatematica.html#a27b793e32b1410383bacb44d0233ee86">00345</a> <span class="keywordtype">int</span> <a class="code" href="classMatematica.html#a27b793e32b1410383bacb44d0233ee86" title="Boh.">Matematica::DerMatrix</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass,<a class="code" href="structSPLINE.html" title="Coefficient of a spline.">SPLINE</a> Wg,<a class="code" href="classSpline.html" title="coeficients of a N order spline">Spline</a> *Sp){
<a name="l00346"></a>00346   <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a> *Coeff = <span class="keyword">new</span> <a class="code" href="classMatrice.html" title="Matrice computes the algebric operations on matrices.">Matrice</a>(NMass,NMass);
<a name="l00347"></a>00347   <span class="keywordtype">double</span> MenoDue = - .75*Wg.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> + 1.5*Wg.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>;  
<a name="l00348"></a>00348   <span class="comment">//MenoDue += .125*Wg.a1 - .125*Wg.a2; //O(h^4)</span>
<a name="l00349"></a>00349   <span class="keywordtype">double</span> MenoUno = -.5*Wg.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> + Wg.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> + 1.5*Wg.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - 6.*Wg.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>;
<a name="l00350"></a>00350   <span class="comment">//MenoUno += -.125*Wg.a1 - .5*Wg.a2;</span>
<a name="l00351"></a>00351   <span class="keywordtype">double</span> Zero = Wg.<a class="code" href="structSPLINE.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a0</a> - 2.*Wg.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> + 9.*Wg.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>;
<a name="l00352"></a>00352   <span class="comment">//Zero += 0.75*Wg.a2;</span>
<a name="l00353"></a>00353   <span class="keywordtype">double</span> PiuUno = .5*Wg.<a class="code" href="structSPLINE.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a1</a> + Wg.<a class="code" href="structSPLINE.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a2</a> - 1.5*Wg.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> - 6.*Wg.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>;
<a name="l00354"></a>00354   <span class="comment">//PiuUno += .25*Wg.a1 + .5*Wg.a2;</span>
<a name="l00355"></a>00355   <span class="keywordtype">double</span> PiuDue = .75*Wg.<a class="code" href="structSPLINE.html#aac922a785af4fb14fc828152cd94c34e" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a3</a> + 1.5*Wg.<a class="code" href="structSPLINE.html#ac6ef178808a2e015c97d93c99e52a441" title="a0 + a1*x + a2*x^2 + a3*x^3 + a4^4">a4</a>;
<a name="l00356"></a>00356   <span class="comment">//PiuDue += -.125*Wg.a1 -.125*Wg.a2;</span>
<a name="l00357"></a>00357   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;NMass;r++){
<a name="l00358"></a>00358     <span class="keywordflow">if</span>(r&gt; 1) Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-2,MenoDue*Px[r-2]);
<a name="l00359"></a>00359     <span class="keywordflow">if</span>(r&gt; 0) Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r-1,MenoUno*Px[r-1]);
<a name="l00360"></a>00360     <span class="keywordflow">if</span>(r&lt; NMass-1) Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+1,PiuUno*Px[r+1]);
<a name="l00361"></a>00361     <span class="keywordflow">if</span>(r&lt; NMass-2) Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r+2,PiuDue*Px[r+2]);
<a name="l00362"></a>00362     Coeff-&gt;<a class="code" href="classMatrice.html#a3caf89cd6f9ccd16fcdc6a6c57039c2f" title="Set a coefficient.">Set</a>(r,r,Zero*Px[r]);
<a name="l00363"></a>00363   }
<a name="l00364"></a>00364   <span class="comment">//Coeff-&gt;Print();</span>
<a name="l00365"></a>00365   Coeff-&gt;<a class="code" href="classMatrice.html#acd68476b8afc6a2dcfb8663ead8b39cd" title="Invert.">Invert</a>();
<a name="l00366"></a>00366   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0;r&lt;NMass;r++){
<a name="l00367"></a>00367     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;NMass;c++){
<a name="l00368"></a>00368       Sp-&gt;<a class="code" href="classSpline.html#aeda17df26c0620cbf9e634c00de774df" title="Add to the n coefficient.">AddCoe</a>( Coeff-&gt;<a class="code" href="classMatrice.html#a2a233d9af97c320a1b372ededf056886" title="Returns a value in 1d.">Val</a>(r,c)*Py[c] , r);
<a name="l00369"></a>00369     }
<a name="l00370"></a>00370   }
<a name="l00371"></a>00371   <span class="keyword">delete</span> Coeff;
<a name="l00372"></a>00372   <span class="keywordflow">return</span> 0;
<a name="l00373"></a>00373 }
<a name="l00374"></a><a class="code" href="classMatematica.html#aa0b83812f24967b127cbd0b508d8ed95">00374</a> <span class="keywordtype">double</span> <a class="code" href="classMatematica.html#aa0b83812f24967b127cbd0b508d8ed95" title="Linear interpolation between two points.">Matematica::LinInterp</a>(<span class="keywordtype">double</span> Px1,<span class="keywordtype">double</span> Px2,<span class="keywordtype">double</span> Py1,<span class="keywordtype">double</span> Py2,<span class="keywordtype">double</span> x){
<a name="l00375"></a>00375   <span class="keywordtype">double</span> m = (Py2-Py1)/(Px2-Px1);
<a name="l00376"></a>00376   <span class="keywordtype">double</span> q = Py1 - m*Px1;
<a name="l00377"></a>00377   <span class="keywordflow">return</span> m*x+q;
<a name="l00378"></a>00378 }
<a name="l00379"></a><a class="code" href="classMatematica.html#a704c5213772cd3d9fd7dd77d74461bf2">00379</a> <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> <a class="code" href="classMatematica.html#a704c5213772cd3d9fd7dd77d74461bf2" title="Linear interpolation.">Matematica::InterRett</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass){
<a name="l00380"></a>00380   <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1;
<a name="l00381"></a>00381   <span class="keywordtype">double</span> Uno=0.;<span class="keywordtype">double</span> Due=0.;<span class="keywordtype">double</span> Tre=0.;<span class="keywordtype">double</span> Quattro=0.;
<a name="l00382"></a>00382   <span class="keywordtype">double</span> UnoUno=0.;<span class="keywordtype">double</span> DueUno=0.;<span class="keywordtype">double</span> ZeroUno=0.;<span class="keywordtype">double</span> ZeroDue=0.;
<a name="l00383"></a>00383   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00384"></a>00384     <span class="comment">//printf(&quot;%lf %lf\n&quot;,Px[i],Py[i]);</span>
<a name="l00385"></a>00385     Uno += Px[i];
<a name="l00386"></a>00386     Due += QUAD(Px[i]);
<a name="l00387"></a>00387     ZeroUno += Py[i];
<a name="l00388"></a>00388     UnoUno += Px[i]*Py[i];
<a name="l00389"></a>00389     ZeroDue += QUAD(Py[i]);
<a name="l00390"></a>00390   }
<a name="l00391"></a>00391   <span class="keywordtype">double</span> Mediax = Uno / (double) NMass;
<a name="l00392"></a>00392   <span class="keywordtype">double</span> Mediay = ZeroUno / (double) NMass;
<a name="l00393"></a>00393   <span class="keywordtype">double</span> Scartox = (Due - NMass*Uno*Uno)/(<span class="keywordtype">double</span>)(NMass-0);
<a name="l00394"></a>00394   <span class="keywordtype">double</span> Scartoy = (ZeroDue - NMass*ZeroUno*ZeroUno)/(<span class="keywordtype">double</span>)(NMass-0);
<a name="l00395"></a>00395   r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a> = (NMass*UnoUno - Uno*ZeroUno) / (NMass*Due - Uno*Uno);
<a name="l00396"></a>00396   r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a> = (ZeroUno - r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>*Uno)/NMass;
<a name="l00397"></a>00397   <span class="keywordtype">double</span> Posteriori = 0.;
<a name="l00398"></a>00398   r1.<a class="code" href="structRETTA.html#a8e12192aad40946228d8a4edc7dceb7f" title="Covariance.">Cov</a> = UnoUno/(double)NMass - Mediax*Mediay;
<a name="l00399"></a>00399   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00400"></a>00400     Posteriori += QUAD(( Px[i]*r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a> + r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a> - Py[i] ));
<a name="l00401"></a>00401   }
<a name="l00402"></a>00402   r1.<a class="code" href="structRETTA.html#a6f469ce3f1211104f5524db4b5303ed9" title="Correlation.">Corr</a> = r1.<a class="code" href="structRETTA.html#a8e12192aad40946228d8a4edc7dceb7f" title="Covariance.">Cov</a> / ( sqrt(Scartox*Scartoy) );
<a name="l00403"></a>00403   r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> = sqrt(Posteriori/(<span class="keywordtype">double</span>)(NMass-2));
<a name="l00404"></a>00404   r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a> = r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> * sqrt( NMass / (NMass * Due - Uno*Uno)); 
<a name="l00405"></a>00405   r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a> = r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> * sqrt( Due / (NMass*Due - Uno*Uno) );
<a name="l00406"></a>00406   <span class="comment">//  printf(&quot;m %lf q %lf r %lf sigma %lf Mediax %lf Mediay %lf\n&quot;,r1.m,r1.q,r1.r,r1.Corr,Mediax,Mediay);</span>
<a name="l00407"></a>00407   <span class="keywordflow">return</span> r1;
<a name="l00408"></a>00408 }
<a name="l00409"></a>00409 <span class="comment">// Vettore Matematica::Directive(double *Px,int NMass){</span>
<a name="l00410"></a>00410 <span class="comment">//   Vettore v1(3);</span>
<a name="l00411"></a>00411   
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="comment">// }</span>
<a name="l00414"></a><a class="code" href="classMatematica.html#ad5a7658737a31da4e856a760a9beed80">00414</a> <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> <a class="code" href="classMatematica.html#a704c5213772cd3d9fd7dd77d74461bf2" title="Linear interpolation.">Matematica::InterRett</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">double</span> *Peso,<span class="keywordtype">int</span> NMass){
<a name="l00415"></a>00415   <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1;
<a name="l00416"></a>00416   <span class="keywordtype">double</span> Mediax = 0.;
<a name="l00417"></a>00417   <span class="keywordtype">double</span> Mediay = 0.;
<a name="l00418"></a>00418   <span class="keywordtype">double</span> Scartox = 0.;
<a name="l00419"></a>00419   <span class="keywordtype">double</span> Scartoy = 0.;
<a name="l00420"></a>00420   <span class="keywordtype">double</span> Pesox = 0.;
<a name="l00421"></a>00421   <span class="keywordtype">double</span> Uno=0.;<span class="keywordtype">double</span> Due=0.;<span class="keywordtype">double</span> Tre=0.;<span class="keywordtype">double</span> Quattro=0.;
<a name="l00422"></a>00422   <span class="keywordtype">double</span> UnoUno=0.;<span class="keywordtype">double</span> DueUno=0.;<span class="keywordtype">double</span> ZeroUno=0.;<span class="keywordtype">double</span> ZeroDue=0.;
<a name="l00423"></a>00423   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00424"></a>00424     Pesox += Peso[i];
<a name="l00425"></a>00425     Uno += Px[i]*Peso[i];
<a name="l00426"></a>00426     Due += QUAD(Px[i]*Peso[i]);
<a name="l00427"></a>00427     ZeroUno += Py[i];
<a name="l00428"></a>00428     UnoUno += Px[i]*Py[i]*Peso[i];
<a name="l00429"></a>00429     ZeroDue += QUAD(Py[i]);
<a name="l00430"></a>00430   }
<a name="l00431"></a>00431   Mediax = Uno / (double) NMass/Pesox;
<a name="l00432"></a>00432   Mediay = ZeroUno / (double) NMass;
<a name="l00433"></a>00433   Scartox = (Due - Uno*Uno/QUAD(Pesox))/(<span class="keywordtype">double</span>)NMass;
<a name="l00434"></a>00434   Scartoy = (ZeroDue - ZeroUno*ZeroUno)/(<span class="keywordtype">double</span>)NMass;
<a name="l00435"></a>00435   r1.<a class="code" href="structRETTA.html#a6f469ce3f1211104f5524db4b5303ed9" title="Correlation.">Corr</a> = (UnoUno - Uno*ZeroUno) / (<span class="keywordtype">double</span>) NMass/Pesox ;
<a name="l00436"></a>00436   r1.<a class="code" href="structRETTA.html#a880a49112fedae68e714341a9a082fb6" title="r factor">r</a> = r1.<a class="code" href="structRETTA.html#a6f469ce3f1211104f5524db4b5303ed9" title="Correlation.">Corr</a> / ( sqrt(Scartox*Scartoy) );
<a name="l00437"></a>00437   r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a> = (NMass*UnoUno - Uno*ZeroUno) / (NMass*Due - Uno*Uno)/Pesox;
<a name="l00438"></a>00438   r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a> = Scartoy * sqrt( Due / (NMass * Due - Uno*Uno)/QUAD(Pesox)); 
<a name="l00439"></a>00439   r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a> = (ZeroUno - r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>*Uno)/NMass;
<a name="l00440"></a>00440   r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a> = Scartoy * sqrt( NMass / (NMass * Due - Uno*Uno)/QUAD(Pesox) );
<a name="l00441"></a>00441   <span class="keywordflow">return</span> r1;
<a name="l00442"></a>00442 }
<a name="l00443"></a><a class="code" href="classMatematica.html#a54633464985cd9a4864e2d0245fa231c">00443</a> <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> <a class="code" href="classMatematica.html#a54633464985cd9a4864e2d0245fa231c" title="Exponential interpolation.">Matematica::InterExp</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass){
<a name="l00444"></a>00444   <a class="code" href="structRETTA.html" title="Linear interpolation.">RETTA</a> r1;
<a name="l00445"></a>00445   <span class="keywordtype">double</span> Uno=0.;<span class="keywordtype">double</span> Due=0.;<span class="keywordtype">double</span> Tre=0.;<span class="keywordtype">double</span> Quattro=0.;
<a name="l00446"></a>00446   <span class="keywordtype">double</span> UnoUno=0.;<span class="keywordtype">double</span> DueUno=0.;<span class="keywordtype">double</span> ZeroUno=0.;<span class="keywordtype">double</span> ZeroDue=0.;
<a name="l00447"></a>00447   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00448"></a>00448     <span class="keywordflow">if</span>(Py[i] &lt;= 0.){
<a name="l00449"></a>00449       <span class="comment">//printf(&quot;Negative number not allowed for an exponential interpolation %lf\n&quot;,Py[i]);</span>
<a name="l00450"></a>00450       <span class="keywordflow">continue</span>;
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452     Uno += Px[i];
<a name="l00453"></a>00453     Due += QUAD(Px[i]);
<a name="l00454"></a>00454     ZeroUno += log10(Py[i]);
<a name="l00455"></a>00455     UnoUno += Px[i]*log10(Py[i]);
<a name="l00456"></a>00456     ZeroDue += QUAD(log10(Py[i]));
<a name="l00457"></a>00457   }
<a name="l00458"></a>00458   <span class="keywordtype">double</span> Mediax = Uno / (double) NMass;
<a name="l00459"></a>00459   <span class="keywordtype">double</span> Mediay = ZeroUno / (double) NMass;
<a name="l00460"></a>00460   <span class="keywordtype">double</span> Scartox = (Due - NMass*Uno*Uno)/(<span class="keywordtype">double</span>)(NMass-1);
<a name="l00461"></a>00461   <span class="keywordtype">double</span> Scartoy = (ZeroDue - NMass*ZeroUno*ZeroUno)/(<span class="keywordtype">double</span>)(NMass-1);
<a name="l00462"></a>00462   r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a> = (NMass*UnoUno - Uno*ZeroUno) / (NMass*Due - Uno*Uno);
<a name="l00463"></a>00463   r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a> = (ZeroUno - r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a>*Uno)/NMass;
<a name="l00464"></a>00464   <span class="keywordtype">double</span> Posteriori = 0.;
<a name="l00465"></a>00465   r1.<a class="code" href="structRETTA.html#a8e12192aad40946228d8a4edc7dceb7f" title="Covariance.">Cov</a> = UnoUno/(double)NMass - Mediax*Mediay;
<a name="l00466"></a>00466   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00467"></a>00467     Posteriori += QUAD(( Px[i]*r1.<a class="code" href="structRETTA.html#a5175b356eac1d83a42608b42a25d00b9" title="y = m*x + q">m</a> + r1.<a class="code" href="structRETTA.html#a5b5e3f03e443adea974601f295136638" title="y = m*x + q">q</a> - log10(Py[i]) ));
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469   r1.<a class="code" href="structRETTA.html#a6f469ce3f1211104f5524db4b5303ed9" title="Correlation.">Corr</a> = r1.<a class="code" href="structRETTA.html#a8e12192aad40946228d8a4edc7dceb7f" title="Covariance.">Cov</a> / ( sqrt(Scartox*Scartoy) );
<a name="l00470"></a>00470   r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> = sqrt(Posteriori/(<span class="keywordtype">double</span>)(NMass-2));
<a name="l00471"></a>00471   r1.<a class="code" href="structRETTA.html#a9fb99a6e1b11a7d83154875843000fc8" title="Error on the slope.">ErrM</a> = r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> * sqrt( NMass / (NMass * Due - Uno*Uno)); 
<a name="l00472"></a>00472   r1.<a class="code" href="structRETTA.html#a3d2f5c6d85a4ffb02fcf4410f3b049a3" title="Error on the intercept.">ErrQ</a> = r1.<a class="code" href="structRETTA.html#a8ca6dcd2c4b3c13b0164f59283c4dd28" title="Error a posteriori.">ErrY</a> * sqrt( Due / (NMass*Due - Uno*Uno) );
<a name="l00473"></a>00473   <span class="comment">//  printf(&quot;m %lf q %lf r %lf sigma %lf Mediax %lf Mediay %lf\n&quot;,r1.m,r1.q,r1.r,r1.Corr,Mediax,Mediay);</span>
<a name="l00474"></a>00474   <span class="keywordflow">return</span> r1;
<a name="l00475"></a>00475 }
<a name="l00476"></a><a class="code" href="classMatematica.html#ae9688b8f498233bf332032c7dafc1982">00476</a> <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> <a class="code" href="classMatematica.html#ae9688b8f498233bf332032c7dafc1982" title="Gaussian interpolation.">Matematica::InterGauss</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMax){
<a name="l00477"></a>00477   <a class="code" href="structMOMENTI.html" title="Moments of a distribution.">MOMENTI</a> m1; m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>=0.; m1.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a>=0.; m1.<a class="code" href="structMOMENTI.html#abfbb9b4d7abdcac6679c9c91109bfc6b" title="Third moment.">Tre</a>=0.;m1.<a class="code" href="structMOMENTI.html#a8466803d0c40a49457299b39f72651fe" title="Step interval.">Delta</a>=0.;m1.<a class="code" href="structMOMENTI.html#a558051bc0b213b418d65f58e4ad9a311" title="Number of points considered.">Num</a>=0;
<a name="l00478"></a>00478   m1.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a> = Px[0];
<a name="l00479"></a>00479   m1.<a class="code" href="structMOMENTI.html#a3b2b236fc7834236613c9a51e415be2e" title="Maximum value.">Max</a> = Px[0];
<a name="l00480"></a>00480   <span class="keywordtype">double</span> Count = 0.;
<a name="l00481"></a>00481   <span class="keywordtype">double</span> Sum2 = 0.;
<a name="l00482"></a>00482   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMax;i++){
<a name="l00483"></a>00483 <span class="preprocessor">#ifdef MAT_DEBUG</span>
<a name="l00484"></a>00484 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(Py[i] &lt; 0.){printf(<span class="stringliteral">&quot;Invalid weight %lf &lt; 0\n&quot;</span>,Py[i]);}
<a name="l00485"></a>00485 <span class="preprocessor">#endif</span>
<a name="l00486"></a>00486 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(Px[i]&lt;m1.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a>) m1.<a class="code" href="structMOMENTI.html#a780c7f9b946188b22a9355ed414c6af9" title="Minimum value.">Min</a> = Px[i];
<a name="l00487"></a>00487     <span class="keywordflow">if</span>(Px[i]&gt;m1.<a class="code" href="structMOMENTI.html#a3b2b236fc7834236613c9a51e415be2e" title="Maximum value.">Max</a>) m1.<a class="code" href="structMOMENTI.html#a3b2b236fc7834236613c9a51e415be2e" title="Maximum value.">Max</a> = Px[i];
<a name="l00488"></a>00488     m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a> += Px[i]*Py[i];
<a name="l00489"></a>00489     Sum2 += SQR(Px[i])*Py[i];
<a name="l00490"></a>00490     Count += Py[i];
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492   m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a> /= Count;
<a name="l00493"></a>00493   m1.<a class="code" href="structMOMENTI.html#a15d9d06c593c6771637966bd64f78b6f" title="Second moment.">Due</a> = sqrt(Sum2 - m1.<a class="code" href="structMOMENTI.html#ace35fa89d42816a5d3c59ff882b65e4c" title="First moment.">Uno</a>*NMax)/(double)(NMax-1);
<a name="l00494"></a>00494   <span class="keywordflow">return</span> m1;
<a name="l00495"></a>00495 }
<a name="l00496"></a><a class="code" href="classMatematica.html#a90a6e30254a3d26a422a173cdc46a823">00496</a> <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> <a class="code" href="classMatematica.html#a90a6e30254a3d26a422a173cdc46a823" title="Minimum of the Parabola between.">Matematica::MinimoParabola</a>(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b,<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass){
<a name="l00497"></a>00497   <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> Par;
<a name="l00498"></a>00498   <span class="keywordtype">double</span> Uno=0.;<span class="keywordtype">double</span> Due=0.;<span class="keywordtype">double</span> Tre=0.;<span class="keywordtype">double</span> Quattro=0.;
<a name="l00499"></a>00499   <span class="keywordtype">double</span> UnoUno=0.;<span class="keywordtype">double</span> DueUno=0.;<span class="keywordtype">double</span> ZeroUno=0.;<span class="keywordtype">double</span> ZeroDue=0.;
<a name="l00500"></a>00500   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;*(Px+i)&lt;b || i&lt;NMass;i++){
<a name="l00501"></a>00501     <span class="comment">//    printf(&quot;%.0f\t&quot;,*(Px+i));</span>
<a name="l00502"></a>00502     <span class="keywordflow">if</span>(*(Px+i)&gt;=a){
<a name="l00503"></a>00503       Uno += *(Px+i);
<a name="l00504"></a>00504       Due += QUAD(*(Px+i));
<a name="l00505"></a>00505       Tre += *(Px+i)*QUAD(*(Px+i));
<a name="l00506"></a>00506       Quattro += QUAD(QUAD(*Px+i));
<a name="l00507"></a>00507       UnoUno += *(Px+i) * *(Py+i);
<a name="l00508"></a>00508       DueUno += QUAD(*(Px+i)) * *(Py+i);
<a name="l00509"></a>00509       ZeroUno += *(Py+i);
<a name="l00510"></a>00510       ZeroDue += QUAD(*(Py+i));
<a name="l00511"></a>00511       <span class="comment">//      printf(&quot;%.2g\t%.2g\t%.2g\t%.2g\n&quot;,Uno,Due,Tre,Quattro);</span>
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513   }
<a name="l00514"></a>00514   <span class="keywordtype">double</span> X2 = NMass*Due - Uno*Uno;
<a name="l00515"></a>00515   <span class="keywordtype">double</span> X3 = NMass*Tre - Due*Uno;
<a name="l00516"></a>00516   <span class="keywordtype">double</span> X4 = NMass*Quattro - Due*Due;
<a name="l00517"></a>00517   <span class="keywordtype">double</span> XY = NMass *UnoUno - Uno*ZeroUno;
<a name="l00518"></a>00518   <span class="keywordtype">double</span> X2Y = NMass*DueUno - Due*ZeroUno;
<a name="l00519"></a>00519   Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a> = (X4*X2 - X3*X3)/(X2Y*X2 - X3*XY);
<a name="l00520"></a>00520   Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a> = (Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*XY - X3)/X2;
<a name="l00521"></a>00521   Par.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a> = (ZeroUno - Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>*Uno - Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*Due)/(<span class="keywordtype">double</span>)NMass;
<a name="l00522"></a>00522   Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a> = -Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>/(2*Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>);
<a name="l00523"></a>00523   Par.<a class="code" href="structPARABOLA.html#abbfab7a69ef1371aef5bf3cefa0abaa9" title="Minimum of the parabola.">MinimoY</a> = Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*SQR(Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a>) + Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>*Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a> + Par.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a>;
<a name="l00524"></a>00524   <span class="comment">//printf(&quot;y = %.2f*x^2 + %.2f*x + %.2f\t a=0.075,b=-50.93,c=8623\n&quot;,Par.a2,Par.a1,Par.a0);</span>
<a name="l00525"></a>00525   <span class="keywordflow">return</span> Par;
<a name="l00526"></a>00526 }
<a name="l00527"></a><a class="code" href="classMatematica.html#a0e0bcc6fadb562dde7298fa8119e7c4d">00527</a> <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> <a class="code" href="classMatematica.html#a90a6e30254a3d26a422a173cdc46a823" title="Minimum of the Parabola between.">Matematica::MinimoParabola</a>(<span class="keywordtype">double</span> *Px,<span class="keywordtype">double</span> *Py,<span class="keywordtype">int</span> NMass){
<a name="l00528"></a>00528   <a class="code" href="structPARABOLA.html" title="Parabolas coefficients.">PARABOLA</a> Par;
<a name="l00529"></a>00529   <span class="keywordtype">double</span> Uno=0.;<span class="keywordtype">double</span> Due=0.;<span class="keywordtype">double</span> Tre=0.;<span class="keywordtype">double</span> Quattro=0.;
<a name="l00530"></a>00530   <span class="keywordtype">double</span> UnoUno=0.;<span class="keywordtype">double</span> DueUno=0.;<span class="keywordtype">double</span> ZeroUno=0.;<span class="keywordtype">double</span> ZeroDue=0.;
<a name="l00531"></a>00531   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NMass;i++){
<a name="l00532"></a>00532     Uno += Px[i];
<a name="l00533"></a>00533     Due += Px[i]*Px[i];
<a name="l00534"></a>00534     Tre += Px[i]*Px[i]*Px[i];
<a name="l00535"></a>00535     Quattro += Px[i]*Px[i]*Px[i]*Px[i];
<a name="l00536"></a>00536     UnoUno += Px[i]*Py[i];
<a name="l00537"></a>00537     DueUno += Px[i]*Px[i]*Py[i];
<a name="l00538"></a>00538     ZeroUno += Py[i];
<a name="l00539"></a>00539     ZeroDue += Py[i]*Py[i];
<a name="l00540"></a>00540   }
<a name="l00541"></a>00541   <span class="keywordtype">double</span> X2 = NMass*Due - Uno*Uno;
<a name="l00542"></a>00542   <span class="keywordtype">double</span> X3 = NMass*Tre - Due*Uno;
<a name="l00543"></a>00543   <span class="keywordtype">double</span> X4 = NMass*Quattro - Due*Due;
<a name="l00544"></a>00544   <span class="keywordtype">double</span> XY = NMass *UnoUno - Uno*ZeroUno;
<a name="l00545"></a>00545   <span class="keywordtype">double</span> X2Y = NMass*DueUno - Due*ZeroUno;
<a name="l00546"></a>00546   Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a> = (X2Y*X2 - X3*XY)/(X4*X2 - X3*X3);
<a name="l00547"></a>00547   Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a> = (XY - Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*X3)/X2;
<a name="l00548"></a>00548   Par.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a> = (ZeroUno - Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>*Uno - Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*Due)/(<span class="keywordtype">double</span>)NMass;
<a name="l00549"></a>00549   Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a> = -Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>/(2.*Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>);
<a name="l00550"></a>00550   Par.<a class="code" href="structPARABOLA.html#abbfab7a69ef1371aef5bf3cefa0abaa9" title="Minimum of the parabola.">MinimoY</a> = Par.<a class="code" href="structPARABOLA.html#ac55c2d269ed76bd9bdb7fb25f3533a4e" title="a0 + a1 x + a2 x^2">a2</a>*SQR(Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a>) + Par.<a class="code" href="structPARABOLA.html#a5d015a3751aec61f2442b957cb6f517a" title="a0 + a1 x + a2 x^2">a1</a>*Par.<a class="code" href="structPARABOLA.html#a09d69325016439f54c434a28a71bf666" title="Minimum of the parabola.">Minimo</a> + Par.<a class="code" href="structPARABOLA.html#ad95dcba445836b4ba94129111a4b888c" title="a0 + a1 x + a2 x^2">a0</a>;
<a name="l00551"></a>00551   <span class="comment">//printf(&quot;y = %.2f*x^2 + %.2f*x + %.2f\t a=0.075,b=-50.93,c=8623\n&quot;,Par.a2,Par.a1,Par.a0);</span>
<a name="l00552"></a>00552   <span class="keywordflow">return</span> Par;
<a name="l00553"></a>00553 }
<a name="l00554"></a><a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e">00554</a> <span class="keywordtype">double</span> <a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Matematica::Blend</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *dPoint,<span class="keywordtype">double</span> x,<span class="keywordtype">int</span> nPoint,<span class="keywordtype">int</span> nOrder){
<a name="l00555"></a>00555   <span class="comment">// if( ( x &lt; dPoint[nPoint]) || ( x &gt;= dPoint[nPoint+1]))</span>
<a name="l00556"></a>00556   <span class="comment">//   return 0.;</span>
<a name="l00557"></a>00557   <span class="keywordflow">if</span>(nOrder == 1){
<a name="l00558"></a>00558     <span class="keywordflow">if</span>( ( x &gt;= dPoint[nPoint])&amp;&amp;( x &lt; dPoint[nPoint+1]))
<a name="l00559"></a>00559       <span class="keywordflow">return</span> 1.;
<a name="l00560"></a>00560     <span class="keywordflow">else</span> 
<a name="l00561"></a>00561       <span class="keywordflow">return</span> 0.;
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563   <span class="keywordtype">double</span> Resp = 0.;
<a name="l00564"></a>00564   <span class="keywordtype">double</span> Primo = (x - dPoint[nPoint])/(dPoint[nPoint+nOrder] - dPoint[nPoint])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,x,nPoint,nOrder-1);
<a name="l00565"></a>00565   <span class="keywordtype">double</span> Secondo = (dPoint[nPoint+nOrder+1]-x)/(dPoint[nPoint+nOrder+1] - dPoint[nPoint+1])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,x,nPoint+1,nOrder-1);
<a name="l00566"></a>00566   <span class="keywordflow">if</span>( (dPoint[nPoint+nOrder-1] == dPoint[nPoint]) &amp;&amp; (dPoint[nPoint+nOrder] == dPoint[nPoint+1]) )
<a name="l00567"></a>00567     Resp = 0.;
<a name="l00568"></a>00568   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dPoint[nPoint+nOrder] == dPoint[nPoint])
<a name="l00569"></a>00569     Resp = Primo;
<a name="l00570"></a>00570   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dPoint[nPoint+nOrder] == dPoint[nPoint+1])
<a name="l00571"></a>00571     Resp = Secondo;
<a name="l00572"></a>00572   <span class="keywordflow">else</span> 
<a name="l00573"></a>00573     Resp = Primo + Secondo;
<a name="l00574"></a>00574   <span class="comment">//printf(&quot;%d %d - (%lf-%lf) = %lf\n&quot;,nPoint,nOrder,x,dPoint[nPoint],Resp);</span>
<a name="l00575"></a>00575   <span class="keywordflow">return</span> Resp;
<a name="l00576"></a>00576 }
<a name="l00577"></a><a class="code" href="classMatematica.html#a078a6c2222921c85f87f62b4d61b4553">00577</a> <span class="keywordtype">double</span> <a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Matematica::Blend</a>(<span class="keywordtype">double</span> *dPoint,<span class="keywordtype">size_t</span> Incr,<span class="keywordtype">double</span> x,<span class="keywordtype">int</span> nP,<span class="keywordtype">int</span> nO){
<a name="l00578"></a>00578 <span class="comment">/*********************************************************************</span>
<a name="l00579"></a>00579 <span class="comment"></span>
<a name="l00580"></a>00580 <span class="comment"> Simple b-spline curve algorithm</span>
<a name="l00581"></a>00581 <span class="comment"></span>
<a name="l00582"></a>00582 <span class="comment"> Copyright 1994 by Keith Vertanen (vertankd@cda.mrs.umn.edu)</span>
<a name="l00583"></a>00583 <span class="comment"></span>
<a name="l00584"></a>00584 <span class="comment"> Released to the public domain (your mileage may vary)</span>
<a name="l00585"></a>00585 <span class="comment"></span>
<a name="l00586"></a>00586 <span class="comment">**********************************************************************/</span>
<a name="l00587"></a>00587   <span class="keywordtype">double</span> Resp;       
<a name="l00588"></a>00588   <span class="keywordflow">if</span>(nO == 1){
<a name="l00589"></a>00589     <span class="keywordflow">if</span>( (dPoint[nP*Incr] &lt;= x)&amp;&amp;(x&lt;dPoint[(nP+1)*Incr]))
<a name="l00590"></a>00590       Resp = 1.;
<a name="l00591"></a>00591     <span class="keywordflow">else</span> 
<a name="l00592"></a>00592       Resp = 0.;
<a name="l00593"></a>00593   }
<a name="l00594"></a>00594   <span class="keywordflow">else</span> {
<a name="l00595"></a>00595     <span class="keywordflow">if</span>( (dPoint[(nP+nO-1)*Incr] == dPoint[nP*Incr]) &amp;&amp; (dPoint[(nP+nO)*Incr] == dPoint[(nP+1)*Incr]) )
<a name="l00596"></a>00596       Resp = 0.;
<a name="l00597"></a>00597     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dPoint[(nP+nO)*Incr] = dPoint[(nP)*Incr])
<a name="l00598"></a>00598       Resp = (dPoint[(nP+nO)*Incr] - x)/(dPoint[(nP+nO)*Incr] - dPoint[(nP+1)*Incr])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,Incr,x,nP,nO-1);
<a name="l00599"></a>00599     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dPoint[(nP+nO)*Incr] == dPoint[(nP+1)*Incr])
<a name="l00600"></a>00600       Resp = (x - dPoint[(nP)*Incr])/(dPoint[(nP+nO-1)*Incr] - dPoint[(nP)*Incr])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,Incr,x,nP+1,nO-1);
<a name="l00601"></a>00601     <span class="keywordflow">else</span> 
<a name="l00602"></a>00602       Resp = (dPoint[(nP+nO)*Incr] - x)/(dPoint[(nP+nO)*Incr] - dPoint[(nP+1)*Incr])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,Incr,x,nP,nO-1) + (x - dPoint[nP*Incr])/(dPoint[(nP+nO-1)*Incr] - dPoint[nP*Incr])*<a class="code" href="classMatematica.html#a9dbb46c7af9cbcd87568e0dace30d10e" title="For the BSpline.">Blend</a>(dPoint,Incr,x,nP+1,nO-1);
<a name="l00603"></a>00603   }
<a name="l00604"></a>00604   <span class="comment">//printf(&quot;%d %d - (%lf-%lf) %d = %lf\n&quot;,nP,nO,x,dPoint[nP],Incr,Resp);</span>
<a name="l00605"></a>00605   <span class="keywordflow">return</span> Resp;
<a name="l00606"></a>00606 }
<a name="l00607"></a>00607 <span class="comment">// int Matematica::InterBSpline2D(Matrice *MaIn,Matrice *MaOut){</span>
<a name="l00608"></a>00608 <span class="comment">//   double Max=1.;</span>
<a name="l00609"></a>00609 <span class="comment">//   double Min=0.;</span>
<a name="l00610"></a>00610 <span class="comment">//   int NOutShow=0;</span>
<a name="l00611"></a>00611 <span class="comment">//   double DeltaIn=(Max-Min)/(double)(NIn-1);</span>
<a name="l00612"></a>00612 <span class="comment">//   double DeltaOut=(Max-Min)/(double)(NOut-1);</span>
<a name="l00613"></a>00613 <span class="comment">//   int NOrder = 3+1;</span>
<a name="l00614"></a>00614 <span class="comment">//   double *dArray = (double *)calloc(NIn+NOrder+1,sizeof(double));</span>
<a name="l00615"></a>00615 <span class="comment">//   for(int p=0;p&lt;=NIn+NOrder;p++){</span>
<a name="l00616"></a>00616 <span class="comment">//     if(p&lt;NOrder){</span>
<a name="l00617"></a>00617 <span class="comment">//       dArray[p] = Min;</span>
<a name="l00618"></a>00618 <span class="comment">//     }</span>
<a name="l00619"></a>00619 <span class="comment">//     else if( (NOrder&lt;=p) &amp;&amp; (p&lt;=NIn) ){</span>
<a name="l00620"></a>00620 <span class="comment">//       dArray[p] = (p-NOrder+1)*DeltaIn+Min;//Pm[p-NOrder].Pos[CLat1];//</span>
<a name="l00621"></a>00621 <span class="comment">//     }</span>
<a name="l00622"></a>00622 <span class="comment">//     else if( p&gt;NIn){</span>
<a name="l00623"></a>00623 <span class="comment">//       dArray[p] = (p-NOrder+2)*DeltaIn+Min;</span>
<a name="l00624"></a>00624 <span class="comment">//     }</span>
<a name="l00625"></a>00625 <span class="comment">//   }</span>
<a name="l00626"></a>00626 <span class="comment">//   for(int vo=0;vo&lt;NOut;vo++){</span>
<a name="l00627"></a>00627 <span class="comment">//    for(int vvo=0;vvo&lt;NOut;vvo++){</span>
<a name="l00628"></a>00628 <span class="comment">//      MaOut-&gt;Set(vo,vvo,0.);</span>
<a name="l00629"></a>00629 <span class="comment">//      double x = DeltaOut*vo+Min;</span>
<a name="l00630"></a>00630 <span class="comment">//      //for(int vi=0;vi&lt;NIn;vi++){</span>
<a name="l00631"></a>00631 <span class="comment">//      for(int vi=vo-1;vi&lt;vo+NOrder+1;vi++){</span>
<a name="l00632"></a>00632 <span class="comment">//        if(vi &lt; 0 || vi &gt;= NIn) continue;</span>
<a name="l00633"></a>00633 <span class="comment">//        double Blendx = Mat-&gt;Blend(dArray,x,vi,NOrder);</span>
<a name="l00634"></a>00634 <span class="comment">//        double y = DeltaOut*vvo+Min;</span>
<a name="l00635"></a>00635 <span class="comment">//        //for(int vvi=0;vvi&lt;NIn;vvi++){</span>
<a name="l00636"></a>00636 <span class="comment">//        for(int vvi=vvo-1;vvi&lt;vvo+NOrder+1;vvi++){</span>
<a name="l00637"></a>00637 <span class="comment">//     if(vvi &lt; 0 || vvi &gt;= NIn) continue;</span>
<a name="l00638"></a>00638 <span class="comment">//     double Blendy = Mat-&gt;Blend(dArray,y,vvi,NOrder);</span>
<a name="l00639"></a>00639 <span class="comment">//     MaOut-&gt;Add(vo,vvo,Blendx*Blendy * PlIn-&gt;Val(vi,vvi));</span>
<a name="l00640"></a>00640 <span class="comment">//        }</span>
<a name="l00641"></a>00641 <span class="comment">//      }</span>
<a name="l00642"></a>00642 <span class="comment">//    }</span>
<a name="l00643"></a>00643 <span class="comment">//   }</span>
<a name="l00644"></a>00644 <span class="comment">//   for(int vo=0;vo&lt;NOut;vo++){</span>
<a name="l00645"></a>00645 <span class="comment">//     if(vo &lt; NIn){//To arrange</span>
<a name="l00646"></a>00646 <span class="comment">//       PlOut[vo][NOut-1] = PlIn[vo][NIn-1];</span>
<a name="l00647"></a>00647 <span class="comment">//       PlOut[NOut - 1][vo] = PlIn[NIn-1][vo];</span>
<a name="l00648"></a>00648 <span class="comment">//     }</span>
<a name="l00649"></a>00649 <span class="comment">//   }</span>
<a name="l00650"></a>00650 <span class="comment">//   NOutShow = NOut;</span>
<a name="l00651"></a>00651 <span class="comment">//   free(dArray);</span>
<a name="l00652"></a>00652 <span class="comment">//   return NOutShow;</span>
<a name="l00653"></a>00653 <span class="comment">// }</span>
<a name="l00654"></a>00654 <span class="comment">// </span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:20 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
