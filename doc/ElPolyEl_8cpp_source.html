<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Allink: src/ElPoly/ElPolyEl.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Allink
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_8e9a8b7e3c72bcc96dd64e909190dc02.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_1bb97581e94de66daf7acda7f0e3ec00.html">ElPoly</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ElPolyEl.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">ElPoly:This progam provide a graphical visualisation of the data </span>
<a name="l00003"></a>00003 <span class="comment">opend by VarData using openGL glut. The most important option are </span>
<a name="l00004"></a>00004 <span class="comment">the possibility of changing the backfold of the polymers with &#39;c&#39;, </span>
<a name="l00005"></a>00005 <span class="comment">see the subsequent file in the list with &#39;&gt;&#39;, see the bond with &#39;b&#39;. </span>
<a name="l00006"></a>00006 <span class="comment">Copyright (C) 2008 by Giovanni Marelli &lt;sabeiro@virgilio.it&gt;</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment">the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00012"></a>00012 <span class="comment">(at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment">GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment">along with this program; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00022"></a>00022 <span class="comment">***********************************************************************/</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;ElPoly.h&quot;</span>
<a name="l00024"></a>00024 ;
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="classElPoly.html#a98503475eca11a72b69cb62879d41183">00026</a> <a class="code" href="classElPoly.html#a98503475eca11a72b69cb62879d41183" title="Constructor.">ElPoly::ElPoly</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv,<span class="keywordtype">int</span> *FilePos){
<a name="l00027"></a>00027   cFile = (<span class="keywordtype">char</span> **)calloc(argc,4);<span class="comment">//sizeof(**cFile));</span>
<a name="l00028"></a>00028   <span class="keywordflow">if</span>(cFile == NULL){printf(<span class="stringliteral">&quot;cFile not allocated\n&quot;</span>);<span class="keywordflow">return</span>;}
<a name="l00029"></a>00029   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0;f&lt;argc;f++){
<a name="l00030"></a>00030     cFile[f] = (<span class="keywordtype">char</span> *)calloc(STRSIZE,<span class="keyword">sizeof</span>(*cFile));
<a name="l00031"></a>00031     <span class="keywordflow">if</span>(cFile[f] == NULL){printf(<span class="stringliteral">&quot;cFile not allocated\n&quot;</span>);<span class="keywordflow">return</span>;}
<a name="l00032"></a>00032     cFile[f] = argv[FilePos[f]];
<a name="l00033"></a>00033   }
<a name="l00034"></a>00034   <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a> = argc;
<a name="l00035"></a>00035   <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = 0; <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>;
<a name="l00036"></a>00036   <a class="code" href="classElPoly.html#a1ec5265fae2a3e11f0ee82db6a536ec5" title="Boh.">NPro</a> =0;<span class="comment">//?</span>
<a name="l00037"></a>00037   <a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a>=0;
<a name="l00038"></a>00038   <span class="keywordflow">if</span>(!<a class="code" href="classVarData.html#accdecf8cab5f68b6ca19ce4f143806eb" title="Maximum number of bonds.">pNLink</a>()) <a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a> = 1;
<a name="l00039"></a>00039   <span class="keywordflow">else</span> <a class="code" href="classElPoly.html#ac3e70209b515c8a6293fcdb019a2fb29" title="Boh.">IfLine</a> = 0;
<a name="l00040"></a>00040   <span class="comment">// IfIntorno=0;//?</span>
<a name="l00041"></a>00041   <span class="comment">// IfColour=0;//?</span>
<a name="l00042"></a>00042   <span class="comment">// IfChains=0;//?</span>
<a name="l00043"></a>00043   <span class="comment">// IfChType=0;//?</span>
<a name="l00044"></a>00044   <span class="comment">// Diameter=0.1;//?</span>
<a name="l00045"></a>00045   <span class="comment">// StepDiameter=0.;//?</span>
<a name="l00046"></a>00046   <span class="comment">// ExtraDiam=0.;//?</span>
<a name="l00047"></a>00047   <span class="comment">// Vicinanze=1.;//?</span>
<a name="l00048"></a>00048   <a class="code" href="classElPoly.html#ae460da3c47449cbbd76b22e9c2501a69" title="Define the shrink factor between the box edges.">InvScaleUn</a>=1.;
<a name="l00049"></a>00049   <a class="code" href="classElPoly.html#ae8a6916dd0cb066c7e911f973caf504a" title="Normal scaling factor (z zooming)">ScaleFact</a> = 1.;
<a name="l00050"></a>00050   <a class="code" href="classElPoly.html#a676418848d4d134fdefd0bda050ddea1" title="Line size of the gl.">LineSize</a> = 1;
<a name="l00051"></a>00051   <a class="code" href="classElPoly.html#ae1c44ad3d54bfd33bcd7be4a5d1e9a8c" title="How many lipids are skipped in the visualization.">NVisSkip</a> = 1;
<a name="l00052"></a>00052   <a class="code" href="classVarData.html#ab414e7210af332040754fc1daaa67509" title="Type of chain selected.">NChType</a> = CHAIN_EVERY;
<a name="l00053"></a>00053   <a class="code" href="classElPoly.html#a051cdcf73b2b4af010122eed5c23c59d" title="Type of backfold.">NBackFold</a> = BF_PART;
<a name="l00054"></a>00054   <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_PART;
<a name="l00055"></a>00055   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) <a class="code" href="classVarData.html#aa2dd0176f89991418fa38a24db3f3381" title="Reference position.">ShiftPos</a>[d] = 0.;
<a name="l00056"></a>00056   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++) <a class="code" href="classVarData.html#a4666508bbc27ca92b693e20b16098f5a" title="Scale factor.">ScaleF</a>[d] = 1.;
<a name="l00057"></a>00057 <span class="preprocessor">#ifdef OMPI_MPI_H </span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>  MPI_Init(&amp;argc,&amp;argv);
<a name="l00059"></a>00059   <span class="keywordtype">int</span> Rank=0,Size=0;
<a name="l00060"></a>00060   MPI_Comm_rank(MPI_COMM_WORLD, &amp;Rank);
<a name="l00061"></a>00061   MPI_Comm_size(MPI_COMM_WORLD, &amp;Size);
<a name="l00062"></a>00062   <span class="keywordtype">int</span> Partition = (int)(<a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>/(<span class="keywordtype">double</span>)Size);
<a name="l00063"></a>00063   <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = Partition*Rank;
<a name="l00064"></a>00064   <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = Partition*(Rank+1);
<a name="l00065"></a>00065   <span class="keywordflow">if</span>(Rank==Size-1) <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] += <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>%Size;
<a name="l00066"></a>00066   Proc = <span class="keyword">new</span> <a class="code" href="classSingProc.html" title="Basics class to start a MPI grid.">SingProc</a>(Size,Rank);
<a name="l00067"></a>00067 <span class="preprocessor">#endif</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>  <span class="comment">//TrialSys();</span>
<a name="l00069"></a>00069 }
<a name="l00070"></a><a class="code" href="classElPoly.html#afdf47e94336886931e93e716f32bb1ee">00070</a> <a class="code" href="classElPoly.html#afdf47e94336886931e93e716f32bb1ee" title="Desctructor.">ElPoly::~ElPoly</a>(){
<a name="l00071"></a>00071   <span class="comment">// for(int f=0;f&lt;NFileTot;f++)</span>
<a name="l00072"></a>00072   <span class="comment">//   free(cFile[f]);</span>
<a name="l00073"></a>00073   <span class="comment">// free(cFile);</span>
<a name="l00074"></a>00074 <span class="preprocessor">#ifdef OMPI_MPI_H </span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>  MPI_Finalize();
<a name="l00076"></a>00076 <span class="preprocessor">#endif</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span>}
<a name="l00078"></a><a class="code" href="classElPoly.html#ae3aab8086f988eecdd12b8f29f45a56a">00078</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#ae3aab8086f988eecdd12b8f29f45a56a" title="Calculation of the contact angle  angle Boh?">ElPoly::Angle</a>(<span class="keywordtype">int</span> Values){
<a name="l00079"></a>00079   <span class="keywordtype">int</span> NRadici = 4;
<a name="l00080"></a>00080   <span class="keywordtype">int</span> NZeri = NRadici;
<a name="l00081"></a>00081   <span class="keywordtype">double</span> *Radici;
<a name="l00082"></a>00082   Radici = (<span class="keywordtype">double</span> *)malloc(NRadici*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00083"></a>00083   <span class="keywordtype">double</span> *Average;
<a name="l00084"></a>00084   Average = (<span class="keywordtype">double</span> *)malloc(NRadici*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00085"></a>00085   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NRadici;i++){
<a name="l00086"></a>00086     Radici[i] = 0.;
<a name="l00087"></a>00087     Average[i] = 0.;
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];f&lt;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1];f++){
<a name="l00090"></a>00090     <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">Processing</a>(f);
<a name="l00091"></a>00091     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a385ea4b67d94de234204940ef8da368d" title="Opens a file without reallocationg.">OpenRisk</a>(cFile[f],BF_PART)==0)<span class="keywordflow">return</span> 1;
<a name="l00092"></a>00092     <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#aa06af2f751c2d30f883911088239686e" title="External parameter to calculate the contact angle.">Ypsilon</a> = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(2)-<a class="code" href="classVarData.html#adfa118e0505b98efdcaf18dbd72cc11e" title="Center of mass of the system.">pCm</a>(2)-1.;
<a name="l00093"></a>00093     <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#a4eff9d128336501e44aac2b9524eb6b0" title="External parameter in the definition of the contact angle.">PreFact</a> = pow((2.*<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/10.)/DUE_PI,.33);
<a name="l00094"></a>00094     <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#aba8f98cb34b78863b26b00d33aabdc1d" title="Pointer to a function.">Func</a> = &amp;<a class="code" href="classElPoly.html#a2dd3ba2334c4444c4ef406347618c170" title="Definition of the contact angle function Boh.">Matematica::ContactAngle</a>;
<a name="l00095"></a>00095     printf(<span class="stringliteral">&quot;Volume  %lf Cm %lf # to Invert %lf\n&quot;</span>,(<span class="keywordtype">double</span>)<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/10.,<a class="code" href="classVarData.html#adfa118e0505b98efdcaf18dbd72cc11e" title="Center of mass of the system.">pCm</a>(2),pow(DUE_PI/(2.*<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()/10.),.25));
<a name="l00096"></a>00096     NZeri = <a class="code" href="classVarData.html#aab4995eedc5bb0d45d86f0e2a5d0e869" title="Implementation of all usefull algorythms.">Mat</a>-&gt;<a class="code" href="classMatematica.html#af1e1e5332753626f39db69dca411ecfc" title="Find the.">Zeri</a>(0.,DUE_PI/2.,Radici,NRadici);
<a name="l00097"></a>00097     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NZeri;i++){
<a name="l00098"></a>00098       Radici[i] *= 360./DUE_PI;
<a name="l00099"></a>00099       Average[i] += Radici[i];
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101     <span class="keywordflow">if</span>(NZeri == 0){
<a name="l00102"></a>00102       printf(<span class="stringliteral">&quot;The function has no real roots\n&quot;</span>);
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NZeri;i++){
<a name="l00106"></a>00106     Average[i] /= NFile[1]-NFile[0];
<a name="l00107"></a>00107     printf(<span class="stringliteral">&quot;Angle %lf\n&quot;</span>,Average[i]);
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109   <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110 }
<a name="l00111"></a><a class="code" href="classElPoly.html#a59529de9a660df4734a218130963ae25">00111</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a59529de9a660df4734a218130963ae25" title="Averaged center of mass Boh.">ElPoly::CenterOfMass</a>(<span class="keywordtype">int</span> Coord){
<a name="l00112"></a>00112   <span class="keywordtype">double</span> SysCm;
<a name="l00113"></a>00113   FILE *FileToWrite = NULL;
<a name="l00114"></a>00114   FileToWrite = fopen(<span class="stringliteral">&quot;CenterOfMass.dat&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00115"></a>00115   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];f&lt;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1];f++){
<a name="l00116"></a>00116     <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">Processing</a>(f);
<a name="l00117"></a>00117     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a385ea4b67d94de234204940ef8da368d" title="Opens a file without reallocationg.">OpenRisk</a>(cFile[f],1)==0)<span class="keywordflow">return</span> 1;
<a name="l00118"></a>00118     SysCm=0.;
<a name="l00119"></a>00119     <span class="keywordflow">if</span>(Coord == 3){
<a name="l00120"></a>00120       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00121"></a>00121    SysCm += <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,2);
<a name="l00122"></a>00122       }
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124     <span class="keywordflow">else</span>{
<a name="l00125"></a>00125       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00126"></a>00126    SysCm += <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,Coord);
<a name="l00127"></a>00127       }
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129       fprintf(FileToWrite,<span class="stringliteral">&quot;%lf \n&quot;</span>,SysCm/<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()); 
<a name="l00130"></a>00130   }
<a name="l00131"></a>00131   printf(<span class="stringliteral">&quot;\n&quot;</span>); 
<a name="l00132"></a>00132   fclose(FileToWrite);
<a name="l00133"></a>00133   <span class="keywordflow">return</span> 0;
<a name="l00134"></a>00134 }
<a name="l00135"></a><a class="code" href="classElPoly.html#a5fa485410c0b7e02f523f96f33504435">00135</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a5fa485410c0b7e02f523f96f33504435" title="Defines the first and the last file to be elaborated  file.">ElPoly::ChangeFile</a>(){
<a name="l00136"></a>00136   printf(<span class="stringliteral">&quot;Introduce the first of %d file from the list: &quot;</span>,<a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>);
<a name="l00137"></a>00137   scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0]);
<a name="l00138"></a>00138   <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] &lt; 0 || <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] &gt; <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1])
<a name="l00139"></a>00139     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = 0;
<a name="l00140"></a>00140   <a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a> = <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];
<a name="l00141"></a>00141   printf(<span class="stringliteral">&quot;Introduce the second of %d file from the list: &quot;</span>,<a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>);
<a name="l00142"></a>00142   scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1]);
<a name="l00143"></a>00143   <span class="keywordflow">if</span>(<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] &lt; <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] || <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] &gt; <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>)
<a name="l00144"></a>00144     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>;
<a name="l00145"></a>00145   <span class="keywordflow">return</span> 0;
<a name="l00146"></a>00146 }
<a name="l00147"></a><a class="code" href="classElPoly.html#a3432306726a27b310ec27b3900894b11">00147</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a3432306726a27b310ec27b3900894b11" title="Opens the f file of the list  open.">ElPoly::OpenFile</a>(<span class="keywordtype">int</span> f){
<a name="l00148"></a>00148   <span class="keywordflow">if</span>(f &gt;= <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a> || f &lt; 0)
<a name="l00149"></a>00149     <span class="keywordflow">return</span> 0;
<a name="l00150"></a>00150   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a50a785f6295f7e7fb2494fcad2a2a7fc" title="Open the.">Open</a>(cFile[f],<a class="code" href="classElPoly.html#a051cdcf73b2b4af010122eed5c23c59d" title="Type of backfold.">NBackFold</a>)) <span class="keywordflow">return</span> 1;
<a name="l00151"></a>00151   <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = f;
<a name="l00152"></a>00152   <a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a> = f;
<a name="l00153"></a>00153   <span class="keywordflow">return</span> 0;
<a name="l00154"></a>00154 }
<a name="l00155"></a><a class="code" href="classElPoly.html#a5ddc1cdb4d65932381030dba86448813">00155</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#a3432306726a27b310ec27b3900894b11" title="Opens the f file of the list  open.">ElPoly::OpenFile</a>(<span class="keywordtype">char</span> *FileName){
<a name="l00156"></a>00156   <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a50a785f6295f7e7fb2494fcad2a2a7fc" title="Open the.">Open</a>(FileName,<a class="code" href="classElPoly.html#a051cdcf73b2b4af010122eed5c23c59d" title="Type of backfold.">NBackFold</a>))<span class="keywordflow">return</span> 1;
<a name="l00157"></a>00157   <span class="keywordflow">return</span> 0;
<a name="l00158"></a>00158 }
<a name="l00159"></a><a class="code" href="classElPoly.html#a2dd3ba2334c4444c4ef406347618c170">00159</a> <span class="keywordtype">double</span> <a class="code" href="classElPoly.html#a2dd3ba2334c4444c4ef406347618c170" title="Definition of the contact angle function Boh.">ElPoly::ContactAngle</a>(<span class="keywordtype">double</span> x){
<a name="l00160"></a>00160   <span class="keywordtype">double</span> Ris;
<a name="l00161"></a>00161   Ris = QUAD( 2*x - QUAD(sin(2*x)) ) / (4./3. * CUB(sin(x))-2.*x*cos(x)+cos(x)*sin(2*x) ) - 5.;
<a name="l00162"></a>00162   <span class="keywordflow">return</span> Ris;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 <span class="comment">// OpenGl----------------------------------</span>
<a name="l00165"></a><a class="code" href="classElPoly.html#ae41ade7fbfd977babf42a7e2e6b33f07">00165</a> <span class="keywordtype">int</span> <a class="code" href="classElPoly.html#ae41ade7fbfd977babf42a7e2e6b33f07" title="Calculates some properties of the system  prop.">ElPoly::PropertiesF</a>(){
<a name="l00166"></a>00166   <a class="code" href="classProperties.html" title="Some calculated properties of the system.">Properties</a> Pr;
<a name="l00167"></a>00167   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];f&lt;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1];f++){
<a name="l00168"></a>00168     <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">Processing</a>(f);
<a name="l00169"></a>00169     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a385ea4b67d94de234204940ef8da368d" title="Opens a file without reallocationg.">OpenRisk</a>(cFile[f],BF_PART))<span class="keywordflow">return</span> 0;
<a name="l00170"></a>00170     Pr = Pr + <a class="code" href="classVarData.html#a5440abb543ae3c83d1b628b0ba0eb3c6" title="Calculate some basis properties.">SysProperties</a>();
<a name="l00171"></a>00171   }
<a name="l00172"></a>00172   Pr = Pr * (1./(NFile[1] - NFile[0]));
<a name="l00173"></a>00173   printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00174"></a>00174   <span class="keywordtype">char</span> *NomeFile = (<span class="keywordtype">char</span> *) malloc(60*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00175"></a>00175   sprintf(NomeFile,<span class="stringliteral">&quot;PropertiesChi%.0fRho%.0fKappa%.0f.txt&quot;</span>,<a class="code" href="classVarData.html#a8def89edf23019d700fdbadb476e4c0a" title="Incompatibility.">pchiN</a>(),<a class="code" href="classVarData.html#a9b47d9a32db9326bceac9402c94683d9" title="Density coexistence.">prho</a>(),<a class="code" href="classVarData.html#af410b05a34ef11ae5d26090a7706493b" title="Incompressibility.">pkappaN</a>());
<a name="l00176"></a>00176   FILE *FileToWrite = NULL;
<a name="l00177"></a>00177   FileToWrite = fopen(NomeFile,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00178"></a>00178   fprintf(FileToWrite,<span class="stringliteral">&quot;RePhob %lf RePhil %lf\n&quot;</span>,Pr.<a class="code" href="classProperties.html#aa28defaa4daebd09445e3d3180ec521a" title="End2End distance of the.">RePhob</a>,Pr.RePhil);
<a name="l00179"></a>00179   fprintf(FileToWrite,<span class="stringliteral">&quot;RadGyrPhob %lf RadGyrPhil %lf\n&quot;</span>,Pr.GyrPhob,Pr.GyrPhil);
<a name="l00180"></a>00180   fprintf(FileToWrite,<span class="stringliteral">&quot;StructFactPhob %lf StructFactPhil %lf\n&quot;</span>,Pr.FactPhob,Pr.FactPhil);
<a name="l00181"></a>00181   fprintf(FileToWrite,<span class="stringliteral">&quot;VolPhob %lf VolPhil %lf\n&quot;</span>,Pr.VolPhob,Pr.VolPhil);
<a name="l00182"></a>00182   fprintf(FileToWrite,<span class="stringliteral">&quot;ChainDiff %lf\n&quot;</span>,Pr.ChDiff);
<a name="l00183"></a>00183   Pr.<a class="code" href="classProperties.html#a9dcac18006ce057b8d78c847174c1362" title="Print the current values.">Print</a>();
<a name="l00184"></a>00184   fclose(FileToWrite);
<a name="l00185"></a>00185   <span class="keywordflow">return</span> 0;
<a name="l00186"></a>00186 }
<a name="l00187"></a><a class="code" href="classElPoly.html#acffadf1cdc641927dfd8af49eebc2069">00187</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#acffadf1cdc641927dfd8af49eebc2069" title="Reorder the LIPID block in four different layers.">ElPoly::DivideLayers</a>(<span class="keywordtype">int</span> How){
<a name="l00188"></a>00188   <span class="keywordtype">int</span> NLayer = 2;
<a name="l00189"></a>00189   <span class="keywordflow">if</span>(How == VAR_OPPOSED) NLayer = 4;
<a name="l00190"></a>00190   <span class="keywordtype">int</span> *NChStep = (<span class="keywordtype">int</span> *)calloc(NLayer,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00191"></a>00191   <span class="keywordtype">int</span> *ChainLevel = (<span class="keywordtype">int</span> *)calloc(<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>(),<span class="keyword">sizeof</span>(int));
<a name="l00192"></a>00192   <span class="keywordflow">if</span>(How == VAR_OPPOSED){
<a name="l00193"></a>00193     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0,b=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00194"></a>00194       <span class="keywordflow">if</span>(c*<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].NPCh &gt; <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].EndIdx) b++;
<a name="l00195"></a>00195       <span class="keywordtype">int</span> Level = 0;
<a name="l00196"></a>00196       <span class="keywordflow">if</span>(CHAIN_IF_TYPE(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Type,CHAIN_UP))
<a name="l00197"></a>00197    Level = 1;
<a name="l00198"></a>00198       <span class="keywordflow">if</span>(!strcmp(<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].Name,<span class="stringliteral">&quot;LIPID1&quot;</span>)) Level += 2;
<a name="l00199"></a>00199       NChStep[Level]++;
<a name="l00200"></a>00200       ChainLevel[c] = Level;
<a name="l00201"></a>00201     }
<a name="l00202"></a>00202   }
<a name="l00203"></a>00203   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(How == VAR_TUBE || How == VAR_VESICLE){
<a name="l00204"></a>00204     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0,b=0;c&lt;<a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();c++){
<a name="l00205"></a>00205       <span class="keywordflow">if</span>(c*<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].NPCh &gt; <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].EndIdx) b++;
<a name="l00206"></a>00206       <span class="keywordtype">int</span> Level = 0;
<a name="l00207"></a>00207       <span class="keywordflow">if</span>(CHAIN_IF_TYPE(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Type,CHAIN_OUTER))
<a name="l00208"></a>00208    Level = 1;
<a name="l00209"></a>00209       NChStep[Level]++;
<a name="l00210"></a>00210       ChainLevel[c] = Level;
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213   <span class="comment">//for(int c=0;c&lt;pNChain();c++)printf(&quot;%lf %d %d\n&quot;,Ch[c].Pos[CNorm],c,ChainLevel[c]);</span>
<a name="l00214"></a>00214   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];f&lt;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1];f++){
<a name="l00215"></a>00215     <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">Processing</a>(f);
<a name="l00216"></a>00216     <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#a385ea4b67d94de234204940ef8da368d" title="Opens a file without reallocationg.">OpenRisk</a>(cFile[f],BF_NO))return ;
<a name="l00217"></a>00217     <a class="code" href="structPART.html" title="Information of every particle.">PART</a> *Pn = (<a class="code" href="structPART.html" title="Information of every particle.">PART</a> *)calloc(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>(),<span class="keyword">sizeof</span>(<a class="code" href="structPART.html" title="Information of every particle.">PART</a>));
<a name="l00218"></a>00218     <span class="keywordtype">int</span> pp=0;
<a name="l00219"></a>00219     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00220"></a>00220       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00221"></a>00221       Pn[p].<a class="code" href="structPART.html#a863738e46f14b3bfc674ad87d35f143d" title="xyz Position of the particle">Pos</a>[d] = <a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,d);
<a name="l00222"></a>00222       Pn[p].<a class="code" href="structPART.html#afd1b3747170c238c06ba3420cbc5c2a2" title="xyzr Velocity of the particle">Vel</a>[d] = <a class="code" href="classVarData.html#af437e6050bc54d9934ce8e41d4e14af0" title="Return the velocity.">pVel</a>(p,d);
<a name="l00223"></a>00223       }
<a name="l00224"></a>00224       Pn[p].<a class="code" href="structPART.html#a6365019ac3c6ee60c2db6a3674f35614" title="Type.">Typ</a> = <a class="code" href="classVarData.html#a75896c37dd78ba0d2da013ad4cf0e87c" title="Return the type.">pType</a>(p);
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;NLayer;l++){
<a name="l00227"></a>00227       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00228"></a>00228       <span class="keywordflow">if</span>(ChainLevel[<a class="code" href="classVarData.html#ab7c7c0a0081da25f3d4624ae61dc9d68" title="Return the chain.">pChain</a>(p)] == l){
<a name="l00229"></a>00229         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0;d&lt;3;d++){
<a name="l00230"></a>00230        <a class="code" href="classVarData.html#a5b8f787336ad1a776f82be0a59c9f570" title="Set the particle position.">SetPos</a>(pp,Pn[p].Pos);
<a name="l00231"></a>00231        <a class="code" href="classVarData.html#ae8d1cbd45a41409d2a76e73738003744" title="Set the particle velocity.">SetVel</a>(pp,Pn[p].Vel);
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233      <a class="code" href="classVarData.html#a54f680d04a52452baf2d8e9852c425cd" title="Set the particle type.">SetType</a>(pp,Pn[p].Typ);
<a name="l00234"></a>00234         pp++;
<a name="l00235"></a>00235       }
<a name="l00236"></a>00236       }
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238     <a class="code" href="classVarData.html#a80a5e498e47cbb396e01f85c0392a274" title="Define four different blocks.">DefBlock</a>(NChStep,How);
<a name="l00239"></a>00239     <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">Write</a>(cFile[f]);
<a name="l00240"></a>00240     free(Pn);
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00243"></a>00243   free(ChainLevel);
<a name="l00244"></a>00244   free(NChStep);
<a name="l00245"></a>00245 }
<a name="l00246"></a><a class="code" href="classElPoly.html#abfd537703af91a0dceb86c6bba5bd213">00246</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#abfd537703af91a0dceb86c6bba5bd213" title="Remove chains satisfying a condition.">ElPoly::RemoveChains</a>(){
<a name="l00247"></a>00247   <span class="keywordtype">int</span> nChain = <a class="code" href="classVarData.html#a9f6d9339cabdd81a05bf272c116ceea2" title="Number of chain.">pNChain</a>();
<a name="l00248"></a>00248   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d" title="Number of blocks.">pNBlock</a>();b++){
<a name="l00249"></a>00249     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>;c++){
<a name="l00250"></a>00250       <span class="keywordflow">if</span>(<a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].Pos[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>] &gt; .4*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>) &amp;&amp; <a class="code" href="classVarData.html#af2deb35998deb81dc9ef4ae6f65cc27d" title="Information on all chains.">Ch</a>[c].<a class="code" href="structCHAIN.html#ac00d29ea47aa8845638961a34cb3ec0e" title="xyzr Postion of the chain">Pos</a>[<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>] &lt; .6*<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>) ){
<a name="l00251"></a>00251    <a class="code" href="classVarData.html#a9b8f7a0f3ed7c785a4da59c58781d050" title="Swap two chains.">SwapChain</a>(c,nChain-1,b);
<a name="l00252"></a>00252    nChain--;
<a name="l00253"></a>00253    <a class="code" href="classVarData.html#a2e0b2cd0414a0994122e1dfae41e57b8" title="Set and reallocate the number of particles.">SetNPart</a>(<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>()-<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>());
<a name="l00254"></a>00254       }
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256     <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a> = nChain;
<a name="l00257"></a>00257   }
<a name="l00258"></a>00258   <a class="code" href="classVarData.html#a868e00b8cdabb8ea14fcec15942725ae" title="Set and reallocate the number of chains.">SetNChain</a>(nChain);
<a name="l00259"></a>00259   <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#a3fa6306dcea956ea84ce7b5f2b22f628" title="End particle position.">EndIdx</a> = <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>*<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#a521663d12899e0fefe0a182332a8573f" title="# particles per chain">NPCh</a>;
<a name="l00260"></a>00260   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=1;b&lt;<a class="code" href="classVarData.html#a474ffd5306304ac53eb7ef48a18e511d" title="Number of blocks.">pNBlock</a>();b++){
<a name="l00261"></a>00261     <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a71d10413e52e4e5aa82ac5e6189afdd0" title="Initial particle position.">InitIdx</a> = <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[0].<a class="code" href="structBLOCK.html#aa49e4d7af0d71e79524ef6fb081707b5" title="# chains">NChain</a>*<a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b].<a class="code" href="structBLOCK.html#a521663d12899e0fefe0a182332a8573f" title="# particles per chain">NPCh</a> + <a class="code" href="classVarData.html#ab8ead2169b1b4894b78fd3c264b6009e" title="Information for every block.">Block</a>[b-1].<a class="code" href="structBLOCK.html#a3fa6306dcea956ea84ce7b5f2b22f628" title="End particle position.">EndIdx</a>;
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263   <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">Write</a>(<span class="stringliteral">&quot;cleft.dat&quot;</span>);
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 <span class="comment">// int ElPoly::DensPatch(int NPatch,int Values){</span>
<a name="l00266"></a>00266 <span class="comment">//   int NType = 2;</span>
<a name="l00267"></a>00267 <span class="comment">//   double *DensProf = (double *)calloc(NPatch*Values,sizeof(double));</span>
<a name="l00268"></a>00268 <span class="comment">//   for(int f=NFile[0];f&lt;NFile[1];f++){</span>
<a name="l00269"></a>00269 <span class="comment">//    Processing(f);</span>
<a name="l00270"></a>00270 <span class="comment">//     fprintf(stderr,&quot;Processing: %d/%d %.1f %%\r&quot;,f,(NFile[1]-NFile[0]),(f-NFile[0])/(double)(NFile[1]-NFile[0])*100.);</span>
<a name="l00271"></a>00271 <span class="comment">//     if(OpenRisk(cFile[f],BF_PARTICLE))return 0;</span>
<a name="l00272"></a>00272     
<a name="l00273"></a>00273 <span class="comment">//   }</span>
<a name="l00274"></a>00274 <span class="comment">//   char *FileName = (char *)calloc(60,sizeof(char));</span>
<a name="l00275"></a>00275 <span class="comment">//   sprintf(FileName,&quot;ChainPArea%.0fRho%.0fChiN%.0fKappa.dat&quot;,Gen-&gt;rho,Gen-&gt;chiN,Gen-&gt;kappaN);</span>
<a name="l00276"></a>00276 <span class="comment">//   FileToWrite = fopen(FileName,&quot;w&quot;);</span>
<a name="l00277"></a>00277 <span class="comment">//   fprintf(FileToWrite,&quot;#%s\n&quot;,SysInfo());</span>
<a name="l00278"></a>00278 <span class="comment">// }</span>
<a name="l00279"></a><a class="code" href="classElPoly.html#a86e52eb42d4ead5eb6b800ab1fd3a4d2">00279</a> <span class="keywordtype">char</span> *<a class="code" href="classElPoly.html#a86e52eb42d4ead5eb6b800ab1fd3a4d2" title="Convert the internal definition for the menu of ElPoly in string.">ElPoly::ChooseDraw</a>(<span class="keywordtype">int</span> ExtWhat2Draw){
<a name="l00280"></a>00280   <span class="keywordtype">char</span> *String = (<span class="keywordtype">char</span> *)calloc(16,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00281"></a>00281   <span class="keywordflow">if</span>(ExtWhat2Draw == EL_PART)
<a name="l00282"></a>00282     sprintf(String,<span class="stringliteral">&quot;part&quot;</span>);
<a name="l00283"></a>00283   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_PART)
<a name="l00284"></a>00284     sprintf(String,<span class="stringliteral">&quot;part&quot;</span>);
<a name="l00285"></a>00285   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_CHAIN)
<a name="l00286"></a>00286     sprintf(String,<span class="stringliteral">&quot;chain&quot;</span>);
<a name="l00287"></a>00287   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_DENS)
<a name="l00288"></a>00288     sprintf(String,<span class="stringliteral">&quot;dens&quot;</span>);
<a name="l00289"></a>00289   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_QUAD)
<a name="l00290"></a>00290     sprintf(String,<span class="stringliteral">&quot;quad&quot;</span>);
<a name="l00291"></a>00291   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_QUAD1)
<a name="l00292"></a>00292     sprintf(String,<span class="stringliteral">&quot;quad1&quot;</span>);
<a name="l00293"></a>00293   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_POTENTIAL)
<a name="l00294"></a>00294     sprintf(String,<span class="stringliteral">&quot;pot&quot;</span>);
<a name="l00295"></a>00295   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_SURF)
<a name="l00296"></a>00296     sprintf(String,<span class="stringliteral">&quot;surf&quot;</span>);
<a name="l00297"></a>00297   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_CROSS)
<a name="l00298"></a>00298     sprintf(String,<span class="stringliteral">&quot;cross&quot;</span>);
<a name="l00299"></a>00299   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_ISOIPSE)
<a name="l00300"></a>00300     sprintf(String,<span class="stringliteral">&quot;isoipse&quot;</span>);
<a name="l00301"></a>00301   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_SAMPLE)
<a name="l00302"></a>00302     sprintf(String,<span class="stringliteral">&quot;sample&quot;</span>);
<a name="l00303"></a>00303   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_COLOR)
<a name="l00304"></a>00304     sprintf(String,<span class="stringliteral">&quot;color&quot;</span>);
<a name="l00305"></a>00305   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_SKIN)
<a name="l00306"></a>00306     sprintf(String,<span class="stringliteral">&quot;skin&quot;</span>);
<a name="l00307"></a>00307   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_POLYGON)
<a name="l00308"></a>00308     sprintf(String,<span class="stringliteral">&quot;polygon&quot;</span>);
<a name="l00309"></a>00309   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_ISOLEVEL)
<a name="l00310"></a>00310     sprintf(String,<span class="stringliteral">&quot;isolevel&quot;</span>);
<a name="l00311"></a>00311   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ExtWhat2Draw == EL_SQUAREMESH)
<a name="l00312"></a>00312     sprintf(String,<span class="stringliteral">&quot;squaremesh&quot;</span>);
<a name="l00313"></a>00313   <span class="keywordflow">return</span> String;
<a name="l00314"></a>00314 }
<a name="l00315"></a><a class="code" href="classElPoly.html#aba70049e8fa7f7b845f9ccd8ad700015">00315</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a86e52eb42d4ead5eb6b800ab1fd3a4d2" title="Convert the internal definition for the menu of ElPoly in string.">ElPoly::ChooseDraw</a>(<span class="keywordtype">char</span> *String){
<a name="l00316"></a>00316   <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;part&quot;</span>))
<a name="l00317"></a>00317     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_PART;
<a name="l00318"></a>00318   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;quad&quot;</span>))
<a name="l00319"></a>00319     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_QUAD;
<a name="l00320"></a>00320   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;chain&quot;</span>))
<a name="l00321"></a>00321     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_CHAIN;
<a name="l00322"></a>00322   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;dens&quot;</span>))
<a name="l00323"></a>00323     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_DENS;
<a name="l00324"></a>00324   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;quad1&quot;</span>))
<a name="l00325"></a>00325     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_QUAD1;
<a name="l00326"></a>00326   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;pot&quot;</span>))
<a name="l00327"></a>00327     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_POTENTIAL;
<a name="l00328"></a>00328   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;surf&quot;</span>))
<a name="l00329"></a>00329     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_SURF;
<a name="l00330"></a>00330   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;cross&quot;</span>))
<a name="l00331"></a>00331     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_CROSS;
<a name="l00332"></a>00332   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;isoipse&quot;</span>))
<a name="l00333"></a>00333     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_ISOIPSE;
<a name="l00334"></a>00334   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;sample&quot;</span>))
<a name="l00335"></a>00335     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_SAMPLE;
<a name="l00336"></a>00336   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;color&quot;</span>))
<a name="l00337"></a>00337     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_COLOR;
<a name="l00338"></a>00338   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;stalk&quot;</span>))
<a name="l00339"></a>00339     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_STALK;
<a name="l00340"></a>00340   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;skin&quot;</span>))
<a name="l00341"></a>00341     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_SKIN;
<a name="l00342"></a>00342   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;polygon&quot;</span>))
<a name="l00343"></a>00343     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_POLYGON;
<a name="l00344"></a>00344   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;isolevel&quot;</span>))
<a name="l00345"></a>00345     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_ISOLEVEL;
<a name="l00346"></a>00346   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(String,<span class="stringliteral">&quot;squaremesh&quot;</span>))
<a name="l00347"></a>00347     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = EL_SQUAREMESH;
<a name="l00348"></a>00348   <span class="keywordflow">else</span>
<a name="l00349"></a>00349     <a class="code" href="classElPoly.html#a247a6410f4f46763810a706af08a1c70" title="Draw the content in the appropriate visulization.">What2Draw</a> = 0;
<a name="l00350"></a>00350 }
<a name="l00351"></a><a class="code" href="classElPoly.html#a464eca35e2fcc5f03f9f8be8702f36cc">00351</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a464eca35e2fcc5f03f9f8be8702f36cc" title="Set the initial and final number of files.">ElPoly::SetBoundFile</a>(<span class="keywordtype">int</span> InitFile,<span class="keywordtype">int</span> EndFile){
<a name="l00352"></a>00352   <span class="keywordflow">if</span>(InitFile &lt; 0)
<a name="l00353"></a>00353     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = 0;
<a name="l00354"></a>00354   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(InitFile &lt; EndFile){
<a name="l00355"></a>00355     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0] = InitFile;
<a name="l00356"></a>00356     <a class="code" href="classElPoly.html#af67f045188086b91309e231e77a86076" title="Current number of the file list.">quando</a> = InitFile;
<a name="l00357"></a>00357   }
<a name="l00358"></a>00358   <span class="keywordflow">else</span> {
<a name="l00359"></a>00359     printf(<span class="stringliteral">&quot;Wrong init file %d !&lt; %d\n&quot;</span>,InitFile,EndFile);
<a name="l00360"></a>00360   }
<a name="l00361"></a>00361   <span class="keywordflow">if</span>(EndFile &gt;= <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>)
<a name="l00362"></a>00362     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = <a class="code" href="classElPoly.html#ad7dff49d260c06459abb507a09fa932d" title="Total number of file.">NFileTot</a>-1;
<a name="l00363"></a>00363   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(EndFile &gt; InitFile)
<a name="l00364"></a>00364     <a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1] = EndFile;
<a name="l00365"></a>00365   <span class="keywordflow">else</span> {
<a name="l00366"></a>00366     printf(<span class="stringliteral">&quot;Wrong end file %d !&lt; %d\n&quot;</span>,InitFile,EndFile);
<a name="l00367"></a>00367   }
<a name="l00368"></a>00368 }
<a name="l00369"></a><a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a">00369</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">ElPoly::Processing</a>(<span class="keywordtype">int</span> f){
<a name="l00370"></a>00370   fprintf(stderr,<span class="stringliteral">&quot;Processing: %s %d/%d %.1f %%\r&quot;</span>,cFile[f],f,(<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1]-<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0]),(f-<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0])/(<span class="keywordtype">double</span>)(<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1]-<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0])*100.);
<a name="l00371"></a>00371 }
<a name="l00372"></a><a class="code" href="classElPoly.html#a2d5b51a7f120a4104f6e5070ca6c55f5">00372</a> <span class="keywordtype">void</span> <a class="code" href="classElPoly.html#a2d5b51a7f120a4104f6e5070ca6c55f5" title="Shift the system to the center.">ElPoly::Shift2Center</a>(){
<a name="l00373"></a>00373   <span class="keywordtype">double</span> sigma = 
<a name="l00374"></a>00374     sqrt(QUAD(<a class="code" href="classVarData.html#a71e85d43bc5bd1fcb6563c91a67576b2" title="Re/CutOff.">pReOverCutOff</a>())/(<a class="code" href="classVarData.html#a0ad300d40b5d4a3391361b4c8875091f" title="Number of particle per chain.">pNPCh</a>()-1)/3.);
<a name="l00375"></a>00375   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[0];f&lt;<a class="code" href="classElPoly.html#afc36f5ebb0ee5c1be5fc2161e1fa3959" title="First and last file of the list.">NFile</a>[1];f++){
<a name="l00376"></a>00376     <a class="code" href="classElPoly.html#a02045f98c00a6ef6af607bc27fc3e82a" title="Information on the current file elaborated.">Processing</a>(f);
<a name="l00377"></a>00377     <a class="code" href="classVarData.html#a50a785f6295f7e7fb2494fcad2a2a7fc" title="Open the.">Open</a>(cFile[f],BF_NO);
<a name="l00378"></a>00378     <span class="comment">// for(int d=0;d&lt;3;d++){</span>
<a name="l00379"></a>00379     <span class="comment">//   ShiftPos[d] = .5 - pCm(d)*pInvEdge(d);</span>
<a name="l00380"></a>00380     <span class="comment">// }</span>
<a name="l00381"></a>00381     <span class="comment">// ShiftRef(BF_CHAIN);</span>
<a name="l00382"></a>00382     <span class="keywordtype">double</span> Temp = <a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>);
<a name="l00383"></a>00383     <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30" title="Set Edge.">SetEdge</a>(<a class="code" href="classVarData.html#ab1955d8a8a364358ea5cb9b22419941d" title="xyzr edges of the simulation box">pEdge</a>(<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>),<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>);
<a name="l00384"></a>00384     <a class="code" href="classVarData.html#ac659e9234deb7729483b32fd9d6b5b30" title="Set Edge.">SetEdge</a>(Temp,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>);
<a name="l00385"></a>00385     
<a name="l00386"></a>00386     <span class="comment">// FILE *FWrite = fopen(&quot;Response.dat&quot;,&quot;w&quot;);</span>
<a name="l00387"></a>00387     <span class="comment">// fprintf(FWrite,&quot;# L=%lf %lf %lf t=%lf blocks=%d\n&quot;,pEdge(0),pEdge(1),pEdge(2),pTime(),pNBlock());</span>
<a name="l00388"></a>00388     <span class="comment">// HeaderInteraction(FWrite);</span>
<a name="l00389"></a>00389     <span class="comment">// HeaderNano(FWrite);</span>
<a name="l00390"></a>00390     <span class="comment">// fprintf(FWrite,&quot;# n=%d N=%d name=%s\n&quot;,Block[0].NChain,Block[0].NPCh,Block[0].Name);</span>
<a name="l00391"></a>00391     <span class="comment">// int NChain = 0;</span>
<a name="l00392"></a>00392     <span class="comment">// for(int c=0;c&lt;pNChain();c++){</span>
<a name="l00393"></a>00393     <span class="comment">//   double Dist = 0.;</span>
<a name="l00394"></a>00394     <span class="comment">//   for(int d=0;d&lt;3;d++){</span>
<a name="l00395"></a>00395     <span class="comment">//   Dist += SQR(Nano-&gt;Pos[d] - Ch[c].Pos[d]);</span>
<a name="l00396"></a>00396     <span class="comment">//   }</span>
<a name="l00397"></a>00397     <span class="comment">//   if(Dist &gt; SQR(2.5*Nano-&gt;Rad)) continue;</span>
<a name="l00398"></a>00398     <span class="comment">//   for(int p=c*pNPCh();p&lt;(c+1)*pNPCh();p++){</span>
<a name="l00399"></a>00399     <span class="comment">//   fprintf(FWrite,&quot;%lf %lf %lf %lf %lf %lf %d\n&quot;,</span>
<a name="l00400"></a>00400     <span class="comment">//      pPos(p,0),pPos(p,1),pPos(p,2),</span>
<a name="l00401"></a>00401     <span class="comment">//      pVel(p,0),pVel(p,1),pVel(p,2),pType(p));</span>
<a name="l00402"></a>00402     <span class="comment">//   }</span>
<a name="l00403"></a>00403     <span class="comment">//   NChain++;</span>
<a name="l00404"></a>00404     <span class="comment">// }</span>
<a name="l00405"></a>00405     <span class="comment">// printf(&quot;Number of chains %d\n&quot;,NChain);</span>
<a name="l00406"></a>00406     <span class="comment">// return;</span>
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0;p&lt;<a class="code" href="classVarData.html#a388622b5e7d2ad20e8ac1a8a951d655f" title="Number of particle.">pNPart</a>();p++){
<a name="l00409"></a>00409       <span class="keywordtype">double</span> Pos[3] = {<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#ac5f3674d89bb344da0be11d57eea248e" title="Normal coordinate.">CNorm</a>),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#a08e2743fbc74ffadb73bf88a833cd03f" title="lateral coordinate">CLat1</a>),<a class="code" href="classVarData.html#ab70211c3dc01d352727d2052b2c555c5" title="Return back folded position.">pPos</a>(p,<a class="code" href="classVarData.html#a14ec5e9f32dac94d5974f23bbba4ff86" title="lateral coordinate">CLat2</a>)};
<a name="l00410"></a>00410       <a class="code" href="classVarData.html#a5b8f787336ad1a776f82be0a59c9f570" title="Set the particle position.">SetPos</a>(p,Pos);
<a name="l00411"></a>00411       <span class="comment">// for(int d=0;d&lt;3;d++){</span>
<a name="l00412"></a>00412       <span class="comment">//    Pm[p].Vel[d] = Mat-&gt;Gaussiano(0.,sigma);</span>
<a name="l00413"></a>00413       <span class="comment">// }</span>
<a name="l00414"></a>00414     }
<a name="l00415"></a>00415     <a class="code" href="classVarData.html#a054aab836dcf7735720ef32e0b8f7ecb" title="Writes a &quot;system-file&quot; or a &quot;x y z&quot; file".">Write</a>(cFile[f]);
<a name="l00416"></a>00416   }
<a name="l00417"></a>00417 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 27 2014 22:02:19 for Allink by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
